(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{1036:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(613)},123:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"e",(function(){return createAzureCommunicationChatAdapter})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ChatComposite_ChatComposite})),__webpack_require__.d(__webpack_exports__,"a",(function(){return Call_Call})),__webpack_require__.d(__webpack_exports__,"d",(function(){return createAzureCommunicationCallAdapter})),__webpack_require__.d(__webpack_exports__,"c",(function(){return MeetingComposite_MeetingComposite}));__webpack_require__(8),__webpack_require__(18),__webpack_require__(9),__webpack_require__(352),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(10),__webpack_require__(50),__webpack_require__(37),__webpack_require__(87),__webpack_require__(115),__webpack_require__(212);var src_chatClient=__webpack_require__(444),src=__webpack_require__(36),events=(__webpack_require__(113),__webpack_require__(166),__webpack_require__(77),__webpack_require__(520),__webpack_require__(73),__webpack_require__(764),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29),__webpack_require__(40),__webpack_require__(156)),events_default=__webpack_require__.n(events),immer_esm=__webpack_require__(39);__webpack_require__(713),__webpack_require__(129),__webpack_require__(81),__webpack_require__(90),__webpack_require__(138),__webpack_require__(178),__webpack_require__(712);function _possibleConstructorReturn(self,call){return!call||"object"!=typeof call&&"function"!=typeof call?function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self):call}function _wrapNativeSuper(Class){var _cache="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function _wrapNativeSuper(Class){if(null===Class||!function _isNativeFunction(fn){return-1!==Function.toString.call(fn).indexOf("[native code]")}(Class))return Class;if("function"!=typeof Class)throw new TypeError("Super expression must either be null or a function");if(void 0!==_cache){if(_cache.has(Class))return _cache.get(Class);_cache.set(Class,Wrapper)}function Wrapper(){return _construct(Class,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(Class.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,Class)})(Class)}function _construct(Parent,args,Class){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(Parent,args,Class){var a=[null];a.push.apply(a,args);var instance=new(Function.bind.apply(Parent,a));return Class&&_setPrototypeOf(instance,Class.prototype),instance}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(o,p){return o.__proto__=p,o})(o,p)}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}var ChatError=function(_Error){!function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}(ChatError,_Error);var _super=function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var result,Super=_getPrototypeOf(Derived);if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return _possibleConstructorReturn(this,result)}}(ChatError);function ChatError(target,inner){var _this;return function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ChatError),(_this=_super.call(this)).target=void 0,_this.inner=void 0,_this.target=target,_this.inner=inner,_this.name="ChatError",_this.message=_this.target+": "+_this.inner.message,_this}return ChatError}(_wrapNativeSuper(Error)),Constants_TYPING_INDICATOR_MAINTAIN_TIME=8e3;new Date(0);function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var newClearErrorsModifier=function newClearErrorsModifier(targets){return function(draft){var _step,_iterator=_createForOfIteratorHelper(targets);try{for(_iterator.s();!(_step=_iterator.n()).done;){var target=_step.value;void 0!==draft.latestErrors[target]&&delete draft.latestErrors[target]}}catch(err){_iterator.e(err)}finally{_iterator.f()}}};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function ChatContext_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function ChatContext_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ChatContext_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ChatContext_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function ChatContext_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}Object(immer_esm.b)();var ChatContext_ChatContext=function(){function ChatContext(maxListeners){!function ChatContext_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ChatContext),this._state={userId:{id:""},displayName:"",threads:{},latestErrors:{}},this._batchMode=!1,this._emitter=void 0,this.typingIndicatorInterval=void 0,this._emitter=new events_default.a,maxListeners&&this._emitter.setMaxListeners(maxListeners)}return function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}(ChatContext,[{key:"setState",value:function setState(state){this._state=state,this._batchMode||this._emitter.emit("stateChanged",this._state)}},{key:"getState",value:function getState(){return this._state}},{key:"modifyState",value:function modifyState(modifier){var _this=this;this.batch((function(){_this.setState(Object(immer_esm.a)(_this._state,(function(draft){modifier(draft)})))}))}},{key:"setThread",value:function setThread(threadId,threadState){this.setState(Object(immer_esm.a)(this._state,(function(draft){draft.threads[threadId]=threadState})))}},{key:"createThread",value:function createThread(threadId,properties){this.setState(Object(immer_esm.a)(this._state,(function(draft){draft.threads[threadId]={chatMessages:{},threadId:threadId,properties:properties,participants:{},readReceipts:[],typingIndicators:[],latestReadTime:new Date(0)}})))}},{key:"updateChatConfig",value:function updateChatConfig(userId,displayName){this.setState(Object(immer_esm.a)(this._state,(function(draft){draft.displayName=displayName,draft.userId=userId})))}},{key:"createThreadIfNotExist",value:function createThreadIfNotExist(threadId,properties){return!Object.prototype.hasOwnProperty.call(this.getState().threads,threadId)&&(this.createThread(threadId,properties),!0)}},{key:"updateThread",value:function updateThread(threadId,properties){this.setState(Object(immer_esm.a)(this._state,(function(draft){var thread=draft.threads[threadId];thread&&(thread.properties=properties)})))}},{key:"updateThreadTopic",value:function updateThreadTopic(threadId,topic){this.setState(Object(immer_esm.a)(this._state,(function(draft){if(void 0!==topic){var thread=draft.threads[threadId];thread&&!thread.properties?thread.properties={topic:topic}:thread&&thread.properties&&(thread.properties.topic=topic)}})))}},{key:"deleteThread",value:function deleteThread(threadId){this.setState(Object(immer_esm.a)(this._state,(function(draft){draft.threads[threadId]&&delete draft.threads[threadId]})))}},{key:"setChatMessages",value:function setChatMessages(threadId,messages){var _this2=this;this.setState(Object(immer_esm.a)(this._state,(function(draft){var threadState=draft.threads[threadId];threadState&&(threadState.chatMessages=messages);var thread=draft.threads[threadId];if(thread)for(var _i=0,_Object$values=Object.values(messages);_i<_Object$values.length;_i++){var message=_Object$values[_i];_this2.filterTypingIndicatorForUser(thread,message.sender)}})))}},{key:"updateChatMessageContent",value:function updateChatMessageContent(threadId,messagesId,content){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$thread,chatMessage=null===(_draft$threads$thread=draft.threads[threadId])||void 0===_draft$threads$thread?void 0:_draft$threads$thread.chatMessages[messagesId];chatMessage&&(chatMessage.content||(chatMessage.content={}),chatMessage.content.message=content)})))}},{key:"deleteLocalMessage",value:function deleteLocalMessage(threadId,localId){var localMessageDeleted=!1;return this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$thread2,chatMessages=null===(_draft$threads$thread2=draft.threads[threadId])||void 0===_draft$threads$thread2?void 0:_draft$threads$thread2.chatMessages,message=chatMessages?chatMessages[localId]:void 0;chatMessages&&message&&message.clientMessageId&&(delete chatMessages[message.clientMessageId],localMessageDeleted=!0)}))),localMessageDeleted}},{key:"deleteMessage",value:function deleteMessage(threadId,id){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$thread3,chatMessages=null===(_draft$threads$thread3=draft.threads[threadId])||void 0===_draft$threads$thread3?void 0:_draft$threads$thread3.chatMessages;chatMessages&&delete chatMessages[id]})))}},{key:"setParticipant",value:function setParticipant(threadId,participant){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$thread4,participants=null===(_draft$threads$thread4=draft.threads[threadId])||void 0===_draft$threads$thread4?void 0:_draft$threads$thread4.participants;participants&&(participants[Object(src.d)(participant.id)]=participant)})))}},{key:"setParticipants",value:function setParticipants(threadId,participants){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$thread5,participantsMap=null===(_draft$threads$thread5=draft.threads[threadId])||void 0===_draft$threads$thread5?void 0:_draft$threads$thread5.participants;if(participantsMap){var _step,_iterator=ChatContext_createForOfIteratorHelper(participants);try{for(_iterator.s();!(_step=_iterator.n()).done;){var participant=_step.value;participantsMap[Object(src.d)(participant.id)]=participant}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})))}},{key:"deleteParticipants",value:function deleteParticipants(threadId,participantIds){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$thread6,participants=null===(_draft$threads$thread6=draft.threads[threadId])||void 0===_draft$threads$thread6?void 0:_draft$threads$thread6.participants;participants&&participantIds.forEach((function(id){delete participants[Object(src.d)(id)]}))})))}},{key:"deleteParticipant",value:function deleteParticipant(threadId,participantId){this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$thread7,participants=null===(_draft$threads$thread7=draft.threads[threadId])||void 0===_draft$threads$thread7?void 0:_draft$threads$thread7.participants;participants&&delete participants[Object(src.d)(participantId)]})))}},{key:"addReadReceipt",value:function addReadReceipt(threadId,readReceipt){var _this3=this;this.setState(Object(immer_esm.a)(this._state,(function(draft){var thread=draft.threads[threadId],readReceipts=null==thread?void 0:thread.readReceipts;thread&&readReceipts&&(readReceipt.sender!==_this3.getState().userId&&thread.latestReadTime<readReceipt.readOn&&(thread.latestReadTime=readReceipt.readOn),readReceipts.push(readReceipt))})))}},{key:"startTypingIndicatorCleanUp",value:function startTypingIndicatorCleanUp(){var _this4=this;this.typingIndicatorInterval||(this.typingIndicatorInterval=window.setInterval((function(){var isTypingActive=!1,isStateChanged=!1,newState=Object(immer_esm.a)(_this4._state,(function(draft){for(var _i2=0,_Object$values2=Object.values(draft.threads);_i2<_Object$values2.length;_i2++){var thread=_Object$values2[_i2],filteredTypingIndicators=thread.typingIndicators.filter((function(typingIndicator){return Date.now()-typingIndicator.receivedOn.getTime()<Constants_TYPING_INDICATOR_MAINTAIN_TIME}));thread.typingIndicators.length!==filteredTypingIndicators.length&&(isStateChanged=!0,thread.typingIndicators=filteredTypingIndicators),thread.typingIndicators.length>0&&(isTypingActive=!0)}}));isStateChanged&&_this4.setState(newState),!isTypingActive&&_this4.typingIndicatorInterval&&(window.clearInterval(_this4.typingIndicatorInterval),_this4.typingIndicatorInterval=void 0)}),1e3))}},{key:"addTypingIndicator",value:function addTypingIndicator(threadId,typingIndicator){this.setState(Object(immer_esm.a)(this._state,(function(draft){var thread=draft.threads[threadId];thread&&thread.typingIndicators.push(typingIndicator)}))),this.startTypingIndicatorCleanUp()}},{key:"setChatMessage",value:function setChatMessage(threadId,message){var _this5=this,messageId=message.id,clientMessageId=message.clientMessageId;(messageId||clientMessageId)&&this.setState(Object(immer_esm.a)(this._state,(function(draft){var _draft$threads$thread8,threadMessages=null===(_draft$threads$thread8=draft.threads[threadId])||void 0===_draft$threads$thread8?void 0:_draft$threads$thread8.chatMessages,isLocalIdInMap=threadMessages&&clientMessageId&&threadMessages[clientMessageId],messageKey=!messageId||isLocalIdInMap?clientMessageId:messageId;threadMessages&&messageKey&&(threadMessages[messageKey]=message);var thread=draft.threads[threadId];thread&&_this5.filterTypingIndicatorForUser(thread,message.sender)})))}},{key:"withAsyncErrorTeedToState",value:function withAsyncErrorTeedToState(f,target,clearTargets){var _this6=this;return _asyncToGenerator(regeneratorRuntime.mark((function _callee(){var ret,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,f.apply(void 0,_args);case 3:return ret=_context.sent,_this6.modifyState(newClearErrorsModifier(void 0!==clearTargets?clearTargets:[target])),_context.abrupt("return",ret);case 8:throw _context.prev=8,_context.t0=_context.catch(0),_this6.setLatestError(target,_context.t0),new ChatError(target,_context.t0);case 12:case"end":return _context.stop()}}),_callee,null,[[0,8]])})))}},{key:"withErrorTeedToState",value:function withErrorTeedToState(f,target,clearTargets){var _this7=this;return function(){try{var ret=f.apply(void 0,arguments);return _this7.modifyState(newClearErrorsModifier(void 0!==clearTargets?clearTargets:[target])),ret}catch(error){throw _this7.setLatestError(target,error),new ChatError(target,error)}}}},{key:"setLatestError",value:function setLatestError(target,error){this.setState(Object(immer_esm.a)(this._state,(function(draft){draft.latestErrors[target]=error})))}},{key:"filterTypingIndicatorForUser",value:function filterTypingIndicatorForUser(thread,userId){if(userId){var typingIndicators=thread.typingIndicators,userIdAsKey=Object(src.d)(userId),filteredTypingIndicators=typingIndicators.filter((function(typingIndicator){return Object(src.d)(typingIndicator.sender)!==userIdAsKey}));filteredTypingIndicators.length!==typingIndicators.length&&(thread.typingIndicators=filteredTypingIndicators)}}},{key:"batch",value:function batch(operations){if(this._batchMode)throw new Error("batch() called from within another batch()");this._batchMode=!0;var priorState=this._state;try{operations(),this._state!==priorState&&this._emitter.emit("stateChanged",this._state)}catch(e){this._state=priorState}finally{this._batchMode=!1}}},{key:"onStateChange",value:function onStateChange(handler){this._emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this._emitter.off("stateChanged",handler)}}]),ChatContext}(),convertChatMessage=(__webpack_require__(34),function convertChatMessage(message){var status=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"delivered",clientMessageId=arguments.length>2?arguments[2]:void 0;return Object.assign({},message,{clientMessageId:clientMessageId,status:status})});function EventSubscriber_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncIterator(iterable){var method;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(method=iterable[Symbol.asyncIterator]),null==method&&Symbol.iterator&&(method=iterable[Symbol.iterator])),null==method&&(method=iterable["@@asyncIterator"]),null==method&&(method=iterable["@@iterator"]),null==method)throw new TypeError("Object is not async iterable");return method.call(iterable)}var EventSubscriber_EventSubscriber=function EventSubscriber(chatClient,chatContext){var _this=this;!function EventSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,EventSubscriber),this.chatClient=void 0,this.chatContext=void 0,this.convertEventToChatMessage=function(event){return convertChatMessage({id:event.id,version:event.version,content:{message:event.message},type:event.type,sender:event.sender,senderDisplayName:event.senderDisplayName,sequenceId:"",createdOn:new Date(event.createdOn)})},this.onChatMessageReceived=function(event){var _this$chatContext$get,newMessage=_this.convertEventToChatMessage(event),existingMessage=null===(_this$chatContext$get=_this.chatContext.getState().threads[event.threadId])||void 0===_this$chatContext$get?void 0:_this$chatContext$get.chatMessages[event.id];existingMessage&&(newMessage.sequenceId=existingMessage.sequenceId),_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(event.threadId),_this.chatContext.setChatMessage(event.threadId,newMessage)}))},this.onChatMessageDeleted=function(event){_this.chatContext.deleteMessage(event.threadId,event.id)},this.onChatMessageEdited=function(event){var editedMessage=_this.convertEventToChatMessage(event);_this.chatContext.setChatMessage(event.threadId,convertChatMessage(editedMessage))},this.onParticipantsAdded=function(event){var participantsToAdd=event.participantsAdded.map((function(participant){return Object.assign({},participant,{shareHistoryTime:participant.shareHistoryTime?new Date(participant.shareHistoryTime):void 0})}));_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(event.threadId),_this.chatContext.setParticipants(event.threadId,participantsToAdd)})),_this.fetchLastParticipantMessage(event.threadId,"participantAdded")},this.fetchLastParticipantMessage=function(){var _ref=function EventSubscriber_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){EventSubscriber_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){EventSubscriber_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(threadId,actionType){var _iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,_value,message;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:_iteratorNormalCompletion=!0,_didIteratorError=!1,_context.prev=2,_iterator=_asyncIterator(_this.chatClient.getChatThreadClient(threadId).listMessages());case 4:return _context.next=6,_iterator.next();case 6:return _step=_context.sent,_iteratorNormalCompletion=_step.done,_context.next=10,_step.value;case 10:if(_value=_context.sent,_iteratorNormalCompletion){_context.next=19;break}if((message=_value).type!==actionType){_context.next=16;break}return _this.chatContext.setChatMessage(threadId,Object.assign({},message,{status:"delivered"})),_context.abrupt("break",19);case 16:_iteratorNormalCompletion=!0,_context.next=4;break;case 19:_context.next=25;break;case 21:_context.prev=21,_context.t0=_context.catch(2),_didIteratorError=!0,_iteratorError=_context.t0;case 25:if(_context.prev=25,_context.prev=26,_iteratorNormalCompletion||null==_iterator.return){_context.next=30;break}return _context.next=30,_iterator.return();case 30:if(_context.prev=30,!_didIteratorError){_context.next=33;break}throw _iteratorError;case 33:return _context.finish(30);case 34:return _context.finish(25);case 35:case"end":return _context.stop()}}),_callee,null,[[2,21,25,35],[26,,30,34]])})));return function(_x,_x2){return _ref.apply(this,arguments)}}(),this.onParticipantsRemoved=function(event){var participantIds=event.participantsRemoved.map((function(participant){return participant.id}));_this.chatContext.deleteParticipants(event.threadId,participantIds),_this.fetchLastParticipantMessage(event.threadId,"participantRemoved")},this.onReadReceiptReceived=function(event){var readReceipt=Object.assign({},event,{sender:event.sender,readOn:new Date(event.readOn)});_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(event.threadId),_this.chatContext.addReadReceipt(event.threadId,readReceipt)}))},this.onTypingIndicatorReceived=function(typingIndicator){_this.chatContext.batch((function(){_this.chatContext.createThreadIfNotExist(typingIndicator.threadId),_this.chatContext.addTypingIndicator(typingIndicator.threadId,typingIndicator)}))},this.onChatThreadCreated=function(event){var properties={topic:event.properties.topic};_this.chatContext.createThreadIfNotExist(event.threadId,properties)||_this.chatContext.updateThread(event.threadId,properties)},this.onChatThreadDeleted=function(event){_this.chatContext.deleteThread(event.threadId)},this.onChatThreadPropertiesUpdated=function(event){_this.chatContext.updateThread(event.threadId,{topic:event.properties.topic})},this.subscribe=function(){_this.chatClient.on("chatMessageReceived",_this.onChatMessageReceived),_this.chatClient.on("chatMessageDeleted",_this.onChatMessageDeleted),_this.chatClient.on("chatMessageEdited",_this.onChatMessageEdited),_this.chatClient.on("participantsAdded",_this.onParticipantsAdded),_this.chatClient.on("participantsRemoved",_this.onParticipantsRemoved),_this.chatClient.on("readReceiptReceived",_this.onReadReceiptReceived),_this.chatClient.on("typingIndicatorReceived",_this.onTypingIndicatorReceived),_this.chatClient.on("chatThreadCreated",_this.onChatThreadCreated),_this.chatClient.on("chatThreadDeleted",_this.onChatThreadDeleted),_this.chatClient.on("chatThreadPropertiesUpdated",_this.onChatThreadPropertiesUpdated)},this.unsubscribe=function(){_this.chatClient.off("chatMessageReceived",_this.onChatMessageReceived),_this.chatClient.off("chatMessageDeleted",_this.onChatMessageDeleted),_this.chatClient.off("chatMessageEdited",_this.onChatMessageEdited),_this.chatClient.off("participantsAdded",_this.onParticipantsAdded),_this.chatClient.off("participantsRemoved",_this.onParticipantsRemoved),_this.chatClient.off("readReceiptReceived",_this.onReadReceiptReceived),_this.chatClient.off("typingIndicatorReceived",_this.onTypingIndicatorReceived),_this.chatClient.off("chatThreadCreated",_this.onChatThreadCreated),_this.chatClient.off("chatThreadDeleted",_this.onChatThreadDeleted),_this.chatClient.off("chatThreadPropertiesUpdated",_this.onChatThreadPropertiesUpdated)},this.chatClient=chatClient,this.chatContext=chatContext,this.subscribe()},identifierModels=__webpack_require__(329),index_browser=__webpack_require__(826);function createDecoratedIterator_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function createDecoratedIterator_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return createDecoratedIterator_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return createDecoratedIterator_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function createDecoratedIterator_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function createDecoratedIterator_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function createDecoratedIterator_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){createDecoratedIterator_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){createDecoratedIterator_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var createDecoratedIterator=function createDecoratedIterator(iteratorCreator,context,decorateFn){return function(){var _ref2,_next2,threadsIterator=iteratorCreator.apply(void 0,arguments);return(_ref2={next:(_next2=createDecoratedIterator_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var result;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,threadsIterator.next();case 2:return!(result=_context.sent).done&&result.value&&decorateFn(result.value,context),_context.abrupt("return",result);case 5:case"end":return _context.stop()}}),_callee)}))),function next(){return _next2.apply(this,arguments)})})[Symbol.asyncIterator]=function(){return this},_ref2.byPage=function byPage(){var _ref,_next3,settings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},pages=threadsIterator.byPage(settings);return(_ref={next:(_next3=createDecoratedIterator_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var result,page;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,pages.next();case 2:return result=_context2.sent,page=result.value,!result.done&&result.value&&context.batch((function(){var _step,_iterator=createDecoratedIterator_createForOfIteratorHelper(page);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _item=_step.value;decorateFn(_item,context)}}catch(err){_iterator.e(err)}finally{_iterator.f()}})),_context2.abrupt("return",result);case 6:case"end":return _context2.stop()}}),_callee2)}))),function next(){return _next3.apply(this,arguments)})})[Symbol.asyncIterator]=function(){return this},_ref},_ref2}},createErrorHandlingIterator=function createErrorHandlingIterator(iteratorCreator,context,target,clearTargets){return function(){var _ref4,innerIter=iteratorCreator.apply(void 0,arguments);return(_ref4={next:context.withAsyncErrorTeedToState(innerIter.next.bind(innerIter),target,clearTargets)})[Symbol.asyncIterator]=function(){return this},_ref4.byPage=function byPage(){var _ref3,settings=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},pages=innerIter.byPage(settings);return(_ref3={next:context.withAsyncErrorTeedToState(pages.next.bind(pages),target,clearTargets)})[Symbol.asyncIterator]=function(){return this},_ref3},_ref4}};function StatefulChatThreadClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StatefulChatThreadClient_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StatefulChatThreadClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StatefulChatThreadClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function StatefulChatThreadClient_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var StatefulChatThreadClient_ProxyChatThreadClient=function(){function ProxyChatThreadClient(context){!function StatefulChatThreadClient_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyChatThreadClient),this._context=void 0,this._context=context}return function StatefulChatThreadClient_createClass(Constructor,protoProps,staticProps){return protoProps&&StatefulChatThreadClient_defineProperties(Constructor.prototype,protoProps),staticProps&&StatefulChatThreadClient_defineProperties(Constructor,staticProps),Constructor}(ProxyChatThreadClient,[{key:"get",value:function get(chatThreadClient,prop){var _this=this;switch(prop){case"listMessages":return function createDecoratedListMessages(chatThreadClient,context){return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatThreadClient.listMessages.bind(chatThreadClient),"ChatThreadClient.listMessages"),context,"ChatThreadClient.listMessages"),context,(function setMessage(message,context){context.setChatMessage(chatThreadClient.threadId,convertChatMessage(message))}))}(chatThreadClient,this._context);case"getMessage":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var message,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,chatThreadClient.getMessage.apply(chatThreadClient,_args);case 2:return message=_context.sent,_this._context.setChatMessage(chatThreadClient.threadId,convertChatMessage(message)),_context.abrupt("return",message);case 5:case"end":return _context.stop()}}),_callee)}))),"ChatThreadClient.getMessage");case"sendMessage":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var _result,_ref3,content,clientMessageId,newMessage,result,_args2=arguments;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _ref3=_args2.length<=0?void 0:_args2[0],content=_ref3.content,clientMessageId=Object(index_browser.a)(),newMessage={content:{message:content},clientMessageId:clientMessageId,id:"",type:"text",sequenceId:"",version:"",createdOn:new Date,status:"sending",senderDisplayName:_this._context.getState().displayName,sender:_this._context.getState().userId},_this._context.setChatMessage(chatThreadClient.threadId,newMessage),result=void 0,_context2.prev=5,_context2.next=8,chatThreadClient.sendMessage.apply(chatThreadClient,_args2);case 8:result=_context2.sent,_context2.next=15;break;case 11:throw _context2.prev=11,_context2.t0=_context2.catch(5),_this._context.setChatMessage(chatThreadClient.threadId,Object.assign({},newMessage,{status:"failed"})),_context2.t0;case 15:return null!==(_result=result)&&void 0!==_result&&_result.id&&_this._context.batch((function(){result&&(_this._context.setChatMessage(chatThreadClient.threadId,Object.assign({},newMessage,{clientMessageId:void 0,status:"delivered",id:result.id})),_this._context.deleteLocalMessage(chatThreadClient.threadId,clientMessageId))})),_context2.abrupt("return",result);case 17:case"end":return _context2.stop()}}),_callee2,null,[[5,11]])}))),"ChatThreadClient.sendMessage");case"addParticipants":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var _len,args,_key,result,addRequest,participantsToAdd,_args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:for(_len=_args3.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=_args3[_key];return _context3.next=3,chatThreadClient.addParticipants.apply(chatThreadClient,args);case 3:return result=_context3.sent,addRequest=args[0],participantsToAdd=addRequest.participants,_this._context.setParticipants(chatThreadClient.threadId,participantsToAdd),_context3.abrupt("return",result);case 8:case"end":return _context3.stop()}}),_callee3)}))),"ChatThreadClient.addParticipants");case"deleteMessage":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var _len2,args,_key2,messageId,result,_args4=arguments;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:for(_len2=_args4.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=_args4[_key2];if(messageId=args[0],!_this._context.deleteLocalMessage(chatThreadClient.threadId,messageId)){_context4.next=4;break}return _context4.abrupt("return",{});case 4:return _context4.next=6,chatThreadClient.deleteMessage.apply(chatThreadClient,args);case 6:return result=_context4.sent,_this._context.deleteMessage(chatThreadClient.threadId,messageId),_context4.abrupt("return",result);case 9:case"end":return _context4.stop()}}),_callee4)}))),"ChatThreadClient.deleteMessage");case"listParticipants":return function createDecoratedListParticipants(chatThreadClient,context){return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatThreadClient.listParticipants.bind(chatThreadClient),"ChatThreadClient.listParticipants"),context,"ChatThreadClient.listParticipants"),context,(function setParticipant(participant,context){context.setParticipant(chatThreadClient.threadId,participant)}))}(chatThreadClient,this._context);case"listReadReceipts":return function createDecoratedListReadReceipts(chatThreadClient,context){return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatThreadClient.listReadReceipts.bind(chatThreadClient),"ChatThreadClient.listReadReceipts"),context,"ChatThreadClient.listReadReceipts"),context,(function setReadReceipt(readReceipt,context){context.addReadReceipt(chatThreadClient.threadId,Object.assign({},readReceipt))}))}(chatThreadClient,this._context);case"removeParticipant":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var _len3,args,_key3,result,removeIdentifier,_args5=arguments;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:for(_len3=_args5.length,args=new Array(_len3),_key3=0;_key3<_len3;_key3++)args[_key3]=_args5[_key3];return _context5.next=3,chatThreadClient.removeParticipant.apply(chatThreadClient,args);case 3:return result=_context5.sent,removeIdentifier=args[0],_this._context.deleteParticipant(chatThreadClient.threadId,Object(identifierModels.a)(removeIdentifier)),_context5.abrupt("return",result);case 7:case"end":return _context5.stop()}}),_callee5)}))),"ChatThreadClient.removeParticipant");case"updateMessage":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){var _len4,args,_key4,result,messageId,updateOption,_args6=arguments;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:for(_len4=_args6.length,args=new Array(_len4),_key4=0;_key4<_len4;_key4++)args[_key4]=_args6[_key4];return _context6.next=3,chatThreadClient.updateMessage.apply(chatThreadClient,args);case 3:return result=_context6.sent,messageId=args[0],updateOption=args[1],_this._context.updateChatMessageContent(chatThreadClient.threadId,messageId,null==updateOption?void 0:updateOption.content),_context6.abrupt("return",result);case 7:case"end":return _context6.stop()}}),_callee6)}))),"ChatThreadClient.updateMessage");case"updateTopic":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){var _len5,args,_key5,result,topic,_args7=arguments;return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:for(_len5=_args7.length,args=new Array(_len5),_key5=0;_key5<_len5;_key5++)args[_key5]=_args7[_key5];return _context7.next=3,chatThreadClient.updateTopic.apply(chatThreadClient,args);case 3:return result=_context7.sent,topic=args[0],_this._context.updateThreadTopic(chatThreadClient.threadId,topic),_context7.abrupt("return",result);case 7:case"end":return _context7.stop()}}),_callee7)}))),"ChatThreadClient.updateTopic");case"getProperties":return this._context.withAsyncErrorTeedToState(StatefulChatThreadClient_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){var result,_args8=arguments;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,chatThreadClient.getProperties.apply(chatThreadClient,_args8);case 2:return result=_context8.sent,_this._context.updateThread(chatThreadClient.threadId,result),_context8.abrupt("return",result);case 5:case"end":return _context8.stop()}}),_callee8)}))),"ChatThreadClient.getProperties");default:return Reflect.get(chatThreadClient,prop)}}}]),ProxyChatThreadClient}(),chatThreadClientDeclaratify=function chatThreadClientDeclaratify(chatThreadClient,context){return context.createThreadIfNotExist(chatThreadClient.threadId),new Proxy(chatThreadClient,new StatefulChatThreadClient_ProxyChatThreadClient(context))};function StatefulChatClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StatefulChatClient_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StatefulChatClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StatefulChatClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var proxyChatClient={get:function get(chatClient,prop,receiver){if("context"===prop)return Reflect.get(chatClient,prop);var context=receiver.context;switch(prop){case"createChatThread":return context.withAsyncErrorTeedToState(StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _len,args,_key,result,thread,request,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:for(_len=_args.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=_args[_key];return _context.next=3,chatClient.createChatThread.apply(chatClient,args);case 3:return result=_context.sent,(thread=result.chatThread)&&(request=args[0],context.createThread(thread.id,{topic:request.topic})),_context.abrupt("return",result);case 7:case"end":return _context.stop()}}),_callee)}))),"ChatClient.createChatThread");case"deleteChatThread":return context.withAsyncErrorTeedToState(StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var result,_args2=arguments;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,chatClient.deleteChatThread.apply(chatClient,_args2);case 2:return result=_context2.sent,context.deleteThread(_args2.length<=0?void 0:_args2[0]),_context2.abrupt("return",result);case 5:case"end":return _context2.stop()}}),_callee2)}))),"ChatClient.deleteChatThread");case"listChatThreads":return function createDecoratedListThreads(chatClient,context){return createDecoratedIterator(createErrorHandlingIterator(context.withErrorTeedToState(chatClient.listChatThreads.bind(chatClient),"ChatClient.listChatThreads"),context,"ChatClient.listChatThreads"),context,(function setThreadProperties(chatThreadItem,context){var properties={topic:chatThreadItem.topic};context.createThreadIfNotExist(chatThreadItem.id,properties)||context.updateThread(chatThreadItem.id,properties)}))}(chatClient,context);case"getChatThreadClient":return function(){var chatThreadClient=chatClient.getChatThreadClient.apply(chatClient,arguments);return chatThreadClientDeclaratify(chatThreadClient,context)};case"startRealtimeNotifications":return context.withAsyncErrorTeedToState(StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){var ret,_args3=arguments;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,chatClient.startRealtimeNotifications.apply(chatClient,_args3);case 2:return ret=_context3.sent,receiver.eventSubscriber||(receiver.eventSubscriber=new EventSubscriber_EventSubscriber(chatClient,context)),_context3.abrupt("return",ret);case 5:case"end":return _context3.stop()}}),_callee3)}))),"ChatClient.startRealtimeNotifications",["ChatClient.startRealtimeNotifications","ChatClient.stopRealtimeNotifications"]);case"stopRealtimeNotifications":return context.withAsyncErrorTeedToState(StatefulChatClient_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){var ret,_args4=arguments;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,chatClient.stopRealtimeNotifications.apply(chatClient,_args4);case 2:return ret=_context4.sent,receiver.eventSubscriber&&(receiver.eventSubscriber.unsubscribe(),receiver.eventSubscriber=void 0),_context4.abrupt("return",ret);case 5:case"end":return _context4.stop()}}),_callee4)}))),"ChatClient.stopRealtimeNotifications",["ChatClient.stopRealtimeNotifications","ChatClient.startRealtimeNotifications"]);default:return Reflect.get(chatClient,prop)}}},StatefulChatClient_createStatefulChatClient=function createStatefulChatClient(args,options){var tweakedOptions=Object.assign({},options,{chatClientOptions:Object.assign({},null==options?void 0:options.chatClientOptions,{userAgentOptions:{userAgentPrefix:Object(src.b)()}})});return StatefulChatClient_createStatefulChatClientWithDeps(new src_chatClient.a(args.endpoint,args.credential,tweakedOptions.chatClientOptions),args,tweakedOptions)},StatefulChatClient_createStatefulChatClientWithDeps=function createStatefulChatClientWithDeps(chatClient,args,options){var eventSubscriber,context=new ChatContext_ChatContext(null==options?void 0:options.maxStateChangeListeners);context.updateChatConfig(args.userId,args.displayName);var proxy=new Proxy(chatClient,proxyChatClient);return Object.defineProperty(proxy,"context",{configurable:!1,get:function get(){return context}}),Object.defineProperty(proxy,"eventSubscriber",{configurable:!1,get:function get(){return eventSubscriber},set:function set(val){eventSubscriber=val}}),Object.defineProperty(proxy,"getState",{configurable:!1,value:function value(){return null==context?void 0:context.getState()}}),Object.defineProperty(proxy,"modifyState",{configurable:!1,value:function value(modifier){return null==context?void 0:context.modifyState(modifier)}}),Object.defineProperty(proxy,"onStateChange",{configurable:!1,value:function value(handler){return null==context?void 0:context.onStateChange(handler)}}),Object.defineProperty(proxy,"offStateChange",{configurable:!1,value:function value(handler){return null==context?void 0:context.offStateChange(handler)}}),proxy},memoize_one_esm=(__webpack_require__(177),__webpack_require__(130));function createHandlers_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function createHandlers_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return createHandlers_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return createHandlers_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function createHandlers_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function createHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function createHandlers_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){createHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){createHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var createDefaultChatHandlers=Object(memoize_one_esm.a)((function(chatClient,chatThreadClient){var _onLoadPreviousChatMessages,_updateThreadTopicName,_onParticipantRemove,_onTyping,_onMessageSeen,_onSendMessage,messageIterator=void 0;return{onSendMessage:(_onSendMessage=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee(content){var sendMessageRequest;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return sendMessageRequest={content:content,senderDisplayName:chatClient.getState().displayName},_context.next=3,chatThreadClient.sendMessage(sendMessageRequest);case 3:case"end":return _context.stop()}}),_callee)}))),function onSendMessage(_x){return _onSendMessage.apply(this,arguments)}),onMessageSeen:(_onMessageSeen=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee2(chatMessageId){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,chatThreadClient.sendReadReceipt({chatMessageId:chatMessageId});case 2:case"end":return _context2.stop()}}),_callee2)}))),function onMessageSeen(_x2){return _onMessageSeen.apply(this,arguments)}),onTyping:(_onTyping=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,chatThreadClient.sendTypingNotification();case 2:case"end":return _context3.stop()}}),_callee3)}))),function onTyping(){return _onTyping.apply(this,arguments)}),onParticipantRemove:(_onParticipantRemove=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee4(userId){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,chatThreadClient.removeParticipant(Object(src.a)(userId));case 2:case"end":return _context4.stop()}}),_callee4)}))),function onParticipantRemove(_x3){return _onParticipantRemove.apply(this,arguments)}),updateThreadTopicName:(_updateThreadTopicName=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee5(topicName){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,chatThreadClient.updateTopic(topicName);case 2:case"end":return _context5.stop()}}),_callee5)}))),function updateThreadTopicName(_x4){return _updateThreadTopicName.apply(this,arguments)}),onLoadPreviousChatMessages:(_onLoadPreviousChatMessages=createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee6(messagesToLoad){var remainingMessagesToGet,isAllChatMessagesLoaded,_message$value,message;return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:void 0===messageIterator&&(messageIterator=chatThreadClient.listMessages()),remainingMessagesToGet=messagesToLoad,isAllChatMessagesLoaded=!1;case 3:if(!(remainingMessagesToGet>=1)){_context6.next=13;break}return _context6.next=6,messageIterator.next();case 6:if(message=_context6.sent,null!==(_message$value=message.value)&&void 0!==_message$value&&_message$value.type&&"text"===message.value.type&&remainingMessagesToGet--,!message.done){_context6.next=11;break}return isAllChatMessagesLoaded=!0,_context6.abrupt("break",13);case 11:_context6.next=3;break;case 13:return _context6.abrupt("return",isAllChatMessagesLoaded);case 14:case"end":return _context6.stop()}}),_callee6)}))),function onLoadPreviousChatMessages(_x5){return _onLoadPreviousChatMessages.apply(this,arguments)}),onDismissErrors:function onDismissErrors(errorTypes){var _step,targets=new Set,_iterator=createHandlers_createForOfIteratorHelper(errorTypes);try{for(_iterator.s();!(_step=_iterator.n()).done;){switch(_step.value){case"unableToReachChatService":case"accessDenied":case"userNotInThisThread":case"sendMessageNotInThisThread":addAccessErrorTargets(targets);break;case"sendMessageGeneric":targets.add("ChatThreadClient.sendMessage")}}}catch(err){_iterator.e(err)}finally{_iterator.f()}chatClient.modifyState(newClearErrorsModifier(Array.from(targets.values())))}}})),accessErrorTargets=["ChatThreadClient.getProperties","ChatThreadClient.listMessages","ChatThreadClient.listParticipants","ChatThreadClient.sendMessage","ChatThreadClient.sendTypingNotification"],addAccessErrorTargets=function addAccessErrorTargets(targets){var _step2,_iterator2=createHandlers_createForOfIteratorHelper(accessErrorTargets);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var target=_step2.value;targets.add(target)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}},react=__webpack_require__(0),jsx_runtime=__webpack_require__(1),ChatClientContext=Object(react.createContext)(void 0),ChatClientProvider_ChatClientProvider=function ChatClientProvider(props){return Object(jsx_runtime.jsx)(ChatClientContext.Provider,{value:props.chatClient,children:props.children})};ChatClientProvider_ChatClientProvider.displayName="ChatClientProvider";ChatClientProvider_ChatClientProvider.__docgenInfo={description:"ChatClientProvider requires valid StatefulChatClient. It provides a global access to the\nstateful chat client for the contoso app\n\n@param props - only one parameter StatefulChatClient",methods:[],displayName:"ChatClientProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},chatClient:{required:!0,tsType:{name:"StatefulChatClient"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../chat-component-bindings/src/providers/ChatClientProvider.tsx"]={name:"ChatClientProvider",docgenInfo:ChatClientProvider_ChatClientProvider.__docgenInfo,path:"../chat-component-bindings/src/providers/ChatClientProvider.tsx"});var ChatThreadClientContext=Object(react.createContext)(void 0),ChatThreadClientProvider_ChatThreadClientProvider=function ChatThreadClientProvider(props){return Object(jsx_runtime.jsx)(ChatThreadClientContext.Provider,{value:props.chatThreadClient,children:props.children})};ChatThreadClientProvider_ChatThreadClientProvider.displayName="ChatThreadClientProvider";ChatThreadClientProvider_ChatThreadClientProvider.__docgenInfo={description:"ChatThreadClientProvider requires valid StatefulChatThreadClient. It provides a global access to the\nstateful chat thread client for the contoso app\n\n@param props - includes one parameter StatefulChatThreadClient",methods:[],displayName:"ChatThreadClientProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},chatThreadClient:{required:!0,tsType:{name:"ChatThreadClient"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../chat-component-bindings/src/providers/ChatThreadClientProvider.tsx"]={name:"ChatThreadClientProvider",docgenInfo:ChatThreadClientProvider_ChatThreadClientProvider.__docgenInfo,path:"../chat-component-bindings/src/providers/ChatThreadClientProvider.tsx"});var react_components_src=__webpack_require__(24);var es=__webpack_require__(59),baseSelectors_getUserId=function getUserId(state){return Object(src.d)(state.userId)},getDisplayName=function getDisplayName(state){return state.displayName},getParticipants=function getParticipants(state,props){var _state$threads$props$3;return props.threadId&&(null===(_state$threads$props$3=state.threads[props.threadId])||void 0===_state$threads$props$3?void 0:_state$threads$props$3.participants)||{}},sanitizedMessageContentType=function sanitizedMessageContentType(type){var lowerCaseType=type.toLowerCase();return"text"===lowerCaseType||"html"===lowerCaseType||"richtext/html"===lowerCaseType?lowerCaseType:"unknown"},sendBoxSelector=Object(es.a)([baseSelectors_getUserId,getDisplayName],(function(userId,displayName){return{displayName:displayName,userId:userId}})),compareMessages=(__webpack_require__(738),__webpack_require__(1389),__webpack_require__(230),function compareMessages(firstMessage,secondMessage){if(void 0===firstMessage.payload.createdOn)return 1;if(void 0===secondMessage.payload.createdOn)return-1;var firstDate=new Date(firstMessage.payload.createdOn).getTime(),secondDate=new Date(secondMessage.payload.createdOn).getTime(),idDelta=firstMessage.payload.messageId&&secondMessage.payload.messageId?Number.parseInt(firstMessage.payload.messageId)-Number.parseInt(secondMessage.payload.messageId):0;return firstDate-secondDate==0?idDelta:firstDate-secondDate}),ACSKnownMessageType_text="text",ACSKnownMessageType_html="html",ACSKnownMessageType_richtextHtml="richtext/html",ACSKnownMessageType_topicUpdated="topicUpdated",ACSKnownMessageType_participantAdded="participantAdded",ACSKnownMessageType_participantRemoved="participantRemoved",memoizedAllConvertChatMessage=Object(src.c)((function(_key,chatMessage,userId,isSeen,isLargeGroup){var messageType=chatMessage.type.toLowerCase();return"text"===messageType||"richtext/html"===messageType?chatThreadSelector_convertToUiChatMessage(chatMessage,userId,isSeen,isLargeGroup):chatThreadSelector_convertToUiSystemMessage(chatMessage)})),chatThreadSelector_convertToUiChatMessage=function convertToUiChatMessage(message,userId,isSeen,isLargeGroup){var _message$content;return{type:"chat",payload:{createdOn:message.createdOn,content:null===(_message$content=message.content)||void 0===_message$content?void 0:_message$content.message,type:sanitizedMessageContentType(message.type),status:!isLargeGroup&&"delivered"===message.status&&isSeen?"seen":message.status,senderDisplayName:message.senderDisplayName,senderId:void 0!==message.sender?Object(src.d)(message.sender):userId,messageId:message.id,clientMessageId:message.clientMessageId}}},chatThreadSelector_convertToUiSystemMessage=function convertToUiSystemMessage(message){var _message$content$part,_message$content2,_message$content2$par,_message$content$topi,_message$content3,systemMessageType=message.type;return"participantAdded"===systemMessageType||"participantRemoved"===systemMessageType?{type:"system",payload:{createdOn:message.createdOn,participants:null!==(_message$content$part=null===(_message$content2=message.content)||void 0===_message$content2||null===(_message$content2$par=_message$content2.participants)||void 0===_message$content2$par?void 0:_message$content2$par.filter((function(participant){return participant.displayName&&""!==participant.displayName})).map((function(participant){return{userId:Object(src.d)(participant.id),displayName:participant.displayName}})))&&void 0!==_message$content$part?_message$content$part:[],type:systemMessageType,messageId:message.id,iconName:"participantAdded"===systemMessageType?"PeopleAdd":"PeopleBlock"}}:{type:"system",payload:{createdOn:message.createdOn,topic:null!==(_message$content$topi=null===(_message$content3=message.content)||void 0===_message$content3?void 0:_message$content3.topic)&&void 0!==_message$content$topi?_message$content$topi:"",type:"topicUpdated",messageId:message.id,iconName:"Edit"}}},chatThreadSelector=Object(es.a)([baseSelectors_getUserId,function getChatMessages(state,props){var _state$threads$props$;return props.threadId&&(null===(_state$threads$props$=state.threads[props.threadId])||void 0===_state$threads$props$?void 0:_state$threads$props$.chatMessages)||{}},function getLatestReadTime(state,props){var _state$threads$props$5;return props.threadId&&(null===(_state$threads$props$5=state.threads[props.threadId])||void 0===_state$threads$props$5?void 0:_state$threads$props$5.latestReadTime)||new Date(0)},function getIsLargeGroup(state,props){var _state$threads$props$4,participants=null===(_state$threads$props$4=state.threads[props.threadId])||void 0===_state$threads$props$4?void 0:_state$threads$props$4.participants;return!!participants&&Object.values(participants).length>20}],(function(userId,chatMessages,latestReadTime,isLargeGroup){var convertedMessages=memoizedAllConvertChatMessage((function(memoizedFn){return Object.values(chatMessages).filter((function(message){return message.type.toLowerCase()===ACSKnownMessageType_text||message.type.toLowerCase()===ACSKnownMessageType_richtextHtml||message.type.toLowerCase()===ACSKnownMessageType_html||message.type===ACSKnownMessageType_participantAdded||message.type===ACSKnownMessageType_participantRemoved||message.type===ACSKnownMessageType_topicUpdated||void 0!==message.clientMessageId})).map((function(message){var _message$id;return memoizedFn(null!==(_message$id=message.id)&&void 0!==_message$id?_message$id:message.clientMessageId,message,userId,message.createdOn<=latestReadTime,isLargeGroup)}))}));return chatThreadSelector_updateMessagesWithAttached(convertedMessages,userId),{userId:userId,showMessageStatus:!isLargeGroup,messages:convertedMessages}})),chatThreadSelector_updateMessagesWithAttached=function updateMessagesWithAttached(chatMessagesWithStatus,userId){chatMessagesWithStatus.sort(compareMessages),chatMessagesWithStatus.forEach((function(message,index,messages){if("chat"===message.type){var mine=message.payload.senderId===userId,attached=!1,nextMessage=messages[index+1];if(0===index)index!==messages.length-1&&message.payload.senderId==message.payload.senderId&&(attached="top");else{var previousMessage=messages[index-1];"chat"===previousMessage.type&&message.payload.senderId===previousMessage.payload.senderId?attached=index!==messages.length-1&&"chat"===nextMessage.type&&message.payload.senderId===nextMessage.payload.senderId||"bottom":index!==messages.length-1&&"chat"===nextMessage.type&&message.payload.senderId===nextMessage.payload.senderId&&(attached="top")}message.payload.attached=attached,message.payload.mine=mine}}))},typingIndicatorSelector=es.a([function getTypingIndicators(state,props){var _state$threads$props$8;return props.threadId&&(null===(_state$threads$props$8=state.threads[props.threadId])||void 0===_state$threads$props$8?void 0:_state$threads$props$8.typingIndicators)||[]},getParticipants,baseSelectors_getUserId],(function(typingIndicators,participants,userId){return Object.values(participants).length>=20?{typingUsers:[]}:{typingUsers:function convertSdkTypingIndicatorsToCommunicationParticipants(typingIndicators,participants){return typingIndicators.map((function(typingIndicator){var _participants$toFlatC;return{userId:Object(src.d)(typingIndicator.sender),displayName:null===(_participants$toFlatC=participants[Object(src.d)(typingIndicator.sender)])||void 0===_participants$toFlatC?void 0:_participants$toFlatC.displayName}}))}(function filterTypingIndicators(typingIndicators,userId){for(var filteredTypingIndicators=[],seen=new Set,date8SecondsAgo=new Date(Date.now()-8e3),i=typingIndicators.length-1;i>=0;i--){var typingIndicator=typingIndicators[i];Object(src.d)(typingIndicator.sender)!==userId&&(typingIndicator.receivedOn<date8SecondsAgo||seen.has(Object(src.d)(typingIndicator.sender))||(seen.add(Object(src.d)(typingIndicator.sender)),filteredTypingIndicators.push(typingIndicator)))}return filteredTypingIndicators}(typingIndicators,userId),participants)}})),chatParticipantListSelector=es.a([baseSelectors_getUserId,getParticipants,getDisplayName],(function(userId,chatParticipants,displayName){var participants=function convertChatParticipantsToCommunicationParticipants(chatParticipants){return chatParticipants.map((function(participant){return{userId:Object(src.d)(participant.id),displayName:participant.displayName}}))}(Object.values(chatParticipants));if(0!==participants.length){var moderatorIdx=function moderatorIndex(participants){return participants.map((function(p){return p.displayName})).indexOf(void 0)}(participants);if(-1!==moderatorIdx)moderatorIdx===participants.map((function(p){return p.userId})).indexOf(userId)?participants[moderatorIdx].displayName=displayName:participants=participants.filter((function(p){return p.displayName}))}return{myUserId:userId,participants:participants}}));__webpack_require__(269);function errorBarSelector_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function errorBarSelector_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return errorBarSelector_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return errorBarSelector_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function errorBarSelector_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var errorBarSelector=Object(es.a)([function getLatestErrors(state){return state.latestErrors}],(function(latestErrors){var activeErrors=[],specificSendMessageErrorSeen=!1;return hasUnableToReachChatServiceError(latestErrors)&&activeErrors.push("unableToReachChatService"),hasAccessDeniedError(latestErrors)&&activeErrors.push("accessDenied"),hasNotInThisThreadError(latestErrors)&&(void 0!==latestErrors["ChatThreadClient.sendMessage"]?(activeErrors.push("sendMessageNotInThisThread"),specificSendMessageErrorSeen=!0):activeErrors.push("userNotInThisThread")),specificSendMessageErrorSeen||void 0===latestErrors["ChatThreadClient.sendMessage"]||activeErrors.push("sendMessageGeneric"),activeErrors.splice(maxErrorCount),{activeErrors:activeErrors}})),maxErrorCount=3,errorBarSelector_accessErrorTargets=["ChatThreadClient.getProperties","ChatThreadClient.listMessages","ChatThreadClient.listParticipants","ChatThreadClient.sendMessage","ChatThreadClient.sendTypingNotification"],hasUnableToReachChatServiceError=function hasUnableToReachChatServiceError(latestErrors){var _step,_iterator=errorBarSelector_createForOfIteratorHelper(errorBarSelector_accessErrorTargets);try{for(_iterator.s();!(_step=_iterator.n()).done;){var error=latestErrors[_step.value];if(void 0!==error&&"REQUEST_SEND_ERROR"===error.code)return!0}}catch(err){_iterator.e(err)}finally{_iterator.f()}return!1},hasAccessDeniedError=function hasAccessDeniedError(latestErrors){var _step2,_iterator2=errorBarSelector_createForOfIteratorHelper(errorBarSelector_accessErrorTargets);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var error=latestErrors[_step2.value];if(void 0!==error&&401===error.statusCode)return!0}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return!1},hasNotInThisThreadError=function hasNotInThisThreadError(latestErrors){var _step3,_iterator3=errorBarSelector_createForOfIteratorHelper(errorBarSelector_accessErrorTargets);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var error=latestErrors[_step3.value];if(void 0!==error&&(400===error.statusCode||403===error.statusCode))return!0}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}return!1},getSelector=function getSelector(component){return usePropsFor_findSelector(component)},usePropsFor_findSelector=function findSelector(component){switch(component){case react_components_src.r:return sendBoxSelector;case react_components_src.k:return chatThreadSelector;case react_components_src.t:return typingIndicatorSelector;case react_components_src.o:return chatParticipantListSelector;case react_components_src.e:return errorBarSelector}};function AzureCommunicationChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function AzureCommunicationChatAdapter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){AzureCommunicationChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){AzureCommunicationChatAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function AzureCommunicationChatAdapter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AzureCommunicationChatAdapter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AzureCommunicationChatAdapter_createClass(Constructor,protoProps,staticProps){return protoProps&&AzureCommunicationChatAdapter_defineProperties(Constructor.prototype,protoProps),staticProps&&AzureCommunicationChatAdapter_defineProperties(Constructor,staticProps),Constructor}function AzureCommunicationChatAdapter_asyncIterator(iterable){var method;if("undefined"!=typeof Symbol&&(Symbol.asyncIterator&&(method=iterable[Symbol.asyncIterator]),null==method&&Symbol.iterator&&(method=iterable[Symbol.iterator])),null==method&&(method=iterable["@@asyncIterator"]),null==method&&(method=iterable["@@iterator"]),null==method)throw new TypeError("Object is not async iterable");return method.call(iterable)}var AzureCommunicationChatAdapter_ChatContext=function(){function ChatContext(clientState,threadId){AzureCommunicationChatAdapter_classCallCheck(this,ChatContext),this.emitter=new events_default.a,this.state=void 0,this.threadId=void 0;var thread=clientState.threads[threadId];if(this.threadId=threadId,!thread)throw"Cannot find threadId, please initialize thread before use!";this.state={userId:Object(src.d)(clientState.userId),displayName:clientState.displayName,thread:thread,latestErrors:clientState.latestErrors}}return AzureCommunicationChatAdapter_createClass(ChatContext,[{key:"onStateChange",value:function onStateChange(handler){this.emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this.emitter.off("stateChanged",handler)}},{key:"setState",value:function setState(state){this.state=state,this.emitter.emit("stateChanged",this.state)}},{key:"getState",value:function getState(){return this.state}},{key:"setError",value:function setError(error){this.setState(Object.assign({},this.state,{error:error}))}},{key:"updateClientState",value:function updateClientState(clientState){var thread=clientState.threads[this.threadId];if(!thread)throw"Cannot find threadId, please make sure thread state is still in Stateful ChatClient.";this.setState({userId:Object(src.d)(clientState.userId),displayName:clientState.displayName,thread:thread,latestErrors:clientState.latestErrors})}}]),ChatContext}(),AzureCommunicationChatAdapter_AzureCommunicationChatAdapter=function(){function AzureCommunicationChatAdapter(chatClient,chatThreadClient){var _this=this;AzureCommunicationChatAdapter_classCallCheck(this,AzureCommunicationChatAdapter),this.chatClient=void 0,this.chatThreadClient=void 0,this.context=void 0,this.handlers=void 0,this.emitter=new events_default.a,this.bindAllPublicMethods(),this.chatClient=chatClient,this.chatThreadClient=chatThreadClient,this.context=new AzureCommunicationChatAdapter_ChatContext(chatClient.getState(),chatThreadClient.threadId);this.handlers=createDefaultChatHandlers(chatClient,chatThreadClient),this.chatClient.onStateChange((function onStateChange(clientState){_this?_this.context.updateClientState(clientState):chatClient.offStateChange(onStateChange)})),this.subscribeAllEvents()}var _asyncTeeErrorToEventEmitter,_loadPreviousChatMessages,_setTopic,_removeParticipant,_sendTypingIndicator,_sendReadReceipt,_sendMessage,_fetchInitialData;return AzureCommunicationChatAdapter_createClass(AzureCommunicationChatAdapter,[{key:"bindAllPublicMethods",value:function bindAllPublicMethods(){this.onStateChange=this.onStateChange.bind(this),this.offStateChange=this.offStateChange.bind(this),this.getState=this.getState.bind(this),this.dispose=this.dispose.bind(this),this.fetchInitialData=this.fetchInitialData.bind(this),this.sendMessage=this.sendMessage.bind(this),this.sendReadReceipt=this.sendReadReceipt.bind(this),this.sendTypingIndicator=this.sendTypingIndicator.bind(this),this.removeParticipant=this.removeParticipant.bind(this),this.setTopic=this.setTopic.bind(this),this.loadPreviousChatMessages=this.loadPreviousChatMessages.bind(this),this.clearErrors=this.clearErrors.bind(this),this.on=this.on.bind(this),this.off=this.off.bind(this)}},{key:"dispose",value:function dispose(){this.unsubscribeAllEvents()}},{key:"fetchInitialData",value:(_fetchInitialData=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var _iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,this.chatThreadClient.getProperties();case 3:_context.next=8;break;case 5:_context.prev=5,_context.t0=_context.catch(0),console.log(_context.t0);case 8:_context.prev=8,_iteratorNormalCompletion=!0,_didIteratorError=!1,_context.prev=11,_iterator=AzureCommunicationChatAdapter_asyncIterator(this.chatThreadClient.listParticipants().byPage({maxPageSize:100}));case 13:return _context.next=15,_iterator.next();case 15:return _step=_context.sent,_iteratorNormalCompletion=_step.done,_context.next=19,_step.value;case 19:if(_context.sent,_iteratorNormalCompletion){_context.next=26;break}case 23:_iteratorNormalCompletion=!0,_context.next=13;break;case 26:_context.next=32;break;case 28:_context.prev=28,_context.t1=_context.catch(11),_didIteratorError=!0,_iteratorError=_context.t1;case 32:if(_context.prev=32,_context.prev=33,_iteratorNormalCompletion||null==_iterator.return){_context.next=37;break}return _context.next=37,_iterator.return();case 37:if(_context.prev=37,!_didIteratorError){_context.next=40;break}throw _iteratorError;case 40:return _context.finish(37);case 41:return _context.finish(32);case 42:_context.next=47;break;case 44:_context.prev=44,_context.t2=_context.catch(8),console.log(_context.t2);case 47:case"end":return _context.stop()}}),_callee,this,[[0,5],[8,44],[11,28,32,42],[33,,37,41]])}))),function fetchInitialData(){return _fetchInitialData.apply(this,arguments)})},{key:"getState",value:function getState(){return this.context.getState()}},{key:"onStateChange",value:function onStateChange(handler){this.context.onStateChange(handler)}},{key:"offStateChange",value:function offStateChange(handler){this.context.offStateChange(handler)}},{key:"sendMessage",value:(_sendMessage=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee3(content){var _this2=this;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,_this2.handlers.onSendMessage(content);case 2:case"end":return _context2.stop()}}),_callee2)}))));case 2:case"end":return _context3.stop()}}),_callee3,this)}))),function sendMessage(_x){return _sendMessage.apply(this,arguments)})},{key:"sendReadReceipt",value:(_sendReadReceipt=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee5(chatMessageId){var _this3=this;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee4(){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,_this3.handlers.onMessageSeen(chatMessageId);case 2:case"end":return _context4.stop()}}),_callee4)}))));case 2:case"end":return _context5.stop()}}),_callee5,this)}))),function sendReadReceipt(_x2){return _sendReadReceipt.apply(this,arguments)})},{key:"sendTypingIndicator",value:(_sendTypingIndicator=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee6(){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,this.handlers.onTyping();case 2:case"end":return _context6.stop()}}),_callee6,this)}))),function sendTypingIndicator(){return _sendTypingIndicator.apply(this,arguments)})},{key:"removeParticipant",value:(_removeParticipant=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee8(userId){var _this4=this;return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee7(){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,_this4.handlers.onParticipantRemove(userId);case 2:case"end":return _context7.stop()}}),_callee7)}))));case 2:case"end":return _context8.stop()}}),_callee8,this)}))),function removeParticipant(_x3){return _removeParticipant.apply(this,arguments)})},{key:"setTopic",value:(_setTopic=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee10(topicName){var _this5=this;return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,_this5.handlers.updateThreadTopicName(topicName);case 2:case"end":return _context9.stop()}}),_callee9)}))));case 2:case"end":return _context10.stop()}}),_callee10,this)}))),function setTopic(_x4){return _setTopic.apply(this,arguments)})},{key:"loadPreviousChatMessages",value:(_loadPreviousChatMessages=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee12(messagesToLoad){var _this6=this;return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return _context12.next=2,this.asyncTeeErrorToEventEmitter(AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,_this6.handlers.onLoadPreviousChatMessages(messagesToLoad);case 2:return _context11.abrupt("return",_context11.sent);case 3:case"end":return _context11.stop()}}),_callee11)}))));case 2:return _context12.abrupt("return",_context12.sent);case 3:case"end":return _context12.stop()}}),_callee12,this)}))),function loadPreviousChatMessages(_x5){return _loadPreviousChatMessages.apply(this,arguments)})},{key:"clearErrors",value:function clearErrors(errorTypes){this.handlers.onDismissErrors(errorTypes)}},{key:"messageReceivedListener",value:function messageReceivedListener(event){var message=convertEventToChatMessage(event);this.emitter.emit("messageReceived",{message:message});var currentUserId=Object(src.d)(this.chatClient.getState().userId);null!=message&&message.sender&&Object(src.d)(message.sender)===currentUserId&&this.emitter.emit("messageSent",{message:message})}},{key:"messageReadListener",value:function messageReadListener(_ref6){var chatMessageId=_ref6.chatMessageId,recipient=_ref6.recipient,message=this.getState().thread.chatMessages[chatMessageId];message&&this.emitter.emit("messageRead",{message:message,readBy:recipient})}},{key:"participantsAddedListener",value:function participantsAddedListener(_ref7){var addedBy=_ref7.addedBy,participantsAdded=_ref7.participantsAdded;this.emitter.emit("participantsAdded",{addedBy:addedBy,participantsAdded:participantsAdded})}},{key:"participantsRemovedListener",value:function participantsRemovedListener(_ref8){var removedBy=_ref8.removedBy,participantsRemoved=_ref8.participantsRemoved;this.emitter.emit("participantsRemoved",{removedBy:removedBy,participantsRemoved:participantsRemoved})}},{key:"chatThreadPropertiesUpdatedListener",value:function chatThreadPropertiesUpdatedListener(event){this.emitter.emit("topicChanged",{topic:event.properties.topic})}},{key:"subscribeAllEvents",value:function subscribeAllEvents(){this.chatClient.on("chatThreadPropertiesUpdated",this.chatThreadPropertiesUpdatedListener.bind(this)),this.chatClient.on("participantsAdded",this.participantsAddedListener.bind(this)),this.chatClient.on("participantsRemoved",this.participantsRemovedListener.bind(this)),this.chatClient.on("chatMessageReceived",this.messageReceivedListener.bind(this)),this.chatClient.on("readReceiptReceived",this.messageReadListener.bind(this)),this.chatClient.on("participantsRemoved",this.participantsRemovedListener.bind(this))}},{key:"unsubscribeAllEvents",value:function unsubscribeAllEvents(){this.chatClient.off("chatThreadPropertiesUpdated",this.chatThreadPropertiesUpdatedListener.bind(this)),this.chatClient.off("participantsAdded",this.participantsAddedListener.bind(this)),this.chatClient.off("participantsRemoved",this.participantsRemovedListener.bind(this)),this.chatClient.off("chatMessageReceived",this.messageReceivedListener.bind(this)),this.chatClient.off("readReceiptReceived",this.messageReadListener.bind(this)),this.chatClient.off("participantsRemoved",this.participantsRemovedListener.bind(this))}},{key:"on",value:function on(event,listener){this.emitter.on(event,listener)}},{key:"off",value:function off(event,listener){this.emitter.off(event,listener)}},{key:"asyncTeeErrorToEventEmitter",value:(_asyncTeeErrorToEventEmitter=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee13(f){return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return _context13.prev=0,_context13.next=3,f();case 3:return _context13.abrupt("return",_context13.sent);case 6:throw _context13.prev=6,_context13.t0=_context13.catch(0),isChatError(_context13.t0)&&this.emitter.emit("error",{operation:_context13.t0.target,error:_context13.t0.inner}),_context13.t0;case 10:case"end":return _context13.stop()}}),_callee13,this,[[0,6]])}))),function asyncTeeErrorToEventEmitter(_x6){return _asyncTeeErrorToEventEmitter.apply(this,arguments)})}]),AzureCommunicationChatAdapter}(),convertEventToChatMessage=function convertEventToChatMessage(event){return{id:event.id,version:event.version,content:{message:event.message},type:event.type,sender:event.sender,senderDisplayName:event.senderDisplayName,sequenceId:"",createdOn:new Date(event.createdOn)}},createAzureCommunicationChatAdapter=function(){var _ref10=AzureCommunicationChatAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee14(_ref9){var endpointUrl,userId,displayName,credential,threadId,chatClient,chatThreadClient,adapter;return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return endpointUrl=_ref9.endpointUrl,userId=_ref9.userId,displayName=_ref9.displayName,credential=_ref9.credential,threadId=_ref9.threadId,chatClient=StatefulChatClient_createStatefulChatClient({userId:userId,displayName:displayName,endpoint:endpointUrl,credential:credential}),_context14.next=4,chatClient.getChatThreadClient(threadId);case 4:return chatThreadClient=_context14.sent,chatClient.startRealtimeNotifications(),adapter=new AzureCommunicationChatAdapter_AzureCommunicationChatAdapter(chatClient,chatThreadClient),_context14.abrupt("return",adapter);case 8:case"end":return _context14.stop()}}),_callee14)})));return function createAzureCommunicationChatAdapter(_x7){return _ref10.apply(this,arguments)}}(),isChatError=function isChatError(e){return void 0!==e.target&&void 0!==e.inner},lib=__webpack_require__(20),Stack=__webpack_require__(99),ChatAdapterContext=Object(react.createContext)(void 0),ChatAdapterProvider_ChatAdapterProvider=function ChatAdapterProvider(props){var adapter=props.adapter;return Object(jsx_runtime.jsx)(ChatAdapterContext.Provider,{value:adapter,children:props.children})};ChatAdapterProvider_ChatAdapterProvider.displayName="ChatAdapterProvider";var ChatAdapterProvider_useAdapter=function useAdapter(){var adapter=Object(react.useContext)(ChatAdapterContext);if(!adapter)throw"Cannot find adapter please initialize before usage.";return adapter};function useAdaptedSelector_slicedToArray(arr,i){return function useAdaptedSelector_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function useAdaptedSelector_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function useAdaptedSelector_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return useAdaptedSelector_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return useAdaptedSelector_arrayLikeToArray(o,minLen)}(arr,i)||function useAdaptedSelector_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function useAdaptedSelector_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}ChatAdapterProvider_ChatAdapterProvider.__docgenInfo={description:"",methods:[],displayName:"ChatAdapterProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},adapter:{required:!0,tsType:{name:"ChatAdapter"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/adapter/ChatAdapterProvider.tsx"]={name:"ChatAdapterProvider",docgenInfo:ChatAdapterProvider_ChatAdapterProvider.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/adapter/ChatAdapterProvider.tsx"});var useAdaptedSelector=function useAdaptedSelector(selector,selectorProps){return useAdaptedSelector_useSelectorWithAdaptation(selector,adaptCompositeState,selectorProps)},useAdaptedSelector_useSelectorWithAdaptation=function useSelectorWithAdaptation(selector,adaptState,selectorProps){var adapter=ChatAdapterProvider_useAdapter(),mounted=Object(react.useRef)(!1);Object(react.useEffect)((function(){return mounted.current=!0,function(){mounted.current=!1}}));var threadId=adapter.getState().thread.threadId,threadConfigProps=Object(react.useMemo)((function(){return{threadId:threadId}}),[threadId]),_useState2=useAdaptedSelector_slicedToArray(Object(react.useState)(selector(adaptState(adapter.getState()),null!=selectorProps?selectorProps:threadConfigProps)),2),props=_useState2[0],setProps=_useState2[1],propRef=Object(react.useRef)(props);return propRef.current=props,Object(react.useEffect)((function(){var onStateChange=function onStateChange(state){if(mounted.current){var newProps=selector(adaptState(state),null!=selectorProps?selectorProps:threadConfigProps);propRef.current!==newProps&&setProps(newProps)}};return adapter.onStateChange(onStateChange),function(){adapter.offStateChange(onStateChange)}}),[adaptState,adapter,selector,selectorProps,threadConfigProps]),props},memoizeState=Object(memoize_one_esm.a)((function(userId,displayName,threads,latestErrors){return{userId:userId,displayName:displayName,threads:threads,latestErrors:latestErrors}})),memoizeThreads=Object(memoize_one_esm.a)((function(thread){var _ref;return(_ref={})[thread.threadId]=thread,_ref})),adaptCompositeState=function adaptCompositeState(compositeState){return memoizeState({kind:"communicationUser",communicationUserId:compositeState.userId},compositeState.displayName,memoizeThreads(compositeState.thread),compositeState.latestErrors)},createCompositeHandlers=Object(memoize_one_esm.a)((function(adapter){return{onSendMessage:adapter.sendMessage,onLoadPreviousChatMessages:adapter.loadPreviousChatMessages,onMessageSeen:adapter.sendReadReceipt,onTyping:adapter.sendTypingIndicator,onParticipantRemove:adapter.removeParticipant,updateThreadTopicName:adapter.setTopic,onDismissErrors:adapter.clearErrors}})),hooks_usePropsFor_usePropsFor=function usePropsFor(component){var selector=getSelector(component);if(!selector)throw new Error("Can't find the selector for component, please check supported component list");return Object.assign({},useAdaptedSelector(selector),function useHandlers(_component){return createCompositeHandlers(ChatAdapterProvider_useAdapter())}())},chatContainer=Object(lib.G)({height:"100%",width:"100%",overflow:"hidden","*::-webkit-scrollbar":{width:"0.3rem",height:"0.3rem"},".scroll::-webkit-scrollbar-track":{background:"rgba(150, 150, 150)",borderRadius:"0.3rem"},"*::-webkit-scrollbar-thumb":{borderRadius:"10px",background:"rgba(150, 150, 150)"}}),chatArea=Object(lib.G)({height:"100%",width:"100%",overflow:"hidden"}),chatWrapper=Object(lib.G)({height:"100%",width:"100%",overflow:"auto"}),chatHeaderContainerStyle=Object(lib.G)({width:"100%",paddingLeft:"1.5rem",paddingRight:"1.5rem","@media screen and (max-width: 25rem)":{paddingLeft:"5%",paddingRight:"5%"},borderBottom:"0.063rem solid #DDDDDD"}),topicNameLabelStyle=Object(lib.G)({fontSize:"1.1rem",lineHeight:"2.5rem",fontWeight:600,marginRight:"0.125rem",textOverflow:"ellipsis",overflowY:"hidden"}),participantListWrapper=Object(lib.G)({boxShadow:"0px 0.3px 0.9px rgba(0, 0, 0, 0.1), 0px 1.6px 3.6px rgba(0, 0, 0, 0.13)",width:"15rem",height:"100%"}),participantListContainerPadding={childrenGap:"0.5rem"},listHeader=Object(lib.G)({fontSize:"1rem",margin:"1rem"}),participantListStack=Object(lib.G)({width:"15rem",height:"100%"}),participantListStyle=Object(lib.G)({overflowY:"hidden"}),ChatHeader_ChatHeader=function ChatHeader(props){return Object(jsx_runtime.jsx)(Stack.a,{className:chatHeaderContainerStyle,horizontal:!0,children:Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)("div",{className:topicNameLabelStyle,children:props.topic})})})};ChatHeader_ChatHeader.displayName="ChatHeader";var getHeaderProps=es.a([function getTopicName(state,props){var _state$threads$props$,_state$threads$props$2;return(null===(_state$threads$props$=state.threads[props.threadId])||void 0===_state$threads$props$||null===(_state$threads$props$2=_state$threads$props$.properties)||void 0===_state$threads$props$2?void 0:_state$threads$props$2.topic)||""}],(function(topic){return{topic:topic}}));ChatHeader_ChatHeader.__docgenInfo={description:"",methods:[],displayName:"ChatHeader",props:{topic:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatHeader.tsx"]={name:"ChatHeader",docgenInfo:ChatHeader_ChatHeader.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatHeader.tsx"});var ChatScreen_ChatScreen=function ChatScreen(props){var onRenderAvatar=props.onRenderAvatar,onRenderMessage=props.onRenderMessage,onRenderTypingIndicator=props.onRenderTypingIndicator,showParticipantPane=props.showParticipantPane,showTopic=props.showTopic,sendBoxParentStyle=Object(lib.G)({width:"100%"}),adapter=ChatAdapterProvider_useAdapter();Object(react.useEffect)((function(){adapter.fetchInitialData()}),[adapter]);var messageThreadProps=hooks_usePropsFor_usePropsFor(react_components_src.k),participantListProps=hooks_usePropsFor_usePropsFor(react_components_src.o),sendBoxProps=hooks_usePropsFor_usePropsFor(react_components_src.r),typingIndicatorProps=hooks_usePropsFor_usePropsFor(react_components_src.t),headerProps=useAdaptedSelector(getHeaderProps),errorBarProps=hooks_usePropsFor_usePropsFor(react_components_src.e),onRenderMessageAvatar=Object(react.useMemo)((function(){return onRenderAvatar&&function(userId){return onRenderAvatar(userId,"chatThread")}}),[onRenderAvatar]),onRenderParticipantAvatar=Object(react.useMemo)((function(){return onRenderAvatar&&function(participant){return onRenderAvatar(participant.userId,"participantList")}}),[onRenderAvatar]);return Object(jsx_runtime.jsxs)(Stack.a,{className:chatContainer,grow:!0,children:[!!showTopic&&Object(jsx_runtime.jsx)(ChatHeader_ChatHeader,Object.assign({},headerProps)),Object(jsx_runtime.jsxs)(Stack.a,{className:chatArea,tokens:participantListContainerPadding,horizontal:!0,grow:!0,children:[Object(jsx_runtime.jsxs)(Stack.a,{className:chatWrapper,grow:!0,children:[props.showErrorBar?Object(jsx_runtime.jsx)(react_components_src.e,Object.assign({},errorBarProps)):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}),Object(jsx_runtime.jsx)(react_components_src.k,Object.assign({},messageThreadProps,{onRenderAvatar:onRenderMessageAvatar,onRenderMessage:onRenderMessage,numberOfChatMessagesToReload:5})),Object(jsx_runtime.jsxs)(Stack.a.Item,{align:"center",className:sendBoxParentStyle,children:[Object(jsx_runtime.jsx)("div",{style:{paddingLeft:"0.5rem",paddingRight:"0.5rem"},children:onRenderTypingIndicator?onRenderTypingIndicator(typingIndicatorProps.typingUsers):Object(jsx_runtime.jsx)(react_components_src.t,Object.assign({},typingIndicatorProps))}),Object(jsx_runtime.jsx)(react_components_src.r,Object.assign({},sendBoxProps))]})]}),showParticipantPane&&Object(jsx_runtime.jsx)(Stack.a.Item,{className:participantListWrapper,children:Object(jsx_runtime.jsxs)(Stack.a,{className:participantListStack,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{className:listHeader,children:"In this chat"}),Object(jsx_runtime.jsx)(Stack.a.Item,{className:participantListStyle,children:Object(jsx_runtime.jsx)(react_components_src.o,Object.assign({},participantListProps,{onRenderAvatar:onRenderParticipantAvatar}))})]})})]})]})};ChatScreen_ChatScreen.displayName="ChatScreen",ChatScreen_ChatScreen.__docgenInfo={description:"",methods:[],displayName:"ChatScreen",props:{showErrorBar:{required:!1,tsType:{name:"boolean"},description:""},showParticipantPane:{required:!1,tsType:{name:"boolean"},description:""},showTopic:{required:!1,tsType:{name:"boolean"},description:""},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, avatarType?: 'chatThread' | 'participantList') => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"avatarType",type:{name:"union",raw:"'chatThread' | 'participantList'",elements:[{name:"literal",value:"'chatThread'"},{name:"literal",value:"'participantList'"}]}}],return:{name:"JSX.Element"}}},description:""},onRenderMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageProps: MessageProps, defaultOnRender?: DefaultMessageRendererType) => JSX.Element",signature:{arguments:[{name:"messageProps",type:{name:"MessageProps"}},{name:"defaultOnRender",type:{name:"DefaultMessageRendererType"}}],return:{name:"JSX.Element"}}},description:""},onRenderTypingIndicator:{required:!1,tsType:{name:"signature",type:"function",raw:"(typingUsers: CommunicationParticipant[]) => JSX.Element",signature:{arguments:[{name:"typingUsers",type:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"}}],return:{name:"JSX.Element"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatScreen.tsx"]={name:"ChatScreen",docgenInfo:ChatScreen_ChatScreen.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatScreen.tsx"});var ChatComposite_ChatComposite=function ChatComposite(props){var adapter=props.adapter,fluentTheme=props.fluentTheme,rtl=props.rtl,locale=props.locale,options=props.options,identifiers=props.identifiers,onRenderAvatar=props.onRenderAvatar,onRenderTypingIndicator=props.onRenderTypingIndicator,onRenderMessage=props.onRenderMessage,chatElement=Object(jsx_runtime.jsx)(react_components_src.f,{fluentTheme:fluentTheme,rtl:rtl,children:Object(jsx_runtime.jsx)(react_components_src.h,{identifiers:identifiers,children:Object(jsx_runtime.jsxs)(ChatAdapterProvider_ChatAdapterProvider,{adapter:adapter,children:[Object(jsx_runtime.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"}),Object(jsx_runtime.jsx)(ChatScreen_ChatScreen,{showErrorBar:null==options?void 0:options.showErrorBar,showParticipantPane:null==options?void 0:options.showParticipantPane,showTopic:null==options?void 0:options.showTopic,onRenderAvatar:onRenderAvatar,onRenderTypingIndicator:onRenderTypingIndicator,onRenderMessage:onRenderMessage})]})})});return locale?Object(react_components_src.i)({locale:locale,children:chatElement}):chatElement};ChatComposite_ChatComposite.__docgenInfo={description:"",methods:[],displayName:"ChatComposite",props:{adapter:{required:!0,tsType:{name:"ChatAdapter"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Fluent theme for the composite.\n\n@defaultValue light theme"},rtl:{required:!1,tsType:{name:"boolean"},description:"Whether composite is displayed right-to-left.\n\n@defaultValue false"},locale:{required:!1,tsType:{name:"Locale"},description:"Locale for the composite.\n\n@defaultValue English (US)"},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, avatarType?: 'chatThread' | 'participantList') => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"avatarType",type:{name:"union",raw:"'chatThread' | 'participantList'",elements:[{name:"literal",value:"'chatThread'"},{name:"literal",value:"'participantList'"}]}}],return:{name:"JSX.Element"}}},description:""},onRenderMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageProps: MessageProps, defaultOnRender?: DefaultMessageRendererType) => JSX.Element",signature:{arguments:[{name:"messageProps",type:{name:"MessageProps"}},{name:"defaultOnRender",type:{name:"DefaultMessageRendererType"}}],return:{name:"JSX.Element"}}},description:""},onRenderTypingIndicator:{required:!1,tsType:{name:"signature",type:"function",raw:"(typingUsers: CommunicationParticipant[]) => JSX.Element",signature:{arguments:[{name:"typingUsers",type:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"}}],return:{name:"JSX.Element"}}},description:""},options:{required:!1,tsType:{name:"signature",type:"object",raw:"{\n  /**\n   * UNSTABLE: Feature flag to enable ErrorBar.\n   *\n   * This option will be removed once ErrorBar is stable.\n   * @experimental\n   *\n   * @defaultValue false\n   */\n  showErrorBar?: boolean;\n  /**\n   * Choose to show the participant pane\n   * @defaultValue false\n   */\n  showParticipantPane?: boolean;\n  /**\n   * Choose to show the topic at the top of the chat\n   * @defaultValue false\n   */\n  showTopic?: boolean;\n}",signature:{properties:[{key:"showErrorBar",value:{name:"boolean",required:!1}},{key:"showParticipantPane",value:{name:"boolean",required:!1}},{key:"showTopic",value:{name:"boolean",required:!1}}]}},description:""},identifiers:{required:!1,tsType:{name:"Identifiers"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/ChatComposite/ChatComposite.tsx"]={name:"ChatComposite",docgenInfo:ChatComposite_ChatComposite.__docgenInfo,path:"../react-composites/src/composites/ChatComposite/ChatComposite.tsx"});__webpack_require__(121);var Spinner=__webpack_require__(1713),callControlsStyles={root:{width:"100%"}},callControlsContainer=Object(lib.G)({width:"100%",height:"3.875rem",padding:"0.0625rem 0",overflow:"hidden",flexDirection:"row",alignItems:"center",marginBottom:2,justifyContent:"center","@media screen and (max-width: 30rem)":{label:{display:"none"}}}),containerStyles={root:{height:"100%",width:"100%"}},subContainerStyles={root:{overflow:"hidden",width:"100%",height:"100%",minHeight:"10rem"}},mediaGalleryContainerStyles={root:{height:"100%"}},CallAdapterContext=(Object(lib.G)({height:"100%",width:"100%",display:"flex",justifyContent:"center",alignItems:"center"}),Object(react.createContext)(void 0)),CallAdapterProvider_CallAdapterProvider=function CallAdapterProvider(props){var adapter=props.adapter;return Object(jsx_runtime.jsx)(CallAdapterContext.Provider,{value:adapter,children:props.children})};CallAdapterProvider_CallAdapterProvider.displayName="CallAdapterProvider";var CallAdapterProvider_useAdapter=function useAdapter(){var adapter=Object(react.useContext)(CallAdapterContext);if(!adapter)throw"Cannot find adapter please initialize before usage.";return adapter};function hooks_useAdaptedSelector_slicedToArray(arr,i){return function hooks_useAdaptedSelector_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function hooks_useAdaptedSelector_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function hooks_useAdaptedSelector_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return hooks_useAdaptedSelector_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hooks_useAdaptedSelector_arrayLikeToArray(o,minLen)}(arr,i)||function hooks_useAdaptedSelector_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hooks_useAdaptedSelector_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}CallAdapterProvider_CallAdapterProvider.__docgenInfo={description:"",methods:[],displayName:"CallAdapterProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},adapter:{required:!0,tsType:{name:"CallAdapter"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/adapter/CallAdapterProvider.tsx"]={name:"CallAdapterProvider",docgenInfo:CallAdapterProvider_CallAdapterProvider.__docgenInfo,path:"../react-composites/src/composites/CallComposite/adapter/CallAdapterProvider.tsx"});var useAdaptedSelector_useAdaptedSelector=function useAdaptedSelector(selector,selectorProps){return hooks_useAdaptedSelector_useSelectorWithAdaptation(selector,useAdaptedSelector_adaptCompositeState,selectorProps)},hooks_useAdaptedSelector_useSelectorWithAdaptation=function useSelectorWithAdaptation(selector,adaptState,selectorProps){var _adapter$getState$cal,adapter=CallAdapterProvider_useAdapter(),mounted=Object(react.useRef)(!1);Object(react.useEffect)((function(){return mounted.current=!0,function(){mounted.current=!1}}));var callId=null===(_adapter$getState$cal=adapter.getState().call)||void 0===_adapter$getState$cal?void 0:_adapter$getState$cal.id,callConfigProps=Object(react.useMemo)((function(){return{callId:callId}}),[callId]),_useState2=hooks_useAdaptedSelector_slicedToArray(Object(react.useState)(selector(adaptState(adapter.getState()),null!=selectorProps?selectorProps:callConfigProps)),2),props=_useState2[0],setProps=_useState2[1],propRef=Object(react.useRef)(props);return propRef.current=props,Object(react.useEffect)((function(){var onStateChange=function onStateChange(state){if(mounted.current){var newProps=selector(adaptState(state),null!=selectorProps?selectorProps:callConfigProps);propRef.current!==newProps&&setProps(newProps)}};return adapter.onStateChange(onStateChange),function(){adapter.offStateChange(onStateChange)}}),[adaptState,adapter,selector,selectorProps,callConfigProps]),props},useAdaptedSelector_memoizeState=Object(memoize_one_esm.a)((function(userId,deviceManager,calls,displayName){return{userId:userId,incomingCalls:{},incomingCallsEnded:[],callsEnded:[],deviceManager:deviceManager,callAgent:{displayName:displayName},calls:calls}})),memoizeCalls=Object(memoize_one_esm.a)((function(call){var _ref;return call?((_ref={})[call.id]=call,_ref):{}})),useAdaptedSelector_adaptCompositeState=function adaptCompositeState(compositeState){return useAdaptedSelector_memoizeState(compositeState.userId,compositeState.devices,memoizeCalls(compositeState.call),compositeState.displayName)},hooks_useSelector_useSelector=function useSelector(selector,selectorProps){return hooks_useAdaptedSelector_useSelectorWithAdaptation(selector,(function(state){return state}),selectorProps)},getDeviceManager=function getDeviceManager(state){return state.deviceManager},getRemoteParticipants=function getRemoteParticipants(state,props){var _state$calls$props$ca;return null===(_state$calls$props$ca=state.calls[props.callId])||void 0===_state$calls$props$ca?void 0:_state$calls$props$ca.remoteParticipants},getIsScreenSharingOn=function getIsScreenSharingOn(state,props){var _state$calls$props$ca2;return null===(_state$calls$props$ca2=state.calls[props.callId])||void 0===_state$calls$props$ca2?void 0:_state$calls$props$ca2.isScreenSharingOn},getIsMuted=function getIsMuted(state,props){var _state$calls$props$ca3;return null===(_state$calls$props$ca3=state.calls[props.callId])||void 0===_state$calls$props$ca3?void 0:_state$calls$props$ca3.isMuted},getLocalVideoStreams=function getLocalVideoStreams(state,props){var _state$calls$props$ca4;return null===(_state$calls$props$ca4=state.calls[props.callId])||void 0===_state$calls$props$ca4?void 0:_state$calls$props$ca4.localVideoStreams},baseSelectors_getDisplayName=function getDisplayName(state){var _state$callAgent;return null===(_state$callAgent=state.callAgent)||void 0===_state$callAgent?void 0:_state$callAgent.displayName},baseSelectors_getIdentifier=function getIdentifier(state){return Object(src.d)(state.userId)},microphoneButtonSelector=(__webpack_require__(127),es.a([function getCallExists(state,props){return!!state.calls[props.callId]},getIsMuted,getDeviceManager],(function(callExists,isMuted,deviceManager){var permission=!deviceManager.deviceAccess||deviceManager.deviceAccess.audio;return{disabled:!callExists||!permission,checked:!!callExists&&!isMuted}}))),cameraButtonSelector=es.a([getLocalVideoStreams,getDeviceManager],(function(localVideoStreams,deviceManager){var previewOn=deviceManager.unparentedViews.length>0&&void 0!==deviceManager.unparentedViews[0].view,localVideoFromCall=null==localVideoStreams?void 0:localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})),permission=!deviceManager.deviceAccess||deviceManager.deviceAccess.video;return{disabled:!deviceManager.selectedCamera||!permission,checked:void 0!==localVideoStreams?!!localVideoFromCall:previewOn}})),screenShareButtonSelector=es.a([getIsScreenSharingOn],(function(isScreenSharingOn){return{checked:isScreenSharingOn}})),optionsButtonSelector=es.a([getDeviceManager],(function(deviceManager){return{microphones:deviceManager.microphones,speakers:deviceManager.speakers,cameras:deviceManager.cameras,selectedMicrophone:deviceManager.selectedMicrophone,selectedSpeaker:deviceManager.selectedSpeaker,selectedCamera:deviceManager.selectedCamera}})),sdk_bundle=__webpack_require__(132);function handlers_createHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function handlers_createHandlers_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){handlers_createHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){handlers_createHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var areStreamsEqual=function areStreamsEqual(prevStream,newStream){return!!prevStream&&!!newStream&&prevStream.source.id===newStream.source.id},createDefaultCallingHandlers=Object(memoize_one_esm.a)((function(callClient,callAgent,deviceManager,call){var onStartLocalVideo=function(){var _ref=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var callId,videoDeviceInfo,cameras,stream;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(callId=null==call?void 0:call.id,videoDeviceInfo=callClient.getState().deviceManager.selectedCamera){_context.next=8;break}return _context.next=5,null==deviceManager?void 0:deviceManager.getCameras();case 5:cameras=_context.sent,(videoDeviceInfo=cameras&&cameras.length>0?cameras[0]:void 0)&&(null==deviceManager||deviceManager.selectCamera(videoDeviceInfo));case 8:if(callId&&videoDeviceInfo){_context.next=10;break}return _context.abrupt("return");case 10:if(stream=new sdk_bundle.LocalVideoStream(videoDeviceInfo),!call||call.localVideoStreams.find((function(s){return areStreamsEqual(s,stream)}))){_context.next=14;break}return _context.next=14,call.startVideo(stream);case 14:case"end":return _context.stop()}}),_callee)})));return function onStartLocalVideo(){return _ref.apply(this,arguments)}}(),onStopLocalVideo=function(){var _ref2=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee2(stream){var callId;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(callId=null==call?void 0:call.id){_context2.next=3;break}return _context2.abrupt("return");case 3:if(!call||!call.localVideoStreams.find((function(s){return areStreamsEqual(s,stream)}))){_context2.next=8;break}return _context2.next=6,call.stopVideo(stream);case 6:return _context2.next=8,callClient.disposeView(callId,void 0,{source:stream.source,mediaStreamType:stream.mediaStreamType});case 8:case"end":return _context2.stop()}}),_callee2)})));return function onStopLocalVideo(_x){return _ref2.apply(this,arguments)}}(),onToggleCamera=function(){var _ref3=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee4(options){var stream,selectedCamera;return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(!call){_context4.next=11;break}if(!(stream=call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})))){_context4.next=7;break}return _context4.next=5,onStopLocalVideo(stream);case 5:_context4.next=9;break;case 7:return _context4.next=9,onStartLocalVideo();case 9:_context4.next=20;break;case 11:if(!(selectedCamera=callClient.getState().deviceManager.selectedCamera)){_context4.next=20;break}if(!isPreviewOn(callClient.getState().deviceManager)){_context4.next=18;break}callClient.getState().deviceManager.unparentedViews.forEach(function(){var _ref4=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee3(view){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,callClient.disposeView(void 0,void 0,view);case 2:case"end":return _context3.stop()}}),_callee3)})));return function(_x3){return _ref4.apply(this,arguments)}}()),_context4.next=20;break;case 18:return _context4.next=20,callClient.createView(void 0,void 0,{source:selectedCamera,mediaStreamType:"Video"},options);case 20:case"end":return _context4.stop()}}),_callee4)})));return function onToggleCamera(_x2){return _ref3.apply(this,arguments)}}(),onSelectMicrophone=function(){var _ref5=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee5(device){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(deviceManager){_context5.next=2;break}return _context5.abrupt("return");case 2:return _context5.abrupt("return",deviceManager.selectMicrophone(device));case 3:case"end":return _context5.stop()}}),_callee5)})));return function onSelectMicrophone(_x4){return _ref5.apply(this,arguments)}}(),onSelectSpeaker=function(){var _ref6=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee6(device){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(deviceManager){_context6.next=2;break}return _context6.abrupt("return");case 2:return _context6.abrupt("return",deviceManager.selectSpeaker(device));case 3:case"end":return _context6.stop()}}),_callee6)})));return function onSelectSpeaker(_x5){return _ref6.apply(this,arguments)}}(),onSelectCamera=function(){var _ref7=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee7(device,options){var stream;return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(deviceManager){_context7.next=2;break}return _context7.abrupt("return");case 2:if(!call){_context7.next=8;break}return deviceManager.selectCamera(device),stream=call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})),_context7.abrupt("return",null==stream?void 0:stream.switchSource(device));case 8:if(isPreviewOn(callClient.getState().deviceManager)){_context7.next=12;break}return deviceManager.selectCamera(device),_context7.abrupt("return");case 12:return onDisposeLocalStreamView(),deviceManager.selectCamera(device),_context7.next=16,callClient.createView(void 0,void 0,{source:device,mediaStreamType:"Video"},options);case 16:case"end":return _context7.stop()}}),_callee7)})));return function onSelectCamera(_x6,_x7){return _ref7.apply(this,arguments)}}(),onToggleMicrophone=function(){var _ref8=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(call){_context8.next=2;break}throw new Error("Please invoke onToggleMicrophone after call is started");case 2:if(!call.isMuted){_context8.next=8;break}return _context8.next=5,call.unmute();case 5:_context8.t0=_context8.sent,_context8.next=11;break;case 8:return _context8.next=10,call.mute();case 10:_context8.t0=_context8.sent;case 11:return _context8.abrupt("return",_context8.t0);case 12:case"end":return _context8.stop()}}),_callee8)})));return function onToggleMicrophone(){return _ref8.apply(this,arguments)}}(),onStartScreenShare=function(){var _ref9=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,null==call?void 0:call.startScreenSharing();case 2:return _context9.abrupt("return",_context9.sent);case 3:case"end":return _context9.stop()}}),_callee9)})));return function onStartScreenShare(){return _ref9.apply(this,arguments)}}(),onStopScreenShare=function(){var _ref10=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee10(){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,null==call?void 0:call.stopScreenSharing();case 2:return _context10.abrupt("return",_context10.sent);case 3:case"end":return _context10.stop()}}),_callee10)})));return function onStopScreenShare(){return _ref10.apply(this,arguments)}}(),onToggleScreenShare=function(){var _ref11=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(null==call||!call.isScreenSharingOn){_context11.next=6;break}return _context11.next=3,onStopScreenShare();case 3:_context11.t0=_context11.sent,_context11.next=9;break;case 6:return _context11.next=8,onStartScreenShare();case 8:_context11.t0=_context11.sent;case 9:return _context11.abrupt("return",_context11.t0);case 10:case"end":return _context11.stop()}}),_callee11)})));return function onToggleScreenShare(){return _ref11.apply(this,arguments)}}(),onHangUp=function(){var _ref12=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee12(){return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return _context12.next=2,null==call?void 0:call.hangUp();case 2:return _context12.abrupt("return",_context12.sent);case 3:case"end":return _context12.stop()}}),_callee12)})));return function onHangUp(){return _ref12.apply(this,arguments)}}(),onCreateLocalStreamView=function(){var _ref13=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee13(options){var callState,localStream;return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:if(call&&0!==call.localVideoStreams.length){_context13.next=2;break}return _context13.abrupt("return");case 2:if(callState=callClient.getState().calls[call.id]){_context13.next=5;break}return _context13.abrupt("return");case 5:if(localStream=callState.localVideoStreams.find((function(item){return"Video"===item.mediaStreamType}))){_context13.next=8;break}return _context13.abrupt("return");case 8:return _context13.abrupt("return",callClient.createView(call.id,void 0,localStream,options));case 9:case"end":return _context13.stop()}}),_callee13)})));return function onCreateLocalStreamView(_x8){return _ref13.apply(this,arguments)}}(),onCreateRemoteStreamView=function(){var _ref14=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee14(userId){var options,callState,participant,remoteVideoStream,screenShareStream,_args14=arguments;return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:if(options=_args14.length>1&&void 0!==_args14[1]?_args14[1]:{scalingMode:"Crop"},call){_context14.next=3;break}return _context14.abrupt("return");case 3:if(callState=callClient.getState().calls[call.id]){_context14.next=6;break}throw new Error("Call Not Found: "+call.id);case 6:if((participant=Object.values(callState.remoteParticipants).find((function(participant){return Object(src.d)(participant.identifier)===userId})))&&participant.videoStreams){_context14.next=9;break}return _context14.abrupt("return");case 9:remoteVideoStream=Object.values(participant.videoStreams).find((function(i){return"Video"===i.mediaStreamType})),screenShareStream=Object.values(participant.videoStreams).find((function(i){return"ScreenSharing"===i.mediaStreamType})),remoteVideoStream&&remoteVideoStream.isAvailable&&!remoteVideoStream.view&&callClient.createView(call.id,participant.identifier,remoteVideoStream,options),screenShareStream&&screenShareStream.isAvailable&&!screenShareStream.view&&callClient.createView(call.id,participant.identifier,screenShareStream,{scalingMode:"Fit"});case 13:case"end":return _context14.stop()}}),_callee14)})));return function onCreateRemoteStreamView(_x9){return _ref14.apply(this,arguments)}}(),onDisposeRemoteStreamView=function(){var _ref15=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee15(userId){var callState,participant,remoteVideoStream,screenShareStream;return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:if(call){_context15.next=2;break}return _context15.abrupt("return");case 2:if(callState=callClient.getState().calls[call.id]){_context15.next=5;break}throw new Error("Call Not Found: "+call.id);case 5:if((participant=Object.values(callState.remoteParticipants).find((function(participant){return Object(src.d)(participant.identifier)===userId})))&&participant.videoStreams){_context15.next=8;break}return _context15.abrupt("return");case 8:remoteVideoStream=Object.values(participant.videoStreams).find((function(i){return"Video"===i.mediaStreamType})),screenShareStream=Object.values(participant.videoStreams).find((function(i){return"ScreenSharing"===i.mediaStreamType})),remoteVideoStream&&remoteVideoStream.view&&callClient.disposeView(call.id,participant.identifier,remoteVideoStream),screenShareStream&&screenShareStream.view&&callClient.disposeView(call.id,participant.identifier,screenShareStream);case 12:case"end":return _context15.stop()}}),_callee15)})));return function onDisposeRemoteStreamView(_x10){return _ref15.apply(this,arguments)}}(),onDisposeLocalStreamView=function(){var _ref16=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee17(){return regeneratorRuntime.wrap((function _callee17$(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:callClient.getState().deviceManager.selectedCamera&&callClient.getState().deviceManager.unparentedViews.forEach(function(){var _ref17=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee16(view){return regeneratorRuntime.wrap((function _callee16$(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:return _context16.next=2,callClient.disposeView(void 0,void 0,view);case 2:case"end":return _context16.stop()}}),_callee16)})));return function(_x11){return _ref17.apply(this,arguments)}}());case 2:case"end":return _context17.stop()}}),_callee17)})));return function onDisposeLocalStreamView(){return _ref16.apply(this,arguments)}}();return{onHangUp:onHangUp,onSelectCamera:onSelectCamera,onSelectMicrophone:onSelectMicrophone,onSelectSpeaker:onSelectSpeaker,onStartCall:function onStartCall(participants,options){return callAgent?callAgent.startCall(participants,options):void 0},onStartScreenShare:onStartScreenShare,onStopScreenShare:onStopScreenShare,onToggleCamera:onToggleCamera,onToggleMicrophone:onToggleMicrophone,onToggleScreenShare:onToggleScreenShare,onCreateLocalStreamView:onCreateLocalStreamView,onCreateRemoteStreamView:onCreateRemoteStreamView,onParticipantRemove:function(){var _ref18=handlers_createHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee18(userId){return regeneratorRuntime.wrap((function _callee18$(_context18){for(;;)switch(_context18.prev=_context18.next){case 0:return _context18.next=2,null==call?void 0:call.removeParticipant(Object(src.a)(userId));case 2:case"end":return _context18.stop()}}),_callee18)})));return function onParticipantRemove(_x12){return _ref18.apply(this,arguments)}}(),onStartLocalVideo:onStartLocalVideo,onDisposeRemoteStreamView:onDisposeRemoteStreamView,onDisposeLocalStreamView:onDisposeLocalStreamView}})),isPreviewOn=function isPreviewOn(deviceManager){return deviceManager.unparentedViews.length>0&&void 0!==deviceManager.unparentedViews[0].view},participantListSelector=(__webpack_require__(765),es.a([baseSelectors_getIdentifier,baseSelectors_getDisplayName,getRemoteParticipants,getIsScreenSharingOn,getIsMuted],(function(userId,displayName,remoteParticipants,isScreenSharingOn,isMuted){var participants=remoteParticipants?function convertRemoteParticipantsToCommunicationParticipants(remoteParticipants){return remoteParticipants.map((function(participant){var isScreenSharing=Object.values(participant.videoStreams).some((function(videoStream){return"ScreenSharing"===videoStream.mediaStreamType&&videoStream.isAvailable}));return{userId:Object(src.d)(participant.identifier),displayName:participant.displayName,state:participant.state,isMuted:participant.isMuted,isScreenSharing:isScreenSharing,isSpeaking:participant.isSpeaking}}))}(Object.values(remoteParticipants)):[];return participants.push({userId:userId,displayName:displayName,isScreenSharing:isScreenSharingOn,isMuted:isMuted,state:"Connected"}),{participants:participants,myUserId:userId}}))),participantsButtonSelector=es.a([participantListSelector],(function(participantListProps){return{participantListProps:participantListProps}})),convertRemoteVideoStreamToVideoGalleryStream=function convertRemoteVideoStreamToVideoGalleryStream(stream){var _stream$view,_stream$view2;return{id:stream.id,isAvailable:stream.isAvailable,isMirrored:null===(_stream$view=stream.view)||void 0===_stream$view?void 0:_stream$view.isMirrored,renderElement:null===(_stream$view2=stream.view)||void 0===_stream$view2?void 0:_stream$view2.target}},convertRemoteParticipantToVideoGalleryRemoteParticipant=function convertRemoteParticipantToVideoGalleryRemoteParticipant(userId,isMuted,isSpeaking,videoStreams,displayName){var rawVideoStreamsArray=Object.values(videoStreams),videoStream=void 0,screenShareStream=void 0;return rawVideoStreamsArray[0]&&("Video"===rawVideoStreamsArray[0].mediaStreamType?videoStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0]):screenShareStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[0])),rawVideoStreamsArray[1]&&("ScreenSharing"===rawVideoStreamsArray[1].mediaStreamType?screenShareStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1]):videoStream=convertRemoteVideoStreamToVideoGalleryStream(rawVideoStreamsArray[1])),{userId:userId,displayName:displayName,isMuted:isMuted,isSpeaking:isSpeaking,videoStream:videoStream,screenShareStream:screenShareStream,isScreenSharingOn:void 0!==screenShareStream&&screenShareStream.isAvailable}},memoizedAllConvertRemoteParticipant=Object(src.c)((function(userId,isMuted,isSpeaking,videoStreams,displayName){return convertRemoteParticipantToVideoGalleryRemoteParticipant(userId,isMuted,isSpeaking,videoStreams,displayName)})),videoGallerySelector_videoGalleryRemoteParticipantsMemo=function videoGalleryRemoteParticipantsMemo(remoteParticipants){return remoteParticipants?memoizedAllConvertRemoteParticipant((function(memoizedFn){return Object.values(remoteParticipants).map((function(participant){return memoizedFn(Object(src.d)(participant.identifier),participant.isMuted,participant.isSpeaking,participant.videoStreams,participant.displayName)}))})):[]},videoGallerySelector=Object(es.a)([function getScreenShareRemoteParticipant(state,props){var _state$calls$props$ca5;return null===(_state$calls$props$ca5=state.calls[props.callId])||void 0===_state$calls$props$ca5?void 0:_state$calls$props$ca5.screenShareRemoteParticipant},getRemoteParticipants,getLocalVideoStreams,getIsMuted,getIsScreenSharingOn,baseSelectors_getDisplayName,baseSelectors_getIdentifier],(function(screenShareRemoteParticipantId,remoteParticipants,localVideoStreams,isMuted,isScreenSharingOn,displayName,identifier){var _localVideoStream$vie,_localVideoStream$vie2,screenShareRemoteParticipant=screenShareRemoteParticipantId&&remoteParticipants?remoteParticipants[screenShareRemoteParticipantId]:void 0,localVideoStream=null==localVideoStreams?void 0:localVideoStreams.find((function(i){return"Video"===i.mediaStreamType}));return{screenShareParticipant:screenShareRemoteParticipant?convertRemoteParticipantToVideoGalleryRemoteParticipant(Object(src.d)(screenShareRemoteParticipant.identifier),screenShareRemoteParticipant.isMuted,screenShareRemoteParticipant.isSpeaking,screenShareRemoteParticipant.videoStreams,screenShareRemoteParticipant.displayName):void 0,localParticipant:{userId:identifier,displayName:null!=displayName?displayName:"",isMuted:isMuted,isScreenSharingOn:isScreenSharingOn,videoStream:{isAvailable:!!localVideoStream,isMirrored:null==localVideoStream||null===(_localVideoStream$vie=localVideoStream.view)||void 0===_localVideoStream$vie?void 0:_localVideoStream$vie.isMirrored,renderElement:null==localVideoStream||null===(_localVideoStream$vie2=localVideoStream.view)||void 0===_localVideoStream$vie2?void 0:_localVideoStream$vie2.target}},remoteParticipants:videoGallerySelector_videoGalleryRemoteParticipantsMemo(remoteParticipants)}})),CallAgentContext=Object(react.createContext)(void 0),CallAgentProvider_CallAgentProviderBase=function CallAgentProviderBase(props){var initialState={callAgent:props.callAgent};return Object(jsx_runtime.jsx)(CallAgentContext.Provider,{value:initialState,children:props.children})};CallAgentProvider_CallAgentProviderBase.displayName="CallAgentProviderBase";var CallAgentProvider_CallAgentProvider=function CallAgentProvider(props){return Object(jsx_runtime.jsx)(CallAgentProvider_CallAgentProviderBase,Object.assign({},props))};CallAgentProvider_CallAgentProvider.displayName="CallAgentProvider";function CallClientProvider_slicedToArray(arr,i){return function CallClientProvider_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallClientProvider_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CallClientProvider_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallClientProvider_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallClientProvider_arrayLikeToArray(o,minLen)}(arr,i)||function CallClientProvider_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallClientProvider_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}CallAgentProvider_CallAgentProvider.__docgenInfo={description:"",methods:[],displayName:"CallAgentProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},callAgent:{required:!1,tsType:{name:"CallAgent"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../calling-component-bindings/src/providers/CallAgentProvider.tsx"]={name:"CallAgentProvider",docgenInfo:CallAgentProvider_CallAgentProvider.__docgenInfo,path:"../calling-component-bindings/src/providers/CallAgentProvider.tsx"});var CallClientContext=Object(react.createContext)(void 0),CallClientProvider_CallClientProviderBase=function CallClientProviderBase(props){var callClient=props.callClient,_useState2=CallClientProvider_slicedToArray(Object(react.useState)(void 0),2),deviceManager=_useState2[0],setDeviceManager=_useState2[1];Object(react.useEffect)((function(){callClient.getDeviceManager().then((function(manager){manager.getCameras(),manager.getMicrophones(),manager.getSpeakers(),setDeviceManager(manager)})).catch((function(error){throw new Error(error)}))}),[callClient]);var initialState={callClient:callClient,deviceManager:deviceManager};return Object(jsx_runtime.jsx)(CallClientContext.Provider,{value:initialState,children:props.children})};CallClientProvider_CallClientProviderBase.displayName="CallClientProviderBase";var CallClientProvider_CallClientProvider=function CallClientProvider(props){return Object(jsx_runtime.jsx)(CallClientProvider_CallClientProviderBase,Object.assign({},props))};CallClientProvider_CallClientProvider.displayName="CallClientProvider";CallClientProvider_CallClientProvider.__docgenInfo={description:"",methods:[],displayName:"CallClientProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},callClient:{required:!0,tsType:{name:"StatefulCallClient"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../calling-component-bindings/src/providers/CallClientProvider.tsx"]={name:"CallClientProvider",docgenInfo:CallClientProvider_CallClientProvider.__docgenInfo,path:"../calling-component-bindings/src/providers/CallClientProvider.tsx"});var CallProvider_CallContext=Object(react.createContext)(void 0),CallProvider_CallProviderBase=function CallProviderBase(props){var children=props.children,initialState={call:props.call};return Object(jsx_runtime.jsx)(CallProvider_CallContext.Provider,{value:initialState,children:children})};CallProvider_CallProviderBase.displayName="CallProviderBase";var CallProvider_CallProvider=function CallProvider(props){return Object(jsx_runtime.jsx)(CallProvider_CallProviderBase,Object.assign({},props))};CallProvider_CallProvider.displayName="CallProvider";CallProvider_CallProvider.__docgenInfo={description:"",methods:[],displayName:"CallProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},call:{required:!1,tsType:{name:"Call"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../calling-component-bindings/src/providers/CallProvider.tsx"]={name:"CallProvider",docgenInfo:CallProvider_CallProvider.__docgenInfo,path:"../calling-component-bindings/src/providers/CallProvider.tsx"});var emptySelector=function emptySelector(){return{}},usePropsFor_getSelector=function getSelector(component){return hooks_usePropsFor_findSelector(component)},hooks_usePropsFor_findSelector=function findSelector(component){switch(component){case react_components_src.u:return videoGallerySelector;case react_components_src.l:return microphoneButtonSelector;case react_components_src.a:return cameraButtonSelector;case react_components_src.q:return screenShareButtonSelector;case react_components_src.m:return optionsButtonSelector;case react_components_src.o:return participantListSelector;case react_components_src.p:return participantsButtonSelector;case react_components_src.d:return emptySelector}};function useHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function useHandlers_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){useHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){useHandlers_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var CallComposite_hooks_useHandlers_useHandlers=function useHandlers(_component){return useHandlers_createCompositeHandlers(CallAdapterProvider_useAdapter())},useHandlers_createCompositeHandlers=Object(memoize_one_esm.a)((function(adapter){return{onCreateLocalStreamView:(_onCreateLocalStreamView=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee(options){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,adapter.createStreamView(void 0,options);case 2:case"end":return _context.stop()}}),_callee)}))),function onCreateLocalStreamView(_x){return _onCreateLocalStreamView.apply(this,arguments)}),onCreateRemoteStreamView:(_onCreateRemoteStreamView=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee2(userId,options){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,adapter.createStreamView(userId,options);case 2:case"end":return _context2.stop()}}),_callee2)}))),function onCreateRemoteStreamView(_x2,_x3){return _onCreateRemoteStreamView.apply(this,arguments)}),onHangUp:(_onHangUp=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,adapter.leaveCall();case 2:case"end":return _context3.stop()}}),_callee3)}))),function onHangUp(){return _onHangUp.apply(this,arguments)}),onParticipantRemove:(_onParticipantRemove=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee4(userId){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,adapter.removeParticipant(userId);case 2:case"end":return _context4.stop()}}),_callee4)}))),function onParticipantRemove(_x4){return _onParticipantRemove.apply(this,arguments)}),onSelectCamera:(_onSelectCamera=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee5(deviceInfo,options){return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,adapter.setCamera(deviceInfo,options);case 2:case"end":return _context5.stop()}}),_callee5)}))),function onSelectCamera(_x5,_x6){return _onSelectCamera.apply(this,arguments)}),onSelectMicrophone:(_onSelectMicrophone=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee6(deviceInfo){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,adapter.setMicrophone(deviceInfo);case 2:case"end":return _context6.stop()}}),_callee6)}))),function onSelectMicrophone(_x7){return _onSelectMicrophone.apply(this,arguments)}),onSelectSpeaker:(_onSelectSpeaker=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee7(deviceInfo){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,adapter.setSpeaker(deviceInfo);case 2:case"end":return _context7.stop()}}),_callee7)}))),function onSelectSpeaker(_x8){return _onSelectSpeaker.apply(this,arguments)}),onStartCall:function onStartCall(participants){var rawIds=participants.map((function(participant){return Object(src.d)(participant)}));return adapter.startCall(rawIds)},onStartScreenShare:(_onStartScreenShare=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee8(){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,adapter.startScreenShare();case 2:case"end":return _context8.stop()}}),_callee8)}))),function onStartScreenShare(){return _onStartScreenShare.apply(this,arguments)}),onStopScreenShare:(_onStopScreenShare=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee9(){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,adapter.stopScreenShare();case 2:case"end":return _context9.stop()}}),_callee9)}))),function onStopScreenShare(){return _onStopScreenShare.apply(this,arguments)}),onToggleCamera:(_onToggleCamera=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee10(options){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _context10.next=2,adapter.onToggleCamera(options);case 2:case"end":return _context10.stop()}}),_callee10)}))),function onToggleCamera(_x9){return _onToggleCamera.apply(this,arguments)}),onToggleMicrophone:(_onToggleMicrophone=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){var _adapter$getState$cal;return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(null===(_adapter$getState$cal=adapter.getState().call)||void 0===_adapter$getState$cal||!_adapter$getState$cal.isMuted){_context11.next=6;break}return _context11.next=3,adapter.unmute();case 3:_context11.t0=_context11.sent,_context11.next=9;break;case 6:return _context11.next=8,adapter.mute();case 8:_context11.t0=_context11.sent;case 9:return _context11.abrupt("return",_context11.t0);case 10:case"end":return _context11.stop()}}),_callee11)}))),function onToggleMicrophone(){return _onToggleMicrophone.apply(this,arguments)}),onToggleScreenShare:(_onToggleScreenShare=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee12(){var _adapter$getState$cal2;return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:if(null===(_adapter$getState$cal2=adapter.getState().call)||void 0===_adapter$getState$cal2||!_adapter$getState$cal2.isScreenSharingOn){_context12.next=6;break}return _context12.next=3,adapter.stopScreenShare();case 3:_context12.t0=_context12.sent,_context12.next=9;break;case 6:return _context12.next=8,adapter.startScreenShare();case 8:_context12.t0=_context12.sent;case 9:return _context12.abrupt("return",_context12.t0);case 10:case"end":return _context12.stop()}}),_callee12)}))),function onToggleScreenShare(){return _onToggleScreenShare.apply(this,arguments)}),onStartLocalVideo:(_onStartLocalVideo=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee13(){return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:if(!adapter.getState().call){_context13.next=2;break}return _context13.abrupt("return",adapter.startCamera());case 2:case"end":return _context13.stop()}}),_callee13)}))),function onStartLocalVideo(){return _onStartLocalVideo.apply(this,arguments)}),onDisposeLocalStreamView:(_onDisposeLocalStreamView=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee14(){return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return _context14.abrupt("return",adapter.disposeStreamView());case 1:case"end":return _context14.stop()}}),_callee14)}))),function onDisposeLocalStreamView(){return _onDisposeLocalStreamView.apply(this,arguments)}),onDisposeRemoteStreamView:(_onDisposeRemoteStreamView=useHandlers_asyncToGenerator(regeneratorRuntime.mark((function _callee15(userId){return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return _context15.abrupt("return",adapter.disposeStreamView(userId));case 1:case"end":return _context15.stop()}}),_callee15)}))),function onDisposeRemoteStreamView(_x10){return _onDisposeRemoteStreamView.apply(this,arguments)})};var _onDisposeRemoteStreamView,_onDisposeLocalStreamView,_onStartLocalVideo,_onToggleScreenShare,_onToggleMicrophone,_onToggleCamera,_onStopScreenShare,_onStartScreenShare,_onSelectSpeaker,_onSelectMicrophone,_onSelectCamera,_onParticipantRemove,_onHangUp,_onCreateRemoteStreamView,_onCreateLocalStreamView})),CallComposite_hooks_usePropsFor_usePropsFor=function usePropsFor(component){var selector=usePropsFor_getSelector(component);if(!selector)throw new Error("Can't find the selector for component, please check supported component list");return Object.assign({},useAdaptedSelector_useAdaptedSelector(selector),CallComposite_hooks_useHandlers_useHandlers())},Spinner_types=__webpack_require__(185),videoBaseStyle=Object(lib.G)({border:0}),aspectRatioBoxStyle=(Object(lib.G)(videoBaseStyle,{width:"100%",height:"100%"}),Object(lib.G)(videoBaseStyle,{width:"100%",height:0,position:"relative",paddingTop:"56.25%"})),aspectRatioBoxContentStyle=Object(lib.G)({position:"absolute",top:0,left:0,width:"100%",height:"100%"}),stackContainerStyle=Object(lib.G)({height:"100%",width:"15%"}),screenShareContainerStyle=Object(lib.G)({height:"100%",width:"85%",position:"relative"}),stackContainerParticipantVideoStyles={root:{borderRadius:0},videoContainer:{borderRadius:0,"& video":{borderRadius:0}}},videoStreamStyle=Object(lib.G)({position:"absolute",bottom:".25rem",right:".25rem",height:"auto",width:"25%"}),ScreenShare_styles_loadingStyle=Object(lib.G)({height:"100%",width:"100%",display:"flex",justifyContent:"center"}),memoizeAllRemoteParticipants=Object(src.c)((function(userId,isMuted,renderElement,displayName){return Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:aspectRatioBoxStyle,children:Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxContentStyle,children:Object(jsx_runtime.jsx)(react_components_src.v,{styles:stackContainerParticipantVideoStyles,userId:userId,renderElement:renderElement?Object(jsx_runtime.jsx)(react_components_src.s,{videoStreamElement:renderElement}):void 0,displayName:displayName,isMuted:isMuted})})},userId)})),ScreenShare_onRenderPlaceholder=function onRenderPlaceholder(props){return Object(jsx_runtime.jsx)("div",{className:ScreenShare_styles_loadingStyle,children:Object(jsx_runtime.jsx)(Spinner.a,{label:"Loading "+props.displayName+"'s screen",size:Spinner_types.a.xSmall})})};ScreenShare_onRenderPlaceholder.displayName="onRenderPlaceholder";var ScreenShare_ScreenShare=function ScreenShare(props){var screenShareParticipant=props.screenShareParticipant,localParticipant=props.localParticipant,remoteParticipants=props.remoteParticipants,onCreateRemoteStreamView=props.onCreateRemoteStreamView,onCreateLocalStreamView=props.onCreateLocalStreamView,localVideoStream=null==localParticipant?void 0:localParticipant.videoStream,isScreenShareAvailable=screenShareParticipant&&screenShareParticipant.screenShareStream&&screenShareParticipant.screenShareStream.isAvailable,screenShareStreamComponent=Object(react.useMemo)((function(){var _videoStream$renderEl;if(isScreenShareAvailable){var screenShareStream=null==screenShareParticipant?void 0:screenShareParticipant.screenShareStream,videoStream=null==screenShareParticipant?void 0:screenShareParticipant.videoStream;return null==screenShareStream||!screenShareStream.isAvailable||null!=screenShareStream&&screenShareStream.renderElement||screenShareParticipant&&onCreateRemoteStreamView&&onCreateRemoteStreamView(screenShareParticipant.userId),null==videoStream||!videoStream.isAvailable||null!=videoStream&&videoStream.renderElement||screenShareParticipant&&onCreateRemoteStreamView&&onCreateRemoteStreamView(screenShareParticipant.userId),Object(jsx_runtime.jsx)(react_components_src.v,{displayName:null==screenShareParticipant?void 0:screenShareParticipant.displayName,isMuted:null==screenShareParticipant?void 0:screenShareParticipant.isMuted,renderElement:null!=screenShareStream&&screenShareStream.renderElement?Object(jsx_runtime.jsx)(react_components_src.s,{videoStreamElement:null==screenShareStream?void 0:screenShareStream.renderElement}):void 0,onRenderPlaceholder:ScreenShare_onRenderPlaceholder,styles:{overlayContainer:videoStreamStyle},children:videoStream&&videoStream.isAvailable&&videoStream.renderElement&&Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:aspectRatioBoxStyle,children:Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxContentStyle,children:Object(jsx_runtime.jsx)(react_components_src.v,{renderElement:Object(jsx_runtime.jsx)(react_components_src.s,{videoStreamElement:null!==(_videoStream$renderEl=videoStream.renderElement)&&void 0!==_videoStream$renderEl?_videoStream$renderEl:null})})})})})}}),[isScreenShareAvailable,onCreateRemoteStreamView,screenShareParticipant]),sidePanelLocalParticipant=Object(react.useMemo)((function(){return!localVideoStream||null!=localVideoStream&&localVideoStream.renderElement||onCreateLocalStreamView&&onCreateLocalStreamView(),Object(jsx_runtime.jsx)(react_components_src.v,{styles:stackContainerParticipantVideoStyles,isMuted:null==localParticipant?void 0:localParticipant.isMuted,renderElement:null!=localVideoStream&&localVideoStream.renderElement?Object(jsx_runtime.jsx)(react_components_src.s,{videoStreamElement:null==localVideoStream?void 0:localVideoStream.renderElement}):void 0,displayName:null==localParticipant?void 0:localParticipant.displayName})}),[localParticipant,localVideoStream,onCreateLocalStreamView]),sidePanelRemoteParticipants=Object(react.useMemo)((function(){return memoizeAllRemoteParticipants((function(memoizedRemoteParticipantFn){return remoteParticipants&&screenShareParticipant?remoteParticipants.filter((function(remoteParticipant){return remoteParticipant.userId!==screenShareParticipant.userId})).map((function(participant){var remoteVideoStream=participant.videoStream;return null==remoteVideoStream||!remoteVideoStream.isAvailable||null!=remoteVideoStream&&remoteVideoStream.renderElement||onCreateRemoteStreamView&&onCreateRemoteStreamView(participant.userId),memoizedRemoteParticipantFn(participant.userId,participant.isMuted,null==remoteVideoStream?void 0:remoteVideoStream.renderElement,participant.displayName)})):[]}))}),[remoteParticipants,onCreateRemoteStreamView,screenShareParticipant]);return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,verticalFill:!0,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{className:stackContainerStyle,children:Object(jsx_runtime.jsxs)(Stack.a,{grow:!0,className:Object(lib.G)({height:"100%",overflow:"auto"}),children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",className:aspectRatioBoxStyle,children:Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxContentStyle,children:sidePanelLocalParticipant})}),sidePanelRemoteParticipants]})}),Object(jsx_runtime.jsx)(Stack.a.Item,{className:screenShareContainerStyle,children:screenShareStreamComponent})]})};ScreenShare_ScreenShare.displayName="ScreenShare",ScreenShare_ScreenShare.__docgenInfo={description:"",methods:[],displayName:"ScreenShare",props:{screenShareParticipant:{required:!0,tsType:{name:"union",raw:"VideoGalleryRemoteParticipant | undefined",elements:[{name:"VideoGalleryRemoteParticipant"},{name:"undefined"}]},description:""},localParticipant:{required:!1,tsType:{name:"VideoGalleryLocalParticipant"},description:""},remoteParticipants:{required:!0,tsType:{name:"Array",elements:[{name:"VideoGalleryRemoteParticipant"}],raw:"VideoGalleryRemoteParticipant[]"},description:""},onCreateLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onCreateRemoteStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/ScreenShare.tsx"]={name:"ScreenShare",docgenInfo:ScreenShare_ScreenShare.__docgenInfo,path:"../react-composites/src/composites/CallComposite/ScreenShare.tsx"});var getCallId=function getCallId(state){var _state$call;return null===(_state$call=state.call)||void 0===_state$call?void 0:_state$call.id},getEndedCall=function getEndedCall(state){return state.endedCall},baseSelectors_getDeviceManager=function getDeviceManager(state){return state.devices},getIsPreviewCameraOn=function getIsPreviewCameraOn(state){return baseSelectors_isPreviewOn(state.devices)},getPage=function getPage(state){return state.page},getLocalMicrophoneEnabled=function getLocalMicrophoneEnabled(state){return state.isLocalPreviewMicrophoneEnabled},baseSelectors_getLocalVideoStreams=function getLocalVideoStreams(state){var _state$call4;return null===(_state$call4=state.call)||void 0===_state$call4?void 0:_state$call4.localVideoStreams},baseSelectors_isPreviewOn=function isPreviewOn(deviceManager){return deviceManager.unparentedViews.length>0&&void 0!==deviceManager.unparentedViews[0].view};function MediaGallery_slicedToArray(arr,i){return function MediaGallery_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MediaGallery_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MediaGallery_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MediaGallery_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MediaGallery_arrayLikeToArray(o,minLen)}(arr,i)||function MediaGallery_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MediaGallery_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var VideoGalleryStyles={root:{height:"100%",minHeight:"10rem"}},MediaGallery_localVideoViewOption={scalingMode:"Crop",isMirrored:!0},remoteVideoViewOption={scalingMode:"Crop"},MediaGallery_MediaGallery=function MediaGallery(props){var videoGalleryProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.u),_useState2=MediaGallery_slicedToArray(Object(react.useState)(!1),2),isButtonStatusSynced=_useState2[0],setIsButtonStatusSynced=_useState2[1],isPreviewCameraOn=hooks_useSelector_useSelector(getIsPreviewCameraOn),isScreenShareActive=Object(react.useMemo)((function(){return void 0!==videoGalleryProps.screenShareParticipant}),[videoGalleryProps]);Object(react.useEffect)((function(){!isPreviewCameraOn||props.isVideoStreamOn||isButtonStatusSynced||props.onStartLocalVideo(),setIsButtonStatusSynced(!0)}),[isButtonStatusSynced,isPreviewCameraOn,props]);var VideoGalleryMemoized=Object(react.useMemo)((function(){return Object(jsx_runtime.jsx)(react_components_src.u,Object.assign({},videoGalleryProps,{localVideoViewOption:MediaGallery_localVideoViewOption,remoteVideoViewOption:remoteVideoViewOption,styles:VideoGalleryStyles,layout:"floatingLocalVideo",onRenderAvatar:props.onRenderAvatar}))}),[props.onRenderAvatar,videoGalleryProps]);return isScreenShareActive?Object(jsx_runtime.jsx)(ScreenShare_ScreenShare,Object.assign({},videoGalleryProps)):VideoGalleryMemoized};MediaGallery_MediaGallery.__docgenInfo={description:"",methods:[],displayName:"MediaGallery",props:{isVideoStreamOn:{required:!1,tsType:{name:"boolean"},description:""},isMicrophoneChecked:{required:!1,tsType:{name:"boolean"},description:""},onStartLocalVideo:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: PlaceholderProps, defaultOnRender: (props: PlaceholderProps) => JSX.Element) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/MediaGallery.tsx"]={name:"MediaGallery",docgenInfo:MediaGallery_MediaGallery.__docgenInfo,path:"../react-composites/src/composites/CallComposite/MediaGallery.tsx"});__webpack_require__(201);var isInCall=function isInCall(callStatus){return!("None"===callStatus||"Disconnected"===callStatus)},complianceBannerSelector=es.a([function getIsTranscriptionActive(state){var _state$call5;return!(null===(_state$call5=state.call)||void 0===_state$call5||!_state$call5.transcription.isTranscriptionActive)},function getIsRecordingActive(state){var _state$call6;return!(null===(_state$call6=state.call)||void 0===_state$call6||!_state$call6.recording.isRecordingActive)}],(function(isTranscriptionActive,isRecordingActive){return{callTranscribeState:isTranscriptionActive,callRecordState:isRecordingActive}})),callStatusSelector=Object(es.a)([function getCallStatus(state){var _state$call$state,_state$call2;return null!==(_state$call$state=null===(_state$call2=state.call)||void 0===_state$call2?void 0:_state$call2.state)&&void 0!==_state$call$state?_state$call$state:"None"},function getIsScreenShareOn(state){var _state$call$isScreenS,_state$call3;return null!==(_state$call$isScreenS=null===(_state$call3=state.call)||void 0===_state$call3?void 0:_state$call3.isScreenSharingOn)&&void 0!==_state$call$isScreenS&&_state$call$isScreenS}],(function(callStatus,isScreenShareOn){return{callStatus:callStatus,isScreenShareOn:isScreenShareOn}})),mediaGallerySelector=es.a([baseSelectors_getLocalVideoStreams],(function(localVideoStreams){var _localVideoStreams$fi,_localVideoStreams$fi2;return{isVideoStreamOn:!(null==localVideoStreams||null===(_localVideoStreams$fi=localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})))||void 0===_localVideoStreams$fi||null===(_localVideoStreams$fi2=_localVideoStreams$fi.view)||void 0===_localVideoStreams$fi2||!_localVideoStreams$fi2.target)}})),groupCallLeaveButtonStyle={root:{border:"0.125rem",borderRadius:2,marginRight:".75rem",height:"2.1875rem",width:"6.5625rem"},flexContainer:{flexFlow:"row"}},groupCallLeaveButtonCompressedStyle={root:{width:"2rem",height:"3.75rem",border:"0.125rem",borderRadius:2,marginRight:"0.4375rem"},flexContainer:{flexFlow:"row"}};function CallControls_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CallControls_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CallControls_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CallControls_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var CallControls_CallControls=function CallControls(props){var callInvitationURL=props.callInvitationURL,compressedMode=props.compressedMode,onEndCallClick=props.onEndCallClick,microphoneButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.l),cameraButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.a),screenShareButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.q),participantsButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.p),participantsListProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.o);participantsButtonProps.participantListProps=participantsListProps;var optionsButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.m),hangUpButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.d),onHangUp=Object(react.useCallback)(CallControls_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,hangUpButtonProps.onHangUp();case 2:onEndCallClick();case 3:case"end":return _context.stop()}}),_callee)}))),[hangUpButtonProps,onEndCallClick]);return Object(jsx_runtime.jsxs)(react_components_src.b,{layout:"dockedBottom",children:[Object(jsx_runtime.jsx)(react_components_src.a,Object.assign({"data-ui-id":"call-composite-camera-button"},cameraButtonProps,{showLabel:!compressedMode})),Object(jsx_runtime.jsx)(react_components_src.l,Object.assign({"data-ui-id":"call-composite-microphone-button"},microphoneButtonProps,{showLabel:!compressedMode})),Object(jsx_runtime.jsx)(react_components_src.q,Object.assign({},screenShareButtonProps,{showLabel:!compressedMode})),props.showParticipantsControl&&Object(jsx_runtime.jsx)(react_components_src.p,Object.assign({"data-ui-id":"call-composite-participants-button"},participantsButtonProps,{showLabel:!compressedMode,callInvitationURL:callInvitationURL})),Object(jsx_runtime.jsx)(react_components_src.m,Object.assign({persistMenu:!0},optionsButtonProps,{showLabel:!compressedMode})),Object(jsx_runtime.jsx)(react_components_src.d,Object.assign({"data-ui-id":"call-composite-hangup-button"},hangUpButtonProps,{onHangUp:onHangUp,styles:compressedMode?groupCallLeaveButtonCompressedStyle:groupCallLeaveButtonStyle,showLabel:!compressedMode}))]})};CallControls_CallControls.displayName="CallControls",CallControls_CallControls.__docgenInfo={description:"",methods:[],displayName:"CallControls",props:{showParticipantsControl:{required:!0,tsType:{name:"boolean"},description:""},compressedMode:{required:!1,tsType:{name:"boolean"},description:""},callInvitationURL:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/CallControls.tsx"]={name:"CallControls",docgenInfo:CallControls_CallControls.__docgenInfo,path:"../react-composites/src/composites/CallComposite/CallControls.tsx"});var Link=__webpack_require__(1705),MessageBar=__webpack_require__(1707);function ComplianceBanner_slicedToArray(arr,i){return function ComplianceBanner_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ComplianceBanner_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ComplianceBanner_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ComplianceBanner_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ComplianceBanner_arrayLikeToArray(o,minLen)}(arr,i)||function ComplianceBanner_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ComplianceBanner_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ComplianceBanner_ComplianceBanner=function ComplianceBanner(props){var _useState2=ComplianceBanner_slicedToArray(Object(react.useState)(!1),2),previousCallTranscribeState=_useState2[0],setPreviousCallTranscribeState=_useState2[1],_useState4=ComplianceBanner_slicedToArray(Object(react.useState)(!1),2),previousCallRecordState=_useState4[0],setPreviousCallRecordState=_useState4[1],_useState6=ComplianceBanner_slicedToArray(Object(react.useState)(0),2),variant=_useState6[0],setVariant=_useState6[1],callTranscribeState=props.callTranscribeState,callRecordState=props.callRecordState;function PrivacyPolicy(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://privacy.microsoft.com/en-US/privacystatement#mainnoticetoendusersmodule",target:"_blank",underline:!0,children:"Privacy policy"})}function LearnMore(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://support.microsoft.com/en-us/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24",target:"_blank",underline:!0,children:"Learn more"})}return Object(react.useEffect)((function(){previousCallRecordState&&previousCallTranscribeState?setVariant(callRecordState&&!callTranscribeState?1:!callRecordState&&callTranscribeState?2:callRecordState||callTranscribeState?0:3):previousCallRecordState&&!previousCallTranscribeState?setVariant(callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?5:callRecordState||callTranscribeState?0:6):!previousCallRecordState&&previousCallTranscribeState?setVariant(callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?7:callRecordState||callTranscribeState?0:8):previousCallRecordState||previousCallTranscribeState||setVariant(callRecordState&&callTranscribeState?4:callRecordState&&!callTranscribeState?7:!callRecordState&&callTranscribeState?5:0),setPreviousCallTranscribeState(callTranscribeState),setPreviousCallRecordState(callRecordState)}),[callTranscribeState,callRecordState]),0===variant?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Object(jsx_runtime.jsx)(MessageBar.a,{onDismiss:function onDismiss(){setVariant(0)},dismissButtonAriaLabel:"Close",children:function getBannerMessage(variant){switch(variant){case 1:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has stopped."})," You are now only recording this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 2:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has stopped."})," You are now only transcribing this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 3:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription are being saved. "})," Recording and transcription have stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 4:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription have started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 5:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 6:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording is being saved."})," Recording has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 7:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 8:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription is being saved."})," Transcription has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}(variant)})};ComplianceBanner_ComplianceBanner.__docgenInfo={description:"",methods:[],displayName:"ComplianceBanner",props:{callTranscribeState:{required:!1,tsType:{name:"boolean"},description:""},callRecordState:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/ComplianceBanner.tsx"]={name:"ComplianceBanner",docgenInfo:ComplianceBanner_ComplianceBanner.__docgenInfo,path:"../react-composites/src/composites/CallComposite/ComplianceBanner.tsx"});var lobbySelector=es.a([baseSelectors_getLocalVideoStreams],(function(localVideoStreams){var _localVideoStream$vie,_localVideoStream$vie2,localVideoStream=null==localVideoStreams?void 0:localVideoStreams.find((function(i){return"Video"===i.mediaStreamType}));return{localParticipantVideoStream:{isAvailable:!!localVideoStream,isMirrored:null==localVideoStream||null===(_localVideoStream$vie=localVideoStream.view)||void 0===_localVideoStream$vie?void 0:_localVideoStream$vie.isMirrored,renderElement:null==localVideoStream||null===(_localVideoStream$vie2=localVideoStream.view)||void 0===_localVideoStream$vie2?void 0:_localVideoStream$vie2.target}}}));function LobbyControlBar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function LobbyControlBar_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){LobbyControlBar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){LobbyControlBar_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var LobbyControlBar_LobbyCallControlBar=function LobbyCallControlBar(props){var theme=Object(react_components_src.D)(),microphoneButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.l),cameraButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.a),optionsButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.m),hangUpButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.d),onHangUp=Object(react.useCallback)(LobbyControlBar_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,hangUpButtonProps.onHangUp();case 2:props.onEndCallClick();case 3:case"end":return _context.stop()}}),_callee)}))),[hangUpButtonProps,props]);return Object(jsx_runtime.jsxs)(react_components_src.b,{layout:"dockedBottom",styles:{root:{background:theme.palette.white,minHeight:"4.25rem",alignItems:"center"}},children:[Object(jsx_runtime.jsx)(react_components_src.a,Object.assign({showLabel:!0},cameraButtonProps)),Object(jsx_runtime.jsx)(react_components_src.l,Object.assign({showLabel:!0},microphoneButtonProps,{checked:props.isMicrophoneChecked})),Object(jsx_runtime.jsx)(react_components_src.m,Object.assign({showLabel:!0},optionsButtonProps)),Object(jsx_runtime.jsx)(react_components_src.d,{showLabel:!0,style:{borderRadius:"0.25rem",marginLeft:"0.25rem"},onHangUp:onHangUp})]})};function Lobby_slicedToArray(arr,i){return function Lobby_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function Lobby_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function Lobby_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Lobby_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Lobby_arrayLikeToArray(o,minLen)}(arr,i)||function Lobby_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lobby_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}LobbyControlBar_LobbyCallControlBar.displayName="LobbyCallControlBar",LobbyControlBar_LobbyCallControlBar.__docgenInfo={description:"",methods:[],displayName:"LobbyCallControlBar",props:{isMicrophoneChecked:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/LobbyControlBar.tsx"]={name:"LobbyCallControlBar",docgenInfo:LobbyControlBar_LobbyCallControlBar.__docgenInfo,path:"../react-composites/src/composites/CallComposite/LobbyControlBar.tsx"});var Lobby_onRenderEmptyPlaceholder=function onRenderEmptyPlaceholder(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},Lobby_Lobby=function Lobby(props){var palette=Object(react_components_src.D)().palette,_useState2=Lobby_slicedToArray(Object(react.useState)(!1),2),isButtonStatusSynced=_useState2[0],setIsButtonStatusSynced=_useState2[1],isPreviewCameraOn=hooks_useSelector_useSelector(getIsPreviewCameraOn),videoStream=props.localParticipantVideoStream,isVideoReady=videoStream.isAvailable,renderElement=videoStream.renderElement,callStateText="InLobby"===props.callState?"Waiting to be admitted":"Connecting...";return Object(react.useEffect)((function(){"InLobby"!==props.callState||!isPreviewCameraOn||isButtonStatusSynced||isVideoReady||renderElement||(props.onStartLocalVideo().catch((function(err){return console.log("Can not start video",err)})),setIsButtonStatusSynced(!0))}),[isButtonStatusSynced,isPreviewCameraOn,isVideoReady,props,renderElement]),Object(react.useEffect)((function(){videoStream&&isVideoReady&&props.onCreateLocalStreamView&&props.onCreateLocalStreamView(props.localVideoViewOption).catch((function(err){return console.log("Can not render video",err)}))}),[isVideoReady,videoStream,props,renderElement]),Object(jsx_runtime.jsxs)(react_components_src.v,{styles:{root:{height:"100%",width:"100%"},overlayContainer:{}},renderElement:renderElement?Object(jsx_runtime.jsx)(react_components_src.s,{videoStreamElement:renderElement}):void 0,onRenderPlaceholder:Lobby_onRenderEmptyPlaceholder,children:[Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",background:isVideoReady?"#201f1e":palette.neutralLight,opacity:.75}}),Object(jsx_runtime.jsx)("div",{style:{textAlign:"center",zIndex:0,width:"50%",height:"25%",overflow:"none",margin:"auto",position:"absolute",top:0,left:0,bottom:0,right:0},children:Object(jsx_runtime.jsxs)("p",{style:{fontSize:"1.75rem",color:isVideoReady?"white":palette.neutralPrimary},children:[" ",Object(jsx_runtime.jsx)("br",{})," ",callStateText]})}),Object(jsx_runtime.jsx)(LobbyControlBar_LobbyCallControlBar,{isMicrophoneChecked:props.isMicrophoneChecked,onEndCallClick:props.onEndCallClick})]})};Lobby_Lobby.displayName="Lobby",Lobby_Lobby.__docgenInfo={description:"",methods:[],displayName:"Lobby",props:{callState:{required:!0,tsType:{name:"string"},description:""},localParticipantVideoStream:{required:!0,tsType:{name:"VideoGalleryStream"},description:""},localVideoViewOption:{required:!1,tsType:{name:"VideoStreamOptions"},description:""},isCameraChecked:{required:!1,tsType:{name:"boolean"},description:""},isMicrophoneChecked:{required:!1,tsType:{name:"boolean"},description:""},onCreateLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onStartLocalVideo:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onEndCallClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/Lobby.tsx"]={name:"Lobby",docgenInfo:Lobby_Lobby.__docgenInfo,path:"../react-composites/src/composites/CallComposite/Lobby.tsx"});var MessageBar_types=__webpack_require__(56),MessageBarButton=__webpack_require__(1720),permissionsBannerContainerStyle={width:"100%"},permissionsBannerMessageBarStyle={root:{maxHeight:"5rem"},text:{flexGrow:"1",span:{whiteSpace:"normal"}}};function PermissionsBanner_slicedToArray(arr,i){return function PermissionsBanner_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function PermissionsBanner_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function PermissionsBanner_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return PermissionsBanner_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PermissionsBanner_arrayLikeToArray(o,minLen)}(arr,i)||function PermissionsBanner_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function PermissionsBanner_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var PermissionsBanner_PermissionsBanner=function PermissionsBanner(props){var cameraPermissionGranted=props.cameraPermissionGranted,microphonePermissionGranted=props.microphonePermissionGranted,_useState2=PermissionsBanner_slicedToArray(Object(react.useState)(!1),2),dismissedCameraBanner=_useState2[0],setDismissedCameraBanner=_useState2[1],_useState4=PermissionsBanner_slicedToArray(Object(react.useState)(!1),2),dismissedMicrophoneBanner=_useState4[0],setDismissedMicrophoneBanner=_useState4[1],bannerMessage=Object(react.useMemo)((function(){return function getPermissionsBannerMessage(cameraPermissionGranted,microphonePermissionGranted,dismissedCameraBanner,dismissedMicrophoneBanner){var showCameraMessage=void 0!==cameraPermissionGranted&&!cameraPermissionGranted&&!dismissedCameraBanner,showMicrophoneMessage=void 0!==microphonePermissionGranted&&!microphonePermissionGranted&&!dismissedMicrophoneBanner;return showCameraMessage&&showMicrophoneMessage?"Camera and microphone use is blocked by your browser.":showCameraMessage?"Camera use is blocked by your browser.":showMicrophoneMessage?"Microphone use is blocked by your browser.":""}(cameraPermissionGranted,microphonePermissionGranted,dismissedCameraBanner,dismissedMicrophoneBanner)}),[cameraPermissionGranted,microphonePermissionGranted,dismissedCameraBanner,dismissedMicrophoneBanner]),dismissBanner=Object(react.useCallback)((function(){void 0===cameraPermissionGranted||cameraPermissionGranted||setDismissedCameraBanner(!0),void 0===microphonePermissionGranted||microphonePermissionGranted||setDismissedMicrophoneBanner(!0)}),[cameraPermissionGranted,microphonePermissionGranted]);return""===bannerMessage?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Object(jsx_runtime.jsxs)(MessageBar.a,{styles:permissionsBannerMessageBarStyle,messageBarType:MessageBar_types.a.warning,isMultiline:!1,actions:Object(jsx_runtime.jsx)(MessageBarButton.a,{onClick:dismissBanner,children:"Dismiss"}),children:[Object(jsx_runtime.jsx)("b",{children:bannerMessage}),"","Grant permission by clicking the lock in the address bar and selecting 'Allow'."]})};PermissionsBanner_PermissionsBanner.__docgenInfo={description:"Shows a banner notifying user if camera or microphone permission is denied and also instructions on how to allow the\nnecessary permissions. If either camera or microphone permission is true or undefined then no banner for those items\nare show. This banner will not show anything if the permission (undefined) has been requested but user has not\nresponded to it. Sample app/composite will always request permission so the case of permission not requested is\nassumed to not happen by this component. If the banner was dismissed, it will be dismissed for the current state of\nthe props and stay dismissed even if permission change after dismissal.\n\n@param props {@link PermissionsBannerProps}",methods:[],displayName:"PermissionsBanner",props:{cameraPermissionGranted:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"If cameraPermission is true or undefined, no banner is shown for camera."},microphonePermissionGranted:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:"If microphonePermission is true or undefined, no banner is shown for microphone."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/common/PermissionsBanner.tsx"]={name:"PermissionsBanner",docgenInfo:PermissionsBanner_PermissionsBanner.__docgenInfo,path:"../react-composites/src/composites/common/PermissionsBanner.tsx"});var devicePermissionSelector=es.a([baseSelectors_getDeviceManager],(function(deviceManager){return{video:deviceManager.deviceAccess?deviceManager.deviceAccess.video:void 0,audio:deviceManager.deviceAccess?deviceManager.deviceAccess.audio:void 0}})),ContextualMenu=__webpack_require__(1696),Modal=__webpack_require__(1700),Label=__webpack_require__(1710),DefaultButton=__webpack_require__(430),FocusTrapCallout=__webpack_require__(1681),ShareScreenStop20Filled=__webpack_require__(1679),ShareScreenStart20Filled=__webpack_require__(1669),screenSharePopupModalStackStyles={width:"18rem",height:"11.4375rem",paddingBottom:"0.5rem"},screenSharePopupModalLabelStyles={lineHeight:"1rem",fontSize:"0.75rem",fontWeight:"normal"};function ScreenSharePopup_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function ScreenSharePopup_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){ScreenSharePopup_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){ScreenSharePopup_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function ScreenSharePopup_slicedToArray(arr,i){return function ScreenSharePopup_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ScreenSharePopup_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ScreenSharePopup_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ScreenSharePopup_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ScreenSharePopup_arrayLikeToArray(o,minLen)}(arr,i)||function ScreenSharePopup_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ScreenSharePopup_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ScreenSharePopup_onRenderStopScreenShareIcon=function onRenderStopScreenShareIcon(){return Object(jsx_runtime.jsx)(ShareScreenStop20Filled.a,{primaryFill:"currentColor"})};ScreenSharePopup_onRenderStopScreenShareIcon.displayName="onRenderStopScreenShareIcon";var DRAG_OPTIONS={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:ContextualMenu.a,keepInBounds:!0},ScreenSharePopup_ScreenSharePopup=function ScreenSharePopup(props){var hostId=props.hostId,onStopScreenShare=props.onStopScreenShare,_useState2=ScreenSharePopup_slicedToArray(Object(react.useState)(!1),2),stoppingInProgress=_useState2[0],setStoppingInProgress=_useState2[1],theme=Object(react_components_src.D)(),screenSharePopupModalStylesThemed=Object(react.useMemo)((function(){return function getScreenSharePopupModalStyles(theme){return{root:{width:"100%",height:"100%"},main:{boxShadow:theme.effects.elevation8,borderRadius:theme.effects.roundedCorner4,background:theme.palette.neutralLighterAlt}}}(theme)}),[theme]),screenSharePopupModalButtonStylesThemed=Object(react.useMemo)((function(){return function getScreenSharePopupModalButtonStyles(theme){return{root:{padding:"0.375rem 0.75rem",border:"0rem",boxShadow:theme.effects.elevation4,borderRadius:theme.effects.roundedCorner4,svg:{verticalAlign:"text-top"}}}}(theme)}),[theme]),isMounted=Object(react.useRef)(!1);Object(react.useEffect)((function(){return isMounted.current=!0,function(){isMounted.current=!1}}),[]);var onStopScreenShareClicked=Object(react.useCallback)(ScreenSharePopup_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setStoppingInProgress(!0),_context.next=3,onStopScreenShare();case 3:isMounted.current&&setStoppingInProgress(!1);case 4:case"end":return _context.stop()}}),_callee)}))),[onStopScreenShare]);return Object(jsx_runtime.jsxs)(Modal.a,{layerProps:hostId?{hostId:hostId}:void 0,isOpen:!0,isModeless:!0,dragOptions:DRAG_OPTIONS,styles:screenSharePopupModalStylesThemed,children:[Object(jsx_runtime.jsxs)(Stack.a,{style:screenSharePopupModalStackStyles,horizontalAlign:"center",children:[Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,verticalAlign:"center",horizontalAlign:"center",children:[Object(jsx_runtime.jsx)(ShareScreenStart20Filled.a,{primaryFill:"disabled"}),Object(jsx_runtime.jsx)(Label.a,{style:screenSharePopupModalLabelStyles,children:"You're presenting your screen."})]}),Object(jsx_runtime.jsx)(DefaultButton.a,{styles:screenSharePopupModalButtonStylesThemed,onRenderIcon:ScreenSharePopup_onRenderStopScreenShareIcon,onClick:onStopScreenShareClicked,text:"Stop presenting",disabled:stoppingInProgress})]}),Object(jsx_runtime.jsx)(FocusTrapCallout.a,{focusTrapProps:{isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1}})]})};function CallScreen_slicedToArray(arr,i){return function CallScreen_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallScreen_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CallScreen_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallScreen_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallScreen_arrayLikeToArray(o,minLen)}(arr,i)||function CallScreen_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallScreen_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}ScreenSharePopup_ScreenSharePopup.displayName="ScreenSharePopup",ScreenSharePopup_ScreenSharePopup.__docgenInfo={description:"",methods:[],displayName:"ScreenSharePopup",props:{onStopScreenShare:{required:!0,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},hostId:{required:!1,tsType:{name:"string"},description:"ID of the react element to host the screenshare modal window in.\nIf this is not supplied the modal dialog is hosted in a fixed\nposition element rendered at the end of the document.\n\n{@link https://docs.microsoft.com/en-us/javascript/api/react-internal/ilayerprops?view=office-ui-fabric-react-latest#hostId}"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/ScreenSharePopup.tsx"]={name:"ScreenSharePopup",docgenInfo:ScreenSharePopup_ScreenSharePopup.__docgenInfo,path:"../react-composites/src/composites/CallComposite/ScreenSharePopup.tsx"});var CallScreen_CallScreen=function CallScreen(props){var callInvitationURL=props.callInvitationURL,endCallHandler=props.endCallHandler,callErrorHandler=props.callErrorHandler,onRenderAvatar=props.onRenderAvatar,_useState2=CallScreen_slicedToArray(Object(react.useState)(!1),2),joinedCall=_useState2[0],setJoinedCall=_useState2[1],_useSelector=hooks_useSelector_useSelector(callStatusSelector),callStatus=_useSelector.callStatus,isScreenShareOn=_useSelector.isScreenShareOn,callId=hooks_useSelector_useSelector(getCallId),currentCallId=Object(react.useRef)("");callId&&(currentCallId.current=callId);var mediaGalleryProps=hooks_useSelector_useSelector(mediaGallerySelector),mediaGalleryHandlers=CallComposite_hooks_useHandlers_useHandlers(),complianceBannerProps=hooks_useSelector_useSelector(complianceBannerSelector),lobbyProps=hooks_useSelector_useSelector(lobbySelector),lobbyHandlers=CallComposite_hooks_useHandlers_useHandlers(),devicePermissions=hooks_useSelector_useSelector(devicePermissionSelector),adapter=CallAdapterProvider_useAdapter();Object(react.useEffect)((function(){joinedCall||adapter.joinCall(),setJoinedCall(!0)}),[adapter,joinedCall]);var endedCall=hooks_useSelector_useSelector(getEndedCall);if(Object(react.useEffect)((function(){var _endedCall$callEndRea,_endedCall$callEndRea2,_endedCall$callEndRea3;endedCall&&currentCallId.current===(null==endedCall?void 0:endedCall.id)&&(0===(null==endedCall||null===(_endedCall$callEndRea=endedCall.callEndReason)||void 0===_endedCall$callEndRea?void 0:_endedCall$callEndRea.code)&&5854===(null==endedCall?void 0:endedCall.callEndReason.subCode)?callErrorHandler("errorJoiningTeamsMeeting"):0===(null==endedCall||null===(_endedCall$callEndRea2=endedCall.callEndReason)||void 0===_endedCall$callEndRea2?void 0:_endedCall$callEndRea2.code)&&5300===(null==endedCall||null===(_endedCall$callEndRea3=endedCall.callEndReason)||void 0===_endedCall$callEndRea3?void 0:_endedCall$callEndRea3.subCode)&&callErrorHandler("removed"))}),[adapter,callErrorHandler,endedCall]),"isTeamsCall"in adapter){var _azureAdapter$getStat,azureAdapter=adapter,callState=null===(_azureAdapter$getStat=azureAdapter.getState().call)||void 0===_azureAdapter$getStat?void 0:_azureAdapter$getStat.state;if(azureAdapter.isTeamsCall()&&void 0!==callState&&azureAdapter.getState().call&&["Connecting","Ringing","InLobby"].includes(callState))return Object(jsx_runtime.jsx)(Lobby_Lobby,Object.assign({callState:callState},lobbyProps,lobbyHandlers,{onEndCallClick:endCallHandler,isMicrophoneChecked:azureAdapter.getState().isLocalPreviewMicrophoneEnabled,localVideoViewOption:{scalingMode:"Crop",isMirrored:!0}}))}return Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:containerStyles,grow:!0,children:isInCall(null!=callStatus?callStatus:"None")?Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(Stack.a.Item,{style:{width:"100%"},children:Object(jsx_runtime.jsx)(ComplianceBanner_ComplianceBanner,Object.assign({},complianceBannerProps))}),Object(jsx_runtime.jsx)(Stack.a.Item,{style:permissionsBannerContainerStyle,children:Object(jsx_runtime.jsx)(PermissionsBanner_PermissionsBanner,{microphonePermissionGranted:devicePermissions.audio,cameraPermissionGranted:devicePermissions.video})}),Object(jsx_runtime.jsx)(Stack.a.Item,{styles:subContainerStyles,grow:!0,children:"Connected"===callStatus&&Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(Stack.a,{styles:containerStyles,grow:!0,children:Object(jsx_runtime.jsx)(Stack.a.Item,{id:"UILibraryMediaGallery",grow:!0,styles:mediaGalleryContainerStyles,children:Object(jsx_runtime.jsx)(MediaGallery_MediaGallery,Object.assign({},mediaGalleryProps,mediaGalleryHandlers,{onRenderAvatar:onRenderAvatar}))})}),isScreenShareOn?Object(jsx_runtime.jsx)(ScreenSharePopup_ScreenSharePopup,{hostId:"UILibraryMediaGallery",onStopScreenShare:function onStopScreenShare(){return adapter.stopScreenShare()}}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})]})}),props.showCallControls&&Object(jsx_runtime.jsx)(Stack.a.Item,{styles:callControlsStyles,children:Object(jsx_runtime.jsx)(Stack.a,{className:callControlsContainer,children:Object(jsx_runtime.jsx)(CallControls_CallControls,{showParticipantsControl:!0,onEndCallClick:endCallHandler,callInvitationURL:callInvitationURL})})})]}):Object(jsx_runtime.jsx)(Spinner.a,{label:"Initializing call client...",ariaLive:"assertive",labelPosition:"top"})})};CallScreen_CallScreen.displayName="CallScreen",CallScreen_CallScreen.__docgenInfo={description:"",methods:[],displayName:"CallScreen",props:{callInvitationURL:{required:!1,tsType:{name:"string"},description:""},showCallControls:{required:!0,tsType:{name:"boolean"},description:""},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: PlaceholderProps, defaultOnRender: (props: PlaceholderProps) => JSX.Element) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/CallScreen.tsx"]={name:"CallScreen",docgenInfo:CallScreen_CallScreen.__docgenInfo,path:"../react-composites/src/composites/CallComposite/CallScreen.tsx"});var Dropdown=__webpack_require__(1695),mainStackTokens={childrenGap:"1rem"},dropDownStyles=function dropDownStyles(theme){return{caretDownWrapper:{height:"2.5rem",lineHeight:"2.5rem"},dropdownItem:{fontSize:"0.875rem",height:"2.5rem",background:theme.palette.neutralQuaternaryAlt},dropdown:{height:"2.5rem",width:"100%",svg:{verticalAlign:"top"}},title:{fontSize:"0.875rem",height:"2.5rem",lineHeight:"2.3125rem"},label:{fontWeight:600,fontSize:"0.875rem"},errorMessage:{fontSize:"0.875rem"}}},localSettingsContainer=Object(lib.G)({width:"18.75rem",minWidth:"12.5rem",maxHeight:"19.125rem",marginTop:".313rem"}),dropDownTitleIconStyles=Object(lib.G)({overflow:"hidden",textOverflow:"ellipsis",minWidth:"0",maxWidth:"100%",overflowWrap:"break-word",margin:".063rem"}),optionIconStyles=Object(lib.G)({marginRight:"8px",verticalAlign:"text-top"}),Video20Filled=__webpack_require__(1673),MicOn20Filled=__webpack_require__(1676),Speaker220Filled=__webpack_require__(1682);function LocalDeviceSettings_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function LocalDeviceSettings_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return LocalDeviceSettings_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return LocalDeviceSettings_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function LocalDeviceSettings_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var getDropDownList=function getDropDownList(list){var _step,noDuplicates=new Map,_iterator=LocalDeviceSettings_createForOfIteratorHelper(list);try{for(_iterator.s();!(_step=_iterator.n()).done;){var item=_step.value;noDuplicates.set(item.id,item)}}catch(err){_iterator.e(err)}finally{_iterator.f()}var _step2,dropdownList=[],_iterator2=LocalDeviceSettings_createForOfIteratorHelper(noDuplicates.values());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _item=_step2.value;dropdownList.push({key:_item.id,text:""===_item.name?_item.deviceType:_item.name})}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}return dropdownList},_onRenderTitle=function onRenderTitle(iconType,props){var icon=props&&function getOptionIcon(type){return"Camera"===type?Object(jsx_runtime.jsx)(Video20Filled.a,{primaryFill:"currentColor",className:optionIconStyles},"videoIconKey"):"Microphone"===type?Object(jsx_runtime.jsx)(MicOn20Filled.a,{primaryFill:"currentColor",className:optionIconStyles},"microphoneIconKey"):"Speaker"===type?Object(jsx_runtime.jsx)(Speaker220Filled.a,{primaryFill:"currentColor",className:optionIconStyles},"speakerIconKey"):void 0}(iconType);return props?Object(jsx_runtime.jsxs)("div",{className:dropDownTitleIconStyles,children:[icon,Object(jsx_runtime.jsx)("span",{children:props[0].text})]}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},LocalDeviceSettings_localVideoViewOption={scalingMode:"Crop",isMirrored:!0},LocalDeviceSettings_LocalDeviceSettings=function LocalDeviceSettings(props){var _props$cameras$,_props$microphones$,_props$speakers$,theme=Object(react_components_src.D)();return Object(jsx_runtime.jsxs)(Stack.a,{"data-ui-id":"call-composite-device-settings",className:localSettingsContainer,tokens:mainStackTokens,children:[Object(jsx_runtime.jsx)(Dropdown.a,{"data-ui-id":"call-composite-local-camera-settings",label:"Camera",placeholder:"Select an option",options:props.cameraPermissionGranted?getDropDownList(props.cameras):[{key:"deniedOrUnknown",text:""}],styles:dropDownStyles(theme),disabled:!props.cameraPermissionGranted,errorMessage:void 0===props.cameraPermissionGranted||props.cameraPermissionGranted?void 0:"Your browser is blocking access to your camera.",defaultSelectedKey:props.cameraPermissionGranted?props.selectedCamera?props.selectedCamera.id:props.cameras?null===(_props$cameras$=props.cameras[0])||void 0===_props$cameras$?void 0:_props$cameras$.id:"":"deniedOrUnknown",onChange:function onChange(event,option,index){props.onSelectCamera(props.cameras[null!=index?index:0],LocalDeviceSettings_localVideoViewOption)},onRenderTitle:function onRenderTitle(props){return _onRenderTitle("Camera",props)}}),Object(jsx_runtime.jsx)(Dropdown.a,{label:"Sound",placeholder:"Select an option",styles:dropDownStyles(theme),disabled:!props.microphonePermissionGranted,errorMessage:void 0===props.microphonePermissionGranted||props.microphonePermissionGranted?void 0:"Your browser is blocking access to your microphone.",options:props.microphonePermissionGranted?getDropDownList(props.microphones):[{key:"deniedOrUnknown",text:""}],defaultSelectedKey:props.microphonePermissionGranted?props.selectedMicrophone?props.selectedMicrophone.id:props.microphones?null===(_props$microphones$=props.microphones[0])||void 0===_props$microphones$?void 0:_props$microphones$.id:"":"deniedOrUnknown",onChange:function onChange(event,option,index){props.onSelectMicrophone(props.microphones[null!=index?index:0])},onRenderTitle:function onRenderTitle(props){return _onRenderTitle("Microphone",props)}}),Object(jsx_runtime.jsx)(Dropdown.a,{placeholder:"Select an option",styles:dropDownStyles(theme),disabled:0===props.speakers.length,options:getDropDownList(props.speakers),defaultSelectedKey:props.selectedSpeaker?props.selectedSpeaker.id:props.speakers?null===(_props$speakers$=props.speakers[0])||void 0===_props$speakers$?void 0:_props$speakers$.id:"",onChange:function onChange(event,option,index){props.onSelectSpeaker(props.speakers[null!=index?index:0])},onRenderTitle:function onRenderTitle(props){return _onRenderTitle("Speaker",props)}})]})};LocalDeviceSettings_LocalDeviceSettings.displayName="LocalDeviceSettings",LocalDeviceSettings_LocalDeviceSettings.__docgenInfo={description:"",methods:[],displayName:"LocalDeviceSettings",props:{cameras:{required:!0,tsType:{name:"Array",elements:[{name:"VideoDeviceInfo"}],raw:"VideoDeviceInfo[]"},description:""},microphones:{required:!0,tsType:{name:"Array",elements:[{name:"AudioDeviceInfo"}],raw:"AudioDeviceInfo[]"},description:""},speakers:{required:!0,tsType:{name:"Array",elements:[{name:"AudioDeviceInfo"}],raw:"AudioDeviceInfo[]"},description:""},selectedCamera:{required:!1,tsType:{name:"VideoDeviceInfo"},description:""},selectedMicrophone:{required:!1,tsType:{name:"AudioDeviceInfo"},description:""},selectedSpeaker:{required:!1,tsType:{name:"AudioDeviceInfo"},description:""},microphonePermissionGranted:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},cameraPermissionGranted:{required:!0,tsType:{name:"union",raw:"boolean | undefined",elements:[{name:"boolean"},{name:"undefined"}]},description:""},onSelectCamera:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: VideoDeviceInfo, options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"VideoDeviceInfo"}},{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onSelectMicrophone:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: AudioDeviceInfo) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"AudioDeviceInfo"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onSelectSpeaker:{required:!0,tsType:{name:"signature",type:"function",raw:"(device: AudioDeviceInfo) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"AudioDeviceInfo"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/LocalDeviceSettings.tsx"]={name:"LocalDeviceSettings",docgenInfo:LocalDeviceSettings_LocalDeviceSettings.__docgenInfo,path:"../react-composites/src/composites/CallComposite/LocalDeviceSettings.tsx"});var PrimaryButton=__webpack_require__(1666),videoCameraIconStyle=Object(lib.G)({marginRight:"0.375rem",fontSize:"1.375rem"}),buttonStyle=Object(lib.G)({fontWeight:600,fontSize:"0.875rem",height:"2.75rem",width:"100%",marginTop:"1.125rem",maxWidth:"18.75rem",minWidth:"12.5rem"}),StartCallButton_StartCallButton=function StartCallButton(props){var isDisabled=props.isDisabled,onClickHandler=props.onClickHandler;return Object(jsx_runtime.jsxs)(PrimaryButton.a,{"data-ui-id":"call-composite-start-call-button",disabled:isDisabled,className:buttonStyle,onClick:onClickHandler,children:[Object(jsx_runtime.jsx)(Video20Filled.a,{primaryFill:"currentColor",className:videoCameraIconStyle}),"Start call"]})};StartCallButton_StartCallButton.displayName="StartCallButton",StartCallButton_StartCallButton.__docgenInfo={description:"",methods:[],displayName:"StartCallButton",props:{onClickHandler:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},isDisabled:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/StartCallButton.tsx"]={name:"StartCallButton",docgenInfo:StartCallButton_StartCallButton.__docgenInfo,path:"../react-composites/src/composites/CallComposite/StartCallButton.tsx"});var titleContainerStyle=Object(lib.G)({fontSize:"1.25rem",lineHeight:"1.75rem",fontWeight:600,marginBottom:"1.563rem"}),VideoOff20Filled=__webpack_require__(1674),Text=__webpack_require__(1711),localPreviewContainerStyle=Object(lib.G)({borderRadius:".25rem",width:"25rem",height:"18.75rem"}),cameraOffLabelStyle=Object(lib.G)({fontFamily:"Segoe UI Regular",fontSize:"0.625rem"}),localPreviewTileStyle={root:{borderRadius:".25rem"}},localPreviewSelector=es.a([baseSelectors_getDeviceManager],(function(deviceManager){var view=deviceManager.unparentedViews.length>0&&deviceManager.unparentedViews[0].view;return{videoStreamElement:view?view.target:null}}));function LocalPreview_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function LocalPreview_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){LocalPreview_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){LocalPreview_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var LocalPreview_LocalPreview=function LocalPreview(){var cameraButtonProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.a),localPreviewProps=hooks_useSelector_useSelector(localPreviewSelector),_useSelector=hooks_useSelector_useSelector(devicePermissionSelector),microphonePermissionGranted=_useSelector.audio,cameraPermissionGranted=_useSelector.video,isLocalMicrophoneEnabled=hooks_useSelector_useSelector(getLocalMicrophoneEnabled),adapter=CallAdapterProvider_useAdapter(),onToggleMic=Object(react.useCallback)(LocalPreview_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:isLocalMicrophoneEnabled?adapter.mute():adapter.unmute();case 1:case"end":return _context.stop()}}),_callee)}))),[adapter,isLocalMicrophoneEnabled]),theme=Object(react_components_src.D)(),onRenderPlaceholder=Object(react.useCallback)((function(){return Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.G)({width:"100%",height:"100%"}),verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(VideoOff20Filled.a,{className:Object(lib.G)(cameraOffLabelStyle,{color:theme.palette.neutralTertiary})})}),Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.G)(cameraOffLabelStyle,{color:theme.palette.neutralSecondary}),children:"Your camera is turned off."})})]})}),[theme]);return Object(jsx_runtime.jsx)(Stack.a,{"data-ui-id":"call-composite-local-preview",className:localPreviewContainerStyle,children:Object(jsx_runtime.jsx)(react_components_src.v,{styles:localPreviewTileStyle,renderElement:null!=localPreviewProps&&localPreviewProps.videoStreamElement?Object(jsx_runtime.jsx)(react_components_src.s,{videoStreamElement:localPreviewProps.videoStreamElement}):void 0,onRenderPlaceholder:onRenderPlaceholder,children:Object(jsx_runtime.jsxs)(react_components_src.b,{layout:"floatingBottom",children:[Object(jsx_runtime.jsx)(react_components_src.a,Object.assign({"data-ui-id":"call-composite-local-device-settings-camera-button"},cameraButtonProps,{showLabel:!0,disabled:!cameraPermissionGranted})),Object(jsx_runtime.jsx)(react_components_src.l,{"data-ui-id":"call-composite-local-device-settings-microphone-button",checked:isLocalMicrophoneEnabled,onToggleMicrophone:onToggleMic,disabled:!microphonePermissionGranted,showLabel:!0})]})})})};LocalPreview_LocalPreview.displayName="LocalPreview",LocalPreview_LocalPreview.__docgenInfo={description:"",methods:[],displayName:"LocalPreview"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/LocalPreview.tsx"]={name:"LocalPreview",docgenInfo:LocalPreview_LocalPreview.__docgenInfo,path:"../react-composites/src/composites/CallComposite/LocalPreview.tsx"});var configurationStackTokens={childrenGap:"3rem"},configurationContainer=Object(lib.G)({height:"calc(100% - 3rem)"}),ConfigurationScreen_ConfigurationScreen=function ConfigurationScreen(props){var startCallHandler=props.startCallHandler,options=useAdaptedSelector_useAdaptedSelector(usePropsFor_getSelector(react_components_src.m)),localDeviceSettingsHandlers=CallComposite_hooks_useHandlers_useHandlers(),_useSelector=hooks_useSelector_useSelector(devicePermissionSelector),cameraPermissionGranted=_useSelector.video,microphonePermissionGranted=_useSelector.audio;return Object(jsx_runtime.jsx)(Stack.a,{verticalAlign:"center",className:configurationContainer,children:Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,wrap:!0,horizontalAlign:"center",verticalAlign:"center",tokens:configurationStackTokens,children:[Object(jsx_runtime.jsx)(LocalPreview_LocalPreview,{}),Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{className:titleContainerStyle,children:"Start a call"}),Object(jsx_runtime.jsx)(LocalDeviceSettings_LocalDeviceSettings,Object.assign({},options,localDeviceSettingsHandlers,{cameraPermissionGranted:cameraPermissionGranted,microphonePermissionGranted:microphonePermissionGranted})),Object(jsx_runtime.jsx)("div",{children:Object(jsx_runtime.jsx)(StartCallButton_StartCallButton,{onClickHandler:startCallHandler,isDisabled:!microphonePermissionGranted})})]})]})})};ConfigurationScreen_ConfigurationScreen.displayName="ConfigurationScreen",ConfigurationScreen_ConfigurationScreen.__docgenInfo={description:"",methods:[],displayName:"ConfigurationScreen"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/ConfigurationScreen.tsx"]={name:"ConfigurationScreen",docgenInfo:ConfigurationScreen_ConfigurationScreen.__docgenInfo,path:"../react-composites/src/composites/CallComposite/ConfigurationScreen.tsx"});var Error_styles_mainStackTokens={childrenGap:"0.25rem"},buttonsStackTokens={childrenGap:"0.75rem"},upperStackTokens={childrenGap:"1.5rem"},endCallContainerStyle=Object(lib.G)({width:"20.625rem",position:"absolute",top:"0",bottom:"0",left:"0",right:"0",margin:"auto"}),endCallTitleStyle=Object(lib.G)({fontSize:"1.375rem",fontWeight:600}),Error_styles_buttonStyle=Object(lib.G)({fontWeight:600,height:"2.5rem",width:"9.875rem",fontSize:"0.875rem",padding:0}),Error_styles_videoCameraIconStyle=Object(lib.G)({marginRight:"0.375rem",fontSize:"1.375rem"}),bottomStackFooterStyle=Object(lib.G)({fontSize:"0.875 rem"});function Error_Error(props){var _props$title,title=null!==(_props$title=props.title)&&void 0!==_props$title?_props$title:"Error joining the Call";return Object(jsx_runtime.jsx)(Stack.a,{verticalAlign:"center",tokens:Error_styles_mainStackTokens,className:endCallContainerStyle,children:Object(jsx_runtime.jsxs)(Stack.a,{tokens:upperStackTokens,children:[Object(jsx_runtime.jsx)("div",{className:endCallTitleStyle,children:title}),Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,tokens:buttonsStackTokens,children:Object(jsx_runtime.jsxs)(PrimaryButton.a,{className:Error_styles_buttonStyle,onClick:props.rejoinHandler,children:[Object(jsx_runtime.jsx)(Video20Filled.a,{primaryFill:"currentColor",className:Error_styles_videoCameraIconStyle}),"Retry Call"]})}),Object(jsx_runtime.jsx)("div",{className:bottomStackFooterStyle,children:props.reason?props.reason:Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Common reasons for this error:",Object(jsx_runtime.jsxs)("ul",{children:[Object(jsx_runtime.jsx)("li",{children:"Incorrect Teams Meeting URL"}),Object(jsx_runtime.jsx)("li",{children:"Incorrect Group Call ID"})]})]})})]})})}function Call_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function Call_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){Call_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){Call_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}Error_Error.displayName="Error",Error_Error.__docgenInfo={description:"",methods:[],displayName:"Error",props:{title:{required:!1,tsType:{name:"string"},description:""},reason:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/Error.tsx"]={name:"Error",docgenInfo:Error_Error.__docgenInfo,path:"../react-composites/src/composites/CallComposite/Error.tsx"});var Call_MainScreen=function MainScreen(_ref){var showCallControls=_ref.showCallControls,callInvitationURL=_ref.callInvitationURL,onRenderAvatar=_ref.onRenderAvatar,page=hooks_useSelector_useSelector(getPage),adapter=CallAdapterProvider_useAdapter();switch(page){case"configuration":return Object(jsx_runtime.jsx)(ConfigurationScreen_ConfigurationScreen,{startCallHandler:function startCallHandler(){return adapter.setPage("call")}});case"error":return Object(jsx_runtime.jsx)(Error_Error,{rejoinHandler:function rejoinHandler(){return adapter.setPage("configuration")}});case"errorJoiningTeamsMeeting":return Object(jsx_runtime.jsx)(Error_Error,{rejoinHandler:function rejoinHandler(){return adapter.setPage("configuration")},title:"Error joining Teams Meeting",reason:"Access to the Teams meeting was denied."});case"removed":return Object(jsx_runtime.jsx)(Error_Error,{rejoinHandler:function rejoinHandler(){return adapter.setPage("configuration")},title:"Oops! You are no longer a participant of the call.",reason:"Access to the meeting has been stopped"});default:return Object(jsx_runtime.jsx)(CallScreen_CallScreen,{showCallControls:showCallControls,endCallHandler:Call_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:adapter.setPage("configuration");case 1:case"end":return _context.stop()}}),_callee)}))),callErrorHandler:function callErrorHandler(customPage){customPage?adapter.setPage(customPage):adapter.setPage("error")},onRenderAvatar:onRenderAvatar,callInvitationURL:callInvitationURL})}},Call_Call=function Call(props){return Object(jsx_runtime.jsx)(Call_CallCompositeInternal,Object.assign({},props,{showCallControls:!0}))};Call_Call.displayName="Call";var Call_CallCompositeInternal=function CallCompositeInternal(props){var adapter=props.adapter,callInvitationURL=props.callInvitationURL,fluentTheme=props.fluentTheme,rtl=props.rtl,locale=props.locale,identifiers=props.identifiers;Object(react.useEffect)((function(){Call_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,adapter.askDevicePermission({video:!0,audio:!0});case 2:adapter.queryCameras(),adapter.queryMicrophones(),adapter.querySpeakers();case 5:case"end":return _context2.stop()}}),_callee2)})))()}),[adapter]);var callElement=Object(jsx_runtime.jsx)(react_components_src.f,{fluentTheme:fluentTheme,rtl:rtl,children:Object(jsx_runtime.jsx)(react_components_src.h,{identifiers:identifiers,children:Object(jsx_runtime.jsx)(CallAdapterProvider_CallAdapterProvider,{adapter:adapter,children:Object(jsx_runtime.jsx)(Call_MainScreen,{showCallControls:props.showCallControls,onRenderAvatar:props.onRenderAvatar,callInvitationURL:callInvitationURL})})})});return locale?Object(react_components_src.i)({locale:locale,children:callElement}):callElement};Call_Call.__docgenInfo={description:"",methods:[],displayName:"Call",props:{adapter:{required:!0,tsType:{name:"CallAdapter"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Fluent theme for the composite.\n\n@defaultValue light theme"},rtl:{required:!1,tsType:{name:"boolean"},description:"Whether composite is displayed right-to-left.\n\n@defaultValue false"},locale:{required:!1,tsType:{name:"Locale"},description:"Locale for the composite.\n\n@defaultValue English (US)"},callInvitationURL:{required:!1,tsType:{name:"string"},description:""},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: PlaceholderProps, defaultOnRender: (props: PlaceholderProps) => JSX.Element) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:""},identifiers:{required:!1,tsType:{name:"Identifiers"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/Call.tsx"]={name:"Call",docgenInfo:Call_Call.__docgenInfo,path:"../react-composites/src/composites/CallComposite/Call.tsx"}),Call_CallCompositeInternal.__docgenInfo={description:"An internal-only call composite export.\nThis is used by the meeting composite and has extra customizability points that we are not ready\nto export publicly.\n@internal",methods:[],displayName:"CallCompositeInternal",props:{adapter:{required:!0,tsType:{name:"CallAdapter"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Fluent theme for the composite.\n\n@defaultValue light theme"},rtl:{required:!1,tsType:{name:"boolean"},description:"Whether composite is displayed right-to-left.\n\n@defaultValue false"},locale:{required:!1,tsType:{name:"Locale"},description:"Locale for the composite.\n\n@defaultValue English (US)"},callInvitationURL:{required:!1,tsType:{name:"string"},description:""},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: PlaceholderProps, defaultOnRender: (props: PlaceholderProps) => JSX.Element) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:""},identifiers:{required:!1,tsType:{name:"Identifiers"},description:""},showCallControls:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/CallComposite/Call.tsx"]={name:"CallCompositeInternal",docgenInfo:Call_CallCompositeInternal.__docgenInfo,path:"../react-composites/src/composites/CallComposite/Call.tsx"});__webpack_require__(104);function DeviceManagerDeclarative_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function DeviceManagerDeclarative_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){DeviceManagerDeclarative_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){DeviceManagerDeclarative_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function DeviceManagerDeclarative_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var ProxyDeviceManager=function(){function ProxyDeviceManager(deviceManager,context){var _this=this;!function DeviceManagerDeclarative_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyDeviceManager),this._deviceManager=void 0,this._context=void 0,this.setDeviceManager=function(){_this._context.setDeviceManagerIsSpeakerSelectionAvailable(_this._deviceManager.isSpeakerSelectionAvailable),_this._context.setDeviceManagerSelectedMicrophone(_this._deviceManager.selectedMicrophone),_this._context.setDeviceManagerSelectedSpeaker(_this._deviceManager.selectedSpeaker)},this.subscribe=function(){_this._deviceManager.on("videoDevicesUpdated",_this.videoDevicesUpdated),_this._deviceManager.on("audioDevicesUpdated",_this.audioDevicesUpdated),_this._deviceManager.on("selectedMicrophoneChanged",_this.selectedMicrophoneChanged),_this._deviceManager.on("selectedSpeakerChanged",_this.selectedSpeakerChanged)},this.unsubscribe=function(){_this._deviceManager.off("videoDevicesUpdated",_this.videoDevicesUpdated),_this._deviceManager.off("audioDevicesUpdated",_this.audioDevicesUpdated),_this._deviceManager.off("selectedMicrophoneChanged",_this.selectedMicrophoneChanged),_this._deviceManager.off("selectedSpeakerChanged",_this.selectedSpeakerChanged)},this.selectCamera=function(videoDeviceInfo){_this._context.setDeviceManagerSelectedCamera(videoDeviceInfo)},this.videoDevicesUpdated=DeviceManagerDeclarative_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=_this._context,_context.t1=dedupeById,_context.next=4,_this._deviceManager.getCameras();case 4:_context.t2=_context.sent,_context.t3=(0,_context.t1)(_context.t2),_context.t0.setDeviceManagerCameras.call(_context.t0,_context.t3);case 7:case"end":return _context.stop()}}),_callee)}))),this.audioDevicesUpdated=DeviceManagerDeclarative_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.t0=_this._context,_context2.t1=dedupeById,_context2.next=4,_this._deviceManager.getMicrophones();case 4:return _context2.t2=_context2.sent,_context2.t3=(0,_context2.t1)(_context2.t2),_context2.t0.setDeviceManagerMicrophones.call(_context2.t0,_context2.t3),_context2.t4=_this._context,_context2.t5=dedupeById,_context2.next=11,_this._deviceManager.getSpeakers();case 11:_context2.t6=_context2.sent,_context2.t7=(0,_context2.t5)(_context2.t6),_context2.t4.setDeviceManagerSpeakers.call(_context2.t4,_context2.t7);case 14:case"end":return _context2.stop()}}),_callee2)}))),this.selectedMicrophoneChanged=function(){_this._context.setDeviceManagerSelectedMicrophone(_this._deviceManager.selectedMicrophone)},this.selectedSpeakerChanged=function(){_this._context.setDeviceManagerSelectedSpeaker(_this._deviceManager.selectedSpeaker)},this._deviceManager=deviceManager,this._context=context,this.setDeviceManager(),this.subscribe()}return function DeviceManagerDeclarative_createClass(Constructor,protoProps,staticProps){return protoProps&&DeviceManagerDeclarative_defineProperties(Constructor.prototype,protoProps),staticProps&&DeviceManagerDeclarative_defineProperties(Constructor,staticProps),Constructor}(ProxyDeviceManager,[{key:"get",value:function get(target,prop){var _this2=this;switch(prop){case"getCameras":return function(){return target.getCameras().then((function(cameras){return _this2._context.setDeviceManagerCameras(dedupeById(cameras)),cameras}))};case"getMicrophones":return function(){return target.getMicrophones().then((function(microphones){return _this2._context.setDeviceManagerMicrophones(dedupeById(microphones)),microphones}))};case"getSpeakers":return function(){return target.getSpeakers().then((function(speakers){return _this2._context.setDeviceManagerSpeakers(dedupeById(speakers)),speakers}))};case"selectMicrophone":return function(){return target.selectMicrophone.apply(target,arguments).then((function(){_this2._context.setDeviceManagerSelectedMicrophone(target.selectedMicrophone)}))};case"selectSpeaker":return function(){return target.selectSpeaker.apply(target,arguments).then((function(){_this2._context.setDeviceManagerSelectedSpeaker(target.selectedSpeaker)}))};case"askDevicePermission":return function(){return target.askDevicePermission.apply(target,arguments).then((function(deviceAccess){return _this2._context.setDeviceManagerDeviceAccess(deviceAccess),_this2.setDeviceManager(),deviceAccess}))};default:return Reflect.get(target,prop)}}}]),ProxyDeviceManager}(),dedupeById=function dedupeById(devices){var ids=new Set,uniqueDevices=[];return devices.forEach((function(device){ids.has(device.id)||(uniqueDevices.push(device),ids.add(device.id))})),uniqueDevices},deviceManagerDeclaratify=function deviceManagerDeclaratify(deviceManager,context){var proxyDeviceManager=new ProxyDeviceManager(deviceManager,context);return Object.defineProperty(deviceManager,"unsubscribe",{configurable:!1,value:function value(){return proxyDeviceManager.unsubscribe()}}),Object.defineProperty(deviceManager,"selectCamera",{configurable:!1,value:function value(videoDeviceInfo){return proxyDeviceManager.selectCamera(videoDeviceInfo)}}),new Proxy(deviceManager,proxyDeviceManager)};__webpack_require__(673);function CallContext_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function CallContext_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CallContext_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CallContext_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function CallContext_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CallContext_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function CallContext_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}Object(immer_esm.b)();var CallContext_CallContext=function(){function CallContext(userId){var maxListeners=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;CallContext_classCallCheck(this,CallContext),this._state=void 0,this._emitter=void 0,this._atomicId=void 0,this._state={calls:{},callsEnded:[],incomingCalls:{},incomingCallsEnded:[],deviceManager:{isSpeakerSelectionAvailable:!1,cameras:[],microphones:[],speakers:[],unparentedViews:[]},callAgent:void 0,userId:userId},this._emitter=new events_default.a,this._emitter.setMaxListeners(maxListeners),this._atomicId=0}return function CallContext_createClass(Constructor,protoProps,staticProps){return protoProps&&CallContext_defineProperties(Constructor.prototype,protoProps),staticProps&&CallContext_defineProperties(Constructor,staticProps),Constructor}(CallContext,[{key:"setState",value:function setState(state){this._state=state,this._emitter.emit("stateChanged",this._state)}},{key:"getState",value:function getState(){return this._state}},{key:"onStateChange",value:function onStateChange(handler){this._emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this._emitter.off("stateChanged",handler)}},{key:"clearCallRelatedState",value:function clearCallRelatedState(){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.calls={},draft.incomingCalls={},draft.callsEnded.splice(0,draft.callsEnded.length),draft.incomingCallsEnded.splice(0,draft.incomingCallsEnded.length)})))}},{key:"setCallAgent",value:function setCallAgent(callAgent){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.callAgent=callAgent})))}},{key:"setCall",value:function setCall(call){this.setState(Object(immer_esm.c)(this._state,(function(draft){var existingCall=draft.calls[call.id];existingCall?(existingCall.callerInfo=call.callerInfo,existingCall.state=call.state,existingCall.callEndReason=call.callEndReason,existingCall.direction=call.direction,existingCall.isMuted=call.isMuted,existingCall.isScreenSharingOn=call.isScreenSharingOn,existingCall.localVideoStreams=call.localVideoStreams,existingCall.remoteParticipants=call.remoteParticipants,existingCall.transcription.isTranscriptionActive=call.transcription.isTranscriptionActive,existingCall.recording.isRecordingActive=call.recording.isRecordingActive):draft.calls[call.id]=call})))}},{key:"removeCall",value:function removeCall(callId){this.setState(Object(immer_esm.c)(this._state,(function(draft){delete draft.calls[callId]})))}},{key:"setCallEnded",value:function setCallEnded(callId,callEndReason){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.endTime=new Date,call.callEndReason=callEndReason,delete draft.calls[callId],draft.callsEnded.length>=10&&draft.callsEnded.shift(),draft.callsEnded.push(call))})))}},{key:"setCallState",value:function setCallState(callId,state){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.state=state)})))}},{key:"setCallId",value:function setCallId(newCallId,oldCallId){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[oldCallId];call&&(delete draft.calls[oldCallId],draft.calls[newCallId]=call)})))}},{key:"setCallIsScreenSharingOn",value:function setCallIsScreenSharingOn(callId,isScreenSharingOn){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.isScreenSharingOn=isScreenSharingOn)})))}},{key:"setCallRemoteParticipants",value:function setCallRemoteParticipants(callId,addRemoteParticipant,removeRemoteParticipant){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(removeRemoteParticipant.forEach((function(id){delete call.remoteParticipants[id]})),addRemoteParticipant.forEach((function(participant){call.remoteParticipants[Object(src.d)(participant.identifier)]=participant})))})))}},{key:"setCallRemoteParticipantsEnded",value:function setCallRemoteParticipantsEnded(callId,addRemoteParticipant,removeRemoteParticipant){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(removeRemoteParticipant.forEach((function(id){delete call.remoteParticipantsEnded[id]})),addRemoteParticipant.forEach((function(participant){call.remoteParticipantsEnded[Object(src.d)(participant.identifier)]=participant})))})))}},{key:"setCallLocalVideoStream",value:function setCallLocalVideoStream(callId,streams){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.localVideoStreams=streams)})))}},{key:"setCallIsMicrophoneMuted",value:function setCallIsMicrophoneMuted(callId,isMicrophoneMuted){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.isMuted=isMicrophoneMuted)})))}},{key:"setCallRecordingActive",value:function setCallRecordingActive(callId,isRecordingActive){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.recording.isRecordingActive=isRecordingActive)})))}},{key:"setCallTranscriptionActive",value:function setCallTranscriptionActive(callId,isTranscriptionActive){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.transcription.isTranscriptionActive=isTranscriptionActive)})))}},{key:"setCallReceivedTransferRequest",value:function setCallReceivedTransferRequest(callId,transfer){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.transfer.receivedTransferRequests.length>=10&&call.transfer.receivedTransferRequests.shift(),call.transfer.receivedTransferRequests.push(transfer))})))}},{key:"setCallRequestedTransfer",value:function setCallRequestedTransfer(callId,transfer){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.transfer.requestedTransfers.length>=10&&call.transfer.requestedTransfers.shift(),call.transfer.requestedTransfers.push(transfer))})))}},{key:"setCallRequestedTransferState",value:function setCallRequestedTransferState(callId,transferId,state,error){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];if(call){var _step,_iterator=CallContext_createForOfIteratorHelper(call.transfer.requestedTransfers);try{for(_iterator.s();!(_step=_iterator.n()).done;){var requestedTransfer=_step.value;if(requestedTransfer.id===transferId){requestedTransfer.state=state,requestedTransfer.error=error;break}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}})))}},{key:"setCallScreenShareParticipant",value:function setCallScreenShareParticipant(callId,participantKey){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&(call.screenShareRemoteParticipant=participantKey)})))}},{key:"setLocalVideoStreamRendererView",value:function setLocalVideoStreamRendererView(callId,view){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];call&&call.localVideoStreams.length>0&&(call.localVideoStreams[0].view=view)})))}},{key:"setParticipantState",value:function setParticipantState(callId,participantKey,state){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];participant&&(participant.state=state)}})))}},{key:"setParticipantIsMuted",value:function setParticipantIsMuted(callId,participantKey,muted){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];participant&&(participant.isMuted=muted)}})))}},{key:"setParticipantDisplayName",value:function setParticipantDisplayName(callId,participantKey,displayName){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];participant&&(participant.displayName=displayName)}})))}},{key:"setParticipantIsSpeaking",value:function setParticipantIsSpeaking(callId,participantKey,isSpeaking){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];participant&&(participant.isSpeaking=isSpeaking)}})))}},{key:"setParticipantVideoStream",value:function setParticipantVideoStream(callId,participantKey,stream){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];if(participant){var existingStream=participant.videoStreams[stream.id];existingStream?(existingStream.isAvailable=stream.isAvailable,existingStream.mediaStreamType=stream.mediaStreamType):participant.videoStreams[stream.id]=stream}}})))}},{key:"setRemoteVideoStreamIsAvailable",value:function setRemoteVideoStreamIsAvailable(callId,participantKey,streamId,isAvailable){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];if(participant){var stream=participant.videoStreams[streamId];stream&&(stream.isAvailable=isAvailable)}}})))}},{key:"setRemoteVideoStreams",value:function setRemoteVideoStreams(callId,participantKey,addRemoteVideoStream,removeRemoteVideoStream){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];if(participant){var _step2,_iterator2=CallContext_createForOfIteratorHelper(removeRemoteVideoStream);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var id=_step2.value;delete participant.videoStreams[id]}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}var _step3,_iterator3=CallContext_createForOfIteratorHelper(addRemoteVideoStream);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var newStream=_step3.value,stream=participant.videoStreams[newStream.id];stream?(stream.mediaStreamType=newStream.mediaStreamType,stream.isAvailable=newStream.isAvailable):participant.videoStreams[newStream.id]=newStream}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}})))}},{key:"setRemoteVideoStreamRendererView",value:function setRemoteVideoStreamRendererView(callId,participantKey,streamId,view){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.calls[callId];if(call){var participant=call.remoteParticipants[participantKey];if(participant){var stream=participant.videoStreams[streamId];stream&&(stream.view=view)}}})))}},{key:"setIncomingCall",value:function setIncomingCall(call){this.setState(Object(immer_esm.c)(this._state,(function(draft){var existingCall=draft.incomingCalls[call.id];existingCall?existingCall.callerInfo=call.callerInfo:draft.incomingCalls[call.id]=call})))}},{key:"removeIncomingCall",value:function removeIncomingCall(callId){this.setState(Object(immer_esm.c)(this._state,(function(draft){delete draft.incomingCalls[callId]})))}},{key:"setIncomingCallEnded",value:function setIncomingCallEnded(callId,callEndReason){this.setState(Object(immer_esm.c)(this._state,(function(draft){var call=draft.incomingCalls[callId];call&&(call.endTime=new Date,call.callEndReason=callEndReason,delete draft.incomingCalls[callId],draft.incomingCallsEnded.length>=10&&draft.incomingCallsEnded.shift(),draft.incomingCallsEnded.push(call))})))}},{key:"setDeviceManagerIsSpeakerSelectionAvailable",value:function setDeviceManagerIsSpeakerSelectionAvailable(isSpeakerSelectionAvailable){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.isSpeakerSelectionAvailable=isSpeakerSelectionAvailable})))}},{key:"setDeviceManagerSelectedMicrophone",value:function setDeviceManagerSelectedMicrophone(selectedMicrophone){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.selectedMicrophone=selectedMicrophone})))}},{key:"setDeviceManagerSelectedSpeaker",value:function setDeviceManagerSelectedSpeaker(selectedSpeaker){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.selectedSpeaker=selectedSpeaker})))}},{key:"setDeviceManagerSelectedCamera",value:function setDeviceManagerSelectedCamera(selectedCamera){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.selectedCamera=selectedCamera})))}},{key:"setDeviceManagerCameras",value:function setDeviceManagerCameras(cameras){this.setState(Object(immer_esm.c)(this._state,(function(draft){cameras.length>0&&!cameras.some((function(camera){var _draft$deviceManager$;return camera.id===(null===(_draft$deviceManager$=draft.deviceManager.selectedCamera)||void 0===_draft$deviceManager$?void 0:_draft$deviceManager$.id)}))&&(draft.deviceManager.selectedCamera=cameras[0]),draft.deviceManager.cameras=cameras})))}},{key:"setDeviceManagerMicrophones",value:function setDeviceManagerMicrophones(microphones){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.microphones=microphones})))}},{key:"setDeviceManagerSpeakers",value:function setDeviceManagerSpeakers(speakers){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.speakers=speakers})))}},{key:"setDeviceManagerDeviceAccess",value:function setDeviceManagerDeviceAccess(deviceAccess){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.deviceAccess=deviceAccess})))}},{key:"setDeviceManagerUnparentedView",value:function setDeviceManagerUnparentedView(localVideoStream,view){this.setState(Object(immer_esm.c)(this._state,(function(draft){draft.deviceManager.unparentedViews.push({source:localVideoStream.source,mediaStreamType:localVideoStream.mediaStreamType,view:view})})))}},{key:"deleteDeviceManagerUnparentedView",value:function deleteDeviceManagerUnparentedView(localVideoStream){this.setState(Object(immer_esm.c)(this._state,(function(draft){var foundIndex=draft.deviceManager.unparentedViews.findIndex((function(stream){return stream.source.id===localVideoStream.source.id&&stream.mediaStreamType===localVideoStream.mediaStreamType}));-1!==foundIndex&&draft.deviceManager.unparentedViews.splice(foundIndex,1)})))}},{key:"getAndIncrementAtomicId",value:function getAndIncrementAtomicId(){var id=this._atomicId;return this._atomicId++,id}}]),CallContext}();function Converter_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function Converter_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return Converter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Converter_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function Converter_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function convertSdkLocalStreamToDeclarativeLocalStream(stream){return{source:stream.source,mediaStreamType:stream.mediaStreamType,view:void 0}}function convertSdkRemoteStreamToDeclarativeRemoteStream(stream){return{id:stream.id,mediaStreamType:stream.mediaStreamType,isAvailable:stream.isAvailable,view:void 0}}function convertSdkParticipantToDeclarativeParticipant(participant){var _step,declarativeVideoStreams={},_iterator=Converter_createForOfIteratorHelper(participant.videoStreams);try{for(_iterator.s();!(_step=_iterator.n()).done;){var videoStream=_step.value;declarativeVideoStreams[videoStream.id]=convertSdkRemoteStreamToDeclarativeRemoteStream(videoStream)}}catch(err){_iterator.e(err)}finally{_iterator.f()}return{identifier:participant.identifier,displayName:participant.displayName,state:participant.state,callEndReason:participant.callEndReason,videoStreams:declarativeVideoStreams,isMuted:participant.isMuted,isSpeaking:participant.isSpeaking}}function convertFromSDKToDeclarativeVideoStreamRendererView(view){return{scalingMode:view.scalingMode,isMirrored:view.isMirrored,target:view.target}}var RequestedTransferSubscriber=function RequestedTransferSubscriber(call,context,transfer,transferId){var _this=this;!function RequestedTransferSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RequestedTransferSubscriber),this._call=void 0,this._context=void 0,this._transfer=void 0,this._transferId=void 0,this.subscribe=function(){_this._transfer.on("stateChanged",_this.stateChanged)},this.unsubscribe=function(){_this._transfer.off("stateChanged",_this.stateChanged)},this.stateChanged=function(){_this._context.setCallRequestedTransferState(_this._call.id,_this._transferId,_this._transfer.state,_this._transfer.error)},this._call=call,this._context=context,this._transfer=transfer,this._transferId=transferId,this.subscribe()};function TransferCallFeatureDeclarative_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function TransferCallFeatureDeclarative_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return TransferCallFeatureDeclarative_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return TransferCallFeatureDeclarative_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function TransferCallFeatureDeclarative_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function TransferCallFeatureDeclarative_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var TransferCallFeatureDeclarative_ProxyTransferCallFeature=function(){function ProxyTransferCallFeature(call,context){!function TransferCallFeatureDeclarative_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyTransferCallFeature),this._call=void 0,this._context=void 0,this._requestedTransferSubscribers=void 0,this._call=call,this._context=context,this._requestedTransferSubscribers=[]}return function TransferCallFeatureDeclarative_createClass(Constructor,protoProps,staticProps){return protoProps&&TransferCallFeatureDeclarative_defineProperties(Constructor.prototype,protoProps),staticProps&&TransferCallFeatureDeclarative_defineProperties(Constructor,staticProps),Constructor}(ProxyTransferCallFeature,[{key:"unsubscribe",value:function unsubscribe(){var _step,_iterator=TransferCallFeatureDeclarative_createForOfIteratorHelper(this._requestedTransferSubscribers);try{for(_iterator.s();!(_step=_iterator.n()).done;){_step.value.unsubscribe()}}catch(err){_iterator.e(err)}finally{_iterator.f()}this._requestedTransferSubscribers=[]}},{key:"get",value:function get(target,prop){var _this=this;switch(prop){case"transfer":return function(targetParticipant,transferOptions){var transfer=target.transfer(targetParticipant,transferOptions),transferId=_this._context.getAndIncrementAtomicId();if(_this._context.setCallRequestedTransfer(_this._call.id,function convertSdkTransferToDeclarativeTransfer(transfer,targetParticipant,transferId){return{id:transferId,targetParticipant:targetParticipant,state:transfer.state,error:transfer.error}}(transfer,targetParticipant.targetParticipant,transferId)),_this._requestedTransferSubscribers.length>=10){var subscriber=_this._requestedTransferSubscribers.shift();null==subscriber||subscriber.unsubscribe()}return _this._requestedTransferSubscribers.push(new RequestedTransferSubscriber(_this._call,_this._context,transfer,transferId)),transfer};default:return Reflect.get(target,prop)}}}]),ProxyTransferCallFeature}();function CallDeclarative_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CallDeclarative_ProxyCall=function(){function ProxyCall(call,context){!function CallDeclarative_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyCall),this._call=void 0,this._context=void 0,this._transfer=void 0,this._call=call,this._context=context}return function CallDeclarative_createClass(Constructor,protoProps,staticProps){return protoProps&&CallDeclarative_defineProperties(Constructor.prototype,protoProps),staticProps&&CallDeclarative_defineProperties(Constructor,staticProps),Constructor}(ProxyCall,[{key:"unsubscribe",value:function unsubscribe(){this._transfer&&this._transfer.unsubscribe()}},{key:"get",value:function get(target,prop){var _this=this;switch(prop){case"api":return function(cls){var feature=target.api(cls);return feature.transfer?(_this._transfer||(_this._transfer=function transferCallFeatureDeclaratify(call,transfer,context){var proxyTransferCallFeature=new TransferCallFeatureDeclarative_ProxyTransferCallFeature(call,context);return Object.defineProperty(transfer,"unsubscribe",{configurable:!1,value:function value(){return proxyTransferCallFeature.unsubscribe()}}),new Proxy(transfer,proxyTransferCallFeature)}(_this._call,feature,_this._context)),_this._transfer):feature};default:return Reflect.get(target,prop)}}}]),ProxyCall}(),callDeclaratify=function callDeclaratify(call,context){var proxyCall=new CallDeclarative_ProxyCall(call,context);return Object.defineProperty(call,"unsubscribe",{configurable:!1,value:function value(){return proxyCall.unsubscribe()}}),new Proxy(call,proxyCall)};__webpack_require__(47);var ReceivedTransferSubscriber_ReceivedTransferSubscriber=function ReceivedTransferSubscriber(callIdRef,context,transfer){var _this=this;!function ReceivedTransferSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ReceivedTransferSubscriber),this._callIdRef=void 0,this._context=void 0,this._transfer=void 0,this.subscribe=function(){_this._transfer.on("transferRequested",_this.transferRequested)},this.unsubscribe=function(){_this._transfer.off("transferRequested",_this.transferRequested)},this.transferRequested=function(transferRequested){_this._context.setCallReceivedTransferRequest(_this._callIdRef.callId,function convertSdkTransferRequestedToDeclarativeTransferRequested(transferRequested){return{targetParticipant:transferRequested.targetParticipant}}(transferRequested))},this._callIdRef=callIdRef,this._context=context,this._transfer=transfer,this.subscribe()};var RemoteVideoStreamSubscriber=function RemoteVideoStreamSubscriber(callIdRef,participantKey,remoteVideoStream,context){var _this=this;!function RemoteVideoStreamSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RemoteVideoStreamSubscriber),this._callIdRef=void 0,this._participantKey=void 0,this._remoteVideoStream=void 0,this._context=void 0,this.subscribe=function(){_this._remoteVideoStream.on("isAvailableChanged",_this.isAvailableChanged),_this.checkAndUpdateScreenShareState()},this.unsubscribe=function(){_this._remoteVideoStream.off("isAvailableChanged",_this.isAvailableChanged)},this.includesActiveScreenShareStream=function(streams){for(var _i=0,_Object$values=Object.values(streams);_i<_Object$values.length;_i++){var stream=_Object$values[_i];if("ScreenSharing"===stream.mediaStreamType&&stream.isAvailable)return!0}return!1},this.checkAndUpdateScreenShareState=function(){var _this$_context$getSta,_this$_context$getSta2,_this$_context$getSta3;if("ScreenSharing"===_this._remoteVideoStream.mediaStreamType)if(_this._remoteVideoStream.isAvailable)_this._context.setCallScreenShareParticipant(_this._callIdRef.callId,_this._participantKey);else{var existingScreenShare=null===(_this$_context$getSta=_this._context.getState().calls[_this._callIdRef.callId])||void 0===_this$_context$getSta?void 0:_this$_context$getSta.screenShareRemoteParticipant;if(existingScreenShare&&existingScreenShare!==_this._participantKey){var streams=null===(_this$_context$getSta2=_this._context.getState().calls[_this._callIdRef.callId])||void 0===_this$_context$getSta2||null===(_this$_context$getSta3=_this$_context$getSta2.remoteParticipants[existingScreenShare])||void 0===_this$_context$getSta3?void 0:_this$_context$getSta3.videoStreams;streams&&_this.includesActiveScreenShareStream(streams)||_this._context.setCallScreenShareParticipant(_this._callIdRef.callId,void 0)}else _this._context.setCallScreenShareParticipant(_this._callIdRef.callId,void 0)}},this.isAvailableChanged=function(){_this._context.setRemoteVideoStreamIsAvailable(_this._callIdRef.callId,_this._participantKey,_this._remoteVideoStream.id,_this._remoteVideoStream.isAvailable),_this.checkAndUpdateScreenShareState()},this._callIdRef=callIdRef,this._participantKey=participantKey,this._remoteVideoStream=remoteVideoStream,this._context=context,this.subscribe()};function StreamUtils_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=StreamUtils_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function StreamUtils_slicedToArray(arr,i){return function StreamUtils_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function StreamUtils_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||StreamUtils_unsupportedIterableToArray(arr,i)||function StreamUtils_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function StreamUtils_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return StreamUtils_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?StreamUtils_arrayLikeToArray(o,minLen):void 0}}function StreamUtils_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function StreamUtils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StreamUtils_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StreamUtils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StreamUtils_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _createViewRemoteVideo(){return(_createViewRemoteVideo=StreamUtils_asyncToGenerator(regeneratorRuntime.mark((function _callee(context,internalContext,callId,participantId,stream,options){var streamId,participantKey,renderInfo,renderer,view,refreshedRenderInfo;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(streamId=stream.id,participantKey="string"==typeof participantId?participantId:Object(src.d)(participantId),renderInfo=internalContext.getRemoteRenderInfoForParticipant(callId,participantKey,streamId)){_context.next=6;break}return console.warn("RemoteVideoStream not found in state"),_context.abrupt("return");case 6:if("Rendered"!==renderInfo.status){_context.next=9;break}return console.warn("RemoteVideoStream is already rendered"),_context.abrupt("return");case 9:if("Rendering"!==renderInfo.status){_context.next=12;break}return console.warn("RemoteVideoStream rendering is already in progress"),_context.abrupt("return");case 12:if("Stopping"!==renderInfo.status){_context.next=15;break}return console.warn("RemoteVideoStream is in the middle of stopping"),_context.abrupt("return");case 15:return renderer=new sdk_bundle.VideoStreamRenderer(renderInfo.stream),internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"Rendering",void 0),_context.prev=17,_context.next=20,renderer.createView(options);case 20:view=_context.sent,_context.next=27;break;case 23:throw _context.prev=23,_context.t0=_context.catch(17),internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"NotRendered",void 0),_context.t0;case 27:if(refreshedRenderInfo=internalContext.getRemoteRenderInfoForParticipant(callId,participantKey,streamId)){_context.next=32;break}return renderer.dispose(),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,void 0),_context.abrupt("return");case 32:if("Stopping"!==refreshedRenderInfo.status){_context.next=37;break}return renderer.dispose(),internalContext.setRemoteRenderInfo(callId,participantKey,streamId,refreshedRenderInfo.stream,"NotRendered",void 0),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,void 0),_context.abrupt("return");case 37:internalContext.setRemoteRenderInfo(callId,participantKey,streamId,refreshedRenderInfo.stream,"Rendered",renderer),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,convertFromSDKToDeclarativeVideoStreamRendererView(view));case 39:case"end":return _context.stop()}}),_callee,null,[[17,23]])})))).apply(this,arguments)}function _createViewLocalVideo(){return(_createViewLocalVideo=StreamUtils_asyncToGenerator(regeneratorRuntime.mark((function _callee2(context,internalContext,callId,options){var renderInfo,renderer,view,refreshedRenderInfo;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(renderInfo=internalContext.getLocalRenderInfo(callId)){_context2.next=4;break}return console.warn("LocalVideoStream not found in state"),_context2.abrupt("return");case 4:if("Rendered"!==renderInfo.status){_context2.next=7;break}return console.warn("LocalVideoStream is already rendered"),_context2.abrupt("return");case 7:if("Rendering"!==renderInfo.status){_context2.next=10;break}return console.warn("LocalVideoStream rendering is already in progress"),_context2.abrupt("return");case 10:if("Stopping"!==renderInfo.status){_context2.next=13;break}return console.warn("LocalVideoStream is in the middle of stopping"),_context2.abrupt("return");case 13:return renderer=new sdk_bundle.VideoStreamRenderer(renderInfo.stream),internalContext.setLocalRenderInfo(callId,renderInfo.stream,"Rendering",renderer),_context2.prev=15,_context2.next=18,renderer.createView(options);case 18:view=_context2.sent,_context2.next=25;break;case 21:throw _context2.prev=21,_context2.t0=_context2.catch(15),internalContext.setLocalRenderInfo(callId,renderInfo.stream,"NotRendered",void 0),_context2.t0;case 25:if(refreshedRenderInfo=internalContext.getLocalRenderInfo(callId)){_context2.next=30;break}return renderer.dispose(),context.setLocalVideoStreamRendererView(callId,void 0),_context2.abrupt("return");case 30:if("Stopping"!==refreshedRenderInfo.status){_context2.next=35;break}return renderer.dispose(),internalContext.setLocalRenderInfo(callId,refreshedRenderInfo.stream,"NotRendered",void 0),context.setLocalVideoStreamRendererView(callId,void 0),_context2.abrupt("return");case 35:internalContext.setLocalRenderInfo(callId,refreshedRenderInfo.stream,"Rendered",renderer),context.setLocalVideoStreamRendererView(callId,convertFromSDKToDeclarativeVideoStreamRendererView(view));case 37:case"end":return _context2.stop()}}),_callee2,null,[[15,21]])})))).apply(this,arguments)}function _createViewUnparentedVideo(){return(_createViewUnparentedVideo=StreamUtils_asyncToGenerator(regeneratorRuntime.mark((function _callee3(context,internalContext,stream,options){var renderInfo,localVideoStream,renderer,view,refreshedRenderInfo;return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!(renderInfo=internalContext.getUnparentedRenderInfo(stream))||"Rendered"!==renderInfo.status){_context3.next=4;break}return console.warn("Unparented LocalVideoStream is already rendered"),_context3.abrupt("return");case 4:if(!renderInfo||"Rendering"!==renderInfo.status){_context3.next=7;break}return console.warn("Unparented LocalVideoStream rendering is already in progress"),_context3.abrupt("return");case 7:if(!renderInfo||"Stopping"!==renderInfo.status){_context3.next=10;break}return console.warn("Unparented LocalVideoStream is in the middle of stopping"),_context3.abrupt("return");case 10:return localVideoStream=new sdk_bundle.LocalVideoStream(stream.source),renderer=new sdk_bundle.VideoStreamRenderer(localVideoStream),internalContext.setUnparentedRenderInfo(stream,localVideoStream,"Rendering",void 0),_context3.prev=13,_context3.next=16,renderer.createView(options);case 16:view=_context3.sent,_context3.next=23;break;case 19:throw _context3.prev=19,_context3.t0=_context3.catch(13),internalContext.deleteUnparentedRenderInfo(stream),_context3.t0;case 23:if(refreshedRenderInfo=internalContext.getUnparentedRenderInfo(stream)){_context3.next=28;break}return renderer.dispose(),context.deleteDeviceManagerUnparentedView(stream),_context3.abrupt("return");case 28:if("Stopping"!==refreshedRenderInfo.status){_context3.next=32;break}return internalContext.deleteUnparentedRenderInfo(stream),context.deleteDeviceManagerUnparentedView(stream),_context3.abrupt("return");case 32:internalContext.setUnparentedRenderInfo(stream,localVideoStream,"Rendered",renderer),context.setDeviceManagerUnparentedView(stream,convertFromSDKToDeclarativeVideoStreamRendererView(view));case 34:case"end":return _context3.stop()}}),_callee3,null,[[13,19]])})))).apply(this,arguments)}function createView(context,internalContext,callId,participantId,stream,options){return"id"in stream&&callId&&participantId?function createViewRemoteVideo(_x,_x2,_x3,_x4,_x5,_x6){return _createViewRemoteVideo.apply(this,arguments)}(context,internalContext,callId,participantId,stream,options):!("id"in stream)&&callId?function createViewLocalVideo(_x7,_x8,_x9,_x10){return _createViewLocalVideo.apply(this,arguments)}(context,internalContext,callId,options):"id"in stream||callId?(console.warn("Invalid combination of parameters"),Promise.resolve()):function createViewUnparentedVideo(_x11,_x12,_x13,_x14){return _createViewUnparentedVideo.apply(this,arguments)}(context,internalContext,stream,options)}function disposeView(context,internalContext,callId,participantId,stream){if("id"in stream&&callId&&participantId)!function disposeViewRemoteVideo(context,internalContext,callId,participantId,stream){var participantKey,streamId=stream.id;participantKey="string"==typeof participantId?participantId:Object(src.d)(participantId),context.setRemoteVideoStreamRendererView(callId,participantKey,streamId,void 0);var renderInfo=internalContext.getRemoteRenderInfoForParticipant(callId,participantKey,streamId);renderInfo&&("Rendering"===renderInfo.status?internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"Stopping",void 0):internalContext.setRemoteRenderInfo(callId,participantKey,streamId,renderInfo.stream,"NotRendered",void 0),renderInfo.renderer&&renderInfo.renderer.dispose())}(context,internalContext,callId,participantId,stream);else if(!("id"in stream)&&callId)!function disposeViewLocalVideo(context,internalContext,callId){context.setLocalVideoStreamRendererView(callId,void 0);var renderInfo=internalContext.getLocalRenderInfo(callId);renderInfo&&("Rendering"===renderInfo.status?internalContext.setLocalRenderInfo(callId,renderInfo.stream,"Stopping",void 0):internalContext.setLocalRenderInfo(callId,renderInfo.stream,"NotRendered",void 0),renderInfo.renderer&&renderInfo.renderer.dispose())}(context,internalContext,callId);else{if("id"in stream||callId)return void console.warn("Invalid combination of parameters");!function disposeViewUnparentedVideo(context,internalContext,stream){context.deleteDeviceManagerUnparentedView(stream);var renderInfo=internalContext.getUnparentedRenderInfo(stream);renderInfo&&("Rendering"===renderInfo.status?internalContext.setUnparentedRenderInfo(stream,renderInfo.stream,"Stopping",void 0):internalContext.deleteUnparentedRenderInfo(stream),renderInfo.renderer&&renderInfo.renderer.dispose())}(context,internalContext,stream)}}function disposeAllViewsFromCall(context,internalContext,callId){var callStreams=internalContext.getRemoteRenderInfoForCall(callId);if(callStreams){var _step,_iterator=StreamUtils_createForOfIteratorHelper(callStreams.entries());try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step2,_ref2=StreamUtils_slicedToArray(_step.value,2),participantKey=_ref2[0],_iterator2=StreamUtils_createForOfIteratorHelper(_ref2[1].entries());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _ref4=StreamUtils_slicedToArray(_step2.value,2);_ref4[0];disposeView(context,internalContext,callId,participantKey,convertSdkRemoteStreamToDeclarativeRemoteStream(_ref4[1].stream))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}}var localStreamAndRenderer=internalContext.getLocalRenderInfo(callId);localStreamAndRenderer&&localStreamAndRenderer.renderer&&disposeView(context,internalContext,callId,void 0,convertSdkLocalStreamToDeclarativeLocalStream(localStreamAndRenderer.stream))}function ParticipantSubscriber_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function ParticipantSubscriber_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantSubscriber_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantSubscriber_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function ParticipantSubscriber_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ParticipantSubscriber_ParticipantSubscriber=function ParticipantSubscriber(callIdRef,participant,context,internalContext){var _this=this;!function ParticipantSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ParticipantSubscriber),this._callIdRef=void 0,this._participant=void 0,this._context=void 0,this._internalContext=void 0,this._participantKey=void 0,this._remoteVideoStreamSubscribers=void 0,this.subscribe=function(){if(_this._participant.on("stateChanged",_this.stateChanged),_this._participant.on("isMutedChanged",_this.isMutedChanged),_this._participant.on("displayNameChanged",_this.displayNameChanged),_this._participant.on("isSpeakingChanged",_this.isSpeakingChanged),_this._participant.on("videoStreamsUpdated",_this.videoStreamsUpdated),_this._participant.videoStreams.length>0){var _step,_iterator=ParticipantSubscriber_createForOfIteratorHelper(_this._participant.videoStreams);try{for(_iterator.s();!(_step=_iterator.n()).done;){var stream=_step.value;_this._internalContext.setRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,stream.id,stream,"NotRendered",void 0),_this.addRemoteVideoStreamSubscriber(stream)}}catch(err){_iterator.e(err)}finally{_iterator.f()}_this._context.setRemoteVideoStreams(_this._callIdRef.callId,_this._participantKey,_this._participant.videoStreams.map(convertSdkRemoteStreamToDeclarativeRemoteStream),[])}},this.unsubscribe=function(){if(_this._participant.off("stateChanged",_this.stateChanged),_this._participant.off("isMutedChanged",_this.isMutedChanged),_this._participant.off("displayNameChanged",_this.displayNameChanged),_this._participant.off("isSpeakingChanged",_this.isSpeakingChanged),_this._participant.off("videoStreamsUpdated",_this.videoStreamsUpdated),_this._participant.videoStreams.length>0){var _step2,_iterator2=ParticipantSubscriber_createForOfIteratorHelper(_this._participant.videoStreams);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var stream=_step2.value;disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,_this._participantKey,convertSdkRemoteStreamToDeclarativeRemoteStream(stream)),_this._internalContext.deleteRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,stream.id)}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}},this.addRemoteVideoStreamSubscriber=function(remoteVideoStream){var _this$_remoteVideoStr;null===(_this$_remoteVideoStr=_this._remoteVideoStreamSubscribers.get(remoteVideoStream.id))||void 0===_this$_remoteVideoStr||_this$_remoteVideoStr.unsubscribe(),_this._remoteVideoStreamSubscribers.set(remoteVideoStream.id,new RemoteVideoStreamSubscriber(_this._callIdRef,_this._participantKey,remoteVideoStream,_this._context))},this.stateChanged=function(){_this._context.setParticipantState(_this._callIdRef.callId,_this._participantKey,_this._participant.state)},this.isMutedChanged=function(){_this._context.setParticipantIsMuted(_this._callIdRef.callId,_this._participantKey,_this._participant.isMuted)},this.displayNameChanged=function(){_this._context.setParticipantDisplayName(_this._callIdRef.callId,_this._participantKey,_this._participant.displayName||"")},this.isSpeakingChanged=function(){_this._context.setParticipantIsSpeaking(_this._callIdRef.callId,_this._participantKey,_this._participant.isSpeaking)},this.videoStreamsUpdated=function(event){var _step3,_iterator3=ParticipantSubscriber_createForOfIteratorHelper(event.removed);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _this$_remoteVideoStr2,stream=_step3.value;null===(_this$_remoteVideoStr2=_this._remoteVideoStreamSubscribers.get(stream.id))||void 0===_this$_remoteVideoStr2||_this$_remoteVideoStr2.unsubscribe(),disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,_this._participantKey,convertSdkRemoteStreamToDeclarativeRemoteStream(stream)),_this._internalContext.deleteRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,stream.id)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}var _step4,_iterator4=ParticipantSubscriber_createForOfIteratorHelper(event.added);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _stream=_step4.value;_this._internalContext.setRemoteRenderInfo(_this._callIdRef.callId,_this._participantKey,_stream.id,_stream,"NotRendered",void 0),_this.addRemoteVideoStreamSubscriber(_stream)}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}_this._context.setRemoteVideoStreams(_this._callIdRef.callId,_this._participantKey,event.added.map(convertSdkRemoteStreamToDeclarativeRemoteStream),event.removed.map((function(stream){return stream.id})))},this._callIdRef=callIdRef,this._participant=participant,this._context=context,this._internalContext=internalContext,this._participantKey=Object(src.d)(this._participant.identifier),this._remoteVideoStreamSubscribers=new Map,this.subscribe()};var RecordingSubscriber=function RecordingSubscriber(callIdRef,context,recording){var _this=this;!function RecordingSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RecordingSubscriber),this._callIdRef=void 0,this._context=void 0,this._recording=void 0,this.subscribe=function(){_this._recording.on("isRecordingActiveChanged",_this.isAvailableChanged)},this.unsubscribe=function(){_this._recording.off("isRecordingActiveChanged",_this.isAvailableChanged)},this.isAvailableChanged=function(){_this._context.setCallRecordingActive(_this._callIdRef.callId,_this._recording.isRecordingActive)},this._callIdRef=callIdRef,this._context=context,this._recording=recording,this._recording.isRecordingActive&&this._context.setCallRecordingActive(this._callIdRef.callId,this._recording.isRecordingActive),this.subscribe()};var TranscriptionSubscriber=function TranscriptionSubscriber(callIdRef,context,transcription){var _this=this;!function TranscriptionSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TranscriptionSubscriber),this._callIdRef=void 0,this._context=void 0,this._transcription=void 0,this.subscribe=function(){_this._transcription.on("isTranscriptionActiveChanged",_this.isTranscriptionActiveChanged)},this.unsubscribe=function(){_this._transcription.off("isTranscriptionActiveChanged",_this.isTranscriptionActiveChanged)},this.isTranscriptionActiveChanged=function(){_this._context.setCallTranscriptionActive(_this._callIdRef.callId,_this._transcription.isTranscriptionActive)},this._callIdRef=callIdRef,this._context=context,this._transcription=transcription,this._transcription.isTranscriptionActive&&this._context.setCallTranscriptionActive(this._callIdRef.callId,this._transcription.isTranscriptionActive),this.subscribe()};function CallSubscriber_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CallSubscriber_CallSubscriber=function(){function CallSubscriber(call,context,internalContext){var _this=this;!function CallSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,CallSubscriber),this._call=void 0,this._callIdRef=void 0,this._context=void 0,this._internalContext=void 0,this._participantSubscribers=void 0,this._recordingSubscriber=void 0,this._transcriptionSubscriber=void 0,this._receivedTransferSubscriber=void 0,this.subscribe=function(){_this._call.on("stateChanged",_this.stateChanged),_this._call.on("idChanged",_this.idChanged),_this._call.on("isScreenSharingOnChanged",_this.isScreenSharingOnChanged),_this._call.on("remoteParticipantsUpdated",_this.remoteParticipantsUpdated),_this._call.on("localVideoStreamsUpdated",_this.localVideoStreamsUpdated),_this._call.on("isMutedChanged",_this.isMuteChanged),_this._call.localVideoStreams.length>0&&_this._internalContext.setLocalRenderInfo(_this._callIdRef.callId,_this._call.localVideoStreams[0],"NotRendered",void 0),_this._call.remoteParticipants.length>0&&(_this._call.remoteParticipants.forEach((function(participant){_this.addParticipantListener(participant)})),_this._context.setCallRemoteParticipants(_this._callIdRef.callId,_this._call.remoteParticipants.map(convertSdkParticipantToDeclarativeParticipant),[]))},this.unsubscribe=function(){_this._call.off("stateChanged",_this.stateChanged),_this._call.off("idChanged",_this.idChanged),_this._call.off("isScreenSharingOnChanged",_this.isScreenSharingOnChanged),_this._call.off("remoteParticipantsUpdated",_this.remoteParticipantsUpdated),_this._call.off("localVideoStreamsUpdated",_this.localVideoStreamsUpdated),_this._call.off("isMutedChanged",_this.isMuteChanged),_this._participantSubscribers.forEach((function(participantSubscriber){participantSubscriber.unsubscribe()})),_this._participantSubscribers.clear(),_this._call.localVideoStreams&&_this._call.localVideoStreams[0]&&disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,void 0,convertSdkLocalStreamToDeclarativeLocalStream(_this._call.localVideoStreams[0])),_this._internalContext.deleteLocalRenderInfo(_this._callIdRef.callId),_this._recordingSubscriber.unsubscribe(),_this._transcriptionSubscriber.unsubscribe(),_this._receivedTransferSubscriber.unsubscribe()},this.stateChanged=function(){_this._context.setCallState(_this._callIdRef.callId,_this._call.state)},this.idChanged=function(){_this._internalContext.setCallId(_this._call.id,_this._callIdRef.callId),_this._context.setCallId(_this._call.id,_this._callIdRef.callId),_this._callIdRef.callId=_this._call.id},this.isScreenSharingOnChanged=function(){_this._context.setCallIsScreenSharingOn(_this._callIdRef.callId,_this._call.isScreenSharingOn)},this.isMuteChanged=function(){_this._context.setCallIsMicrophoneMuted(_this._callIdRef.callId,_this._call.isMuted)},this.remoteParticipantsUpdated=function(event){event.added.forEach((function(participant){_this.addParticipantListener(participant)})),event.removed.forEach((function(participant){_this.removeParticipantListener(participant)})),_this._context.setCallRemoteParticipantsEnded(_this._callIdRef.callId,event.removed.map(convertSdkParticipantToDeclarativeParticipant),event.added.map((function(participant){return Object(src.d)(participant.identifier)}))),_this._context.setCallRemoteParticipants(_this._callIdRef.callId,event.added.map(convertSdkParticipantToDeclarativeParticipant),event.removed.map((function(participant){return Object(src.d)(participant.identifier)})))},this.localVideoStreamsUpdated=function(event){if(event.added.length>0){var localVideoStreams=[convertSdkLocalStreamToDeclarativeLocalStream(_this._call.localVideoStreams[0])];_this._internalContext.setLocalRenderInfo(_this._callIdRef.callId,_this._call.localVideoStreams[0],"NotRendered",void 0),_this._context.setCallLocalVideoStream(_this._callIdRef.callId,[].concat(localVideoStreams))}event.removed.length>0&&(disposeView(_this._context,_this._internalContext,_this._callIdRef.callId,void 0,convertSdkLocalStreamToDeclarativeLocalStream(event.removed[0])),_this._internalContext.deleteLocalRenderInfo(_this._callIdRef.callId),_this._context.setCallLocalVideoStream(_this._callIdRef.callId,[]))},this._call=call,this._callIdRef={callId:call.id},this._context=context,this._internalContext=internalContext,this._participantSubscribers=new Map,this._recordingSubscriber=new RecordingSubscriber(this._callIdRef,this._context,this._call.api(sdk_bundle.Features.Recording)),this._transcriptionSubscriber=new TranscriptionSubscriber(this._callIdRef,this._context,this._call.api(sdk_bundle.Features.Transcription)),this._receivedTransferSubscriber=new ReceivedTransferSubscriber_ReceivedTransferSubscriber(this._callIdRef,this._context,this._call.api(sdk_bundle.Features.Transfer)),this.subscribe()}return function CallSubscriber_createClass(Constructor,protoProps,staticProps){return protoProps&&CallSubscriber_defineProperties(Constructor.prototype,protoProps),staticProps&&CallSubscriber_defineProperties(Constructor,staticProps),Constructor}(CallSubscriber,[{key:"addParticipantListener",value:function addParticipantListener(participant){var _this$_participantSub,participantKey=Object(src.d)(participant.identifier);null===(_this$_participantSub=this._participantSubscribers.get(participantKey))||void 0===_this$_participantSub||_this$_participantSub.unsubscribe(),this._participantSubscribers.set(participantKey,new ParticipantSubscriber_ParticipantSubscriber(this._callIdRef,participant,this._context,this._internalContext))}},{key:"removeParticipantListener",value:function removeParticipantListener(participant){var participantKey=Object(src.d)(participant.identifier),participantSubscriber=this._participantSubscribers.get(participantKey);participantSubscriber&&(participantSubscriber.unsubscribe(),this._participantSubscribers.delete(participantKey))}}]),CallSubscriber}();var IncomingCallSubscriber=function IncomingCallSubscriber(incomingCall,setIncomingCallEnded){var _this=this;!function IncomingCallSubscriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,IncomingCallSubscriber),this._incomingCall=void 0,this._setIncomingCallEnded=void 0,this.subscribe=function(){_this._incomingCall.on("callEnded",_this.callEnded)},this.unsubscribe=function(){_this._incomingCall.off("callEnded",_this.callEnded)},this.callEnded=function(event){_this._setIncomingCallEnded(_this._incomingCall.id,event.callEndReason)},this._incomingCall=incomingCall,this._setIncomingCallEnded=setIncomingCallEnded,this.subscribe()};function CallAgentDeclarative_slicedToArray(arr,i){return function CallAgentDeclarative_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CallAgentDeclarative_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||CallAgentDeclarative_unsupportedIterableToArray(arr,i)||function CallAgentDeclarative_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CallAgentDeclarative_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=CallAgentDeclarative_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function CallAgentDeclarative_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return CallAgentDeclarative_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?CallAgentDeclarative_arrayLikeToArray(o,minLen):void 0}}function CallAgentDeclarative_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function CallAgentDeclarative_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var CallAgentDeclarative_ProxyCallAgent=function(){function ProxyCallAgent(callAgent,context,internalContext){var _this=this;!function CallAgentDeclarative_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyCallAgent),this._callAgent=void 0,this._context=void 0,this._internalContext=void 0,this._callSubscribers=void 0,this._incomingCallSubscribers=void 0,this._declarativeCalls=void 0,this._externalCallsUpdatedListeners=void 0,this.subscribe=function(){_this._callAgent.on("callsUpdated",_this.callsUpdated),_this._callAgent.on("incomingCall",_this.incomingCall);var _step,_iterator=CallAgentDeclarative_createForOfIteratorHelper(_this._callAgent.calls);try{for(_iterator.s();!(_step=_iterator.n()).done;){var call=_step.value;_this.addCall(call)}}catch(err){_iterator.e(err)}finally{_iterator.f()}},this.unsubscribe=function(){_this._callAgent.off("callsUpdated",_this.callsUpdated),_this._callAgent.off("incomingCall",_this.incomingCall);var _step2,_iterator2=CallAgentDeclarative_createForOfIteratorHelper(_this._callSubscribers.entries());try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _ref2=CallAgentDeclarative_slicedToArray(_step2.value,2);_ref2[0];_ref2[1].unsubscribe()}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}_this._callSubscribers.clear();var _step3,_iterator3=CallAgentDeclarative_createForOfIteratorHelper(_this._incomingCallSubscribers.entries());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var _ref4=CallAgentDeclarative_slicedToArray(_step3.value,2);_ref4[0];_ref4[1].unsubscribe()}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}_this._incomingCallSubscribers.clear();var _step4,_iterator4=CallAgentDeclarative_createForOfIteratorHelper(_this._declarativeCalls.entries());try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _ref6=CallAgentDeclarative_slicedToArray(_step4.value,2);_ref6[0];_ref6[1].unsubscribe()}}catch(err){_iterator4.e(err)}finally{_iterator4.f()}_this._declarativeCalls.clear()},this.callsUpdated=function(event){var _step5,addedStatefulCall=[],_iterator5=CallAgentDeclarative_createForOfIteratorHelper(event.added);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var call=_step5.value,statefulCall=_this.addCall(call);addedStatefulCall.push(statefulCall)}}catch(err){_iterator5.e(err)}finally{_iterator5.f()}var _step6,removedStatefulCall=[],_iterator6=CallAgentDeclarative_createForOfIteratorHelper(event.removed);try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){var _call=_step6.value;disposeAllViewsFromCall(_this._context,_this._internalContext,_call.id);var callSubscriber=_this._callSubscribers.get(_call);callSubscriber&&(callSubscriber.unsubscribe(),_this._callSubscribers.delete(_call)),_this._context.setCallEnded(_call.id,_call.callEndReason);var declarativeCall=_this._declarativeCalls.get(_call);declarativeCall?(declarativeCall.unsubscribe(),removedStatefulCall.push(declarativeCall),_this._declarativeCalls.delete(_call)):removedStatefulCall.push(callDeclaratify(_call,_this._context))}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}var _step7,_iterator7=CallAgentDeclarative_createForOfIteratorHelper(_this._externalCallsUpdatedListeners);try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){(0,_step7.value)({added:addedStatefulCall,removed:removedStatefulCall})}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}},this.setIncomingCallEnded=function(incomingCallId,callEndReason){var incomingCallSubscriber=_this._incomingCallSubscribers.get(incomingCallId);incomingCallSubscriber&&(incomingCallSubscriber.unsubscribe(),_this._incomingCallSubscribers.delete(incomingCallId)),_this._context.setIncomingCallEnded(incomingCallId,callEndReason)},this.incomingCall=function(event){_this._incomingCallSubscribers.has(event.incomingCall.id)||_this._incomingCallSubscribers.set(event.incomingCall.id,new IncomingCallSubscriber(event.incomingCall,_this.setIncomingCallEnded)),_this._context.setIncomingCall(function convertSdkIncomingCallToDeclarativeIncomingCall(call){return{id:call.id,callerInfo:call.callerInfo,startTime:new Date,endTime:void 0}}(event.incomingCall))},this.addCall=function(call){var _this$_callSubscriber;return null===(_this$_callSubscriber=_this._callSubscribers.get(call))||void 0===_this$_callSubscriber||_this$_callSubscriber.unsubscribe(),_this._context.setCall(function convertSdkCallToDeclarativeCall(call){var declarativeRemoteParticipants={};return call.remoteParticipants.forEach((function(participant){declarativeRemoteParticipants[Object(src.d)(participant.identifier)]=convertSdkParticipantToDeclarativeParticipant(participant)})),{id:call.id,callerInfo:call.callerInfo,state:call.state,callEndReason:call.callEndReason,direction:call.direction,isMuted:call.isMuted,isScreenSharingOn:call.isScreenSharingOn,localVideoStreams:call.localVideoStreams.map(convertSdkLocalStreamToDeclarativeLocalStream),remoteParticipants:declarativeRemoteParticipants,remoteParticipantsEnded:{},recording:{isRecordingActive:!1},transcription:{isTranscriptionActive:!1},transfer:{receivedTransferRequests:[],requestedTransfers:[]},screenShareRemoteParticipant:void 0,startTime:new Date,endTime:void 0}}(call)),_this._callSubscribers.set(call,new CallSubscriber_CallSubscriber(call,_this._context,_this._internalContext)),_this.getOrCreateDeclarativeCall(call)},this.getOrCreateDeclarativeCall=function(call){var declarativeCall=_this._declarativeCalls.get(call);if(declarativeCall)return declarativeCall;var newDeclarativeCall=callDeclaratify(call,_this._context);return _this._declarativeCalls.set(call,newDeclarativeCall),newDeclarativeCall},this._callAgent=callAgent,this._context=context,this._internalContext=internalContext,this._callSubscribers=new Map,this._incomingCallSubscribers=new Map,this._declarativeCalls=new Map,this._externalCallsUpdatedListeners=new Set,this.subscribe()}return function CallAgentDeclarative_createClass(Constructor,protoProps,staticProps){return protoProps&&CallAgentDeclarative_defineProperties(Constructor.prototype,protoProps),staticProps&&CallAgentDeclarative_defineProperties(Constructor,staticProps),Constructor}(ProxyCallAgent,[{key:"get",value:function get(target,prop){var _this2=this;switch(prop){case"startCall":return function(){var call=target.startCall.apply(target,arguments);return _this2.addCall(call),_this2.getOrCreateDeclarativeCall(call)};case"join":return function(){var call=target.join.apply(target,arguments);return _this2.addCall(call),_this2.getOrCreateDeclarativeCall(call)};case"calls":return Array.from(this._declarativeCalls.values());case"on":return function(){var isCallsUpdated="callsUpdated"===(arguments.length<=0?void 0:arguments[0]);if(isCallsUpdated){var listener=arguments.length<=1?void 0:arguments[1];_this2._externalCallsUpdatedListeners.add(listener)}else target.on.apply(target,arguments)};case"off":return function(){var isCallsUpdated="callsUpdated"===(arguments.length<=0?void 0:arguments[0]);if(isCallsUpdated){var listener=arguments.length<=1?void 0:arguments[1];_this2._externalCallsUpdatedListeners.delete(listener)}else target.off.apply(target,arguments)};case"dispose":return function(){return target.dispose().then((function(){_this2.unsubscribe()}))};default:return Reflect.get(target,prop)}}}]),ProxyCallAgent}(),CallAgentDeclarative_callAgentDeclaratify=function callAgentDeclaratify(callAgent,context,internalContext){return function disposeAllViews(context,internalContext){var _step3,_iterator3=StreamUtils_createForOfIteratorHelper(internalContext.getRemoteRenderInfos().entries());try{for(_iterator3.s();!(_step3=_iterator3.n()).done;)disposeAllViewsFromCall(context,internalContext,StreamUtils_slicedToArray(_step3.value,1)[0])}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}(context,internalContext),context.clearCallRelatedState(),internalContext.clearCallRelatedState(),new Proxy(callAgent,new CallAgentDeclarative_ProxyCallAgent(callAgent,context,internalContext))};function InternalCallContext_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var InternalCallContext=function(){function InternalCallContext(){!function InternalCallContext_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,InternalCallContext),this._remoteRenderInfos=void 0,this._localRenderInfos=void 0,this._unparentedRenderInfos=void 0,this._remoteRenderInfos=new Map,this._localRenderInfos=new Map,this._unparentedRenderInfos=new Map}return function InternalCallContext_createClass(Constructor,protoProps,staticProps){return protoProps&&InternalCallContext_defineProperties(Constructor.prototype,protoProps),staticProps&&InternalCallContext_defineProperties(Constructor,staticProps),Constructor}(InternalCallContext,[{key:"setCallId",value:function setCallId(newCallId,oldCallId){var remoteRenderInfos=this._remoteRenderInfos.get(oldCallId);remoteRenderInfos&&(this._remoteRenderInfos.delete(oldCallId),this._remoteRenderInfos.set(newCallId,remoteRenderInfos));var localRenderInfos=this._localRenderInfos.get(oldCallId);localRenderInfos&&(this._localRenderInfos.delete(oldCallId),this._localRenderInfos.set(newCallId,localRenderInfos))}},{key:"getRemoteRenderInfos",value:function getRemoteRenderInfos(){return this._remoteRenderInfos}},{key:"getRemoteRenderInfoForCall",value:function getRemoteRenderInfoForCall(callId){return this._remoteRenderInfos.get(callId)}},{key:"getRemoteRenderInfoForParticipant",value:function getRemoteRenderInfoForParticipant(callId,participantKey,streamId){var callRenderInfos=this._remoteRenderInfos.get(callId);if(callRenderInfos){var participantRenderInfos=callRenderInfos.get(participantKey);if(participantRenderInfos)return participantRenderInfos.get(streamId)}}},{key:"setRemoteRenderInfo",value:function setRemoteRenderInfo(callId,participantKey,streamId,stream,status,renderer){var callRenderInfos=this._remoteRenderInfos.get(callId);callRenderInfos||(callRenderInfos=new Map,this._remoteRenderInfos.set(callId,callRenderInfos));var participantRenderInfos=callRenderInfos.get(participantKey);participantRenderInfos||(participantRenderInfos=new Map,callRenderInfos.set(participantKey,participantRenderInfos)),participantRenderInfos.set(streamId,{stream:stream,status:status,renderer:renderer})}},{key:"deleteRemoteRenderInfo",value:function deleteRemoteRenderInfo(callId,participantKey,streamId){var callRenderInfos=this._remoteRenderInfos.get(callId);if(callRenderInfos){var participantRenderInfos=callRenderInfos.get(participantKey);participantRenderInfos&&participantRenderInfos.delete(streamId)}}},{key:"setLocalRenderInfo",value:function setLocalRenderInfo(callId,stream,status,renderer){this._localRenderInfos.set(callId,{stream:stream,status:status,renderer:renderer})}},{key:"getLocalRenderInfo",value:function getLocalRenderInfo(callId){return this._localRenderInfos.get(callId)}},{key:"deleteLocalRenderInfo",value:function deleteLocalRenderInfo(callId){this._localRenderInfos.delete(callId)}},{key:"getUnparentedRenderInfo",value:function getUnparentedRenderInfo(localVideoStream){return this._unparentedRenderInfos.get(localVideoStream)}},{key:"setUnparentedRenderInfo",value:function setUnparentedRenderInfo(statefulStream,stream,status,renderer){this._unparentedRenderInfos.set(statefulStream,{stream:stream,status:status,renderer:renderer})}},{key:"deleteUnparentedRenderInfo",value:function deleteUnparentedRenderInfo(localVideoStream){this._unparentedRenderInfos.delete(localVideoStream)}},{key:"clearCallRelatedState",value:function clearCallRelatedState(){this._remoteRenderInfos.clear(),this._localRenderInfos.clear()}}]),InternalCallContext}();function StatefulCallClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function StatefulCallClient_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){StatefulCallClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){StatefulCallClient_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function StatefulCallClient_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var StatefulCallClient_ProxyCallClient=function(){function ProxyCallClient(context,internalContext){!function StatefulCallClient_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ProxyCallClient),this._context=void 0,this._internalContext=void 0,this._callAgent=void 0,this._deviceManager=void 0,this._sdkDeviceManager=void 0,this._context=context,this._internalContext=internalContext}return function StatefulCallClient_createClass(Constructor,protoProps,staticProps){return protoProps&&StatefulCallClient_defineProperties(Constructor.prototype,protoProps),staticProps&&StatefulCallClient_defineProperties(Constructor,staticProps),Constructor}(ProxyCallClient,[{key:"get",value:function get(target,prop){var _this=this;switch(prop){case"createCallAgent":return StatefulCallClient_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var callAgent,_args=arguments;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,target.createCallAgent.apply(target,_args);case 2:return callAgent=_context.sent,_this._callAgent=CallAgentDeclarative_callAgentDeclaratify(callAgent,_this._context,_this._internalContext),_this._context.setCallAgent({displayName:_this._callAgent.displayName}),_context.abrupt("return",_this._callAgent);case 6:case"end":return _context.stop()}}),_callee)})));case"getDeviceManager":return StatefulCallClient_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var deviceManager;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,target.getDeviceManager();case 2:if(deviceManager=_context2.sent,!_this._sdkDeviceManager){_context2.next=11;break}if(_this._sdkDeviceManager!==deviceManager){_context2.next=8;break}return _context2.abrupt("return",_this._deviceManager);case 8:throw new Error("Multiple DeviceManager not supported. This means a incompatible version of communication-calling is used OR calling declarative was not properly updated to communication-calling version.");case 9:_context2.next=12;break;case 11:_this._sdkDeviceManager=deviceManager;case 12:return _this._deviceManager=deviceManagerDeclaratify(deviceManager,_this._context),_context2.abrupt("return",_this._deviceManager);case 14:case"end":return _context2.stop()}}),_callee2)})));default:return Reflect.get(target,prop)}}}]),ProxyCallClient}(),StatefulCallClient_createStatefulCallClient=function createStatefulCallClient(args,options){return StatefulCallClient_createStatefulCallClientWithDeps(new sdk_bundle.CallClient(null==options?void 0:options.callClientOptions),new CallContext_CallContext(args.userId,null==options?void 0:options.maxStateChangeListeners),new InternalCallContext)},StatefulCallClient_createStatefulCallClientWithDeps=function createStatefulCallClientWithDeps(callClient,context,internalContext){return Object.defineProperty(callClient,"getState",{configurable:!1,value:function value(){return context.getState()}}),Object.defineProperty(callClient,"onStateChange",{configurable:!1,value:function value(handler){return context.onStateChange(handler)}}),Object.defineProperty(callClient,"offStateChange",{configurable:!1,value:function value(handler){return context.offStateChange(handler)}}),Object.defineProperty(callClient,"createView",{configurable:!1,value:function value(callId,participantId,stream,options){return createView(context,internalContext,callId,participantId,stream,options)}}),Object.defineProperty(callClient,"disposeView",{configurable:!1,value:function value(callId,participantId,stream){disposeView(context,internalContext,callId,participantId,stream)}}),new Proxy(callClient,new StatefulCallClient_ProxyCallClient(context,internalContext))};function ParticipantSubcriber_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}var ParticipantSubcriber_ParticipantSubscriber=function(){function ParticipantSubscriber(participant,emitter){var _this=this;!function ParticipantSubcriber_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ParticipantSubscriber),this.participant=void 0,this.emitter=void 0,this.isMutedChangedHandler=function(){_this.emitter.emit("isMutedChanged",{participantId:_this.participant.identifier,isMuted:_this.participant.isMuted})},this.displayNameChangedHandler=function(){_this.emitter.emit("displayNameChanged",{participantId:_this.participant.identifier,displayName:_this.participant.displayName})},this.isSpeakingChangedHandler=function(){_this.emitter.emit("isSpeakingChanged",{participantId:_this.participant.identifier,isSpeaking:_this.participant.isSpeaking})},this.videoStreamsUpdatedHandler=function(event){_this.emitter.emit("videoStreamsUpdated",event)},this.participant=participant,this.emitter=emitter,this.subscribeParticipantEvents()}return function ParticipantSubcriber_createClass(Constructor,protoProps,staticProps){return protoProps&&ParticipantSubcriber_defineProperties(Constructor.prototype,protoProps),staticProps&&ParticipantSubcriber_defineProperties(Constructor,staticProps),Constructor}(ParticipantSubscriber,[{key:"subscribeParticipantEvents",value:function subscribeParticipantEvents(){this.participant.on("isMutedChanged",this.isMutedChangedHandler),this.participant.on("displayNameChanged",this.displayNameChangedHandler),this.participant.on("isSpeakingChanged",this.isSpeakingChangedHandler),this.participant.on("videoStreamsUpdated",this.videoStreamsUpdatedHandler)}},{key:"unsubscribeAll",value:function unsubscribeAll(){this.participant.off("isMutedChanged",this.isMutedChangedHandler),this.participant.off("displayNameChanged",this.displayNameChangedHandler),this.participant.off("isSpeakingChanged",this.isSpeakingChangedHandler),this.participant.off("videoStreamsUpdated",this.videoStreamsUpdatedHandler)}}]),ParticipantSubscriber}();function AzureCommunicationCallAdapter_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function AzureCommunicationCallAdapter_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return AzureCommunicationCallAdapter_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AzureCommunicationCallAdapter_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){function e(_x12){return _e.apply(this,arguments)}return e.toString=function(){return _e.toString()},e}((function(e){throw e})),f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){function e(_x13){return _e2.apply(this,arguments)}return e.toString=function(){return _e2.toString()},e}((function(e){didErr=!0,err=e})),f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function AzureCommunicationCallAdapter_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function AzureCommunicationCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function AzureCommunicationCallAdapter_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){AzureCommunicationCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){AzureCommunicationCallAdapter_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function AzureCommunicationCallAdapter_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function AzureCommunicationCallAdapter_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function AzureCommunicationCallAdapter_createClass(Constructor,protoProps,staticProps){return protoProps&&AzureCommunicationCallAdapter_defineProperties(Constructor.prototype,protoProps),staticProps&&AzureCommunicationCallAdapter_defineProperties(Constructor,staticProps),Constructor}var AzureCommunicationCallAdapter_CallContext=function(){function CallContext(clientState){var _clientState$callAgen;AzureCommunicationCallAdapter_classCallCheck(this,CallContext),this.emitter=new events.EventEmitter,this.state=void 0,this.callId=void 0,this.state={isLocalPreviewMicrophoneEnabled:!1,userId:clientState.userId,displayName:null===(_clientState$callAgen=clientState.callAgent)||void 0===_clientState$callAgen?void 0:_clientState$callAgen.displayName,devices:clientState.deviceManager,call:void 0,page:"configuration"}}return AzureCommunicationCallAdapter_createClass(CallContext,[{key:"onStateChange",value:function onStateChange(handler){this.emitter.on("stateChanged",handler)}},{key:"offStateChange",value:function offStateChange(handler){this.emitter.off("stateChanged",handler)}},{key:"setState",value:function setState(state){this.state=state,this.emitter.emit("stateChanged",this.state)}},{key:"getState",value:function getState(){return this.state}},{key:"setPage",value:function setPage(page){this.setState(Object.assign({},this.state,{page:page}))}},{key:"setError",value:function setError(error){this.setState(Object.assign({},this.state,{error:error}))}},{key:"setIsLocalMicrophoneEnabled",value:function setIsLocalMicrophoneEnabled(isLocalPreviewMicrophoneEnabled){this.setState(Object.assign({},this.state,{isLocalPreviewMicrophoneEnabled:isLocalPreviewMicrophoneEnabled}))}},{key:"setCallId",value:function setCallId(callId){this.callId=callId}},{key:"updateClientState",value:function updateClientState(clientState){var _clientState$callAgen2,call=this.callId?clientState.calls[this.callId]:void 0,endedCall=clientState.callsEnded.length>0?clientState.callsEnded[clientState.callsEnded.length-1]:void 0;this.setState(Object.assign({},this.state,{userId:clientState.userId,displayName:null===(_clientState$callAgen2=clientState.callAgent)||void 0===_clientState$callAgen2?void 0:_clientState$callAgen2.displayName,call:call,endedCall:endedCall,devices:clientState.deviceManager,isLocalPreviewMicrophoneEnabled:void 0===(null==call?void 0:call.isMuted)?this.state.isLocalPreviewMicrophoneEnabled:!(null!=call&&call.isMuted)}))}},{key:"setEndedCall",value:function setEndedCall(call){this.setState(Object.assign({},this.state,{endedCall:call}))}}]),CallContext}(),AzureCommunicationCallAdapter_AzureCommunicationCallAdapter=function(){function AzureCommunicationCallAdapter(callClient,locator,callAgent,deviceManager){var _this=this;AzureCommunicationCallAdapter_classCallCheck(this,AzureCommunicationCallAdapter),this.callClient=void 0,this.callAgent=void 0,this.deviceManager=void 0,this.localStream=void 0,this.locator=void 0,this.call=void 0,this.context=void 0,this.handlers=void 0,this.participantSubscribers=new Map,this.emitter=new events.EventEmitter,this.onClientStateChange=void 0,this.isMyMutedChanged=function(){var _this$call;_this.emitter.emit("isMutedChanged",{participantId:_this.getState().userId,isMuted:null===(_this$call=_this.call)||void 0===_this$call?void 0:_this$call.isMuted})},this.bindPublicMethods(),this.callClient=callClient,this.callAgent=callAgent,this.locator=locator,this.deviceManager=deviceManager,this.context=new AzureCommunicationCallAdapter_CallContext(callClient.getState());var onStateChange=function onStateChange(clientState){_this?_this.context.updateClientState(clientState):callClient.offStateChange(onStateChange)};this.handlers=createDefaultCallingHandlers(callClient,callAgent,deviceManager,void 0),this.onClientStateChange=onStateChange,this.callClient.onStateChange(onStateChange)}var _removeParticipant,_stopScreenShare,_startScreenShare,_unmute,_mute,_stopCamera,_startCamera,_onToggleCamera,_setSpeaker,_setMicrophone,_setCamera,_leaveCall,_disposeStreamView,_createStreamView,_askDevicePermission,_querySpeakers;return AzureCommunicationCallAdapter_createClass(AzureCommunicationCallAdapter,[{key:"bindPublicMethods",value:function bindPublicMethods(){this.onStateChange.bind(this),this.offStateChange.bind(this),this.getState.bind(this),this.dispose.bind(this),this.joinCall.bind(this),this.leaveCall.bind(this),this.setCamera.bind(this),this.setMicrophone.bind(this),this.setSpeaker.bind(this),this.askDevicePermission.bind(this),this.queryCameras.bind(this),this.queryMicrophones.bind(this),this.querySpeakers.bind(this),this.startCamera.bind(this),this.stopCamera.bind(this),this.onToggleCamera.bind(this),this.mute.bind(this),this.unmute.bind(this),this.startCall.bind(this),this.startScreenShare.bind(this),this.stopScreenShare.bind(this),this.removeParticipant.bind(this),this.setPage.bind(this),this.createStreamView.bind(this),this.disposeStreamView.bind(this),this.on.bind(this),this.off.bind(this)}},{key:"dispose",value:function dispose(){this.callClient.offStateChange(this.onClientStateChange),this.callAgent.dispose()}},{key:"isTeamsCall",value:function isTeamsCall(){return"meetingLink"in this.locator}},{key:"queryCameras",value:function queryCameras(){return this.deviceManager.getCameras()}},{key:"queryMicrophones",value:function queryMicrophones(){return this.deviceManager.getMicrophones()}},{key:"querySpeakers",value:(_querySpeakers=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",this.deviceManager.getSpeakers());case 1:case"end":return _context.stop()}}),_callee,this)}))),function querySpeakers(){return _querySpeakers.apply(this,arguments)})},{key:"askDevicePermission",value:(_askDevicePermission=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee2(constrain){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.deviceManager.askDevicePermission(constrain);case 2:case"end":return _context2.stop()}}),_callee2,this)}))),function askDevicePermission(_x){return _askDevicePermission.apply(this,arguments)})},{key:"joinCall",value:function joinCall(microphoneOn){var _this$getState$call$s,_this$getState$call;if(isInCall(null!==(_this$getState$call$s=null===(_this$getState$call=this.getState().call)||void 0===_this$getState$call?void 0:_this$getState$call.state)&&void 0!==_this$getState$call$s?_this$getState$call$s:"None"))throw new Error("You are already in the call!");var audioOptions={muted:null!=microphoneOn?microphoneOn:!this.getState().isLocalPreviewMicrophoneEnabled},videoOptions={localVideoStreams:this.localStream?[this.localStream]:void 0};this.locator;return this.call=this.callAgent.join(this.locator,{audioOptions:audioOptions,videoOptions:videoOptions}),this.context.setCallId(this.call.id),this.context.updateClientState(this.callClient.getState()),this.handlers=createDefaultCallingHandlers(this.callClient,this.callAgent,this.deviceManager,this.call),this.subscribeCallEvents(),this.call}},{key:"createStreamView",value:(_createStreamView=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee3(remoteUserId,options){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(void 0!==remoteUserId){_context3.next=5;break}return _context3.next=3,this.handlers.onCreateLocalStreamView(options);case 3:_context3.next=7;break;case 5:return _context3.next=7,this.handlers.onCreateRemoteStreamView(remoteUserId,options);case 7:case"end":return _context3.stop()}}),_callee3,this)}))),function createStreamView(_x2,_x3){return _createStreamView.apply(this,arguments)})},{key:"disposeStreamView",value:(_disposeStreamView=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee4(remoteUserId){return regeneratorRuntime.wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(void 0!==remoteUserId){_context4.next=5;break}return _context4.next=3,this.handlers.onDisposeLocalStreamView();case 3:_context4.next=7;break;case 5:return _context4.next=7,this.handlers.onDisposeRemoteStreamView(remoteUserId);case 7:case"end":return _context4.stop()}}),_callee4,this)}))),function disposeStreamView(_x4){return _disposeStreamView.apply(this,arguments)})},{key:"leaveCall",value:(_leaveCall=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee5(){var _this$call2,callId;return regeneratorRuntime.wrap((function _callee5$(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return callId=null===(_this$call2=this.call)||void 0===_this$call2?void 0:_this$call2.id,_context5.next=3,this.handlers.onHangUp();case 3:this.unsubscribeCallEvents(),this.call=void 0,this.handlers=createDefaultCallingHandlers(this.callClient,this.callAgent,this.deviceManager,void 0),this.context.setCallId(void 0),this.context.updateClientState(this.callClient.getState()),this.stopCamera(),this.mute(),this.emitter.emit("callEnded",{callId:callId});case 11:case"end":return _context5.stop()}}),_callee5,this)}))),function leaveCall(){return _leaveCall.apply(this,arguments)})},{key:"setCamera",value:(_setCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee6(device,options){return regeneratorRuntime.wrap((function _callee6$(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,this.handlers.onSelectCamera(device,options);case 2:case"end":return _context6.stop()}}),_callee6,this)}))),function setCamera(_x5,_x6){return _setCamera.apply(this,arguments)})},{key:"setMicrophone",value:(_setMicrophone=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee7(device){return regeneratorRuntime.wrap((function _callee7$(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,this.handlers.onSelectMicrophone(device);case 2:case"end":return _context7.stop()}}),_callee7,this)}))),function setMicrophone(_x7){return _setMicrophone.apply(this,arguments)})},{key:"setSpeaker",value:(_setSpeaker=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee8(device){return regeneratorRuntime.wrap((function _callee8$(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,this.handlers.onSelectSpeaker(device);case 2:case"end":return _context8.stop()}}),_callee8,this)}))),function setSpeaker(_x8){return _setSpeaker.apply(this,arguments)})},{key:"onToggleCamera",value:(_onToggleCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee9(options){return regeneratorRuntime.wrap((function _callee9$(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,this.handlers.onToggleCamera(options);case 2:case"end":return _context9.stop()}}),_callee9,this)}))),function onToggleCamera(_x9){return _onToggleCamera.apply(this,arguments)})},{key:"startCamera",value:(_startCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee10(){return regeneratorRuntime.wrap((function _callee10$(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(this.isCameraOn()){_context10.next=3;break}return _context10.next=3,this.handlers.onToggleCamera();case 3:case"end":return _context10.stop()}}),_callee10,this)}))),function startCamera(){return _startCamera.apply(this,arguments)})},{key:"stopCamera",value:(_stopCamera=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee11(){return regeneratorRuntime.wrap((function _callee11$(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(!this.isCameraOn()){_context11.next=3;break}return _context11.next=3,this.handlers.onToggleCamera();case 3:case"end":return _context11.stop()}}),_callee11,this)}))),function stopCamera(){return _stopCamera.apply(this,arguments)})},{key:"isCameraOn",value:function isCameraOn(){return this.call?!!this.call.localVideoStreams.find((function(stream){return"Video"===stream.mediaStreamType})):!!this.callClient.getState().deviceManager.selectedCamera&&AzureCommunicationCallAdapter_isPreviewOn(this.callClient.getState().deviceManager)}},{key:"mute",value:(_mute=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee12(){var _this$call3;return regeneratorRuntime.wrap((function _callee12$(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return this.call||this.context.setIsLocalMicrophoneEnabled(!1),_context12.next=3,null===(_this$call3=this.call)||void 0===_this$call3?void 0:_this$call3.mute();case 3:case"end":return _context12.stop()}}),_callee12,this)}))),function mute(){return _mute.apply(this,arguments)})},{key:"unmute",value:(_unmute=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee13(){var _this$call4;return regeneratorRuntime.wrap((function _callee13$(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return this.call||this.context.setIsLocalMicrophoneEnabled(!0),_context13.next=3,null===(_this$call4=this.call)||void 0===_this$call4?void 0:_this$call4.unmute();case 3:case"end":return _context13.stop()}}),_callee13,this)}))),function unmute(){return _unmute.apply(this,arguments)})},{key:"startScreenShare",value:(_startScreenShare=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee14(){var _this$call5;return regeneratorRuntime.wrap((function _callee14$(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:if(null!==(_this$call5=this.call)&&void 0!==_this$call5&&_this$call5.isScreenSharingOn){_context14.next=3;break}return _context14.next=3,this.handlers.onToggleScreenShare();case 3:case"end":return _context14.stop()}}),_callee14,this)}))),function startScreenShare(){return _startScreenShare.apply(this,arguments)})},{key:"stopScreenShare",value:(_stopScreenShare=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee15(){var _this$call6;return regeneratorRuntime.wrap((function _callee15$(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:if(null===(_this$call6=this.call)||void 0===_this$call6||!_this$call6.isScreenSharingOn){_context15.next=3;break}return _context15.next=3,this.handlers.onToggleScreenShare();case 3:case"end":return _context15.stop()}}),_callee15,this)}))),function stopScreenShare(){return _stopScreenShare.apply(this,arguments)})},{key:"startCall",value:function startCall(participants){var idsToAdd=participants.map((function(participant){return Object(src.a)(participant)}));return this.handlers.onStartCall(idsToAdd)}},{key:"removeParticipant",value:(_removeParticipant=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee16(userId){return regeneratorRuntime.wrap((function _callee16$(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:this.handlers.onParticipantRemove(userId);case 1:case"end":return _context16.stop()}}),_callee16,this)}))),function removeParticipant(_x10){return _removeParticipant.apply(this,arguments)})},{key:"getState",value:function getState(){return this.context.getState()}},{key:"onStateChange",value:function onStateChange(handler){this.context.onStateChange(handler)}},{key:"offStateChange",value:function offStateChange(handler){this.context.offStateChange(handler)}},{key:"on",value:function on(event,listener){this.emitter.on(event,listener)}},{key:"subscribeCallEvents",value:function subscribeCallEvents(){var _this$call7,_this$call8,_this$call9,_this$call10;null===(_this$call7=this.call)||void 0===_this$call7||_this$call7.on("remoteParticipantsUpdated",this.onRemoteParticipantsUpdated.bind(this)),null===(_this$call8=this.call)||void 0===_this$call8||_this$call8.on("isMutedChanged",this.isMyMutedChanged.bind(this)),null===(_this$call9=this.call)||void 0===_this$call9||_this$call9.on("isScreenSharingOnChanged",this.isScreenSharingOnChanged.bind(this)),null===(_this$call10=this.call)||void 0===_this$call10||_this$call10.on("idChanged",this.callIdChanged.bind(this))}},{key:"unsubscribeCallEvents",value:function unsubscribeCallEvents(){var _this$call11,_this$call12,_this$call13,_this$call14,_step,_iterator=AzureCommunicationCallAdapter_createForOfIteratorHelper(this.participantSubscribers.values());try{for(_iterator.s();!(_step=_iterator.n()).done;){_step.value.unsubscribeAll()}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.participantSubscribers.clear(),null===(_this$call11=this.call)||void 0===_this$call11||_this$call11.off("remoteParticipantsUpdated",this.onRemoteParticipantsUpdated.bind(this)),null===(_this$call12=this.call)||void 0===_this$call12||_this$call12.off("isMutedChanged",this.isMyMutedChanged.bind(this)),null===(_this$call13=this.call)||void 0===_this$call13||_this$call13.off("isScreenSharingOnChanged",this.isScreenSharingOnChanged.bind(this)),null===(_this$call14=this.call)||void 0===_this$call14||_this$call14.off("idChanged",this.callIdChanged.bind(this))}},{key:"setPage",value:function setPage(page){this.context.setPage(page)}},{key:"onRemoteParticipantsUpdated",value:function onRemoteParticipantsUpdated(_ref){var _this2=this,added=_ref.added,removed=_ref.removed;added&&added.length>0&&this.emitter.emit("participantsJoined",added),removed&&removed.length>0&&this.emitter.emit("participantsLeft",removed),added.forEach((function(participant){_this2.participantSubscribers.set(Object(src.d)(participant.identifier),new ParticipantSubcriber_ParticipantSubscriber(participant,_this2.emitter))})),removed.forEach((function(participant){var subscriber=_this2.participantSubscribers.get(Object(src.d)(participant.identifier));subscriber&&subscriber.unsubscribeAll(),_this2.participantSubscribers.delete(Object(src.d)(participant.identifier))}))}},{key:"isScreenSharingOnChanged",value:function isScreenSharingOnChanged(){var _this$call15;this.emitter.emit("isLocalScreenSharingActiveChanged",{isScreenSharingOn:null===(_this$call15=this.call)||void 0===_this$call15?void 0:_this$call15.isScreenSharingOn})}},{key:"callIdChanged",value:function callIdChanged(){var _this$call16;this.context.setCallId(null===(_this$call16=this.call)||void 0===_this$call16?void 0:_this$call16.id),this.context.updateClientState(this.callClient.getState()),this.emitter.emit("callIdChanged",{callId:this.callIdChanged.bind(this)})}},{key:"off",value:function off(event,listener){this.emitter.off(event,listener)}}]),AzureCommunicationCallAdapter}(),AzureCommunicationCallAdapter_isPreviewOn=function isPreviewOn(deviceManager){return deviceManager.unparentedViews.length>0&&void 0!==deviceManager.unparentedViews[0].view},createAzureCommunicationCallAdapter=function(){var _ref3=AzureCommunicationCallAdapter_asyncToGenerator(regeneratorRuntime.mark((function _callee17(_ref2){var userId,displayName,credential,locator,callClientOptions,callClient,deviceManager,callAgent,adapter;return regeneratorRuntime.wrap((function _callee17$(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:return userId=_ref2.userId,displayName=_ref2.displayName,credential=_ref2.credential,locator=_ref2.locator,callClientOptions=_ref2.callClientOptions,callClient=StatefulCallClient_createStatefulCallClient({userId:userId},{callClientOptions:callClientOptions}),_context17.next=4,callClient.getDeviceManager();case 4:return deviceManager=_context17.sent,_context17.next=7,callClient.createCallAgent(credential,{displayName:displayName});case 7:return callAgent=_context17.sent,adapter=new AzureCommunicationCallAdapter_AzureCommunicationCallAdapter(callClient,locator,callAgent,deviceManager),_context17.abrupt("return",adapter);case 10:case"end":return _context17.stop()}}),_callee17)})));return function createAzureCommunicationCallAdapter(_x11){return _ref3.apply(this,arguments)}}(),CommandBarButton=__webpack_require__(1721),SidePane_styles_palette=Object(lib.B)().palette,sidePaneContainerStyles={root:{height:"100%",paddingTop:"0.5rem",paddingBottom:"0.5rem",width:"21.5rem"}},sidePaneContainerHiddenStyles={root:Object.assign({},sidePaneContainerStyles,{display:"none"})},sidePaneContainerTokens={childrenGap:"0.5rem"},sidePaneHeaderStyles={root:{fontSize:"0.825rem",lineHeight:"1.25rem",padding:"0.25rem",fontWeight:"600"}},sidePaneCloseButtonStyles={icon:{color:SidePane_styles_palette.neutralSecondary},iconHovered:{color:SidePane_styles_palette.neutralSecondary},iconPressed:{color:SidePane_styles_palette.neutralSecondary}},paneBodyContainer={root:{flexDirection:"column",display:"flex"}},scrollableContainer={root:{flexBasis:"0",flexGrow:"1",overflowY:"auto"}},scrollableContainerContents={root:{flexGrow:"1",flexBasis:"0"}},peopleSubheadingStyle={root:{fontSize:"0.75rem",color:SidePane_styles_palette.neutralSecondary}},peoplePaneContainerTokens={childrenGap:"0.5rem"},copy_to_clipboard=__webpack_require__(281),copy_to_clipboard_default=__webpack_require__.n(copy_to_clipboard);function SidePane_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SidePane_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SidePane_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SidePane_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var SidePane_SidePane=function SidePane(props){var sidePaneStyles=props.hidden?sidePaneContainerHiddenStyles:sidePaneContainerStyles;return Object(jsx_runtime.jsx)(Stack.a.Item,{disableShrink:!0,verticalFill:!0,styles:sidePaneStyles,tokens:sidePaneContainerTokens,children:Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"space-between",styles:sidePaneHeaderStyles,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{children:props.headingText}),Object(jsx_runtime.jsx)(CommandBarButton.a,{styles:sidePaneCloseButtonStyles,iconProps:{iconName:"cancel"},onClick:props.onClose})]}),Object(jsx_runtime.jsx)(Stack.a.Item,{verticalFill:!0,grow:!0,styles:paneBodyContainer,children:Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,styles:scrollableContainer,children:Object(jsx_runtime.jsx)(Stack.a.Item,{verticalFill:!0,styles:scrollableContainerContents,children:props.children})})})]})})};SidePane_SidePane.displayName="SidePane";var removeParticipantFromMeeting=function(){var _ref=SidePane_asyncToGenerator(regeneratorRuntime.mark((function _callee(callAdapter,chatAdapter,participantId){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,callAdapter.removeParticipant(participantId);case 2:return _context.next=4,chatAdapter.removeParticipant(participantId);case 4:case"end":return _context.stop()}}),_callee)})));return function removeParticipantFromMeeting(_x,_x2,_x3){return _ref.apply(this,arguments)}}(),SidePane_EmbeddedPeoplePane=function EmbeddedPeoplePane(props){var callAdapter=props.callAdapter,chatAdapter=props.chatAdapter,inviteLink=props.inviteLink,participantListDefaultProps=CallComposite_hooks_usePropsFor_usePropsFor(react_components_src.o),participantListProps=Object(react.useMemo)((function(){var onParticipantRemove=function(){var _ref2=SidePane_asyncToGenerator(regeneratorRuntime.mark((function _callee2(participantId){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",removeParticipantFromMeeting(callAdapter,chatAdapter,participantId));case 1:case"end":return _context2.stop()}}),_callee2)})));return function onParticipantRemove(_x4){return _ref2.apply(this,arguments)}}();return Object.assign({},participantListDefaultProps,{onParticipantRemove:onParticipantRemove})}),[participantListDefaultProps,callAdapter,chatAdapter]);return Object(jsx_runtime.jsx)(SidePane_SidePane,{hidden:props.hidden,headingText:"People",onClose:props.onClose,children:Object(jsx_runtime.jsxs)(Stack.a,{tokens:peoplePaneContainerTokens,children:[inviteLink&&Object(jsx_runtime.jsx)(DefaultButton.a,{text:"Copy invite link",iconProps:{iconName:"Link"},onClick:function onClick(){return copy_to_clipboard_default()(inviteLink)}}),Object(jsx_runtime.jsx)(Stack.a.Item,{styles:peopleSubheadingStyle,children:"In this call"}),Object(jsx_runtime.jsx)(react_components_src.o,Object.assign({},participantListProps))]})})};SidePane_EmbeddedPeoplePane.displayName="EmbeddedPeoplePane";var SidePane_EmbeddedChatPane=function EmbeddedChatPane(props){return Object(jsx_runtime.jsx)(SidePane_SidePane,{hidden:props.hidden,headingText:"Chat",onClose:props.onClose,children:Object(jsx_runtime.jsx)(ChatComposite_ChatComposite,{adapter:props.chatAdapter,fluentTheme:props.fluentTheme})})};SidePane_EmbeddedChatPane.displayName="EmbeddedChatPane",SidePane_EmbeddedPeoplePane.__docgenInfo={description:"",methods:[],displayName:"EmbeddedPeoplePane",props:{inviteLink:{required:!1,tsType:{name:"string"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},hidden:{required:!0,tsType:{name:"boolean"},description:""},callAdapter:{required:!0,tsType:{name:"CallAdapter"},description:""},chatAdapter:{required:!0,tsType:{name:"ChatAdapter"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/MeetingComposite/SidePane.tsx"]={name:"EmbeddedPeoplePane",docgenInfo:SidePane_EmbeddedPeoplePane.__docgenInfo,path:"../react-composites/src/composites/MeetingComposite/SidePane.tsx"}),SidePane_EmbeddedChatPane.__docgenInfo={description:"",methods:[],displayName:"EmbeddedChatPane",props:{chatAdapter:{required:!0,tsType:{name:"ChatAdapter"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},hidden:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/MeetingComposite/SidePane.tsx"]={name:"EmbeddedChatPane",docgenInfo:SidePane_EmbeddedChatPane.__docgenInfo,path:"../react-composites/src/composites/MeetingComposite/SidePane.tsx"});var Chat20Filled=__webpack_require__(1683),Chat20Regular=__webpack_require__(1684),ChatButton_onRenderOnIcon=function onRenderOnIcon(){return Object(jsx_runtime.jsx)(Chat20Filled.a,{primaryFill:"currentColor"},"chatOnIconKey")};ChatButton_onRenderOnIcon.displayName="onRenderOnIcon";var ChatButton_onRenderOffIcon=function onRenderOffIcon(){return Object(jsx_runtime.jsx)(Chat20Regular.a,{primaryFill:"currentColor"},"chatOffIconKey")};ChatButton_onRenderOffIcon.displayName="onRenderOffIcon";var ChatButton_ChatButton=function ChatButton(props){var _props$onRenderOnIcon,_props$onRenderOffIco,strings=Object.assign({label:"Chat"},props.strings);return Object(jsx_runtime.jsx)(react_components_src.c,Object.assign({},props,{strings:strings,onRenderOnIcon:null!==(_props$onRenderOnIcon=props.onRenderOnIcon)&&void 0!==_props$onRenderOnIcon?_props$onRenderOnIcon:ChatButton_onRenderOnIcon,onRenderOffIcon:null!==(_props$onRenderOffIco=props.onRenderOffIcon)&&void 0!==_props$onRenderOffIco?_props$onRenderOffIco:ChatButton_onRenderOffIcon,onClick:props.onClick}))};ChatButton_ChatButton.displayName="ChatButton",ChatButton_ChatButton.__docgenInfo={description:"",methods:[],displayName:"ChatButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/MeetingComposite/ChatButton.tsx"]={name:"ChatButton",docgenInfo:ChatButton_ChatButton.__docgenInfo,path:"../react-composites/src/composites/MeetingComposite/ChatButton.tsx"});var People20Filled=__webpack_require__(1678),People20Regular=__webpack_require__(1685),PeopleButton_onRenderOnIcon=function onRenderOnIcon(){return Object(jsx_runtime.jsx)(People20Filled.a,{primaryFill:"currentColor"},"peopleOnIconKey")};PeopleButton_onRenderOnIcon.displayName="onRenderOnIcon";var PeopleButton_onRenderOffIcon=function onRenderOffIcon(){return Object(jsx_runtime.jsx)(People20Regular.a,{primaryFill:"currentColor"},"peopleOffIconKey")};PeopleButton_onRenderOffIcon.displayName="onRenderOffIcon";var PeopleButton_PeopleButton=function PeopleButton(props){var _props$onRenderOnIcon,_props$onRenderOffIco,strings=Object.assign({label:"People"},props.strings);return Object(jsx_runtime.jsx)(react_components_src.c,Object.assign({},props,{strings:strings,onRenderOnIcon:null!==(_props$onRenderOnIcon=props.onRenderOnIcon)&&void 0!==_props$onRenderOnIcon?_props$onRenderOnIcon:PeopleButton_onRenderOnIcon,onRenderOffIcon:null!==(_props$onRenderOffIco=props.onRenderOffIcon)&&void 0!==_props$onRenderOffIco?_props$onRenderOffIco:PeopleButton_onRenderOffIcon,onClick:props.onClick}))};PeopleButton_PeopleButton.displayName="PeopleButton",PeopleButton_PeopleButton.__docgenInfo={description:"",methods:[],displayName:"PeopleButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/MeetingComposite/PeopleButton.tsx"]={name:"PeopleButton",docgenInfo:PeopleButton_PeopleButton.__docgenInfo,path:"../react-composites/src/composites/MeetingComposite/PeopleButton.tsx"});var MeetingCallControlBar_MeetingCallControlBar=function MeetingCallControlBar(props){return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,children:Object(jsx_runtime.jsx)(CallAdapterProvider_CallAdapterProvider,{adapter:props.callAdapter,children:Object(jsx_runtime.jsx)(CallControls_CallControls,{onEndCallClick:props.onEndCallClick,showParticipantsControl:!1})})}),Object(jsx_runtime.jsxs)(Stack.a.Item,{children:[Object(jsx_runtime.jsx)(ChatButton_ChatButton,{checked:props.chatButtonChecked,showLabel:!0,onClick:props.onChatButtonClicked}),Object(jsx_runtime.jsx)(PeopleButton_PeopleButton,{checked:props.peopleButtonChecked,showLabel:!0,onClick:props.onPeopleButtonClicked})]})]})};MeetingCallControlBar_MeetingCallControlBar.displayName="MeetingCallControlBar",MeetingCallControlBar_MeetingCallControlBar.__docgenInfo={description:"",methods:[],displayName:"MeetingCallControlBar",props:{callAdapter:{required:!0,tsType:{name:"CallAdapter"},description:""},onEndCallClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},chatButtonChecked:{required:!0,tsType:{name:"boolean"},description:""},peopleButtonChecked:{required:!0,tsType:{name:"boolean"},description:""},onChatButtonClicked:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onPeopleButtonClicked:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/MeetingComposite/MeetingCallControlBar.tsx"]={name:"MeetingCallControlBar",docgenInfo:MeetingCallControlBar_MeetingCallControlBar.__docgenInfo,path:"../react-composites/src/composites/MeetingComposite/MeetingCallControlBar.tsx"});var compositeOuterContainerStyles={root:{width:"100%"}};function MeetingComposite_slicedToArray(arr,i){return function MeetingComposite_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MeetingComposite_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MeetingComposite_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MeetingComposite_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MeetingComposite_arrayLikeToArray(o,minLen)}(arr,i)||function MeetingComposite_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MeetingComposite_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MeetingComposite_MeetingComposite=function MeetingComposite(props){var callAdapter=props.callAdapter,chatAdapter=props.chatAdapter,fluentTheme=props.fluentTheme,_useState2=MeetingComposite_slicedToArray(Object(react.useState)(),2),currentCallState=_useState2[0],setCurrentCallState=_useState2[1],_useState4=MeetingComposite_slicedToArray(Object(react.useState)(),2),currentPage=_useState4[0],setCurrentPage=_useState4[1];callAdapter.onStateChange((function(newState){var _newState$call;setCurrentPage(newState.page),setCurrentCallState(null===(_newState$call=newState.call)||void 0===_newState$call?void 0:_newState$call.state)}));var hasJoinedCall="call"===currentPage&&currentCallState&&!["Connecting","Ringing","InLobby"].includes(currentCallState),_useState6=MeetingComposite_slicedToArray(Object(react.useState)(!1),2),showChat=_useState6[0],setShowChat=_useState6[1],_useState8=MeetingComposite_slicedToArray(Object(react.useState)(!1),2),showPeople=_useState8[0],setShowPeople=_useState8[1],closePane=Object(react.useCallback)((function(){setShowChat(!1),setShowPeople(!1)}),[]),toggleChat=Object(react.useCallback)((function(){setShowPeople(!1),setShowChat(!showChat)}),[showChat]),togglePeople=Object(react.useCallback)((function(){setShowChat(!1),setShowPeople(!showPeople)}),[showPeople]);return Object(jsx_runtime.jsx)(react_components_src.f,{fluentTheme:props.fluentTheme,children:Object(jsx_runtime.jsxs)(Stack.a,{verticalFill:!0,grow:!0,styles:compositeOuterContainerStyles,children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,grow:!0,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,children:Object(jsx_runtime.jsx)(Call_CallCompositeInternal,{showCallControls:!1,adapter:callAdapter,fluentTheme:fluentTheme})}),chatAdapter&&Object(jsx_runtime.jsx)(SidePane_EmbeddedChatPane,{hidden:!showChat,chatAdapter:chatAdapter,fluentTheme:props.fluentTheme,onClose:closePane}),callAdapter&&chatAdapter&&Object(jsx_runtime.jsx)(CallAdapterProvider_CallAdapterProvider,{adapter:callAdapter,children:Object(jsx_runtime.jsx)(SidePane_EmbeddedPeoplePane,{hidden:!showPeople,inviteLink:props.meetingInvitationURL,onClose:closePane,chatAdapter:chatAdapter,callAdapter:callAdapter})})]}),hasJoinedCall&&Object(jsx_runtime.jsx)(MeetingCallControlBar_MeetingCallControlBar,{callAdapter:callAdapter,chatButtonChecked:showChat,onChatButtonClicked:toggleChat,peopleButtonChecked:showPeople,onPeopleButtonClicked:togglePeople,onEndCallClick:function endCallClick(){callAdapter.setPage("configuration")}})]})})};MeetingComposite_MeetingComposite.displayName="MeetingComposite",MeetingComposite_MeetingComposite.__docgenInfo={description:"Meeting Composite brings together key components to provide a full meeting experience out of the box.",methods:[],displayName:"MeetingComposite",props:{callAdapter:{required:!0,tsType:{name:"CallAdapter"},description:""},chatAdapter:{required:!0,tsType:{name:"ChatAdapter"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Fluent theme for the composite.\n\nDefaults to a light theme if undefined."},meetingInvitationURL:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-composites/src/composites/MeetingComposite/MeetingComposite.tsx"]={name:"MeetingComposite",docgenInfo:MeetingComposite_MeetingComposite.__docgenInfo,path:"../react-composites/src/composites/MeetingComposite/MeetingComposite.tsx"})},1298:function(module,exports,__webpack_require__){"use strict";(function(module){(0,__webpack_require__(613).configure)([__webpack_require__(1299),__webpack_require__(1385)],module,!1)}).call(this,__webpack_require__(368)(module))},1299:function(module,exports,__webpack_require__){var map={"./Accessibility.stories.mdx":1300,"./CustomUserDataModel.stories.mdx":1301,"./Feedback.stories.mdx":1302,"./IdentityManagement/IdentityManagement.stories.mdx":1501,"./Localization.stories.mdx":1478,"./NonReact/NonReactComposites.stories.mdx":1374,"./Overview.stories.mdx":1375,"./QuickStarts/QuickstartComposite.stories.mdx":1502,"./QuickStarts/QuickstartStateful.stories.mdx":1487,"./QuickStarts/QuickstartUIComponents.stories.mdx":1480,"./Stateful Client/Adapters.stories.mdx":1376,"./Stateful Client/BestPractices.stories.mdx":1379,"./Stateful Client/OverviewStateful.stories.mdx":1380,"./Stateful Client/SettingUpReactHooks.stories.mdx":1381,"./Stateful Client/UsePropsForHook.stories.mdx":1382,"./Stateful Client/UseSelector.stories.mdx":1383,"./Styling/Styling.stories.mdx":1503,"./Theming.stories.mdx":1484,"./UseCases.stories.mdx":1384};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1299},13:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"j",(function(){return mediaGalleryWidthOptions})),__webpack_require__.d(__webpack_exports__,"i",(function(){return mediaGalleryWidthDefault})),__webpack_require__.d(__webpack_exports__,"h",(function(){return mediaGalleryHeightOptions})),__webpack_require__.d(__webpack_exports__,"g",(function(){return mediaGalleryHeightDefault})),__webpack_require__.d(__webpack_exports__,"f",(function(){return compositeExperienceContainerStyle})),__webpack_require__.d(__webpack_exports__,"a",(function(){return COMPONENT_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"b",(function(){return COMPOSITE_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"c",(function(){return EXAMPLES_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"d",(function(){return QUICKSTARTS_FOLDER_PREFIX})),__webpack_require__.d(__webpack_exports__,"e",(function(){return STATEFUL_CLIENT_PREFIX}));var mediaGalleryWidthOptions={range:!0,min:500,max:1e3,step:10},mediaGalleryWidthDefault=600,mediaGalleryHeightOptions={range:!0,min:500,max:1e3,step:10},mediaGalleryHeightDefault=500,compositeExperienceContainerStyle={root:{width:"90vw",height:"90vh"}},COMPONENT_FOLDER_PREFIX="UI Components",COMPOSITE_FOLDER_PREFIX="Composites",EXAMPLES_FOLDER_PREFIX="Examples",QUICKSTARTS_FOLDER_PREFIX="Quickstarts",STATEFUL_CLIENT_PREFIX="Stateful Client"},1300:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"accessibility",title:"Accessibility",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"accessibility"},"Accessibility"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Accessibility by design is a principle across Microsoft products.\nUI Library follows this principle in making sure that all UI Components are fully accessible.\nDuring public preview, the UI Library will continue to improve and add accessibility feature to the UI Components.\nWe expect to add more details on accessibility ahead of the UI Library being in General Availability."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Accessibility",id:"accessibility",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1301:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"customuserdatamodel",title:"Custom User Data Model",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"custom-user-data-model"},"Custom User Data Model"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Azure Communication Services uses an identity agnostic model where developers can ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/identity-model",target:"_blank",rel:"nofollow noopener noreferrer"},"bring their own identities"),".\nDevelopers can bring their own data model and link it to Azure Communication Services identities.\nA developers data model for a user most likely includes information such as their display name, profile picture or avatar and other details. Information used by developers to power their own applications and platforms.\nThe UI Library makes it simple for developers to inject that user data model into the UI Components, so that when rendered they show a users provided information rather than generic information that Azure Communication Services has.\nUI Library enables these capabilities for both UI Components and Composites. Below, we will introduce the patterns to customize user data model for both types of components."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"ui-components"},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For UI Components, user data model can be customized for each individual component.\nThis provides developers the most flexibility when building truly custom experiences that might expose and reflect different parts of a users persona.\nUser data model injection is available for those components that expose user information, particularly their display name and their avatar.\nBelow you will find a table with the components that support injection and the pattern/method used to inject information."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Display Name"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Avatar"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-videotile--video-tile"},"Video Tile")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"displayName"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"placeholder")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-videogallery--video-gallery"},"Video Gallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderRemoteVideoTile and onRenderLocalVideoTile"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-messagethread--message-thread"},"Message Thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderMessage"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-typingindicator--typing-indicator"},"Typing Indicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderUsers"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderUsers")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-participantitem--participant-item"},"Participant Item")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"displayName"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-participantlist--participant-list"},"Participant List")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderParticipant"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderAvatar")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For additional examples on how this user data model injection pattern works, visit the individual component pages for each component."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"composites"},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For Composites, user data model can be customized at a composite level.\nAs turn-key experience, developers can provide a single data model mapping to the composite and the composite takes care of rendering the correct information for a user.\nComposites support user data model injection for display name and avatar across both chat and calling composites."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Composite"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Display Name"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Avatar"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/composites-call-basicexample--basic-example"},"CallComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"displayName"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"onRenderAvatar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/composites-chat-basicexample--basic-example"},"ChatComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/docs/composites-chat-basicexample--basic-example#custom-data-model"},"displayName")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/docs/composites-chat-basicexample--basic-example#custom-data-model"},"onRenderAvatar"))))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For additional examples on how this user data model injection pattern works, visit the individual composite pages."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Custom User Data Model",id:"customuserdatamodel",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1302:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"feedback",title:"Feedback",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"feedback"},"Feedback"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"In order to improve the UI Library for Azure Communication Services we need your feedback!\nThere are various ways for you to provide feedback of your experience and help us make the UI Library better."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"contributing-to-ui-library"},"Contributing to UI Library"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If there is a feature or bug you find and you are intersted in contributing directly to our code base please refer to our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/blob/main/docs/contributing-guide/1.%20getting-set-up.md",target:"_blank",rel:"nofollow noopener noreferrer"},"contribution guide"),".\nWe encourage developers to feel welcomed into the code base and directly contribute."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"github-issues"},"GitHub Issues"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"File feature requests, bugs or other issues against the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/issues",target:"_blank",rel:"nofollow noopener noreferrer"},"UI Library GitHub Repo"),".\nTo help us get to your issue faster use the GitHub labels provided.\nA team member will look to help out with outstanding issues and navigate them to the right owner.\nIssues on this repo should only be related to the UI Library. Issues for Azure Communication Services generally should be added to the main ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication",target:"_blank",rel:"nofollow noopener noreferrer"},"repo"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"microsoft-qa"},"Microsoft QA"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For any questions on UI Library or Azure Communication Services, use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/answers/topics/azure-communication-services.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Microsoft QA"),".\nThere use the tag ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"azure-communication-services")," for the question to be funneled to our team."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"uservoice"},"UserVoice"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For feedback on the UI Library or Azure Communication Services, use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://feedback.azure.com/forums/934536-azure-communication-services",target:"_blank",rel:"nofollow noopener noreferrer"},"UserVoice"),".\nMake sure to use the Azure Communication Services UserVoice and use the category ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"UI Library")," so that its indexed correctly."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Feedback",id:"feedback",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},133:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return addParrotBotToThread})),__webpack_require__.d(__webpack_exports__,"a",(function(){return ConfigHintBanner})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ConfigJoinChatThreadHintBanner}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(90),__webpack_require__(87),__webpack_require__(179),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(93),__webpack_require__(53),__webpack_require__(83),__webpack_require__(520);var _azure_communication_chat__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(444),_azure_communication_common__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(201),_azure_communication_identity__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(445),_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_16__=(__webpack_require__(0),__webpack_require__(169)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var addParrotBotToThread=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(resourceConnectionString,token,threadId,messages){var tokenClient,bot,endpointUrl,chatClient;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return tokenClient=new _azure_communication_identity__WEBPACK_IMPORTED_MODULE_14__.a(resourceConnectionString),_context.next=3,tokenClient.createUserAndToken(["chat"]);case 3:return bot=_context.sent,endpointUrl=new URL(resourceConnectionString.replace("endpoint=","").split(";")[0]).toString(),chatClient=new _azure_communication_chat__WEBPACK_IMPORTED_MODULE_12__.a(endpointUrl,new _azure_communication_common__WEBPACK_IMPORTED_MODULE_13__.a(token)),_context.next=8,chatClient.getChatThreadClient(threadId).addParticipants({participants:[{id:bot.user,displayName:"A simple bot"}]});case 8:return sendMessagesAsBot(bot.token,endpointUrl,threadId,messages),_context.abrupt("return",bot);case 10:case"end":return _context.stop()}}),_callee)})));return function addParrotBotToThread(_x,_x2,_x3,_x4){return _ref.apply(this,arguments)}}(),sendMessagesAsBot=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(token,envUrl,threadId,messages){var chatClient,threadClient,index;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return chatClient=new _azure_communication_chat__WEBPACK_IMPORTED_MODULE_12__.a(envUrl,new _azure_communication_common__WEBPACK_IMPORTED_MODULE_13__.a(token)),_context2.next=3,chatClient.getChatThreadClient(threadId);case 3:threadClient=_context2.sent,index=0,messages.length>0&&threadClient.sendMessage({content:messages[index++]}),setInterval((function(){index<messages.length&&threadClient.sendMessage({content:messages[index++]})}),5e3);case 7:case"end":return _context2.stop()}}),_callee2)})));return function sendMessagesAsBot(_x5,_x6,_x7,_x8){return _ref2.apply(this,arguments)}}(),ConfigHintBanner=function ConfigHintBanner(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_16__.b)(["Please provide the connection string and display name to use."])})},ConfigJoinChatThreadHintBanner=function ConfigJoinChatThreadHintBanner(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_17__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_16__.b)(["Please provide a token, thread id, endpoint url, and display name to use."])})};ConfigHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/Utils.tsx"]={name:"ConfigHintBanner",docgenInfo:ConfigHintBanner.__docgenInfo,path:"stories/ChatComposite/snippets/Utils.tsx"}),ConfigJoinChatThreadHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigJoinChatThreadHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/Utils.tsx"]={name:"ConfigJoinChatThreadHintBanner",docgenInfo:ConfigJoinChatThreadHintBanner.__docgenInfo,path:"stories/ChatComposite/snippets/Utils.tsx"})},1374:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"use-composite-in-non-react-environment",title:"Composites/Using Composites in a non-react environment",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"use-composites-under-non-react-environment"},"Use composites under non-react environment"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If you are not using React, you can still embed a calling/chat composite into your html page with a simple ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"<script>")," tag and several lines of code like:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"You can easily find prebuilt bundles from:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/releases/latest/download/chatComposite.js",target:"_blank",rel:"nofollow noopener noreferrer"},"The latest bundles for chat composite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/releases/latest/download/callComposite.js",target:"_blank",rel:"nofollow noopener noreferrer"},"The latest bundles for call composite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For development and prototyping purpose, import these 2 urls with ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"<script>")," tags will be the fastest way. In production environment, we recommend that serving composite files on your own CDN will help with performance."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-composites-in-html"},"Use Composites in html"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"After importing chat/calling composite bundle, you are able to load composites using these 2 code snippets:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"  const chatAdapter =   The for composite which allows you control composite externally,\n    await chatComposite.loadChatComposite( // This function will be exposed to window.chatComposite once you import composite bundle\n      {\n        displayName, // string\n        threadId, // string\n        endpointUrl, // string\n        userId, // Object { communicationUserId: string }\n        token // string\n      },\n      elementToRender, // Container element\n      props // Optional, Object contains all optional props for composite, check composite page for more details\n    )\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"  const callAdapter =   The for composite which allows you control composite externally,\n    await callComposite.loadChatComposite( // This function will be exposed to window.callComposite once you import composite bundle\n      {\n          groupId, // string, Provide any GUID to join a group\n          displayName, // string\n          userId, // Object { communicationUserId: string }\n          token // string\n      },\n      elementToRender, // container element\n      props // Optional, Object contains all optional props for composite, check composite page for more details\n    )\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/composites-chat-basicexample--basic-example"},"Chat Composite Basic Example")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/composites-call-basicexample--basic-example"},"Call Composite Basic Example")," to see optional props of composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For more details of adapter, check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/story/statefulclient-reacthooks-adapters--page"},"Adapters for Composites")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"example-html-code"},"Example html code"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://github.com/Azure/communication-ui-library/blob/PublicPreview/1.0.0-beta.3/samples/StaticHtmlComposites/index.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Example")," for more detailed example of using calling/chat composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-html"},'\x3c!-- Replace this url with your own CDN in production environment --\x3e\n<script src="https://github.com/Azure/communication-ui-library/releases/latest/download/callComposite.js"><\/script>\n\x3c!-- height need to be set for composite to fit the layout --\x3e\n<div id="chat-container" style="height: 50vh"></div>\n<script>\n  const chatAdapter = await chatComposite.loadChatComposite(\n    {\n      displayName: displayName,\n      threadId: threadId,\n      endpointUrl: endpointUrl,\n      userId: user,\n      token: token\n    },\n    document.getElementById(\'chat-container\')\n  );\n<\/script>\n')),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"build-your-own-composite-js-bundle-files"},"Build your own composite js bundle files:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"git-clone-our-repo"},"git clone our repo"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"git clone https://github.com/Azure/communication-ui-library.git\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"install-packages-and-build-js-bundles"},"install packages and build js bundles"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"cd communication-ui-library\\samples\\StaticHtmlComposites\\\nrush install\nrush build\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Then you will be able to see 2 js bundle files:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre"},".\\samples\\StaticHtmlComposites\\dist\\chatComposite.js\n.\\samples\\StaticHtmlComposites\\dist\\callComposite.js\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"There is also an example html for how to use it, you might want to allocate your own acs token before you embed the code piece to your own web app, check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create and manage Communication Services resources"),":"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre"},".\\samples\\StaticHtmlComposites\\index.html\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"try-it-the-sample"},"try it the sample"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"After finishing building the bundle, you can also try the sample"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},"Replace the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ResourceConnectionString")," in the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"samples/Server/appsettings.json")," file with the connection string from your Azure Communication Services resource, which is listed in the Azure Portal under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Keys"),".")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},"Run this command to start the server:"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"rushx start\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",{start:3},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Browse to http://localhost:3000")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Composites/Using Composites in a non-react environment",id:"use-composite-in-non-react-environment",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1375:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_fluentui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(99),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"overview",title:"Overview",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{horizontal:!0,horizontalAlign:"space-between",style:{backgroundColor:"#EFF6FC",padding:"2.25rem"},mdxType:"Stack"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{style:{fontFamily:'"Segoe UI", sans-serif',color:"rgba(0,0,0,.5)",fontSize:"1.125rem",fontWeight:"500",border:"none",margin:"0rem 0rem 0.25rem 0rem",lineHeight:"1.5rem"}},"Azure Communication Services"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{style:{fontFamily:'"Segoe UI", sans-serif',color:"#0078D4",fontWeight:"600",fontSize:"2rem",margin:"0rem",lineHeight:"2.5rem"}},"UI Library")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a.Item,{align:"center"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{src:"images/hero.svg",alt:"UI Library Hero Image",style:{maxHeight:"18.75rem"}}))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Azure Communication Services - UI Library makes it easy for you to build modern communications user experiences using Azure Communication Services.\nIt gives you a library of production-ready UI components that you can drop into your applications:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"p"},"Composites")," - These components are turn-key solutions that implement common communication scenarios.\nYou can quickly add video calling or chat experiences to your applications.\nComposites are open-source higher order components built using UI components.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"p"},"UI Components")," - These components are open-source building blocks that let you build custom communications experience.\nComponents are offered for both calling and chat capabilities that can be combined to build experiences."))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"These UI client libraries all use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://developer.microsoft.com/fluentui/",target:"_blank",rel:"nofollow noopener noreferrer"},"Microsoft's Fluent design language")," and assets. Fluent UI provides a foundational layer for the UI Library and is actively used across Microsoft products."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"In conjunction to the UI components, the UI Library exposes a ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"stateful client library")," for calling and chat.\nThis client is agnostic to any specific state management framework and can be integrated with common state managers like Redux or React Context.\nThis stateful client library can be used with the UI Components to pass props and methods for the UI Components to render data.\nFor more information, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/story/statefulclient-overview--page"},"Stateful Client Overview"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"installing-ui-library"},"Installing UI Library"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"npm i --save @azure/communication-react\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"composites-overview"},"Composites Overview"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Composites are higher-level components composed of UI components that deliver turn-key solutions for common communication scenarios using Azure Communication Services.\nDevelopers can easily instantiate the Composite using an Azure Communication Services access token and the required configuration attributed for call or chat."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Composite"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Use Cases"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/composites-call-basicexample--basic-example"},"CallComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Calling experience that allows users to start or join a call. Inside the experience users can configure their devices, participate in the call with video and see other participants, including those with video turn on. For Teams Interop is includes lobby functionality for user to wait to be admitted.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/composites-chat-basicexample--basic-example"},"ChatComposite")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat experience where user can send and receive messages. Thread events like typing, reads, participants entering and leaving are displayed to the user as part of the chat thread.")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"ui-component-overview"},"UI Component Overview"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Pure UI Components that can be used by developers to compose communication experiences, from stitching video tiles into a grid to showcase remote participants, to organizing components to fit your applications specifications.\nUI Components support customization to give the components the right feel and look to match an applications branding and style."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Area"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Component"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Description"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-gridlayout--grid-layout"},"Grid Layout")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Grid component to organize Video Tiles into an NxN grid")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-videotile--video-tile"},"Video Tile")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Component that displays video stream when available and a default static component when not")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-controlbar--control-bar"},"Control Bar")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Container to organize DefaultButtons to hook up to specific call actions like mute or share screen")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-videogallery--video-gallery"},"Video Gallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Turn-key video gallery component which dynamically changes as participants are added")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-messagethread--message-thread"},"Message Thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Container that renders chat messages, system messages, and custom messages")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-sendbox--send-box"},"Send Box")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Text input component with a discrete send button")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-messagestatusindicator--message-status-indicator"},"Message Status Indicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Multi-state message status indicator component to show status of sent message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-typingindicator--typing-indicator"},"Typing indicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Text component to render the participants who are actively typing on a thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Common"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-participantitem--participant-item"},"Participant Item")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Common component to render a call or chat participant including avatar and display name")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"/?path=/story/ui-components-participantlist--participant-list"},"Participant List")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Common component to render a call or chat participant list including avatar and display name")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"what-ui-artifact-is-best-for-my-project"},"What UI Artifact is Best for my Project?"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Understanding these requirements will help you choose the right client library:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"li"},"How much customization do you desire?")," Azure Communication core client libraries don't have a UX and are designed so you can build whatever UX you want. UI Library components provide UI assets at the cost of reduced customization."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("strong",{parentName:"li"},"What platforms are you targeting?")," Different platforms have different capabilities.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Details about feature availability in the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/story/usecases--page"},"UI Library is available here"),", but key trade-offs are summarized below."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Client library / SDK"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Implementation Complexity"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Customization Ability"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"th",href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/teams-interop",target:"_blank",rel:"nofollow noopener noreferrer"},"Teams Interop")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Composite Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Low"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Low"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Base Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Medium"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Medium"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Core client libraries"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"High"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"High"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Overview",id:"overview",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1376:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var ChatAdapterExampleText=__webpack_require__(1377).default,CallAdapterExampleText=__webpack_require__(1378).default,layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"statefulclient-reacthooks-adapters",title:"Stateful Client/Adapters",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"adapters-for-composites"},"Adapters for Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Composites deliver turn-key communication experiences for developers.\nThey make it easy for developers to add end-to-end communication experiences to their apps with only a couple lines of code.\nTo power Composites, the UI library provides ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Adapters"),", one for the calling composite ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/composites-call-basicexample--basic-example"},"here")," and one for chat composite\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/composites-chat-basicexample--basic-example"},"here"),".\nThese adapters make use of the stateful clients for calling and chat in conjunction with React Hooks like usePropsFor to provide developers a single interface to configure Composites."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"setting-up-adapters"},"Setting Up Adapters"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To setup the adapters, you will need to provide the adapter with key metadata required.\nThis includes most importantly an access token for your Azure Communication Services resource and context information for the call or chat thread you want to join.\nTo create the adapters we will use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createAzureCommunicationCallAdapter")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createAzureCommunicationChatAdapter")," helper methods.\nThese methods are asynchronous so we will use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useEffect")," to create them."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"calling-adapters"},"Calling Adapters"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To initialize the calling adapter, you will be required to provide a call locator with the information of the group or meeting you are trying to join.\nGroup Id for Azure Communication Services take the shape of GUID generated by the developer to identify a call inside their tenant.\nTeams Meeting information can be acquired through ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/graph/overview",target:"_blank",rel:"nofollow noopener noreferrer"},"Microsoft Graph"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.g,{code:CallAdapterExampleText,mdxType:"Source"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"chat-adapter"},"Chat Adapter"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To initialize the chat adapter, you will be required to provide an endpoint url for the Azure Communication Services resource on ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://portal.azure.com",target:"_blank",rel:"nofollow noopener noreferrer"},"Azure Portal"),".\nIn addition, you will need to provide a thread Id. Thread Id is provisioned from the Azure Communication Services by creating a new thread or adding the user to an existing thread.\nFor more information on thread Id, see our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts",target:"_blank",rel:"nofollow noopener noreferrer"},"documentation"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.g,{code:ChatAdapterExampleText,mdxType:"Source"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"using-adapters"},"Using Adapters"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Once initialized, adapters can be used to initialize Composites as well as to pragmatically take actions on the call or chat experience."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"initializing-composites-with-adapters"},"Initializing Composites with Adapters"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"With the initialized adapters, we can now hook them into the calling and chat composites."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-typescript"},"\nimport { CallComposite, ChatComposite} from '@azure/communication-react';\n\n<CallComposite adapter={callAdapter} />\n\n<ChatComposite adapter={chatAdapter} />\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"accessing-adapter-contents"},"Accessing Adapter Contents"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The adapters provide developers access to state, actions and events related to the underlying chat and calling SDKs.\nBelow are some examples that might be helpful, but additional methods are available."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h4",{id:"calling-adapter-examples"},"Calling Adapter Examples"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-typescript"},"\n//Access state and state changes, including CallClient and UI\ncallAdapter.onStateChange((state) => {\n  console.log(state.userId)\n})\ncallAdapter.getState().userId\ncallAdapter.getState().call\ncallAdapter.getState().devices\n\n//Access actions for the call\ncallAdapter.mute()\ncallAdapter.queryMicrophones()\ncallAdapter.startCamera()\n\n//Call events\ncallAdapter.on('participantsJoined, (event)=>{\n  event.joined.forEach((participant) => {\n    console.log(participant.displayName);\n  });\n})\ncallAdapter.on('callEnded, (event) => {\n  console.log(event.callId);\n})\ncallAdapter.on('error', (e: Error) => {\n  console.log(JSON.stringify(e))\n})\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h4",{id:"chat-adapter-examples"},"Chat Adapter Examples"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-typescript"},"\n//Access state and state changes, including ChatClient and UI\nchatAdapter.onStateChange((state) => {\n  console.log(state.userId)\n})\nchatAdapter.getState().thread\nchatAdapter.getState().userId\n\n//Access actions for the chat\nchatAdapter.sendMessage()\nchatAdapter.removeParticipants()\nchatAdapter.setTopic()\n\n//Chat events\nchatAdapter.on('messageReceived, (event) => {\n  console.log(event.message.content?.message);\n})\nchatAdapter.on('messageSent, (event) => {\n  console.log(event.message.content?.message);\n})\nchatAdapter.on('topicChanged', (event) => {\n  console.log(event.topic);\n})\n\n")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/Adapters",id:"statefulclient-reacthooks-adapters",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1377:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  AzureCommunicationTokenCredential,\n  CommunicationUserIdentifier,\n  getIdentifierKind\n} from '@azure/communication-common';\nimport { ChatAdapter, ChatComposite, createAzureCommunicationChatAdapter } from '@azure/communication-react';\nimport React, { useState, useEffect } from 'react';\n\ntype ChatAdapterExampleProps = {\n  userId: CommunicationUserIdentifier;\n  accessToken: string;\n  endpointUrl: string;\n  threadId: string;\n  displayName: string;\n};\n\nexport const ChatAdapterExample = (props: ChatAdapterExampleProps): JSX.Element | undefined => {\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\n  useEffect(() => {\n    if (props) {\n      const createAdapter = async (): Promise<void> => {\n        setChatAdapter(\n          await createAzureCommunicationChatAdapter({\n            endpointUrl: props.endpointUrl,\n            userId: getIdentifierKind(props.userId),\n            displayName: props.displayName,\n            credential: new AzureCommunicationTokenCredential(props.accessToken),\n            threadId: props.threadId\n          })\n        );\n      };\n      createAdapter();\n    }\n    return () => {\n      if (chatAdapter) {\n        chatAdapter.dispose();\n      }\n    };\n  }, [props, chatAdapter]);\n\n  return chatAdapter && <ChatComposite adapter={chatAdapter} />;\n};\n"},1378:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { GroupCallLocator, TeamsMeetingLinkLocator } from '@azure/communication-calling';\nimport { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport { CallAdapter, CallComposite, createAzureCommunicationCallAdapter } from '@azure/communication-react';\nimport React, { useState, useEffect } from 'react';\n\ntype CallAdapterExampleProps = {\n  userId: CommunicationUserIdentifier;\n  accessToken: string;\n  callLocator: GroupCallLocator | TeamsMeetingLinkLocator;\n  displayName: string;\n};\n\nexport const CallAdapterExample = (props: CallAdapterExampleProps): JSX.Element | undefined => {\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\n  useEffect(() => {\n    if (props) {\n      const createAdapter = async (): Promise<void> => {\n        setCallAdapter(\n          await createAzureCommunicationCallAdapter({\n            userId: { kind: 'communicationUser', communicationUserId: props.userId.communicationUserId },\n            displayName: props.displayName,\n            credential: new AzureCommunicationTokenCredential(props.accessToken),\n            locator: props.callLocator\n          })\n        );\n      };\n      createAdapter();\n    }\n    return () => {\n      if (callAdapter) {\n        callAdapter.dispose();\n      }\n    };\n  }, [props, callAdapter]);\n\n  return callAdapter && <CallComposite adapter={callAdapter} />;\n};\n"},1379:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"statefulclient-bestpractices",title:"Stateful Client/Best Practices",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"best-practices"},"Best Practices"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"We are sharing some of our recommended best practices when handling state with Azure Communication Services UI Library."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-the-stateful-clients"},"Use the Stateful Clients"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Managing the complex state of a calling or chat sesion can be challenging. This was a complex problem we found we were in and we think many of our developer community\nwill run into this challenge themselves. We wanted to find a convenient way to store this information on the client in a way that plays nicely with our components we are offering.\nBy using the stateful client for calling or chat, you are on our recommended path for powering your own communications experience using Azure Communication Services."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-usepropsfor"},"Use usePropsFor"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If you are using our provided UI Components, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," will help you get integrated with the underlying functionality quickly. This provides a series of properties our\nprovided components are expecting from the stateful client to render an experience your users will be expecting. This is the fastest way to get your experience up and running with Azure Communication Services."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"you-can-use-your-own-ui-components"},"You can use your own UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Today you can use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useSelector")," to connect your own components to create your own experiences! We use ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useSelector")," under the hood when you leverage our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," hook.\nWe wanted to ensure that developers wanting to create custom components had the same development path that we were using as well. Using this development path allows\nyou to start on the path that we use as well to create amazing components."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"populating-the-devicemanager-state"},"Populating the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"DeviceManager")," State"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"When using Stateful Calling, the call related state will be automatically retrieved for you.\nHowever, this is not the case for ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManager")," state.\nTo be able to retrieve ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManager")," state from the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"StatefulCallClient"),"s state, you must trigger the appropriate APIs to populate the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManager")," state."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"li"},"DeviceManager.askPermission()"),"  this must be called to ask for device permissions from the user. The result of their decisions will be stored in DeviceManagerState.deviceAccess."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"li"},"DeviceManager.getCameras()"),"  When called, the result will be stored in DeviceManagerState.cameras."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"li"},"DeviceManager.getMicrophones()"),"  When called, the result will be stored in DeviceManagerState.microphones."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"li"},"DeviceManager.getSpeakers()"),"  When called, the result will be stored in DeviceManagerState.speakers")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-of-selectedcamera-inside-the-devicemanager"},"Use of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"selectedCamera")," inside the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"DeviceManager")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To make Stateful Calling easier to use weve added a property to the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManagerState")," called ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"selectedCamera"),".\nThis is not a proxy of the SDK state and is completely controlled by you.\nIt is populated when you set it and updated when you update it. It has no bearing on the function of the SDK and not automatically used by the SDK."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"use-of-createview-and-disposeview-on-the-statefulcallclient"},"Use of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"createView")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"disposeView")," on the StatefulCallClient"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To allow developers to generate a HTMLElement/view of a Stateful VideoStream, we provide a createView and disposeView API.\nThese APIs are located in StatefulCallClient and should only be used for scenarios where developers want to generate their own components to use in conjunction with the UI Library.\nThere are three scenarios to using these APIs:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Rendering a RemoteVideoStreamState"),"\nYou are required to call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," with a valid ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"participantIdentifier"),", and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"remoteVideoStreamState"),".\nThe ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," is async and if your architecture can support awaiting for it we recommend you do that.\nOnce the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," completes the view will be stored under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState.RemoteParticipants.[your remote participant].videoStream.[your videostream].view"),".\nIf you cannot await the result of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView"),", it is fine to call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," again, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," will no-op the second call. Once the view has been created, the call state will be automatically updated and you can check the state for the view.\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CreateView")," will not allow creating multiple view of the same stream.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Rendering a LocalVideoStreamState in a Call"),"\nSame as #1 except this time ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," only requires a valid ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStreamState"),".\nNote that this will only work if the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStream")," is already part of the call (youll have to first call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Call.startVideo")," to add the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStream")," to the Call).\nEverything else is the same as #1 after this except the view can be found in ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState.localVideoStreams.(your videostream).view"),".")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",{parentName:"li"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Rendering a LocalVideoStreamState when not in a call"),"\nThis scenario supports the case if you want to see a video render without adding that stream to the call, for instance ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalPreview")," scenario.\nIn this case ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," requires only a valid ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStreamState"),".\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CreateView")," will put the created view under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManagerState.unparentedViews.(your videostream).view"),".\nYou can access this Map using your original ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"LocalVideoStreamState")," as the key."))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To debug ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createView")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"disposeView"),", they emit ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"console.warns")," when used incorrectly that can be tracked."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"track-changes-to-callid"},"Track Changes to ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"h2"},"callId")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"One major gotcha with using Stateful Calling is that ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId")," may change and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId")," is used to look up data in Stateful state.\nIf you have an old callId and the callId changed, you will not be able to access or find ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState")," in ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClientState"),".\nTo work around, we recommend you do not cache the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callId")," and instead cache the entire call object.\nThe id in the call object will be kept up to date and when ever you access ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClientState")," use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"call.id"),"."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"detecting-screenshare-participant"},"Detecting Screenshare Participant"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To make Stateful Calling easier to use we added a ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"screenshareRemoteParticipant")," property to ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState"),".\nIf there is a remote participant screensharing, this will allow you to quickly look up that participants state by doing something like this:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"CallState.remoteParticipants.get(CallState.screenshareRemoteParticipant);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"This property will be undefined if there are no remote participants screensharing.\nNote that this only applies to remote screenshares and not local screenshares."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"detecting-transcription-and-recording"},"Detecting Transcription and Recording"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Stateful Calling will manage transcription/recording for you.\nYou only need to simply check the states under ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState.transcription")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallState.recording"),"."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/Best Practices",id:"statefulclient-bestpractices",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1380:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"statefulclient-overview",title:"Stateful Client/Overview",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"overview-of-stateful-client"},"Overview of Stateful Client"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Azure Communication Service UI Library exposes stateful clients for calling and chat.\nStateful clients are a 1:1 representation of the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatClient")," exposed by the underlying low-level calling and chat SDKs.\nThey simply add a state layer on top of it to help track state that can be rendered as part of the UI.\nThey can be used in the same way as low-level clients would be used, so developers can use it to query the service and handle events (i.e. participant added or message recieved).\nStateful clients are agnostic to any specific state management framework."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"component-binding-with-stateful-clients"},"Component Binding with Stateful Clients"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To make it simpler to connect the stateful client with UI Components, the UI Library exposes helpers, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/statefulclient-reacthooks-usepropsfor--page"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"a"},"usePropsFor")),", to generate props\nThese helpers aid in extracting the correct set of props required for different UI Components.\nThey expose both data for the UI Components to render such as a message list or a participants remote video, and default handlers for UI Components action such as sending a message."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"installing-stateful-clients"},"Installing Stateful Clients"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Stateful clients are found as part of the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," package."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm i --save @azure/communication-react\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"calling-statefulclient"},"Calling StatefulClient"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Using ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createStatefulCallClient"),", developer can generate a stateful version of the call client."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import { createStatefulCallClient } from '@azure/communication-react;\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\n\nconst endpointUrl = '<ENDPOINT>';\nconst userAccessToken = '<USER_ACCESS_TOKEN>';\nconst tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n\nconst statefulCallClient = createStatefulCallClient({\n  userId: userId,\n});\n\n// You can then use the `statefulCallClient` in the same way as a `CallClient` with a slight variation.\n\nconst callAgent = await statefulCallClient.createCallAgent(tokenCredential, {displayName: 'Optional User Name'})\n\nconst call = callAgent.join({groupId: <GUID>})\n\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To interact with the call, developers have access to ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulCallClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallAgent"),". The stateful clients are a 1:1 representation.\nFor state to be tracked, developers should use the stateful clients to query the service and listen to events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"accessing-the-device-manager"},"Accessing the Device Manager"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Through the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulCallClient"),", developers can access the device manager to query the device available for the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const deviceManager = await statefulCallClient.getDeviceManager();\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The device manager allows developers to access the local video stream to render for the user ahead of joining a call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const cameras = await deviceManager.getCameras();\nconst camera = cameras[0];\nconst localCameraStream = { source: camera, mediaStreamType: 'Video' } as LocalVideoStreamState;\nconst view = statefulClient.createView(localCameraStream);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For more information on the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"DeviceManager"),", see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/javascript/api/azure-communication-services/@azure/communication-calling/devicemanager?view=azure-communication-services-js",target:"_blank",rel:"nofollow noopener noreferrer"},"Device Management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"chat-statefulclient"},"Chat StatefulClient"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Using the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"createStatefulChatClient"),", developer can generate a stateful version of the chat client."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import { createStatefulChatClient } from '@azure/communication-react;\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\n\nconst endpointUrl = '<ENDPOINT>';\nconst userAccessToken = '<USER_ACCESS_TOKEN>';\nconst tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n\nconst statefulChatClient = createStatefulChatClient({\n  userId: userId,\n  displayName: displayName,\n  endpoint: endpointUrl,\n  credential: tokenCredential\n});\n\n// You can then use the `statefulChatClient` in the same way as a `ChatClient` with a slight variation.\n\nconst chatThreadClient = await statefulChatClient.createChatThread({});\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To interact with the chat thread, developers have access ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulChatClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"chatThreadClient"),". The stateful clients are a 1:1 representation.\nFor state to be tracked, developers should use the stateful clients to query the service and listen to events."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"access-the-chat-thread-client"},"Access the Chat Thread Client"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"The Chat Thread Client allows developers to access a variety of methods to query participants and send messages to a thread."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const sendMessageRequest = {\n  content: 'Hello! Can you share the deck for the conference?'\n};\n\nlet sendMessageOptions = {\n  senderDisplayName: 'Jack',\n  type: 'text'\n};\nconst sendChatMessageResult = await chatThreadClient.sendMessage(sendMessageRequest, sendMessageOptions);\nconst messageId = sendChatMessageResult.id;\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For more information on the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatThreadClient"),", see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://azuresdkdocs.blob.core.windows.net/$web/javascript/azure-communication-chat/1.0.0/classes/chatthreadclient.html",target:"_blank",rel:"nofollow noopener noreferrer"},"ChatThreadClient")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"capabilities"},"Capabilities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Stateful clients enable developers to access all the APIs that low-level calling and chat SDKs expose.\nFor a complete list of capabilities see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/voice-video-calling/calling-sdk-features",target:"_blank",rel:"nofollow noopener noreferrer"},"Calling Overview")," and\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/chat/sdk-features",target:"_blank",rel:"nofollow noopener noreferrer"},"Chat Overview"),".\nAt a high level, stateful clients allow developers the following capabilities."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Capabilities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Example"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Read state"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Query the state ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.state")," to access properties such as ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.state.messsages"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Handle state event changes"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Subscribe to events ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.onStateChange()")," and unsubscribe from events ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.offStateChange()"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Send commands"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Mute the microphone ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"td"},"statefulClient.mute()"))))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/Overview",id:"statefulclient-overview",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1381:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"statefulclient-reacthooks-setup",title:"Stateful Client/React Hooks/Setting up",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"hooks"},"Hooks"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://reactjs.org/docs/hooks-intro.html",target:"_blank",rel:"nofollow noopener noreferrer"},"React Hooks")," allows developers to use state and other react features without writing a class component."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"While you can choose any state management library such as Redux, we also provide a simple way to power react components with our Stateful SDK.\nWe provide two ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://reactjs.org/docs/hooks-custom.html",target:"_blank",rel:"nofollow noopener noreferrer"},"custom hooks")," in our library, ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor()")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/statefulclient-reacthooks-useselector--page"},"useSelector()"),", that allow you to subscribe to changes in the SDK state and bind to our UI components.\nAfter binding with the custom hooks a SDK state change will trigger a re-render of the UI component, and events on the component will call into the SDK clients."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"before-you-start"},"Before you Start"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Before you start, you need to wrap your whole App with Providers.\nThey give you access to global variables (like Stateful ChatClient/CallClient) for our hooks to consume.\nThere are different Providers for building apps with varying functionality:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"chat"},"Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For your Chat app, use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatClientProvider")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatThreadClientProvider")," to give hooks access to the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"ChatThreadClient"),".\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulChatClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"chatThreadClient")," instances need to be passed to the Provider when you wrap your app.\nFor more information on creating them, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/statefulclient-overview--page"},"Overview")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"ReactDOM.render(\n  <ChatClientProvider chatClient={statefulChatClient}>\n    <ChatThreadClientProvider chatThreadClient={ChatThreadClient}>\n      <App />\n    </ChatThreadClientProvider>\n  </ChatClientProvider>,\n  document.getElementById('root')\n);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"calling"},"Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For your Chat app, use the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClientProvider"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallAgentProvider")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallProvider")," to give hooks access to the ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallClient"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"CallAgentClient")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Call"),".\n",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"statefulCallClient"),", ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"callAgent")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"call")," instances need to be passed to the Provider when you wrap your app.\nFor more information on creating them, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/statefulclient-overview--page"},"Overview")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"ReactDOM.render(\n  <CallClientProvider callClient={statefulCallClient}>\n    <CallAgentProvider callAgent={callAgent}>\n      <CallProvider call={call}>\n        <App />\n      </CallProvider>\n    </CallAgentProvider>\n  </CallClientProvider>,\n  document.getElementById('root')\n);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"next"},"Next"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Once you have wrapped your entire app with providers, you are now can use the usePropsFor() method inside of your app to connect your components to the state."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To see a full end-to-end example using providers, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/quickstarts-statefulclient--page"},"Getting Started with StatefulClient")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/React Hooks/Setting up",id:"statefulclient-reacthooks-setup",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1382:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"statefulclient-reacthooks-usepropsfor",title:"Stateful Client/React Hooks/UsePropsFor",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"usepropsfor-a-nameusepropsfora"},"usePropsFor ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{name:"usePropsFor"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If you are using React Component from our communication-react components, usePropsFor is the go-to hook.\nIt provides all the required props to power a feature component.\nIt subscribes to state changes of stateful clients, gets props designed for your component, and triggers a re-render whenever the props change."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"To see a full end-to-end example using usePropsFor, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/quickstarts-statefulclient--page"},"Getting Started with StatefulClient")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"usepropsfor-calling-app-example"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"h2"},"usePropsFor")," Calling App Example"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import React from 'react';\nimport { VideoGallery, usePropsFor } from '@azure/communication-react';\n\nexport const ChatScreen = () => {\n  const props = usePropsFor(VideoGallery);\n  return <VideoGallery {...props} />;\n};\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"usepropsfor-chat-app-example"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"h2"},"usePropsFor")," Chat App Example"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import React from 'react';\nimport { MessageThread, usePropsFor } from '@azure/communication-react';\n\nexport const ChatScreen = () => {\n  const props = usePropsFor(MessageThread);\n  return <MessageThread {...props} />;\n};\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," supports the following components:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Chat")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-messagethread--message-thread"},"MessageThread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-sendbox--send-box"},"SendBox")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-typingindicator--typing-indicator"},"TypingIndicator")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-participantlist--participant-list"},"ParticipantList"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"Calling")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-videogallery--video-gallery"},"VideoGallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-participantlist--participant-list"},"ParticipantList")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-controlbar-buttons-camera--camera"},"CameraButton")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-controlbar-buttons-endcall--end-call"},"EndCallButton")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-controlbar-buttons-microphone--microphone"},"MicrophoneButton")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-controlbar-buttons-options--options"},"OptionsButton")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/docs/ui-components-controlbar-buttons-screenshare--screen-share"},"ScreenShareButton"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"choose-your-target"},"Choose your target"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"usePropsFor() is context-aware. It picks out props from the relevant Provider for the component. One exception is ParticipantList -- a component applicable to both chat and calling settings. Thus, ChatClientProvider and CallingClientProvider both provide props for this component","*",". Thus, usePropsFor() can not determine which provider should be used to satisfy the props. You must explicitly set the target to use:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("em",{parentName:"p"},"*","only ParticipantList component is shared by both chat and calling")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import React from 'react';\nimport { ParticipantList, usePropsFor } from '@azure/communication-react';\n\n// This will show 2 different participantLists in parallel\nexport const ParicipantLists = () => {\n  const chatParticipantProps = usePropsFor(ParticipantList, 'chat');\n  const callingParticipantProps = usePropsFor(ParticipantList, 'calling');\n  return (\n    <>\n      <ParticipantList {...chatParticipantProps} />\n      <ParticipantList {...callingParticipantProps} />\n    </>\n  );\n};\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"under-the-hood-of-usepropsfor"},"Under the Hood of usePropsFor"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"usePropsFor() is a function that provides all you need to run a component in our library.\nIt combines 2 tasks for generating the component's props for you:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Finds the right selector designed for the component, then call useSelector()"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Constructs a set of handlers tailored for the component")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"using-usepropsfor-with-custom-components"},"Using usePropsFor with Custom Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"You can use the usePropsFor function for your own custom components by matching the props structure of the supported UI Components.\nBy passing the component that matches your custom components prop structure, you can then use the outputted props on your own custom component.\nThis means you could build your own ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Video Gallery")," with a custom layout using our ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Grid Layout")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"Video Tile")," components, and still leverage our usePropsFor helper.\nIn cases, where matching the prop structure is not possible, the stateful clients can still be leveraged to extract and maintain your own props.\nFor more information, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"/?path=/docs/statefulclient-reacthooks-useselector--page"},"useSelector"),"."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/React Hooks/UsePropsFor",id:"statefulclient-reacthooks-usepropsfor",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1383:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"statefulclient-reacthooks-useselector",title:"Stateful Client/React Hooks/UseSelector",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"useselector-a-nameuseselectora"},"useSelector() ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{name:"useSelector"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useSelector")," allows you to provide your own selector function that maps the stateful SDK state to your own props for your own component. It subscribes to state changes and runs the selector every time when anything changes in the state, but note that it will only trigger a component re-render when the return value of the selector changes."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"when-to-call-useselector"},"When to Call useSelector"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"By default, if you are satisfied with props we prepared for component library, all you need is to call ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," to power our component. If just one or two props need to be filtered or modified, directly overriding properties from return value of ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor")," is recommended. But sometimes you might want to call use selector instead when:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ol",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Override the way how it generates props from state"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ol"},"Write your own components (which we don't provide dedicated selectors for it)")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"basic-example"},"Basic Example:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const userInfoSelector = (state) => ({\n  id: state.userId\n  userName: state.displayName\n});\n\nconst chatInfoProps = useSelector(userInfoSelector);\n\nconst ChatInfo = ({id: string, userName: string}) => {\n  return <div> userName: {userName}, id: {id} </div>;\n}\n\n<ChatInfo {...chatInfoProps} />\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"passing-your-own-props"},"Passing your own props"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"When creating your own selector, you can inject your own custom properties through the second parameter of the selector function."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const threadSelector = (state, props) => ({\n  thread: state.threads[props.threadId]\n});\n\nconst selectorProps = useMemo(() => ({ threadId: myThreadId }), [threadId]);\n\nconst threadProps = useSelector(threadSelector, selectorProps);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"If you don't pass in any selector props or pass an undefined value into useSelector(), useSelector() will also provide a default props object for you, which includes threadId/callId under chat/call context, so this also works:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const threadSelector = (state, props) => ({\n  thread: state.threads[props.threadId] // default props = {threadId: string} in chat, {callId: string} in call\n});\n\nconst threadProps = useSelector(threadSelector);\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"choose-your-target"},"Choose your target"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Similar to usePropsFor, useSelector() is context-aware. It picks out props from available context from providers. Thus, when it is under both ChatClientProvider and CallingClientProvider, it can not determine which provider should be used to satisfy the props. You must explicitly set the target to use:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const threadSelector = (state, props) => ({\n  thread: state.threads[props.threadId]\n});\n\nconst threadProps = useSelector(threadSelector, undefined /* get default selector props */, 'chat');\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"memoizing-your-selector"},"Memoizing your Selector"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"(Recommended for optimized perf)"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"While this basic example will work without problems, but it is not a good way to optimize your app perf, we recommend to use the reselect library to enable memoization for selectors to get better performance, check ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://redux-toolkit.js.org/api/createSelector#createselector",target:"_blank",rel:"nofollow noopener noreferrer"},"reselect's official docs")," for more information."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"import { createSelector } from 'reselect';\n\nconst userInfoSelector = createSelector([(state) => state.userId, (state) => state.displayName], (id, userName) => ({\n  id,\n  userName\n}));\n\nconst chatInfoProps = useSelector(userInfoSelector);\n\nconst ChatInfo = ({ id: string, userName: string }) => {\n  return (\n    <div>\n      {' '}\n      userName: {userName}, id: {id}{' '}\n    </div>\n  );\n};\n\n<ChatInfo {...chatInfoProps} />;\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"override-default-behaviors"},"Override Default Behaviors"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"While we provide a set of default props(which includes data and handler functions) for our UI library component, you might find it doesn't fit all you needs, there are several different ways you can choose to override the default behavior."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"write-your-own-handler-function"},"Write your own Handler Function"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"In some situations, you may want to override default behavior and place your own API call (like call another service, or call another API in our stateful SDK). Here is an example of how to change the message before using the stateful client to send it."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const sendBoxProps = usePropsFor(SendBox);\n// This hook will get stateful client you created\nconst chatThreadClient = useThreadClient();\n\nconst onSendMessage = useCallback(\n  (message: string) => {\n    const sendMessageRequest = {\n      `: ${content}`,\n      senderDisplayName: chatClient.getState().displayName\n    };\n    // directly call into stateful client\n    await chatThreadClient.sendMessage(sendMessageRequest);\n  },\n  [chatThreadClient]\n);\n\n<SendBox {...sendBoxProps} onSendMessage={onSendMessage} />;\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"override-selector"},"Override Selector"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"With the hooks that we provide it is also possible to override a selector without re-writing the default handlers."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const customSelector = createSelector(....); // create your own selector\nconst messageThreadProps = useSelector(customSelector);\nconst messageThreadHandlers = useChatHandlers(MessageThread);\n\n\n<MessageThread {...messageThreadProps} {...messageThreadHandlers} />\n")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h3",{id:"choose-your-own-overridden-combination"},"Choose your own Overridden Combination"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"By calling ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"useSelector"),"/",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("inlineCode",{parentName:"p"},"usePropsFor"),", you can get the right combination of default selector + overrided handler/default handler + overrided selector for your own needs. You can even entirely override the whole behavior by writing your own handler and selectors:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("pre",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("code",{parentName:"pre",className:"language-tsx"},"const customSelector = createSelector(....); // create your own selector\nconst messageThreadProps = useSelector(customSelector);\n// This hook will get stateful client you created\nconst chatThreadClient = useThreadClient();\n\n// Create your own handlers\nconst onMessageSeen = useCallback((message: string) => {\n  await chatThreadClient.sendReadReceipt({ chatMessageId });\n}, [chatThreadClient]);\n\n<MessageThread {...messageThreadProps} onMessageSeen={onMessageSeen} />\n")))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Stateful Client/React Hooks/UseSelector",id:"statefulclient-reacthooks-useselector",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1384:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var _mdx_js_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(2),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.e,{id:"usecases",title:"Use Cases",mdxType:"Meta"}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h1",{id:"ui-library-use-cases"},"UI Library Use Cases"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"UI Library supports many use cases across calling and chat experiences.\nThese capabilities are available through UI Components and Composites.\nFor Composites, these capabilities are built directly in and exposed when the composite is integrated into an application.\nFor UI Components, these capabilities are exposed through a combination of UI functionality and underlying stateful libraries.\nTo take full advantage of these capabilities, we recommend using the UI Components with the stateful call and chat client libraries."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"calling-use-cases"},"Calling Use Cases"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Area"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Use Cases"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call Types"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Join Teams Meeting")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Join Azure Communication Services call with Group Id")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"td",href:"https://docs.microsoft.com/azure/communication-services/concepts/teams-interop",target:"_blank",rel:"nofollow noopener noreferrer"},"Teams Interop")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call Lobby")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Transcription and recording alert banner")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call Controls"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Mute/unmute call")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Video on/off on call")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Screen Sharing")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"End call")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant Gallery"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Remote participants are displayed on grid")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Video preview available throughout call for local user")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Default avatars available when video is off")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Shared screen content displayed on participant gallery")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call configuration"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Microphone device management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Camera device management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Speaker device management")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Local preview available for user to check video")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participants"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant roster")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"chat-use-cases"},"Chat Use Cases"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Area"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Use Cases"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat Types"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Join a Teams Meeting Chat")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Join an Azure Communication Services chat thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat Actions"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Send chat message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Receive chat message")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat Events"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Typing Indicators")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Read Receipt")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant added/removed")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chat title changed")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participants"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant roster")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"supported-identities"},"Supported Identities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"An Azure Communication Services identity is required to initialize the stateful client libraries and authenticate to the service.\nFor more information on authentication, see ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/authentication",target:"_blank",rel:"nofollow noopener noreferrer"},"Authentication")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/access-tokens?pivots=programming-language-javascript",target:"_blank",rel:"nofollow noopener noreferrer"},"Access Tokens")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"teams-interop-use-case"},"Teams Interop Use Case"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"For ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/teams-interop",target:"_blank",rel:"nofollow noopener noreferrer"},"Teams Interop")," scenarios, developers can use UI Library Components to join Teams meetings through Azure Communication Services.\nTo enable Teams Interop, developers can either use calling and chat composites directly or use UI Components to build a custom experience.\nWhen enabling applications with both calling and chat, its important to remember that the chat client can't be initialized until the participant has been admitted to the call.\nOnce admitted, the chat client can be initialized to join the meeting chat thread.\nSee the diagram below for guidance:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{parentName:"p",src:"images/teams-interop-pattern.png",alt:"Teams Interop pattern for calling and chat"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"When using UI Components to deliver Teams Interop experiences, UI Library provides examples for key pieces of the experience.\nFor example:"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("ul",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/story/examples-teamsinterop-lobby--lobby"},"Lobby Example"),": Sample lobby for participant to wait to be admitted to the call."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/story/examples-teamsinterop-compliancebanner--compliance-banner"},"Compliance banner"),": Sample banner to show the user whether the call is being recorded or not."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("li",{parentName:"ul"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"li",href:"/?path=/story/examples-themes-teams--teams"},"Teams Theme"),": Sample theme that makes the UI Library looks like Microsoft Teams.")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"customization"},"Customization"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"UI Library exposes patterns for developers to modify components to fit the look and feel of their application.\nThese capabilities are a key area of differentiation between Composites and UI Components, where Composites provide less customization options in favor of a simpler integration experience."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Use Case"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"UI Components"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Fluent based Theming"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Experience layout is composable"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"CSS Styling can be used to modify style properties"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Icons can be replaced"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Participant gallery layout can be modified"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null}),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call control layout can be modified"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Data models can be injected to modify user metadata"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"observability"},"Observability"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"As part of the decoupled state management architecture of the UI Library, developers are able to access the stateful calling and chat clients directly.\nDevelopers can hook into the stateful client to read the state, handle events and override behavior to pass onto the UI Components."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Use Case"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Composites"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"UI Components"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Example"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Call/Chat client state can be accessed"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Check whether a all is connected or see the participants in a thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Commands can be sent to the call and chat client"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Mute or Unmute the call client or send messages on behalf of the user")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Client events can be accessed and handled"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Handle a participant join a call or intercept a message coming into a thread")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"UI events can be accessed and handled"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},""),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Handle mute button click or chat send button to add your own logic")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"recommended-architecture"},"Recommended Architecture"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("img",{parentName:"p",src:"images/ui-library-architecture.png",alt:"UI Library recommended architecture with client-server architecture"})),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Composite and Base Components are initialized using an Azure Communication Services access token. Access tokens should be procured from Azure Communication Services through a\ntrusted service that you manage. See ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/access-tokens?pivots=programming-language-javascript",target:"_blank",rel:"nofollow noopener noreferrer"},"Quickstart: Create Access Tokens")," and ",Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/tutorials/trusted-service-tutorial",target:"_blank",rel:"nofollow noopener noreferrer"},"Trusted Service Tutorial")," for more information."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"These client libraries also require the context for the call or chat they will join. Similar to user access tokens, this context should be disseminated to clients via your own trusted service. The list below summarizes the initialization and resource management functions that you need to operationalize."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Contoso Responsibilities"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"UI Library Responsibilities"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Provide access token from Azure"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Pass through given access token to initialize components")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Provide refresh function"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Refresh access token using developer provided function")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Retrieve/Pass join information for call or chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Pass through call and chat information to initialize components")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Retrieve/Pass user information for any custom data model"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Pass through custom data model to components to render")))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"platform-support"},"Platform support"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("table",null,Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("thead",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"thead"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"SDK"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Windows"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"macOS"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Ubuntu"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Linux"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"Android"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("th",{parentName:"tr",align:null},"iOS"))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tbody",{parentName:"table"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"UI SDK - Calling"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*",", new Edge"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*",", Safari","*","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Safari","*","*","*")),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("tr",{parentName:"tbody"},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"UI SDK - Chat"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Firefox","*",", Chrome","*",", new Edge"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Firefox","*",", Chrome","*",", Safari","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Chrome","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null},"Safari","*"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("td",{parentName:"tr",align:null})))),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"*","Note that the latest version is supported in addition to the\nprevious two releases."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"*","*","Note that outgoing screen sharing is not supported for Chrome on Android."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"*","*","*","Note that Safari versions 13.1+ are supported. 1:1 calls are not supported on Safari. Outgoing video for Safari\nmacOS supported only for Safari 14+/macOS 11+. Outgoing screen sharing\nis not supported on iOS, device selection(for example choosing Bluetooth headset) is limited by OS, only one device available."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"accessibility"},"Accessibility"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Accessibility by design is a principle across Microsoft products.\nUI Library follows this principle in making sure that all UI Components are fully accessible.\nDuring public preview, the UI Library will continue to improve and add accessibility feature to the UI Components.\nWe expect to add more details on accessibility ahead of the UI Library being in General Availability."),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("h2",{id:"localization"},"Localization"),Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)("p",null,"Localization is a key to making products that can be used across the world and by people who who speak different languages.\nUI Library will provide out of the box support for some languages and capabilities such as RTL.\nDevelopers can provide their own localization files to be used for the UI Library.\nThese localization capabilities will be added ahead of General Availability."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Use Cases",id:"usecases",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_6__.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(_mdx_js_react__WEBPACK_IMPORTED_MODULE_5__.b)(MDXContent,null))}}),__webpack_exports__.default=componentMeta},1385:function(module,exports,__webpack_require__){var map={"./CallComposite/BasicExample.stories.tsx":1386,"./CallComposite/CustomDataModelExample.stories.tsx":1507,"./CallComposite/JoinExistingCall.stories.tsx":1390,"./CallComposite/ThemeExample.stories.tsx":1391,"./ChatComposite/BasicExample.stories.tsx":1392,"./ChatComposite/CustomBehavior.stories.tsx":1508,"./ChatComposite/CustomDataModelExample.stories.tsx":1509,"./ChatComposite/JoinExistingChatThread.stories.tsx":1397,"./ChatComposite/ThemesExample.stories.tsx":1398,"./ControlBar/Buttons/Camera/Camera.stories.tsx":1492,"./ControlBar/Buttons/ControlBarButton/ControlBarButton.stories.tsx":1493,"./ControlBar/Buttons/EndCall/EndCall.stories.tsx":1494,"./ControlBar/Buttons/Microphone/Microphone.stories.tsx":1495,"./ControlBar/Buttons/Options/Options.stories.tsx":1496,"./ControlBar/Buttons/Participants/Participants.stories.tsx":1481,"./ControlBar/Buttons/ScreenShare/ScreenShare.stories.tsx":1497,"./ControlBar/ControlBar.stories.tsx":1486,"./ErrorBar/ErrorBar.stories.tsx":1429,"./Examples/DevicesDropdown/DeviceSettingsDropDown.stories.tsx":1510,"./Examples/IncomingCallAlerts/IncomingCallModal.stories.tsx":1431,"./Examples/IncomingCallAlerts/IncomingCallToast.stories.tsx":1432,"./Examples/Layouts/OneToOneCallLayout.stories.tsx":1433,"./Examples/Layouts/ScreenShareLayout.stories.tsx":1436,"./Examples/LocalPreview/LocalPreview.stories.tsx":1511,"./Examples/TeamsInterop/ComplianceBanner.stories.tsx":1512,"./Examples/TeamsInterop/Lobby.stories.tsx":1513,"./Examples/Themes/TeamsTheme.stories.tsx":1514,"./GridLayout/GridLayout.stories.tsx":1515,"./IdentityManagement/IdentityManagement.stories.tsx":293,"./MeetingComposite/BasicExample.stories.tsx":1443,"./MeetingComposite/JoinExample.stories.tsx":1446,"./MessageStatusIndicator/MessageStatusIndicator.stories.tsx":1516,"./MessageThread/MessageThread.stories.tsx":1479,"./ParticipantItem/ParticipantItem.stories.tsx":1498,"./ParticipantList/ParticipantList.stories.tsx":1488,"./SendBox/SendBox.stories.tsx":1489,"./TypingIndicator/TypingIndicator.stories.tsx":1499,"./VideoGallery/VideoGallery.stories.tsx":1500,"./VideoTile/VideoTile.stories.tsx":1504};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=1385},1386:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BasicExample",(function(){return BasicExample}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(50),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(123),_fluentui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(99),react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(0),_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(13),_controlsUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(6),_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(218),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(282),_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(283),_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(219),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var BasicStory=function BasicStory(args,context){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_16__.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_16__.useEffect)((function(){(function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!args.connectionString||!args.displayName){_context.next=7;break}return _context.next=3,Object(_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__.a)(args.connectionString);case 3:newProps=_context.sent,setContainerProps(newProps),_context.next=8;break;case 7:setContainerProps(void 0);case 8:case"end":return _context.stop()}}),_callee)})));return function fetchContainerProps(){return _ref.apply(this,arguments)}})()()}),[args.connectionString,args.displayName]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_15__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_17__.f,children:containerProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_20__.a,Object.assign({fluentTheme:context.theme,displayName:args.displayName},containerProps,{callInvitationURL:args.callInvitationURL})):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.a,{})})};BasicStory.displayName="BasicStory";var BasicExample=BasicStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"-call-basicexample",title:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"/CallComposite/Basic Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.a,argTypes:Object.assign({connectionString:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.connectionString,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.displayName,callInvitationURL:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.callInvitationURL},_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.b),parameters:{docs:{page:function page(){return Object(_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_19__.a)()}}}},BasicExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const [containerProps, setContainerProps] = useState();\n\n  useEffect(() => {\n    const fetchContainerProps = async (): Promise<void> => {\n      if (args.connectionString && args.displayName) {\n        const newProps = await createUserAndGroup(args.connectionString);\n        setContainerProps(newProps);\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchContainerProps();\n  }, [args.connectionString, args.displayName]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <ContosoCallContainer\n          fluentTheme={context.theme}\n          displayName={args.displayName}\n          {...containerProps}\n          callInvitationURL={args.callInvitationURL}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},BasicExample.parameters)},1387:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport { CallComposite, CallAdapter, createAzureCommunicationCallAdapter } from '@azure/communication-react';\nimport { Theme, PartialTheme } from '@fluentui/react';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nexport type ContainerProps = {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  locator: string;\n  displayName: string;\n  fluentTheme?: PartialTheme | Theme;\n  callInvitationURL?: string;\n};\n\nconst isTeamsMeetingLink = (link: string): boolean => link.startsWith('https://teams.microsoft.com/l/meetup-join');\n\nexport const ContosoCallContainer = (props: ContainerProps): JSX.Element => {\n  const [adapter, setAdapter] = useState<CallAdapter>();\n\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(props.token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [props.token]);\n\n  useEffect(() => {\n    (async () => {\n      if (!!credential && props.locator && props.displayName) {\n        const callLocator = isTeamsMeetingLink(props.locator)\n          ? { meetingLink: props.locator }\n          : { groupId: props.locator };\n        const createAdapter = async (credential: AzureCommunicationTokenCredential): Promise<void> => {\n          setAdapter(\n            await createAzureCommunicationCallAdapter({\n              userId: { kind: 'communicationUser', communicationUserId: props.userId.communicationUserId },\n              displayName: props.displayName,\n              credential,\n              locator: callLocator\n            })\n          );\n        };\n        createAdapter(credential);\n      }\n    })();\n  }, [props, credential]);\n\n  useEffect(() => {\n    return () => {\n      (async () => {\n        if (!adapter) {\n          return;\n        }\n        await adapter.leaveCall().catch((e) => {\n          console.error('Failed to leave call', e);\n        });\n        adapter.dispose();\n      })();\n    };\n  }, [adapter]);\n\n  if (adapter) {\n    return (\n      <div style={{ height: '90vh', width: '90vw' }}>\n        <CallComposite adapter={adapter} fluentTheme={props.fluentTheme} callInvitationURL={props?.callInvitationURL} />\n      </div>\n    );\n  }\n  if (credential === undefined) {\n    return <>Failed to construct credential. Provided token is malformed.</>;\n  }\n  return <>Initializing...</>;\n};\n"},1388:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Contoso server to create a new user and group.\n\nimport { CommunicationIdentityClient } from '@azure/communication-identity';\nimport { v1 as createGUID } from 'uuid';\n\nexport const createUserAndGroup = async (resourceConnectionString: string): Promise<any> => {\n  const tokenClient = new CommunicationIdentityClient(resourceConnectionString);\n  const user = await tokenClient.createUserAndToken(['voip']);\n  return {\n    userId: user.user,\n    token: user.token,\n    endpointUrl: new URL(resourceConnectionString.replace('endpoint=', '').split(';')[0]).toString(),\n\n    // Contoso creates a group call and provides the group ID to the client application.\n    // Alternatively, the client application could join an existing teams meeting.\n    locator: createGUID()\n  };\n};\n"},1390:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"JoinExistingCall",(function(){return JoinExistingCall}));__webpack_require__(50),__webpack_require__(10);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(123),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(99),_constants__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__(0),__webpack_require__(13)),_controlsUtils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6),_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(218),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(282),_snippets_Utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(219),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1),JoinExistingCallStory=function JoinExistingCallStory(args,context){var areAllKnobsSet=!!(args.callLocator&&args.userId&&args.token&&args.displayName);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_5__.f,children:areAllKnobsSet?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_8__.a,{fluentTheme:context.theme,locator:args.callLocator,userId:{communicationUserId:args.userId},token:args.token,displayName:args.displayName,callInvitationURL:args.callInvitationURL}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_9__.b,{})})};JoinExistingCallStory.displayName="JoinExistingCallStory";var JoinExistingCall=JoinExistingCallStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_5__.b+"-call-joinexistingcall",title:_constants__WEBPACK_IMPORTED_MODULE_5__.b+"/CallComposite/Join Existing Call",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.a,argTypes:Object.assign({callLocator:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.callLocator,userId:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.userId,token:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.token,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.displayName,callInvitationURL:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.callInvitationURL},_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.b),parameters:{docs:{page:function page(){return Object(_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_7__.a)()}}}},JoinExistingCall.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const areAllKnobsSet = !!args.callLocator && !!args.userId && !!args.token && !!args.displayName;\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {areAllKnobsSet ? (\n        <ContosoCallContainer\n          fluentTheme={context.theme}\n          locator={args.callLocator}\n          userId={{ communicationUserId: args.userId }}\n          token={args.token}\n          displayName={args.displayName}\n          callInvitationURL={args.callInvitationURL}\n        />\n      ) : (\n        <ConfigJoinCallHintBanner />\n      )}\n    </Stack>\n  );\n}'}},JoinExistingCall.parameters)},1391:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ThemeExample",(function(){return ThemeExample}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(50),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(123),_fluentui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(99),react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(0),_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(13),_controlsUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(6),_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(218),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(282),_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(283),_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(219),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ThemeExampleStory=function ThemeExampleStory(args){var _args$font,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_16__.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];Object(react__WEBPACK_IMPORTED_MODULE_16__.useEffect)((function(){(function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!args.connectionString||!args.displayName){_context.next=7;break}return _context.next=3,Object(_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__.a)(args.connectionString);case 3:newProps=_context.sent,setContainerProps(newProps),_context.next=8;break;case 7:setContainerProps(void 0);case 8:case"end":return _context.stop()}}),_callee)})));return function fetchContainerProps(){return _ref.apply(this,arguments)}})()()}),[args.connectionString,args.displayName]);var theme=Object.assign({},Object(_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.i)(args.theme),{fonts:{},defaultFontStyle:{fontFamily:null!==(_args$font=args.font)&&void 0!==_args$font?_args$font:"Segoe UI"}});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_15__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_17__.f,children:containerProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_20__.a,Object.assign({displayName:args.displayName,fluentTheme:theme},containerProps,{callInvitationURL:args.callInvitationURL})):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.a,{})})};ThemeExampleStory.displayName="ThemeExampleStory";var ThemeExample=ThemeExampleStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"-call-themeexample",title:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"/CallComposite/Theme Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.a,argTypes:Object.assign({connectionString:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.connectionString,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.displayName,theme:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.theme,font:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.font,callInvitationURL:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.callInvitationURL},_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.b),parameters:{docs:{page:function page(){return Object(_CallCompositeDocs__WEBPACK_IMPORTED_MODULE_19__.a)()}}}},ThemeExample.parameters=Object.assign({storySource:{source:'(args): JSX.Element => {\n  const [containerProps, setContainerProps] = useState();\n\n  useEffect(() => {\n    const fetchContainerProps = async (): Promise<void> => {\n      if (args.connectionString && args.displayName) {\n        const newProps = await createUserAndGroup(args.connectionString);\n        setContainerProps(newProps);\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchContainerProps();\n  }, [args.connectionString, args.displayName]);\n\n  const theme: PartialTheme = {\n    ...getControlledTheme(args.theme),\n    // The default themes exported by fluent samples, enforce Segoe UI using the `fonts` attribute in theme object.\n    // To override it, we need to set the `fonts` attribute to `undefined` in the theme object.\n    fonts: {},\n    defaultFontStyle: { fontFamily: args.font ?? \'Segoe UI\' }\n  };\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <ContosoCallContainer\n          displayName={args.displayName}\n          fluentTheme={theme}\n          {...containerProps}\n          callInvitationURL={args.callInvitationURL}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},ThemeExample.parameters)},1392:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BasicExample",(function(){return BasicExample}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(50),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(123),_fluentui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(99),react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(0),_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(13),_controlsUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(6),_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(180),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(284),_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(220),_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(133),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var messageArray=["Hello ACS!","Congratulations! You can see this message because you successfully passed in a connection string!","In production environment, it is recommended to issue tokens in server side.","You can also issue a token by creating your own server and input them in required tab below.","Have fun!"],BasicStory=function BasicStory(args,context){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_16__.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_16__.useEffect)((function(){(function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!args.connectionString||!args.displayName){_context.next=9;break}return _context.next=3,Object(_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__.a)(args.connectionString,args.displayName);case 3:return newProps=_context.sent,_context.next=6,Object(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.c)(args.connectionString,newProps.token,newProps.threadId,messageArray);case 6:setContainerProps(Object.assign({},newProps)),_context.next=10;break;case 9:setContainerProps(void 0);case 10:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.connectionString,args.displayName]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_15__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_17__.f,children:containerProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_20__.a,Object.assign({fluentTheme:context.theme},containerProps,{showParticipants:args.showParticipants,showTopic:args.showTopic})):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.a,{})})};BasicStory.displayName="BasicStory";var BasicExample=BasicStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"-chat-basicexample",title:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"/ChatComposite/Basic Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.b,argTypes:Object.assign({connectionString:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.connectionString,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.displayName,showParticipants:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.showChatParticipants,showTopic:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.showChatTopic},_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.c),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_19__.a)()}}}},BasicExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const [containerProps, setContainerProps] = useState<ContainerProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.connectionString && args.displayName) {\n        const newProps = await createUserAndThread(args.connectionString, args.displayName);\n        await addParrotBotToThread(args.connectionString, newProps.token, newProps.threadId, messageArray);\n        setContainerProps({ ...newProps });\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.connectionString, args.displayName]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <ContosoChatContainer\n          fluentTheme={context.theme}\n          {...containerProps}\n          showParticipants={args.showParticipants}\n          showTopic={args.showTopic}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},BasicExample.parameters)},1393:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  AzureCommunicationTokenCredential,\n  CommunicationUserIdentifier,\n  getIdentifierKind\n} from '@azure/communication-common';\nimport { ChatAdapter, ChatComposite, createAzureCommunicationChatAdapter } from '@azure/communication-react';\nimport { Theme, PartialTheme } from '@fluentui/react';\nimport React, { useState, useEffect, useMemo } from 'react';\n\nexport type ContainerProps = {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  threadId: string;\n  fluentTheme?: PartialTheme | Theme;\n  showParticipants?: boolean;\n  showTopic?: boolean;\n};\n\nexport const ContosoChatContainer = (props: ContainerProps): JSX.Element => {\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(props.token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [props.token]);\n\n  // Creating an adapter is asynchronous.\n  // An update to `config` triggers a new adapter creation, via the useEffect block.\n  // When the adapter becomes ready, the state update triggers a re-render of the ChatComposite.\n  const [adapter, setAdapter] = useState<ChatAdapter>();\n  useEffect(() => {\n    if (!!credential && props) {\n      const createAdapter = async (credential: AzureCommunicationTokenCredential): Promise<void> => {\n        setAdapter(\n          await createAzureCommunicationChatAdapter({\n            endpointUrl: props.endpointUrl,\n            userId: getIdentifierKind(props.userId),\n            displayName: props.displayName,\n            credential,\n            threadId: props.threadId\n          })\n        );\n      };\n      createAdapter(credential);\n    }\n  }, [props, credential]);\n\n  if (adapter) {\n    return (\n      <ChatComposite\n        adapter={adapter}\n        fluentTheme={props.fluentTheme}\n        options={{ showParticipantPane: props.showParticipants }}\n      />\n    );\n  }\n  if (credential === undefined) {\n    return <>Failed to construct credential. Provided token is malformed.</>;\n  }\n  return <>Initializing...</>;\n};\n"},1394:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  AzureCommunicationTokenCredential,\n  CommunicationUserIdentifier,\n  getIdentifierKind\n} from '@azure/communication-common';\nimport { ChatAdapter, ChatComposite, createAzureCommunicationChatAdapter } from '@azure/communication-react';\nimport { PartialTheme, Theme } from '@fluentui/react';\nimport React, { useState, useEffect, useCallback } from 'react';\n\nexport interface CustomDataModelExampleContainerProps {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  threadId: string;\n  botUserId: string;\n  botAvatar: string;\n  fluentTheme?: PartialTheme | Theme;\n}\n\nexport const CustomDataModelExampleContainer = (props: CustomDataModelExampleContainerProps): JSX.Element => {\n  // Creating an adapter is asynchronous.\n  // An update to `config` triggers a new adapter creation, via the useEffect block.\n  // When the adapter becomes ready, the state update triggers a re-render of the ChatComposite.\n  const [adapter, setAdapter] = useState<ChatAdapter>();\n  useEffect(() => {\n    if (props) {\n      const createAdapter = async (): Promise<void> => {\n        setAdapter(\n          await createAzureCommunicationChatAdapter({\n            endpointUrl: props.endpointUrl,\n            userId: getIdentifierKind(props.userId),\n            // Data model injection: The display name for the local user comes from Contoso's data model.\n            displayName: props.displayName,\n            credential: new AzureCommunicationTokenCredential(props.token),\n            threadId: props.threadId\n          })\n        );\n      };\n      createAdapter();\n    }\n  }, [props]);\n\n  // Data model injection: Contoso provides avatars for the chat participants.\n  // Unlike the displayName example above, this sets the avatar for the remote bot participant.\n  //\n  // Although ChatComposite is not a pure react component, this callback may be passed on to\n  // pure components lower in the Component tree.\n  // Thus, it is best practice to memoize this with useCallback() to avoid spurious rendering.\n  const onRenderAvatar = useCallback(\n    (userId: string): JSX.Element => {\n      if (userId === props.botUserId) {\n        return <label>{props.botAvatar}</label>;\n      }\n      return <label>?</label>;\n    },\n    [props.botUserId, props.botAvatar]\n  );\n  return (\n    <>\n      {adapter ? (\n        <ChatComposite\n          fluentTheme={props.fluentTheme}\n          adapter={adapter}\n          onRenderAvatar={onRenderAvatar}\n          options={{ showParticipantPane: true, showTopic: true }}\n        />\n      ) : (\n        <h3>Loading...</h3>\n      )}\n    </>\n  );\n};\n"},1395:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  AzureCommunicationTokenCredential,\n  CommunicationUserIdentifier,\n  getIdentifierKind\n} from '@azure/communication-common';\nimport { ChatAdapter, ChatComposite, createAzureCommunicationChatAdapter } from '@azure/communication-react';\nimport React, { useState, useEffect } from 'react';\n\nexport type ContainerProps = {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  threadId: string;\n};\n\nexport const ContosoChatContainer = (props: ContainerProps): JSX.Element => {\n  const [adapter, setAdapter] = useState<ChatAdapter>();\n\n  useEffect(() => {\n    if (!props) return;\n\n    const createAdapter = async (): Promise<void> => {\n      const chatAdapter = await createAzureCommunicationChatAdapter({\n        endpointUrl: props.endpointUrl,\n        userId: getIdentifierKind(props.userId),\n        displayName: props.displayName,\n        credential: new AzureCommunicationTokenCredential(props.token),\n        threadId: props.threadId\n      });\n\n      // Custom behavior: Intercept messages from the local user and convert\n      // to uppercase before sending to backend.\n      const sendMessage = chatAdapter.sendMessage.bind(chatAdapter);\n      chatAdapter.sendMessage = async (content: string): Promise<void> => {\n        await sendMessage(content.toUpperCase());\n      };\n\n      setAdapter(chatAdapter);\n    };\n\n    createAdapter();\n  }, [props]);\n\n  return (\n    <>\n      {adapter ? (\n        <ChatComposite adapter={adapter} options={{ showParticipantPane: true, showTopic: true }} />\n      ) : (\n        <h3>Loading...</h3>\n      )}\n    </>\n  );\n};\n"},1396:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Contoso server to create a new user and thread.\n\nimport { ChatClient } from '@azure/communication-chat';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport { CommunicationIdentityClient } from '@azure/communication-identity';\n\nexport const createUserAndThread = async (resourceConnectionString: string, displayName: string): Promise<any> => {\n  const tokenClient = new CommunicationIdentityClient(resourceConnectionString);\n  const user = await tokenClient.createUserAndToken(['chat']);\n\n  const endpointUrl = new URL(resourceConnectionString.replace('endpoint=', '').split(';')[0]).toString();\n  const chatClient = new ChatClient(endpointUrl, new AzureCommunicationTokenCredential(user.token));\n  const threadId =\n    (\n      await chatClient.createChatThread(\n        { topic: 'Chat with a friendly bot' },\n        {\n          participants: [{ id: user.user, displayName: displayName }]\n        }\n      )\n    ).chatThread?.id ?? '';\n\n  return {\n    userId: user.user,\n    token: user.token,\n    endpointUrl,\n    displayName,\n    threadId\n  };\n};\n"},1397:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"JoinExistingChatThread",(function(){return JoinExistingChatThread}));__webpack_require__(50),__webpack_require__(10);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(123),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(99),_constants__WEBPACK_IMPORTED_MODULE_5__=(__webpack_require__(0),__webpack_require__(13)),_controlsUtils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(6),_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(180),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(284),_snippets_Utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(133),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(1),JoinExistingChatThreadStory=function JoinExistingChatThreadStory(args,context){var areAllControlsSet=!!(args.endpointUrl&&args.threadId&&args.userId&&args.token&&args.displayName);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_5__.f,children:areAllControlsSet?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_8__.a,{fluentTheme:context.theme,endpointUrl:args.endpointUrl,threadId:args.threadId,userId:{communicationUserId:args.userId},token:args.token,displayName:args.displayName,showParticipants:!0,showTopic:!0}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_10__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_9__.b,{})})};JoinExistingChatThreadStory.displayName="JoinExistingChatThreadStory";var JoinExistingChatThread=JoinExistingChatThreadStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_5__.b+"-chat-joinexistingchatthread",title:_constants__WEBPACK_IMPORTED_MODULE_5__.b+"/ChatComposite/Join Existing Chat Thread",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.b,argTypes:Object.assign({endpointUrl:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.endpointUrl,threadId:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.chatThreadId,userId:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.userId,token:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.token,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.a.displayName},_controlsUtils__WEBPACK_IMPORTED_MODULE_6__.c),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_7__.a)()}}}},JoinExistingChatThread.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const areAllControlsSet =\n    !!args.endpointUrl && !!args.threadId && !!args.userId && !!args.token && !!args.displayName;\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {areAllControlsSet ? (\n        <ContosoChatContainer\n          fluentTheme={context.theme}\n          endpointUrl={args.endpointUrl}\n          threadId={args.threadId}\n          userId={{ communicationUserId: args.userId }}\n          token={args.token}\n          displayName={args.displayName}\n          showParticipants={true}\n          showTopic={true}\n        />\n      ) : (\n        <ConfigJoinChatThreadHintBanner />\n      )}\n    </Stack>\n  );\n}'}},JoinExistingChatThread.parameters)},1398:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ThemeExample",(function(){return ThemeExample}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(50),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(123),_fluentui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(99),react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(0),_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(13),_controlsUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(6),_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(180),_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(284),_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(220),_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(133),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var messageArray=["Welcome to the theming example!","The ChatComposite can be themed with a Fluent UI theme, just like the base components.","Here, you can play around with some themes from the @fluentui/theme-samples package.","To build your own theme, we recommend using https://aka.ms/themedesigner","Have fun!"],ThemeStory=function ThemeStory(args){var _args$font,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_16__.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];Object(react__WEBPACK_IMPORTED_MODULE_16__.useEffect)((function(){(function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!args.connectionString||!args.displayName){_context.next=9;break}return _context.next=3,Object(_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__.a)(args.connectionString,args.displayName);case 3:return newProps=_context.sent,_context.next=6,Object(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.c)(args.connectionString,newProps.token,newProps.threadId,messageArray);case 6:setContainerProps(newProps),_context.next=10;break;case 9:setContainerProps(void 0);case 10:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.connectionString,args.displayName]);var theme=Object.assign({},Object(_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.i)(args.theme),{fonts:{},defaultFontStyle:{fontFamily:null!==(_args$font=args.font)&&void 0!==_args$font?_args$font:"Segoe UI"}});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_15__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_17__.f,children:containerProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Container_snippet__WEBPACK_IMPORTED_MODULE_20__.a,Object.assign({},containerProps,{fluentTheme:theme,showParticipants:!0})):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Utils__WEBPACK_IMPORTED_MODULE_22__.a,{})})};ThemeStory.displayName="ThemeStory";var ThemeExample=ThemeStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"-chat-themeexample",title:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"/ChatComposite/Theme Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.b,argTypes:Object.assign({connectionString:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.connectionString,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.displayName,theme:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.theme,font:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.font},_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.c),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(_ChatCompositeDocs__WEBPACK_IMPORTED_MODULE_19__.a)()}}}},ThemeExample.parameters=Object.assign({storySource:{source:'(args): JSX.Element => {\n  const [containerProps, setContainerProps] = useState<ContainerProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.connectionString && args.displayName) {\n        const newProps = await createUserAndThread(args.connectionString, args.displayName);\n        await addParrotBotToThread(args.connectionString, newProps.token, newProps.threadId, messageArray);\n        setContainerProps(newProps);\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.connectionString, args.displayName]);\n\n  const theme: PartialTheme = {\n    ...getControlledTheme(args.theme),\n    // The default themes exported by fluent samples, enforce Segoe UI using the `fonts` attribute in theme object.\n    // To override it, we need to set the `fonts` attribute to `undefined` in the theme object.\n    fonts: {},\n    defaultFontStyle: { fontFamily: args.font ?? \'Segoe UI\' }\n  };\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <ContosoChatContainer {...containerProps} fluentTheme={theme} showParticipants={true} />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},ThemeExample.parameters)},1399:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomCameraButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'CameraIconKey'} iconName={'Camera'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon\n        key={'CameraIconKey'}\n        iconName={'Camera'}\n        style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }}\n      />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Label key={'CameraLabelKey'} style={{ fontStyle: 'italic' }}>\n          Turn off\n        </Label>\n      );\n    }\n\n    return <Label key={'CameraLabelKey'}>Turn on</Label>;\n  };\n\n  return (\n    <>\n      <CameraButton\n        key={'camera 1'}\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <CameraButton\n        key={'camera 2'}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n    </>\n  );\n};\n"},1400:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CameraButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <CameraButton key={'camBtn1'} checked={true} />\n      <CameraButton key={'camBtn2'} />\n    </FluentThemeProvider>\n  );\n};\n"},1401:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CameraButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <CameraButton showLabel={true} checked={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1402:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ControlBarButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label, Text } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomControlBarButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'customIcon1'} iconName={'Airplane'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon key={'customIcon2'} iconName={'Bus'} style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }} />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Text key={'customText'} style={{ fontStyle: 'italic' }}>\n          unmuted\n        </Text>\n      );\n    }\n\n    return <Label key={'customLabel'}>muted</Label>;\n  };\n\n  return (\n    <>\n      <ControlBarButton\n        key={'customBtn1'}\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <ControlBarButton\n        key={'customBtn2'}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n    </>\n  );\n};\n"},1403:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ControlBarButton } from '@azure/communication-react';\nimport { Airplane20Filled, VehicleShip20Filled } from '@fluentui/react-icons';\nimport React from 'react';\n\nexport const ControlBarButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ControlBarButton\n        key={'btn1'}\n        onRenderIcon={() => <Airplane20Filled key={'airplaneIconKey'} primaryFill=\"currentColor\" />}\n      />\n      <ControlBarButton\n        key={'btn1'}\n        onRenderIcon={() => <VehicleShip20Filled key={'shipIconKey'} primaryFill=\"currentColor\" />}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1404:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ControlBarButton } from '@azure/communication-react';\nimport { Airplane20Filled, VehicleShip20Filled } from '@fluentui/react-icons';\nimport React from 'react';\n\nexport const ControlBarButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ControlBarButton\n        key={'btn1'}\n        onRenderIcon={() => <Airplane20Filled key={'airplaneIconKey'} primaryFill=\"currentColor\" />}\n        strings={{ label: 'airplane' }}\n        labelKey={'airplaneButtonLabel'}\n        showLabel={true}\n      />\n      <ControlBarButton\n        key={'btn1'}\n        onRenderIcon={() => <VehicleShip20Filled key={'shipIconKey'} primaryFill=\"currentColor\" />}\n        strings={{ label: 'ship' }}\n        labelKey={'shipButtonLabel'}\n        showLabel={true}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1405:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { EndCallButton } from '@azure/communication-react';\nimport { Icon, Label } from '@fluentui/react';\nimport React from 'react';\n\nexport const EndCallButtonCustomExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (): JSX.Element => {\n    return <Icon key={'endCallCustomIconKey'} iconName={'DeclineCall'} style={{ color: 'black', fontSize: '25px' }} />;\n  };\n\n  const customOnRenderText = (/*props?: IButtonProps*/): JSX.Element => {\n    return (\n      <Label key={'endCallCustomLabelKey'} style={{ color: 'blue', fontStyle: 'italic' }}>\n        end call\n      </Label>\n    );\n  };\n\n  return (\n    <EndCallButton\n      style={{ background: 'cyan' }}\n      key={'endCallCustomBtnKey'}\n      showLabel={true}\n      onRenderIcon={customOnRenderIcon}\n      onRenderText={customOnRenderText}\n    />\n  );\n};\n"},1406:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { EndCallButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const EndCallButtonDefaultExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <EndCallButton />\n    </FluentThemeProvider>\n  );\n};\n"},1407:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { EndCallButton, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const EndCallButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <EndCallButton showLabel={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1408:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { MicrophoneButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label, Text } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomMicrophoneButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'micCustomIcon1'} iconName={'Microphone'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon\n        key={'micCustomIcon2'}\n        iconName={'Microphone'}\n        style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }}\n      />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Text key={'micCustomText'} style={{ fontStyle: 'italic' }}>\n          unmuted\n        </Text>\n      );\n    }\n\n    return <Label key={'micCustomLabel'}>muted</Label>;\n  };\n\n  return (\n    <>\n      <MicrophoneButton\n        key={'micCustomBtn1'}\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <MicrophoneButton\n        key={'micCustomBtn2'}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n    </>\n  );\n};\n"},1409:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MicrophoneButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const MicrophoneButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MicrophoneButton key={'micBtn1'} checked={true} />\n      <MicrophoneButton key={'micBtn2'} />\n    </FluentThemeProvider>\n  );\n};\n"},1410:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MicrophoneButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const MicrophoneButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MicrophoneButton showLabel={true} checked={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1411:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { OptionsButton } from '@azure/communication-react';\nimport { Icon, IContextualMenuProps, Label } from '@fluentui/react';\nimport React from 'react';\n\nconst exampleOptionsMenuProps: IContextualMenuProps = {\n  items: [\n    {\n      key: '1',\n      name: 'Choose Camera',\n      iconProps: { iconName: 'Camera' },\n      onClick: () => alert('Choose Camera Menu Item Clicked!')\n    }\n  ]\n};\n\nexport const OptionsButtonCustomExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (): JSX.Element => {\n    return (\n      <Icon key={'optionsCustomIconKey'} iconName={'CircleAddition'} style={{ color: 'orange', fontSize: '20px' }} />\n    );\n  };\n\n  const customOnRenderText = (): JSX.Element => {\n    return (\n      <Label key={'optionsCustomLabelKey'} style={{ color: 'darkviolet', fontStyle: 'italic' }}>\n        More\n      </Label>\n    );\n  };\n\n  return (\n    <OptionsButton\n      key={'optionsCustomBtnKey'}\n      showLabel={true}\n      menuProps={exampleOptionsMenuProps}\n      onRenderIcon={customOnRenderIcon}\n      onRenderText={customOnRenderText}\n    />\n  );\n};\n"},1412:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, OptionsButton } from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nconst exampleOptionsMenuProps: IContextualMenuProps = {\n  items: [\n    {\n      key: '1',\n      name: 'Choose Camera',\n      iconProps: { iconName: 'LocationCircle' },\n      onClick: () => alert('Choose Camera Menu Item Clicked!')\n    }\n  ]\n};\n\nexport const OptionsButtonDefaultExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <OptionsButton menuProps={exampleOptionsMenuProps} />\n    </FluentThemeProvider>\n  );\n};\n"},1413:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, OptionsButton } from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nconst exampleOptionsMenuProps: IContextualMenuProps = {\n  items: [\n    {\n      key: '1',\n      name: 'Choose Camera',\n      iconProps: { iconName: 'LocationCircle' },\n      onClick: () => alert('Choose Camera Menu Item Clicked!')\n    }\n  ]\n};\n\nexport const OptionsButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <OptionsButton showLabel={true} menuProps={exampleOptionsMenuProps} />\n    </FluentThemeProvider>\n  );\n};\n"},1414:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  FluentThemeProvider,\n  ParticipantsButton,\n  ParticipantListProps\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nconst mockParticipantsProps: ParticipantListProps = {\n  participants: mockParticipants\n};\n\nexport const ParticipantsButtonDefaultExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton participantListProps={mockParticipantsProps} />\n    </FluentThemeProvider>\n  );\n};\n"},1415:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  FluentThemeProvider,\n  ParticipantsButton,\n  ParticipantListProps\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nconst mockParticipantsProps: ParticipantListProps = {\n  participants: mockParticipants,\n  myUserId: 'user1'\n};\n\nconst mockCallLink = 'URL to invite new participants to the current call (https://...)';\n\nexport const ParticipantsButtonWithCallLinkExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton participantListProps={mockParticipantsProps} callInvitationURL={mockCallLink} />\n    </FluentThemeProvider>\n  );\n};\n"},1416:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  CommunicationParticipant,\n  FluentThemeProvider,\n  ParticipantsButton,\n  ParticipantListProps\n} from '@azure/communication-react';\nimport { Icon, Label, Persona, PersonaSize } from '@fluentui/react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: true,\n    isScreenSharing: false\n  }\n];\n\nconst customOnRenderAvatar = (participant: CommunicationParticipant): JSX.Element => {\n  if (participant.userId === 'user2') {\n    return (\n      <img\n        key={`avatar${participant.userId}`}\n        src=\"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif\"\n        style={{\n          borderRadius: '32px',\n          width: '32px',\n          position: 'relative',\n          margin: 'auto',\n          left: 0,\n          right: 0,\n          top: 0,\n          bottom: 0\n        }}\n      />\n    );\n  }\n\n  return <Persona text={participant.displayName} hidePersonaDetails={true} size={PersonaSize.size32} />;\n};\n\nconst mockParticipantsProps: ParticipantListProps = {\n  participants: mockParticipants,\n  myUserId: 'user1',\n  onRenderAvatar: (participant: CommunicationParticipant) => customOnRenderAvatar(participant)\n};\n\nconst mockCallLink = 'URL to invite new participants to the current call (https://...)';\n\nconst onMuteAll = (): void => {\n  // your implementation to mute all participants\n};\n\nexport const ParticipantsButtonWithCustomRenderExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (): JSX.Element => {\n    return <Icon key={'participantsCustomIconKey'} iconName={'Group'} style={{ color: 'orange', fontSize: '20px' }} />;\n  };\n\n  const customOnRenderText = (): JSX.Element => {\n    return (\n      <Label key={'participantsCustomLabelKey'} style={{ color: 'darkviolet', fontStyle: 'italic' }}>\n        who is on this call\n      </Label>\n    );\n  };\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton\n        showLabel={true}\n        participantListProps={mockParticipantsProps}\n        callInvitationURL={mockCallLink}\n        onMuteAll={onMuteAll}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1417:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  FluentThemeProvider,\n  ParticipantsButton,\n  ParticipantListProps,\n  ParticipantsButtonStylesProps\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: true,\n    isScreenSharing: false\n  }\n];\n\nconst mockParticipantsProps: ParticipantListProps = {\n  participants: mockParticipants,\n  myUserId: 'user1'\n};\n\nconst mockCallLink = 'URL to invite new participants to the current call (https://...)';\n\nconst onMuteAll = (): void => {\n  // your implementation to mute all participants\n};\n\nconst mockStyles: ParticipantsButtonStylesProps = {\n  root: { background: 'blue', color: 'white' },\n  rootHovered: { background: 'crimson', color: 'white' },\n  rootExpanded: { background: 'dimgrey', color: 'white' },\n  label: { color: 'white', fontStyle: 'italic' },\n  participantListContainerStyle: { border: 'solid 1px red' }\n};\n\nexport const ParticipantsButtonWithCustomStylesExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton\n        showLabel={true}\n        participantListProps={mockParticipantsProps}\n        callInvitationURL={mockCallLink}\n        onMuteAll={onMuteAll}\n        styles={mockStyles}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1418:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  FluentThemeProvider,\n  ParticipantsButton,\n  ParticipantListProps\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nconst mockParticipantsProps: ParticipantListProps = {\n  participants: mockParticipants\n};\n\nexport const ParticipantsButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton showLabel={true} participantListProps={mockParticipantsProps} />\n    </FluentThemeProvider>\n  );\n};\n"},1419:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  FluentThemeProvider,\n  ParticipantsButton,\n  ParticipantListProps\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nconst mockParticipantsProps: ParticipantListProps = {\n  participants: mockParticipants,\n  myUserId: 'user1'\n};\n\nconst mockCallLink = 'URL to invite new participants to the current call (https://...)';\n\nconst onMuteAll = (): void => {\n  // your implementation to mute all participants\n};\n\nexport const ParticipantsButtonWithMuteAllOptionExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton\n        participantListProps={mockParticipantsProps}\n        callInvitationURL={mockCallLink}\n        onMuteAll={onMuteAll}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1420:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  FluentThemeProvider,\n  ParticipantsButton,\n  ParticipantListProps\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nconst mockParticipantsProps: ParticipantListProps = {\n  participants: mockParticipants,\n  myUserId: 'user1',\n  excludeMe: true\n};\n\nexport const ParticipantsButtonWithUserExcludeFromListExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ParticipantsButton participantListProps={mockParticipantsProps} />\n    </FluentThemeProvider>\n  );\n};\n"},1421:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ScreenShareButton } from '@azure/communication-react';\nimport { IButtonProps, Icon, Label } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomScreenShareButtonExample: () => JSX.Element = () => {\n  const customOnRenderIcon = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return <Icon key={'screenShareIconKey'} iconName={'Presentation'} style={{ color: 'green', fontSize: '25px' }} />;\n    }\n\n    return (\n      <Icon\n        key={'screenShareIconKey'}\n        iconName={'Presentation'}\n        style={{ color: 'red', fontSize: '25px', fontWeight: 'bolder' }}\n      />\n    );\n  };\n\n  const customOnRenderText = (props?: IButtonProps): JSX.Element => {\n    if (props?.checked) {\n      return (\n        <Label key={'screenShareLabelKey'} style={{ fontStyle: 'italic' }}>\n          sharing screen\n        </Label>\n      );\n    }\n\n    return <Label key={'screenShareLabelKey'}>not sharing screen</Label>;\n  };\n\n  return (\n    <>\n      <ScreenShareButton\n        checked={true}\n        showLabel={true}\n        onRenderIcon={customOnRenderIcon}\n        onRenderText={customOnRenderText}\n      />\n      <ScreenShareButton showLabel={true} onRenderIcon={customOnRenderIcon} onRenderText={customOnRenderText} />\n    </>\n  );\n};\n"},1422:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ScreenShareButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const ScreenShareButtonExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ScreenShareButton key={'micBtn1'} checked={true} />\n      <ScreenShareButton key={'micBtn2'} />\n    </FluentThemeProvider>\n  );\n};\n"},1423:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, ScreenShareButton } from '@azure/communication-react';\nimport React from 'react';\n\nexport const ScreenShareButtonWithLabelExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <ScreenShareButton showLabel={true} checked={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1424:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  OptionsButton,\n  ParticipantListProps,\n  ParticipantsButton,\n  ScreenShareButton\n} from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nconst mockParticipantsProps: ParticipantListProps = {\n  participants: mockParticipants,\n  myUserId: 'user1'\n};\n\nexport const AllButtonsControlBarExample: () => JSX.Element = () => {\n  const exampleOptionsMenuProps: IContextualMenuProps = {\n    items: [\n      {\n        key: '1',\n        name: 'Choose Camera',\n        iconProps: { iconName: 'LocationCircle' },\n        onClick: () => alert('Choose Camera Menu Item Clicked!')\n      }\n    ]\n  };\n  const onMuteAll = (): void => {\n    // your implementation to mute all participants\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'}>\n        <CameraButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <MicrophoneButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <ScreenShareButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <ParticipantsButton\n          participantListProps={mockParticipantsProps}\n          callInvitationURL={'URL to copy'}\n          onMuteAll={onMuteAll}\n        />\n        <OptionsButton menuProps={exampleOptionsMenuProps} />\n        <EndCallButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1425:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  OptionsButton,\n  ParticipantListProps,\n  ParticipantsButton,\n  ScreenShareButton\n} from '@azure/communication-react';\nimport React from 'react';\n\nconst componentMainDivStyle = {\n  display: 'flex',\n  border: 'solid 0.5px lightgray',\n  height: '24rem',\n  alignItems: 'center',\n  justifyContent: 'center'\n};\n\nconst mockParticipantsProps: ParticipantListProps = {\n  participants: []\n};\n\nexport const ControlBarLayoutExample: () => JSX.Element = () => {\n  return (\n    <div style={componentMainDivStyle}>\n      <FluentThemeProvider>\n        <ControlBar layout=\"floatingLeft\">\n          <CameraButton />\n          <MicrophoneButton />\n          <ScreenShareButton />\n          <ParticipantsButton participantListProps={mockParticipantsProps} />\n          <OptionsButton />\n          <EndCallButton />\n        </ControlBar>\n      </FluentThemeProvider>\n    </div>\n  );\n};\n"},1426:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton\n} from '@azure/communication-react';\nimport { CallEnd20Filled } from '@fluentui/react-icons';\nimport React from 'react';\n\nexport const CustomButtonsExample: () => JSX.Element = () => {\n  const CustomEndCallButton: () => JSX.Element = () => {\n    const customStyles = {\n      root: {\n        height: 'inherit',\n        background: 'darkorange',\n        color: 'white',\n        width: '10rem'\n      },\n      rootHovered: {\n        background: 'darkred',\n        color: 'white'\n      },\n      flexContainer: { flexFlow: 'row' }\n    };\n\n    return (\n      <EndCallButton\n        styles={customStyles}\n        showLabel={true}\n        onRenderIcon={() => <CallEnd20Filled primaryFill=\"currentColor\" key={'hangupBtnIconKey'} />}\n        onRenderText={() => (\n          <span key={'hangupBtnTextKey'} style={{ marginLeft: '0.5rem' }}>\n            End Call\n          </span>\n        )}\n        onClick={() => {\n          /* handle hangup */\n        }}\n      />\n    );\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'}>\n        <CameraButton />\n        <MicrophoneButton />\n        <CustomEndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1427:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const CustomControlBarStylesExample: () => JSX.Element = () => {\n  const customStyles = {\n    root: {\n      backgroundColor: 'lightgray',\n      border: 'solid black',\n      borderRadius: '0.3rem',\n      maxWidth: 'fit-content'\n    }\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'} styles={customStyles}>\n        <CameraButton />\n        <MicrophoneButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1428:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CameraButton, ControlBar, FluentThemeProvider, OptionsButton } from '@azure/communication-react';\nimport { IContextualMenuProps } from '@fluentui/react';\nimport React from 'react';\n\nexport const OptionsButtonExample: () => JSX.Element = () => {\n  const exampleOptionsMenuProps: IContextualMenuProps = {\n    items: [\n      {\n        key: '1',\n        name: 'Choose Camera',\n        iconProps: { iconName: 'LocationCircle' },\n        subMenuProps: {\n          items: [\n            { key: 'camera1', text: 'Full HD Webcam', title: 'Full HD Webcam', canCheck: true, isChecked: true },\n            { key: 'camera2', text: 'Macbook Pro Webcam', title: 'Macbook Pro Webcam' }\n          ]\n        }\n      },\n      {\n        key: '2',\n        name: 'Choose Microphone',\n        iconProps: { iconName: 'LocationCircle' },\n        subMenuProps: {\n          items: [\n            { key: 'mic1', text: 'Realtek HD Audio', title: 'Realtek HD Audio' },\n            { key: 'mic2', text: 'Macbook Pro Mic', title: 'Macbook Pro Mic', canCheck: true, isChecked: true }\n          ]\n        }\n      }\n    ]\n  };\n\n  return (\n    <FluentThemeProvider>\n      <ControlBar layout={'horizontal'}>\n        <CameraButton\n          onClick={() => {\n            /*handle onClick*/\n          }}\n        />\n        <OptionsButton menuProps={exampleOptionsMenuProps} />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n"},1429:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ErrorBar",(function(){return ErrorBar}));__webpack_require__(73),__webpack_require__(121),__webpack_require__(151),__webpack_require__(50),__webpack_require__(10),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(9),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(24),_fluentui_react__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(335),_fluentui_react__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(20),_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(5),react__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(0),_constants__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(13),_controlsUtils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(6),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ErrorBarStory=function ErrorBarStory(args){var theme=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_17__.a)(),_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_20__.useState)([]),2),activeErrors=_useState2[0],setActiveErrors=_useState2[1];Object(react__WEBPACK_IMPORTED_MODULE_20__.useEffect)((function(){setActiveErrors(args.errorTypes)}),[args.errorTypes]);var onClose=Object(react__WEBPACK_IMPORTED_MODULE_20__.useCallback)((function(toRemove){setActiveErrors(activeErrors.filter((function(e){return!toRemove.includes(e)})))}),[activeErrors]);return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)("div",{className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_18__.G)({background:theme.palette.neutralLighterAlt,padding:"2em",width:"75%",height:"50%"}),children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_16__.e,{activeErrors:activeErrors,onDismissErrors:onClose})})};ErrorBarStory.displayName="ErrorBarStory";var ErrorBar=ErrorBarStory.bind({});__webpack_exports__.default={title:_constants__WEBPACK_IMPORTED_MODULE_21__.a+"/Error Bar",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_16__.e,argTypes:{errorTypes:_controlsUtils__WEBPACK_IMPORTED_MODULE_22__.a.errorTypes,activeErrors:_controlsUtils__WEBPACK_IMPORTED_MODULE_22__.j,strings:_controlsUtils__WEBPACK_IMPORTED_MODULE_22__.j,onDismissErrors:_controlsUtils__WEBPACK_IMPORTED_MODULE_22__.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__.j,{children:"ErrorBar"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__.c,{children:"`ErrorBar` is a wrapper on fluent UI's `MessageBar` with additional features for surfacing Azure Communication Services errors on the UI consistently."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__.c,{children:"Set the `showErrorBar` option for `ChatComposite` to use an `ErrorBar` to show errors."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__.i,{children:"Localization"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__.c,{children:"Similar to other UI components in this library, `ErrorBarProps` accepts all strings shown on the UI as a `strings` field. The `activeErrors` field selects from these strings to show in the `ErrorBar` UI."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__.i,{children:"Multiple errors"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__.c,{children:"More than one error can occur at the same time. The `ErrorBar` component can show multiple active errors. To avoid confusing the user, it is important to be mindful to limit the total number of errors that are shown together."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__.d,{children:"ErrorBar Props"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_19__.f,{of:_azure_communication_react__WEBPACK_IMPORTED_MODULE_16__.e})]})}()}}}},ErrorBar.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const theme = useTheme();\n\n  const [activeErrors, setActiveErrors] = useState<ErrorType[]>([]);\n\n  useEffect(() => {\n    setActiveErrors(args.errorTypes);\n  }, [args.errorTypes]);\n\n  const onClose = useCallback(\n    (toRemove: ErrorType[]) => {\n      setActiveErrors(activeErrors.filter((e) => !toRemove.includes(e)));\n    },\n    [activeErrors]\n  );\n\n  return (\n    <div\n      className={mergeStyles({\n        background: theme.palette.neutralLighterAlt,\n        padding: '2em',\n        width: '75%',\n        height: '50%'\n      })}\n    >\n      <ErrorBarComponent activeErrors={activeErrors} onDismissErrors={onClose} />\n    </div>\n  );\n}"}},ErrorBar.parameters)},1430:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, useTheme } from '@azure/communication-react';\nimport { Dropdown, IDropdownOption } from '@fluentui/react';\nimport React from 'react';\n\nexport interface DeviceSettingsProps {\n  devices: string[];\n  onChange: (event: React.FormEvent<HTMLDivElement>, option?: IDropdownOption, index?: number) => void;\n}\n\nexport const DeviceSettingDropdownExample = ({ devices, onChange }: DeviceSettingsProps): JSX.Element => {\n  const theme = useTheme();\n\n  return (\n    <FluentThemeProvider fluentTheme={theme}>\n      <Dropdown\n        style={{ width: '15rem', overflow: 'hidden' }}\n        placeholder=\"Select an option\"\n        onChange={onChange}\n        options={devices.map((device) => {\n          return {\n            selected: false,\n            key: device,\n            text: device\n          };\n        })}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1431:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"IncomingCallModal",(function(){return IncomingCallModal}));__webpack_require__(50),__webpack_require__(10),__webpack_require__(0);var _constants__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(13),_controlsUtils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(6),_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(155),_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(294),_IncomingCallAlertsDocs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(420),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1),IncomingCallModalStory=function IncomingCallModalStory(args){var videoStreamElements=Object(_utils__WEBPACK_IMPORTED_MODULE_5__.a)(args.localVideoStreamEnabled?1:0),videoStreamElement=videoStreamElements[0]?videoStreamElements[0]:null;return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_components__WEBPACK_IMPORTED_MODULE_6__.a,{callerName:args.callerName,callerNameAlt:args.callerNameAlt,callerTitle:args.callerTitle,alertText:args.alertText,avatar:args.images.length>0?args.images[0]:void 0,onClickVideoToggle:function onClickVideoToggle(){return null},onClickAccept:function onClickAccept(){return null},onClickReject:function onClickReject(){return null},localParticipantDisplayName:args.localParticipantDisplayName,localVideoInverted:args.localVideoInverted,localVideoStreamElement:videoStreamElement})};IncomingCallModalStory.displayName="IncomingCallModalStory";var IncomingCallModal=IncomingCallModalStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_3__.c+"-incomingcallalerts-incomingcallmodal",title:_constants__WEBPACK_IMPORTED_MODULE_3__.c+"/Incoming Call Alerts/Incoming Call Modal",component:_components__WEBPACK_IMPORTED_MODULE_6__.a,argTypes:{alertText:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callModalAlertText,callerName:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callerName,callerNameAlt:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callerNameAlt,callerTitle:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callerTitle,images:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.callerImages,localParticipantDisplayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.localParticipantDisplayName,localVideoStreamEnabled:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.localVideoStreamEnabled,localVideoInverted:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.a.localVideoInverted,avatar:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j,onClickAccept:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j,onClickReject:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j,localVideoStreamElement:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j,onClickVideoToggle:_controlsUtils__WEBPACK_IMPORTED_MODULE_4__.j},parameters:{docs:{page:function page(){return Object(_IncomingCallAlertsDocs__WEBPACK_IMPORTED_MODULE_7__.a)()}}}},IncomingCallModal.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const videoStreamElements = useVideoStreams(args.localVideoStreamEnabled ? 1 : 0);\n  const videoStreamElement = videoStreamElements[0] ? videoStreamElements[0] : null;\n\n  return (\n    <IncomingCallModalComponent\n      callerName={args.callerName}\n      callerNameAlt={args.callerNameAlt}\n      callerTitle={args.callerTitle}\n      alertText={args.alertText}\n      avatar={args.images.length > 0 ? args.images[0] : undefined}\n      onClickVideoToggle={() => null}\n      onClickAccept={() => null}\n      onClickReject={() => null}\n      localParticipantDisplayName={args.localParticipantDisplayName}\n      localVideoInverted={args.localVideoInverted}\n      localVideoStreamElement={videoStreamElement}\n    />\n  );\n}"}},IncomingCallModal.parameters)},1432:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"IncomingCallToast",(function(){return IncomingCallToast}));__webpack_require__(50),__webpack_require__(10);var _fluentui_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(99),_constants__WEBPACK_IMPORTED_MODULE_4__=(__webpack_require__(0),__webpack_require__(13)),_controlsUtils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(6),_components__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(294),_IncomingCallAlertsDocs__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(420),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(1),IncomingCallToastStory=function IncomingCallToastStory(args){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_2__.a,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_8__.jsx)(_components__WEBPACK_IMPORTED_MODULE_6__.b,{callerName:args.callerName,alertText:args.alertText,avatar:args.images.length>0?args.images[0]:void 0,onClickAccept:function onClickAccept(){return null},onClickReject:function onClickReject(){return null}})})};IncomingCallToastStory.displayName="IncomingCallToastStory";var IncomingCallToast=IncomingCallToastStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_4__.c+"-incomingcallalerts-incomingcalltoast",title:_constants__WEBPACK_IMPORTED_MODULE_4__.c+"/Incoming Call Alerts/Incoming Call Toast",component:_components__WEBPACK_IMPORTED_MODULE_6__.b,argTypes:{callerName:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.a.callerName,alertText:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.a.callToastAlertText,images:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.a.callerImages,avatar:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.j,onClickAccept:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.j,onClickReject:_controlsUtils__WEBPACK_IMPORTED_MODULE_5__.j},parameters:{docs:{page:function page(){return Object(_IncomingCallAlertsDocs__WEBPACK_IMPORTED_MODULE_7__.a)()}}}},IncomingCallToast.parameters=Object.assign({storySource:{source:"(args) => {\n  return (\n    <Stack>\n      <IncomingCallToastComponent\n        callerName={args.callerName}\n        alertText={args.alertText}\n        avatar={args.images.length > 0 ? args.images[0] : undefined}\n        onClickAccept={() => null}\n        onClickReject={() => null}\n      />\n    </Stack>\n  );\n}"}},IncomingCallToast.parameters)},1433:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"OneToOneCallLayout",(function(){return OneToOneCallLayout}));__webpack_require__(50),__webpack_require__(10);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(24),_fluentui_react__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(560),_fluentui_react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(26),_fluentui_react__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(20),_fluentui_react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(99),_constants__WEBPACK_IMPORTED_MODULE_8__=(__webpack_require__(0),__webpack_require__(13)),_controlsUtils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(6),_LayoutsDocs__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(428),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(1),renderPersona=function renderPersona(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_3__.a,{styles:{root:{margin:"auto"}},size:_fluentui_react__WEBPACK_IMPORTED_MODULE_4__.c.size56,hidePersonaDetails:!0,text:"Toby",initialsTextColor:"white"})};renderPersona.displayName="renderPersona";var OneToOneCallLayoutStory=function OneToOneCallLayoutStory(args){var videoStreamStyle=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_5__.G)({border:"1",borderStyle:"solid",position:"absolute",bottom:".25rem",right:".25rem",height:"25%",width:"30%"});return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_6__.a,{style:{height:args.height+"px",width:args.width+"px",border:"1px"},horizontal:!0,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.v,{styles:{overlayContainer:videoStreamStyle},displayName:"Holly",children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_11__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_2__.v,{onRenderPlaceholder:renderPersona})})})};OneToOneCallLayoutStory.displayName="OneToOneCallLayoutStory";var OneToOneCallLayout=OneToOneCallLayoutStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_8__.c+"-layouts-onetoonecalllayout",title:_constants__WEBPACK_IMPORTED_MODULE_8__.c+"/Layouts/One To One Call Layout",argTypes:{width:_controlsUtils__WEBPACK_IMPORTED_MODULE_9__.a.layoutWidth,height:_controlsUtils__WEBPACK_IMPORTED_MODULE_9__.a.layoutHeight},parameters:{docs:{page:function page(){return Object(_LayoutsDocs__WEBPACK_IMPORTED_MODULE_10__.a)()}}}},OneToOneCallLayout.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const videoStreamStyle = mergeStyles({\n    border: '1',\n    borderStyle: 'solid',\n    position: 'absolute',\n    bottom: '.25rem',\n    right: '.25rem',\n    height: '25%',\n    width: '30%'\n  });\n\n  return (\n    <Stack style={{ height: `${args.height}px`, width: `${args.width}px`, border: '1px' }} horizontal>\n      {/* Video component for the other person's video stream */}\n      <VideoTile\n        styles={{\n          overlayContainer: videoStreamStyle\n        }}\n        displayName={'Holly'}\n      >\n        {/* Video component for my video stream stream */}\n        <VideoTile\n          // A render placeholder function for my video stream\n          onRenderPlaceholder={renderPersona}\n        />\n      </VideoTile>\n    </Stack>\n  );\n}"}},OneToOneCallLayout.parameters)},1434:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile } from '@azure/communication-react';\nimport { mergeStyles, Persona, PersonaSize, Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst renderPersona = (): JSX.Element => (\n  <Persona\n    styles={{ root: { margin: 'auto' } }}\n    size={PersonaSize.size56}\n    hidePersonaDetails={true}\n    text={'Toby'}\n    initialsTextColor=\"white\"\n  />\n);\n\nexport const OneToOneCallLayoutExample: () => JSX.Element = () => {\n  const videoStreamStyle = mergeStyles({\n    border: '1',\n    borderStyle: 'solid',\n    position: 'absolute',\n    bottom: '.25rem',\n    right: '.25rem',\n    height: '25\\u0025',\n    width: '30\\u0025'\n  });\n\n  return (\n    <Stack style={{ height: '500px', width: '600px', border: '1px' }} horizontal>\n      {/* Video component for the other person's video stream */}\n      <VideoTile\n        styles={{\n          overlayContainer: videoStreamStyle\n        }}\n        displayName={'Holly'}\n      >\n        {/* Video component for my video stream stream */}\n        <VideoTile\n          // A render placeholder function for my video stream\n          onRenderPlaceholder={renderPersona}\n        />\n      </VideoTile>\n    </Stack>\n  );\n};\n"},1435:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { PlaceholderProps, VideoTile } from '@azure/communication-react';\nimport { mergeStyles, Persona, PersonaSize, Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst renderPersona = (props: PlaceholderProps): JSX.Element => (\n  <Persona\n    styles={{ root: { margin: 'auto' } }}\n    size={PersonaSize.size56}\n    hidePersonaDetails={true}\n    text={props.displayName}\n    initialsTextColor=\"white\"\n  />\n);\n\nconst renderScreenSharePlaceholder = (): JSX.Element => (\n  <Stack className={mergeStyles({ height: '100\\u0025' })}>\n    <Stack verticalAlign=\"center\" horizontalAlign=\"center\" className={mergeStyles({ height: '100\\u0025' })}>\n      Your Screen Share Stream\n    </Stack>\n  </Stack>\n);\n\nconst renderSharePersonaPlaceholder = (): JSX.Element => (\n  <Persona\n    styles={{ root: { margin: 'auto' } }}\n    size={PersonaSize.size56}\n    hidePersonaDetails={true}\n    text={'Toby'}\n    initialsTextColor=\"white\"\n  />\n);\n\nexport const ScreenShareLayoutExample: () => JSX.Element = () => {\n  const MockParticipantDisplayNames = ['Michael', 'Jim', 'Pam', 'Dwight', 'Kelly', 'Ryan', 'Andy'];\n\n  const aspectRatioBoxStyle = mergeStyles({\n    borderWidth: '.063rem .063rem .025rem .063rem',\n    borderStyle: 'solid',\n    width: '100\\u0025',\n    height: 0,\n    position: 'relative',\n    paddingTop: '56.25\\u0025'\n  });\n\n  const aspectRatioBoxContentStyle = mergeStyles({\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100\\u0025',\n    height: '100\\u0025'\n  });\n\n  const videoStreamStyle = mergeStyles({\n    border: '1',\n    borderStyle: 'solid',\n    position: 'absolute',\n    bottom: '.25rem',\n    right: '.25rem',\n    height: '20\\u0025',\n    width: '30\\u0025'\n  });\n\n  const screenShareLayoutStyle = {\n    height: `31.25rem`,\n    width: `53.125rem`,\n    border: '.063rem'\n  };\n\n  const participantsComponents = MockParticipantDisplayNames.map((participantDisplayName, index) => {\n    return (\n      <Stack className={aspectRatioBoxStyle} key={index}>\n        <Stack className={aspectRatioBoxContentStyle}>\n          <VideoTile displayName={participantDisplayName} onRenderPlaceholder={renderPersona} />\n        </Stack>\n      </Stack>\n    );\n  });\n\n  return (\n    <Stack style={screenShareLayoutStyle} horizontal>\n      {/* Side panel component in this layout */}\n      <Stack.Item className={mergeStyles({ height: '100\\u0025', width: '30\\u0025' })}>\n        <Stack grow className={mergeStyles({ height: '100\\u0025', overflow: 'auto' })}>\n          {participantsComponents}\n        </Stack>\n      </Stack.Item>\n      {/* Screen share stream component in this layout */}\n      <Stack.Item grow className={mergeStyles({ height: '100\\u0025' })}>\n        {/* The screen share component that will display the screen share stream and sharer's video */}\n        <VideoTile\n          styles={{\n            overlayContainer: videoStreamStyle\n          }}\n          // A placeholder element for the screen share stream\n          onRenderPlaceholder={renderScreenSharePlaceholder}\n        >\n          {/* We want to render another overlay videoTile inside the parent videoTile for screen sharer's video */}\n          <VideoTile\n            // A placeholder element for screen sharer's video stream\n            onRenderPlaceholder={renderSharePersonaPlaceholder}\n          >\n            {/* We do not want to add any overlay component for this videoTile, so we do not add children for this videoTile. */}\n          </VideoTile>\n        </VideoTile>\n      </Stack.Item>\n    </Stack>\n  );\n};\n"},1436:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ScreenShareLayout",(function(){return ScreenShareLayout}));__webpack_require__(93),__webpack_require__(53),__webpack_require__(517),__webpack_require__(34),__webpack_require__(50),__webpack_require__(10);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(24),_fluentui_react__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(560),_fluentui_react__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(26),_fluentui_react__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(99),_fluentui_react__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(20),_constants__WEBPACK_IMPORTED_MODULE_12__=(__webpack_require__(0),__webpack_require__(13)),_controlsUtils__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(6),_LayoutsDocs__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(428),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1),renderPersona=function renderPersona(props){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{styles:{root:{margin:"auto"}},size:_fluentui_react__WEBPACK_IMPORTED_MODULE_8__.c.size56,hidePersonaDetails:!0,text:props.displayName,initialsTextColor:"white"})};renderPersona.displayName="renderPersona";var renderScreenSharePlaceholder=function renderScreenSharePlaceholder(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_9__.a,{className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_10__.G)({height:"100%"}),children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_9__.a,{verticalAlign:"center",horizontalAlign:"center",className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_10__.G)({height:"100%"}),children:"Your Screen Share Stream"})})};renderScreenSharePlaceholder.displayName="renderScreenSharePlaceholder";var renderSharePersonaPlaceholder=function renderSharePersonaPlaceholder(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_7__.a,{styles:{root:{margin:"auto"}},size:_fluentui_react__WEBPACK_IMPORTED_MODULE_8__.c.size56,hidePersonaDetails:!0,text:"Toby",initialsTextColor:"white"})};renderSharePersonaPlaceholder.displayName="renderSharePersonaPlaceholder";var MockParticipantDisplayNames=["Michael","Jim","Pam","Dwight","Kelly","Ryan","Andy"],aspectRatioBoxContentStyle=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_10__.G)({position:"absolute",top:0,left:0,width:"100%",height:"100%"}),videoStreamStyle=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_10__.G)({border:"1",borderStyle:"solid",position:"absolute",bottom:".25rem",right:".25rem",height:"20%",width:"30%"}),ScreenShareLayoutStory=function ScreenShareLayoutStory(args){var aspectRatioNumberArray=args.sidePanelTileAspectRatio.split(":"),aspectRatio=100*parseInt(aspectRatioNumberArray[1])/parseInt(aspectRatioNumberArray[0])+"%",aspectRatioBoxStyle=Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_10__.G)({borderWidth:".063rem .063rem .025rem .063rem",borderStyle:"solid",width:"100%",height:0,position:"relative",paddingTop:aspectRatio}),screenShareLayoutStyle={height:args.height+"px",width:args.width+"px",border:".063rem"},participantsComponents=MockParticipantDisplayNames.map((function(participantDisplayName,index){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_9__.a,{className:aspectRatioBoxStyle,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_9__.a,{className:aspectRatioBoxContentStyle,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_6__.v,{displayName:participantDisplayName,onRenderPlaceholder:renderPersona})})},index)}));return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsxs)(_fluentui_react__WEBPACK_IMPORTED_MODULE_9__.a,{style:screenShareLayoutStyle,horizontal:!0,children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_9__.a.Item,{className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_10__.G)({height:"100%",width:args.sidePanelWidthRatio}),children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_9__.a,{grow:!0,className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_10__.G)({height:"100%",overflow:"auto"}),children:participantsComponents})}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_9__.a.Item,{grow:!0,className:Object(_fluentui_react__WEBPACK_IMPORTED_MODULE_10__.G)({height:"100%"}),children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_6__.v,{styles:{overlayContainer:videoStreamStyle},onRenderPlaceholder:renderScreenSharePlaceholder,children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_6__.v,{onRenderPlaceholder:renderSharePersonaPlaceholder})})})]})};ScreenShareLayoutStory.displayName="ScreenShareLayoutStory";var ScreenShareLayout=ScreenShareLayoutStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_12__.c+"-layouts-screensharelayout",title:_constants__WEBPACK_IMPORTED_MODULE_12__.c+"/Layouts/Screen Share Layout",argTypes:{width:_controlsUtils__WEBPACK_IMPORTED_MODULE_13__.a.screenShareLayoutWidth,height:_controlsUtils__WEBPACK_IMPORTED_MODULE_13__.a.layoutHeight,sidePanelWidthRatio:_controlsUtils__WEBPACK_IMPORTED_MODULE_13__.a.screenShareSidePanelWidthRatio,sidePanelTileAspectRatio:_controlsUtils__WEBPACK_IMPORTED_MODULE_13__.a.screenShareSidePanelTileAspectRatio},parameters:{docs:{page:function page(){return Object(_LayoutsDocs__WEBPACK_IMPORTED_MODULE_14__.a)()}}}},ScreenShareLayout.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const aspectRatioNumberArray = args.sidePanelTileAspectRatio.split(':');\n  const aspectRatio = (100 * parseInt(aspectRatioNumberArray[1])) / parseInt(aspectRatioNumberArray[0]) + '%';\n\n  const aspectRatioBoxStyle = mergeStyles({\n    borderWidth: '.063rem .063rem .025rem .063rem',\n    borderStyle: 'solid',\n    width: '100%',\n    height: 0,\n    position: 'relative',\n    paddingTop: aspectRatio\n  });\n\n  const screenShareLayoutStyle = {\n    height: `${args.height}px`,\n    width: `${args.width}px`,\n    border: '.063rem'\n  };\n\n  const participantsComponents = MockParticipantDisplayNames.map((participantDisplayName, index) => {\n    return (\n      <Stack className={aspectRatioBoxStyle} key={index}>\n        <Stack className={aspectRatioBoxContentStyle}>\n          <VideoTile displayName={participantDisplayName} onRenderPlaceholder={renderPersona} />\n        </Stack>\n      </Stack>\n    );\n  });\n\n  return (\n    <Stack style={screenShareLayoutStyle} horizontal>\n      {/* Side panel component in this layout */}\n      <Stack.Item className={mergeStyles({ height: '100%', width: args.sidePanelWidthRatio })}>\n        <Stack grow className={mergeStyles({ height: '100%', overflow: 'auto' })}>\n          {participantsComponents}\n        </Stack>\n      </Stack.Item>\n      {/* Screen share stream component in this layout */}\n      <Stack.Item grow className={mergeStyles({ height: '100%' })}>\n        {/* The screen share component that will display the screen share stream and sharer's video */}\n        <VideoTile\n          styles={{\n            overlayContainer: videoStreamStyle\n          }}\n          // A placeholder element for the screen share stream\n          onRenderPlaceholder={renderScreenSharePlaceholder}\n        >\n          {/* Video component for screen sharer's stream */}\n          <VideoTile\n            // A placeholder element for screen sharer's video stream\n            onRenderPlaceholder={renderSharePersonaPlaceholder}\n          />\n        </VideoTile>\n      </Stack.Item>\n    </Stack>\n  );\n}"}},ScreenShareLayout.parameters)},1437:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  StreamMedia,\n  VideoTile,\n  ControlBar,\n  CameraButton,\n  MicrophoneButton,\n  FluentThemeProvider,\n  useTheme\n} from '@azure/communication-react';\nimport { Stack, mergeStyles, Text } from '@fluentui/react';\nimport { VideoOff20Filled } from '@fluentui/react-icons';\nimport React, { useCallback, useState } from 'react';\nimport { useVideoStreams } from '../../../utils';\n\nexport interface LocalPreviewProps {\n  isVideoAvailable: boolean;\n  isCameraEnabled: boolean;\n  isMicrophoneEnabled: boolean;\n}\n\nexport const LocalPreviewExample = ({\n  isVideoAvailable,\n  isCameraEnabled,\n  isMicrophoneEnabled\n}: LocalPreviewProps): JSX.Element => {\n  const [microphone, setMicrophone] = useState(true);\n  const [camera, setCamera] = useState(true);\n  const theme = useTheme();\n  const palette = theme.palette;\n\n  const localPreviewContainerStyle = mergeStyles({\n    minWidth: '25rem',\n    width: '100\\u0025',\n    height: '100\\u0025',\n    maxHeight: '18.75rem',\n    minHeight: '16.875rem',\n    margin: '0 auto',\n    background: palette.neutralLighter,\n    color: palette.neutralTertiary\n  });\n\n  const videoTileStyle = {\n    root: {\n      minHeight: '14rem'\n    }\n  };\n\n  const cameraOffLabelStyle = mergeStyles({\n    fontFamily: 'Segoe UI Regular',\n    fontSize: '0.625rem', // 10px\n    color: palette.neutralTertiary\n  });\n\n  const renderCameraOffPlaceholder = useCallback(\n    () => (\n      <Stack style={{ width: '100\\u0025', height: '100\\u0025' }} verticalAlign=\"center\">\n        <Stack.Item align=\"center\">\n          <VideoOff20Filled primaryFill=\"currentColor\" />\n        </Stack.Item>\n        <Stack.Item align=\"center\">\n          <Text className={cameraOffLabelStyle}>Your camera is turned off</Text>\n        </Stack.Item>\n      </Stack>\n    ),\n    [cameraOffLabelStyle]\n  );\n\n  const videoStreams = useVideoStreams(1);\n  const videoStreamElement = isVideoAvailable ? videoStreams[0] : null;\n\n  return (\n    <FluentThemeProvider fluentTheme={theme}>\n      <Stack style={{ width: '100\\u0025', height: '100\\u0025' }} verticalAlign=\"center\">\n        <Stack.Item align=\"center\">\n          <Stack className={localPreviewContainerStyle}>\n            <VideoTile\n              styles={videoTileStyle}\n              // Here this storybook example isn't connected with Azure Communication Services\n              // We would suggest you replace this videoStreamElement below with a rendered video stream from the calling SDK\n              renderElement={\n                isVideoAvailable && isCameraEnabled && camera ? (\n                  <StreamMedia videoStreamElement={videoStreamElement} />\n                ) : undefined\n              }\n              onRenderPlaceholder={renderCameraOffPlaceholder}\n            >\n              <ControlBar layout=\"floatingBottom\">\n                <CameraButton\n                  disabled={!isCameraEnabled}\n                  checked={isCameraEnabled ? camera : false}\n                  onClick={() => setCamera(!camera)}\n                />\n                <MicrophoneButton\n                  disabled={!isMicrophoneEnabled}\n                  checked={isMicrophoneEnabled ? microphone : false}\n                  onClick={() => setMicrophone(!microphone)}\n                />\n              </ControlBar>\n            </VideoTile>\n          </Stack>\n        </Stack.Item>\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1438:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile } from '@azure/communication-react';\nimport React from 'react';\nimport { ComplianceBanner } from './ComplianceBanner.snippet';\n\nexport const CallComponent = (): JSX.Element => {\n  const videoTileStyles = {\n    root: { height: '100%', width: '100%' },\n    overlayContainer: {}\n  };\n\n  return (\n    <VideoTile styles={videoTileStyles}>\n      <ComplianceBanner callRecordState={true} callTranscribeState={true} />\n    </VideoTile>\n  );\n};\n"},1439:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default='// ComplianceBanner.snippet.tsx\n\nimport { Link, MessageBar } from \'@fluentui/react\';\nimport React, { useEffect, useState } from \'react\';\n\nexport type ComplianceBannerProps = {\n  callTranscribeState?: boolean;\n  callRecordState?: boolean;\n};\n\nexport const ComplianceBanner = (props: ComplianceBannerProps): JSX.Element => {\n  const [previousCallTranscribeState, setPreviousCallTranscribeState] = useState<boolean | undefined>(false);\n  const [previousCallRecordState, setPreviousCallRecordState] = useState<boolean | undefined>(false);\n  const [variant, setVariant] = useState(0);\n\n  const TRANSCRIPTION_STOPPED_STILL_RECORDING = 1;\n  const RECORDING_STOPPED_STILL_TRANSCRIBING = 2;\n  const RECORDING_AND_TRANSCRIPTION_STOPPED = 3;\n  const RECORDING_AND_TRANSCRIPTION_STARTED = 4;\n  const TRANSCRIPTION_STARTED = 5;\n  const RECORDING_STOPPED = 6;\n  const RECORDING_STARTED = 7;\n  const RECORDING_STOPPED_AND_SAVED = 8;\n  const NO_STATE = 0;\n\n  const { callTranscribeState, callRecordState } = props;\n\n  useEffect(() => {\n    if (previousCallRecordState && previousCallTranscribeState) {\n      if (callRecordState && !callTranscribeState) {\n        setVariant(TRANSCRIPTION_STOPPED_STILL_RECORDING);\n      } else if (!callRecordState && callTranscribeState) {\n        setVariant(RECORDING_STOPPED_STILL_TRANSCRIBING);\n      } else if (!callRecordState && !callTranscribeState) {\n        setVariant(RECORDING_AND_TRANSCRIPTION_STOPPED);\n      } else {\n        setVariant(NO_STATE);\n      }\n    } else if (previousCallRecordState && !previousCallTranscribeState) {\n      if (callRecordState && callTranscribeState) {\n        setVariant(RECORDING_AND_TRANSCRIPTION_STARTED);\n      } else if (!callRecordState && callTranscribeState) {\n        setVariant(TRANSCRIPTION_STARTED);\n      } else if (!callRecordState && !callTranscribeState) {\n        setVariant(RECORDING_STOPPED);\n      } else {\n        setVariant(NO_STATE);\n      }\n    } else if (!previousCallRecordState && previousCallTranscribeState) {\n      if (callRecordState && callTranscribeState) {\n        setVariant(RECORDING_AND_TRANSCRIPTION_STARTED);\n      } else if (!callRecordState && callTranscribeState) {\n        setVariant(RECORDING_STARTED);\n      } else if (!callRecordState && !callTranscribeState) {\n        setVariant(RECORDING_STOPPED_AND_SAVED);\n      } else {\n        setVariant(NO_STATE);\n      }\n    } else if (!previousCallRecordState && !previousCallTranscribeState) {\n      if (callRecordState && callTranscribeState) {\n        setVariant(RECORDING_AND_TRANSCRIPTION_STARTED);\n      } else if (callRecordState && !callTranscribeState) {\n        setVariant(RECORDING_STARTED);\n      } else if (!callRecordState && callTranscribeState) {\n        setVariant(TRANSCRIPTION_STARTED);\n      } else {\n        setVariant(NO_STATE);\n      }\n    }\n\n    setPreviousCallTranscribeState(callTranscribeState);\n    setPreviousCallRecordState(callRecordState);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [callTranscribeState, callRecordState]);\n\n  function PrivacyPolicy(): JSX.Element {\n    return (\n      <Link\n        href="https://privacy.microsoft.com/en-US/privacystatement#mainnoticetoendusersmodule"\n        target="_blank"\n        underline\n      >\n        Privacy policy\n      </Link>\n    );\n  }\n\n  function LearnMore(): JSX.Element {\n    return (\n      <Link\n        href="https://support.microsoft.com/en-us/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24"\n        target="_blank"\n        underline\n      >\n        Learn more\n      </Link>\n    );\n  }\n\n  function getBannerMessage(variant: number): JSX.Element {\n    switch (variant) {\n      case TRANSCRIPTION_STOPPED_STILL_RECORDING:\n        return (\n          <>\n            <b>Transcription has stopped.</b> You are now only recording this meeting.\n            <PrivacyPolicy />\n          </>\n        );\n      case RECORDING_STOPPED_STILL_TRANSCRIBING:\n        return (\n          <>\n            <b>Recording has stopped.</b> You are now only transcribing this meeting.\n            <PrivacyPolicy />\n          </>\n        );\n      case RECORDING_AND_TRANSCRIPTION_STOPPED:\n        return (\n          <>\n            <b>Recording and transcription are being saved. </b> Recording and transcription have stopped.\n            <LearnMore />\n          </>\n        );\n      case RECORDING_AND_TRANSCRIPTION_STARTED:\n        return (\n          <>\n            <b>Recording and transcription have started.</b> By joining, you are giving consent for this meeting to be\n            transcribed.\n            <PrivacyPolicy />\n          </>\n        );\n      case TRANSCRIPTION_STARTED:\n        return (\n          <>\n            <b>Transcription has started.</b> By joining, you are giving consent for this meeting to be transcribed.\n            <PrivacyPolicy />\n          </>\n        );\n      case RECORDING_STOPPED:\n        return (\n          <>\n            <b>Recording is being saved.</b> Recording has stopped.\n            <LearnMore />\n          </>\n        );\n      case RECORDING_STARTED:\n        return (\n          <>\n            <b>Recording has started.</b> By joining, you are giving consent for this meeting to be transcribed.\n            <PrivacyPolicy />\n          </>\n        );\n      case RECORDING_STOPPED_AND_SAVED:\n        return (\n          <>\n            <b>Transcription is being saved.</b> Transcription has stopped.\n            <LearnMore />\n          </>\n        );\n    }\n    return <></>;\n  }\n\n  return variant === NO_STATE ? (\n    <></>\n  ) : (\n    <MessageBar\n      onDismiss={() => {\n        setVariant(NO_STATE);\n      }}\n      dismissButtonAriaLabel="Close"\n    >\n      {getBannerMessage(variant)}\n    </MessageBar>\n  );\n};\n'},1440:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  StreamMedia,\n  VideoTile,\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  MicrophoneButton,\n  OptionsButton,\n  useTheme\n} from '@azure/communication-react';\nimport React from 'react';\n\n// Don't import this. It's just a helper for the story.\nimport { useVideoStreams } from '../../../utils';\n\nexport interface LobbyProps {\n  isVideoReady: boolean;\n  callStateText: string;\n  callStateSubText: string;\n}\n\nexport const Lobby = (props: LobbyProps): JSX.Element => {\n  const theme = useTheme();\n  const palette = theme.palette;\n\n  const videoTileStyles = {\n    root: { height: '100%', width: '100%' },\n    overlayContainer: {}\n  };\n\n  const ControlBarStyles = {\n    root: { background: theme.palette.white, minHeight: '4.25rem', alignItems: 'center' }\n  };\n\n  // Helper code to make the storybook work. Replace with your own code for video stream element.\n  const videoStreams = useVideoStreams(1);\n  const videoStreamElement = props.isVideoReady ? videoStreams[0] : undefined;\n  const videoRenderElement = videoStreamElement ? <StreamMedia videoStreamElement={videoStreamElement} /> : undefined;\n\n  return (\n    <VideoTile\n      styles={videoTileStyles}\n      isMirrored={true}\n      onRenderPlaceholder={() => <></>}\n      renderElement={videoRenderElement}\n    >\n      <div\n        style={{\n          width: '100%',\n          height: '100%',\n          position: 'absolute',\n          background: props.isVideoReady ? '#201f1e' : palette.neutralLight,\n          opacity: 0.75\n        }}\n      />\n\n      <div\n        style={{\n          position: 'absolute',\n          top: '50%',\n          left: '50%',\n          transform: 'translate(-50%, -50%)',\n          marginTop: '-2.125rem'\n        }}\n      >\n        <p\n          style={{\n            fontSize: '1.75rem',\n            color: props.isVideoReady ? 'white' : palette.neutralPrimary,\n            textAlign: 'center',\n            margin: '0'\n          }}\n        >\n           <br /> {props.callStateText} <br />\n        </p>\n        <p\n          style={{\n            fontSize: '0.75rem',\n            color: props.isVideoReady ? 'white' : palette.neutralPrimary,\n            textAlign: 'center',\n            margin: '0'\n          }}\n        >\n          {props.callStateSubText}\n        </p>\n      </div>\n\n      <ControlBar layout=\"dockedBottom\" styles={ControlBarStyles}>\n        <CameraButton showLabel={true} checked={true} />\n        <MicrophoneButton showLabel={true} checked={true} />\n        <OptionsButton showLabel={true} />\n        <EndCallButton showLabel={true} style={{ borderRadius: '0.25rem', marginLeft: '0.25rem' }} />\n      </ControlBar>\n    </VideoTile>\n  );\n};\n"},1441:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  GridLayout,\n  MicrophoneButton,\n  ScreenShareButton,\n  VideoTile,\n  useTheme\n} from '@azure/communication-react';\nimport { Stack, mergeStyles } from '@fluentui/react';\nimport React from 'react';\n\nconst teamsTheme = {\n  palette: {\n    themePrimary: '#4b53bc',\n    themeLighterAlt: '#030308',\n    themeLighter: '#0c0d1e',\n    themeLight: '#171939',\n    themeTertiary: '#2d3271',\n    themeSecondary: '#4249a6',\n    themeDarkAlt: '#5a61c3',\n    themeDark: '#6f76cd',\n    themeDarker: '#9196da',\n    neutralLighterAlt: '#1e1e1e',\n    neutralLighter: '#1d1d1d',\n    neutralLight: '#1c1c1c',\n    neutralQuaternaryAlt: '#1a1a1a',\n    neutralQuaternary: '#191919',\n    neutralTertiaryAlt: '#181818',\n    neutralTertiary: '#c8c8c8',\n    neutralSecondary: '#d0d0d0',\n    neutralPrimaryAlt: '#dadada',\n    neutralPrimary: '#ffffff',\n    neutralDark: '#f4f4f4',\n    black: '#f8f8f8',\n    white: '#1f1f1f'\n  }\n};\n\nexport const TeamsTheme: () => JSX.Element = () => {\n  const wrapperStyle = {\n    width: '100%',\n    height: '100%',\n    maxWidth: '50rem',\n    maxHeight: '30rem'\n  };\n\n  return (\n    <div style={wrapperStyle}>\n      <FluentThemeProvider fluentTheme={teamsTheme}>\n        <App />\n      </FluentThemeProvider>\n    </div>\n  );\n};\n\nconst App: () => JSX.Element = () => {\n  const theme = useTheme();\n\n  const headerContainer = mergeStyles({\n    width: '100%',\n    height: '3.875rem',\n    overflow: 'hidden',\n    flexDirection: 'row',\n    justifyContent: 'flex-end',\n    alignItems: 'center',\n    marginBottom: 2,\n    background: theme.palette.white\n  });\n\n  const controlBarStyle = {\n    root: {\n      marginRight: '.5rem',\n      alignItems: 'center'\n    }\n  };\n\n  const teamsButtonStyle = {\n    root: { minWidth: '2.75rem' },\n    rootHovered: { color: theme.palette.themePrimary, background: 'none' }\n  };\n\n  const endCallButtonStyles = {\n    root: {\n      height: '2rem',\n      minHeight: '2rem',\n      width: '6.5rem',\n      borderRadius: '0.125rem'\n    }\n  };\n\n  const videoTileStyle = {\n    root: { background: theme.palette.white }\n  };\n\n  return (\n    <Stack\n      style={{\n        height: '100%',\n        width: '100%',\n        background: theme.palette.neutralQuaternaryAlt\n      }}\n    >\n      <Stack className={headerContainer}>\n        <Stack.Item>\n          <ControlBar styles={controlBarStyle}>\n            <CameraButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              styles={teamsButtonStyle}\n            />\n            <MicrophoneButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              styles={teamsButtonStyle}\n            />\n            <ScreenShareButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              styles={teamsButtonStyle}\n            />\n            <EndCallButton\n              onClick={() => {\n                /*handle onClick*/\n              }}\n              showLabel={true}\n              onRenderText={() => (\n                <span key={'endCallBtnTextKey'} style={{ marginLeft: '0.5rem' }}>\n                  Leave\n                </span>\n              )}\n              styles={endCallButtonStyles}\n            />\n          </ControlBar>\n        </Stack.Item>\n      </Stack>\n      <GridLayout>\n        <VideoTile displayName={'Michael'} styles={videoTileStyle} />\n      </GridLayout>\n    </Stack>\n  );\n};\n"},1442:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { GridLayout, VideoTile } from '@azure/communication-react';\nimport React from 'react';\n\nexport const GridLayoutExample = (): JSX.Element => {\n  const videoTileStyles = { root: { padding: '10px', border: '1px solid #999' } };\n  return (\n    <div style={{ height: '530px', width: '830px' }}>\n      <GridLayout>\n        <VideoTile styles={videoTileStyles} displayName={'Michael'} />\n        <VideoTile styles={videoTileStyles} displayName={'Jim'} />\n        <VideoTile styles={videoTileStyles} displayName={'Pam'} />\n        <VideoTile styles={videoTileStyles} displayName={'Dwight'} />\n      </GridLayout>\n    </div>\n  );\n};\n"},1443:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"BasicExample",(function(){return BasicExample}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(50),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(123),_fluentui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(99),react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(0),_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(13),_controlsUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(6),_MeetingCompositeDocs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(422),_snippets_Meeting_snippet__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(423),_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(424),_Utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(425),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var BasicStory=function BasicStory(args,context){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_16__.useState)(),2),meetingProps=_useState2[0],setMeetingProps=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_16__.useEffect)((function(){(function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!args.connectionString||!args.displayName){_context.next=7;break}return _context.next=3,Object(_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__.a)(args.connectionString,args.displayName);case 3:newProps=_context.sent,setMeetingProps(newProps),_context.next=8;break;case 7:setMeetingProps(void 0);case 8:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.connectionString,args.displayName]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_15__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_17__.f,children:meetingProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Meeting_snippet__WEBPACK_IMPORTED_MODULE_20__.a,Object.assign({fluentTheme:context.theme},meetingProps)):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_Utils__WEBPACK_IMPORTED_MODULE_22__.a,{})})};BasicStory.displayName="BasicStory";var BasicExample=BasicStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"-meeting-basicexample",title:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"/MeetingComposite/Basic Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.c,argTypes:Object.assign({connectionString:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.connectionString,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.displayName},_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.g),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(_MeetingCompositeDocs__WEBPACK_IMPORTED_MODULE_19__.a)()}}}},BasicExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const [meetingProps, setMeetingProps] = useState<MeetingExampleProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.connectionString && args.displayName) {\n        const newProps = await createUserCredentials(args.connectionString, args.displayName);\n        setMeetingProps(newProps);\n      } else {\n        setMeetingProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.connectionString, args.displayName]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {meetingProps ? <MeetingExperience fluentTheme={context.theme} {...meetingProps} /> : <ConfigHintBanner />}\n    </Stack>\n  );\n}'}},BasicExample.parameters)},1444:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { GroupCallLocator, TeamsMeetingLinkLocator } from '@azure/communication-calling';\nimport { AzureCommunicationTokenCredential, CommunicationUserIdentifier } from '@azure/communication-common';\nimport {\n  CallAdapter,\n  ChatAdapter,\n  MeetingComposite,\n  createAzureCommunicationCallAdapter,\n  createAzureCommunicationChatAdapter\n} from '@azure/communication-react';\nimport { Theme, PartialTheme } from '@fluentui/react';\nimport React, { useState, useEffect, useMemo } from 'react';\n\nexport type MeetingExampleProps = {\n  userId: CommunicationUserIdentifier;\n  token: string;\n  displayName: string;\n  endpointUrl: string;\n  locator: GroupCallLocator | TeamsMeetingLinkLocator;\n  threadId: string;\n  fluentTheme?: PartialTheme | Theme;\n  callInvitationURL?: string;\n};\n\nexport const MeetingExperience = (props: MeetingExampleProps): JSX.Element => {\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\n\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(props.token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [props.token]);\n\n  useEffect(() => {\n    if (\n      props &&\n      credential &&\n      props.locator &&\n      props.displayName &&\n      props.threadId &&\n      props.userId &&\n      props.endpointUrl\n    ) {\n      const createAdapters = async (): Promise<void> => {\n        setCallAdapter(\n          await createAzureCommunicationCallAdapter({\n            userId: { kind: 'communicationUser', communicationUserId: props.userId.communicationUserId },\n            displayName: props.displayName,\n            credential,\n            locator: props.locator\n          })\n        );\n\n        setChatAdapter(\n          await createAzureCommunicationChatAdapter({\n            endpointUrl: props.endpointUrl,\n            userId: { kind: 'communicationUser', communicationUserId: props.userId.communicationUserId },\n            displayName: props.displayName,\n            credential,\n            threadId: props.threadId\n          })\n        );\n      };\n      createAdapters();\n    }\n  }, [credential, props]);\n\n  if (callAdapter && chatAdapter) {\n    return <MeetingComposite callAdapter={callAdapter} chatAdapter={chatAdapter} fluentTheme={props.fluentTheme} />;\n  }\n\n  if (credential === undefined) {\n    return <>Failed to construct credential. Provided token is malformed.</>;\n  }\n\n  return <>Initializing...</>;\n};\n"},1445:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Contoso server to create a new user and thread.\n\nimport { ChatClient, ChatParticipant } from '@azure/communication-chat';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport { CommunicationIdentityClient } from '@azure/communication-identity';\nimport { v1 as createGUID } from 'uuid';\nimport { MeetingExampleProps } from './Meeting.snippet';\n\nconst getChatThreadFromTeamsLink = (teamsMeetingLink: string): string => {\n  // Get the threadId from the url - this also contains the call locator ID that will be removed in the threadId.split\n  let threadId = teamsMeetingLink.replace('https://teams.microsoft.com/l/meetup-join/', '');\n  // Decode characters that outlook links encode\n  threadId = threadId.replaceAll('%3a', ':').replace('%40', '@');\n  // Extract just the chat guid from the link, stripping away the call locator ID\n  threadId = threadId.split(/^(.*?@thread\\.v2)/gm)[1];\n\n  if (!threadId || threadId.length === 0) throw 'Could not get chat thread from teams link';\n\n  return threadId;\n};\n\nconst createNewChatThread = async (chatClient: ChatClient, participants: ChatParticipant[]): Promise<string> => {\n  const chatThreadResponse = await chatClient.createChatThread(\n    { topic: 'Meeting with a friendly bot' },\n    { participants }\n  );\n  if (chatThreadResponse.invalidParticipants && chatThreadResponse.invalidParticipants.length > 0) {\n    throw 'Server could not add participants to the chat thread';\n  }\n\n  const chatThread = chatThreadResponse.chatThread;\n  if (!chatThread || !chatThread.id) {\n    throw 'Server could not create chat thread';\n  }\n\n  return chatThread.id;\n};\n\nexport const createUserCredentials = async (\n  resourceConnectionString: string,\n  displayName: string,\n  teamsMeetingLink?: string\n): Promise<MeetingExampleProps> => {\n  const tokenClient = new CommunicationIdentityClient(resourceConnectionString);\n  const { user, token } = await tokenClient.createUserAndToken(['voip', 'chat']);\n  const endpointUrl = new URL(resourceConnectionString.replace('endpoint=', '').split(';')[0]).toString();\n  const chatClient = new ChatClient(endpointUrl, new AzureCommunicationTokenCredential(token));\n\n  const locator = teamsMeetingLink ? { meetingLink: teamsMeetingLink } : { groupId: createGUID() };\n\n  const threadId = teamsMeetingLink\n    ? getChatThreadFromTeamsLink(teamsMeetingLink)\n    : await createNewChatThread(chatClient, [{ id: user, displayName: displayName }]);\n\n  return {\n    userId: user,\n    token,\n    displayName,\n    endpointUrl,\n    locator,\n    threadId\n  };\n};\n"},1446:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"JoinExample",(function(){return JoinExample}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(50),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(123),_fluentui_react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(99),react__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(0),_constants__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(13),_controlsUtils__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(6),_MeetingCompositeDocs__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(422),_snippets_Meeting_snippet__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(423),_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(424),_Utils__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(425),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var JoinExistingMeetingStory=function JoinExistingMeetingStory(args,context){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_16__.useState)(),2),meetingProps=_useState2[0],setMeetingProps=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_16__.useEffect)((function(){(function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(args.connectionString&&args.displayName&&args.teamsMeetingLink)){_context.next=7;break}return _context.next=3,Object(_snippets_Server_snippet__WEBPACK_IMPORTED_MODULE_21__.a)(args.connectionString,args.displayName,args.teamsMeetingLink);case 3:newProps=_context.sent,setMeetingProps(newProps),_context.next=8;break;case 7:setMeetingProps(void 0);case 8:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.connectionString,args.displayName,args.teamsMeetingLink]),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_fluentui_react__WEBPACK_IMPORTED_MODULE_15__.a,{horizontalAlign:"center",verticalAlign:"center",styles:_constants__WEBPACK_IMPORTED_MODULE_17__.f,children:meetingProps?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_snippets_Meeting_snippet__WEBPACK_IMPORTED_MODULE_20__.a,Object.assign({fluentTheme:context.theme},meetingProps)):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_23__.jsx)(_Utils__WEBPACK_IMPORTED_MODULE_22__.b,{})})};JoinExistingMeetingStory.displayName="JoinExistingMeetingStory";var JoinExample=JoinExistingMeetingStory.bind({});__webpack_exports__.default={id:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"-meeting-joinexample",title:_constants__WEBPACK_IMPORTED_MODULE_17__.b+"/MeetingComposite/Join Example",component:_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.c,argTypes:Object.assign({connectionString:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.connectionString,displayName:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.displayName,teamsMeetingLink:_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.a.teamsMeetingLink},_controlsUtils__WEBPACK_IMPORTED_MODULE_18__.g),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(_MeetingCompositeDocs__WEBPACK_IMPORTED_MODULE_19__.a)()}}}},JoinExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const [meetingProps, setMeetingProps] = useState<MeetingExampleProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (!!args.connectionString && !!args.displayName && !!args.teamsMeetingLink) {\n        const newProps = await createUserCredentials(args.connectionString, args.displayName, args.teamsMeetingLink);\n        setMeetingProps(newProps);\n      } else {\n        setMeetingProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.connectionString, args.displayName, args.teamsMeetingLink]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {meetingProps ? (\n        <MeetingExperience fluentTheme={context.theme} {...meetingProps} />\n      ) : (\n        <ConfigJoinMeetingHintBanner />\n      )}\n    </Stack>\n  );\n}'}},JoinExample.parameters)},1447:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { MessageStatus, MessageStatusIndicator } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nexport const DefaultMessageStatusIndicatorsExample: () => JSX.Element = () => {\n  return (\n    <Stack>\n      <MessageStatusIndicator status={'delivered' as MessageStatus} />\n      <MessageStatusIndicator status={'seen' as MessageStatus} />\n      <MessageStatusIndicator status={'sending' as MessageStatus} />\n      <MessageStatusIndicator status={'failed' as MessageStatus} />\n    </Stack>\n  );\n};\n"},1448:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport { Persona, PersonaPresence, PersonaSize } from '@fluentui/react';\nimport React from 'react';\nimport { GetAvatarUrlByUserId, GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomAvatarExample: () => JSX.Element = () => {\n  // Customize the Avatar of other participants to be a Persona component from Fluent and show the presence status on the avatar.\n  return (\n    <FluentThemeProvider>\n      <MessageThread\n        userId={'1'}\n        messages={GetHistoryChatMessages()}\n        onRenderAvatar={(userId: string) => {\n          return (\n            <Persona\n              size={PersonaSize.size32}\n              hidePersonaDetails\n              presence={PersonaPresence.online}\n              text={userId}\n              imageUrl={GetAvatarUrlByUserId(userId)}\n            />\n          );\n        }}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1449:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomChatContainerExample: () => JSX.Element = () => {\n  const messageThreadStyles = {\n    chatContainer: {\n      backgroundColor: 'lightgray',\n      padding: '15px'\n    }\n  };\n\n  // Show a customized Chat container.\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} styles={messageThreadStyles} />\n    </FluentThemeProvider>\n  );\n};\n"},1450:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread, MessageThreadStylesProps } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryWithSystemMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomMessageContainerExample: () => JSX.Element = () => {\n  const messageThreadStyle: MessageThreadStylesProps = {\n    chatMessageContainer: {\n      fontStyle: 'italic',\n      boxShadow: '0px 3.2px 7.2px rgb(0 0 0 / 13\\u0025), 0px 0.6px 1.8px rgb(0 0 0 / 11\\u0025)'\n    },\n    systemMessageContainer: { fontWeight: 'bold', border: 'double red' }\n  };\n\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} styles={messageThreadStyle} messages={GetHistoryWithSystemMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1451:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  DefaultMessageRendererType,\n  FluentThemeProvider,\n  MessageProps,\n  MessageThread\n} from '@azure/communication-react';\nimport { Divider } from '@fluentui/react-northstar';\nimport React from 'react';\nimport { GetHistoryWithCustomMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomMessagesExample: () => JSX.Element = () => {\n  // As an example, we want to use render custom message as a Divider.\n  const onRenderMessage = (messageProps: MessageProps, defaultOnRender?: DefaultMessageRendererType): JSX.Element => {\n    if (messageProps.message.type === 'custom') {\n      return <Divider content={messageProps.message.payload.content} color=\"brand\" important />;\n    }\n\n    return defaultOnRender ? defaultOnRender(messageProps) : <></>;\n  };\n\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryWithCustomMessages()} onRenderMessage={onRenderMessage} />\n    </FluentThemeProvider>\n  );\n};\n"},1452:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport { Text } from '@fluentui/react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithCustomMessageStatusIndicatorExample: () => JSX.Element = () => {\n  // Show the status of messages that I sent by setting 'showMessageStatus' prop to be true and customized it\n  return (\n    <FluentThemeProvider>\n      <MessageThread\n        userId={'1'}\n        messages={GetHistoryChatMessages()}\n        showMessageStatus={true}\n        onRenderMessageStatus={(messageStatusIndicatorProps) => {\n          return messageStatusIndicatorProps.status === 'seen' ? (\n            <Text style={{ fontStyle: 'italic', fontWeight: 'bold', color: 'green' }}>seen</Text>\n          ) : null;\n        }}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1453:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const DefaultMessageThreadExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1454:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithMessageStatusIndicatorExample: () => JSX.Element = () => {\n  // Show the status of messages that I sent by setting 'showMessageStatus' prop to be true.\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} showMessageStatus={true} />\n    </FluentThemeProvider>\n  );\n};\n"},1455:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { ChatMessage, CustomMessage, MessageStatus, SystemMessage } from '@azure/communication-react';\n\n// This is some mock messages for example purposes.\n// For actual projects, you can get chat messages from declarative/selectors for ACS.\nexport const GetHistoryChatMessages = (): ChatMessage[] => {\n  return [\n    {\n      type: 'chat',\n      payload: {\n        senderId: 'user1',\n        senderDisplayName: 'Kat Larsson',\n        messageId: Math.random().toString(),\n        content: 'Hi everyone, I created this awesome group chat for us!',\n        createdOn: new Date('2019-04-13T00:00:00.000+08:10'),\n        mine: true,\n        attached: false,\n        status: 'seen' as MessageStatus,\n        type: 'text'\n      }\n    },\n    {\n      type: 'chat',\n      payload: {\n        senderId: 'user2',\n        senderDisplayName: 'Robert Tolbert',\n        messageId: Math.random().toString(),\n        content: 'Nice! This looks great!',\n        createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n        mine: false,\n        attached: false,\n        type: 'text'\n      }\n    },\n    {\n      type: 'chat',\n      payload: {\n        senderId: 'user3',\n        senderDisplayName: 'Carole Poland',\n        messageId: Math.random().toString(),\n        content: \"Yeah agree, let's chat here from now on!\",\n        createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n        mine: false,\n        attached: false,\n        type: 'text'\n      }\n    }\n  ];\n};\n\nexport const GetHistoryWithSystemMessages = (): (SystemMessage | ChatMessage)[] => {\n  return [\n    ...GetHistoryChatMessages(),\n    {\n      type: 'system',\n      payload: {\n        createdOn: new Date('2020-04-13T00:00:00.000+07:01'),\n        type: 'content',\n        messageId: Math.random().toString(),\n        iconName: 'PeopleAdd',\n        content: 'Miguel Garcia is added to the chat'\n      }\n    }\n  ];\n};\n\nexport const GetHistoryWithCustomMessages = (): (CustomMessage | ChatMessage)[] => {\n  return [\n    {\n      type: 'custom',\n      // Custom message's payload can be any shape, this is just an example.\n      // Whatever is defined in the custom message's payload needs to be handled in onRenderMessage in MessageThread.\n      payload: {\n        createdOn: new Date('2020-04-13T00:00:00.000+07:01'),\n        messageId: Math.random().toString(),\n        content: 'Today'\n      }\n    },\n    ...GetHistoryChatMessages()\n  ];\n};\n\n// This is some mock avatars for example purposes.\nexport const GetAvatarUrlByUserId = (userId: string): string => {\n  switch (userId) {\n    case 'user1':\n      return 'images/avatars/avatar-1.jpg';\n    case 'user2':\n      return 'images/avatars/avatar-2.jpg';\n    case 'user3':\n      return 'images/avatars/avatar-8.jpg';\n    default:\n      return '';\n  }\n};\n"},1456:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryWithSystemMessages } from './placeholdermessages';\n\nexport const MessageThreadWithSystemMessagesExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} messages={GetHistoryWithSystemMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1457:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, MessageThread } from '@azure/communication-react';\nimport React from 'react';\nimport { GetHistoryChatMessages } from './placeholdermessages';\n\nexport const MessageThreadWithMessageDateExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <MessageThread userId={'1'} showMessageDate={true} messages={GetHistoryChatMessages()} />\n    </FluentThemeProvider>\n  );\n};\n"},1458:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ParticipantItem } from '@azure/communication-react';\nimport { PersonaPresence } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomAvatarExample: () => JSX.Element = () => {\n  const avatarStyle = {\n    borderRadius: 20,\n    display: 'block'\n  };\n  const onRenderAvatar = (): JSX.Element => {\n    return (\n      <img\n        src=\"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png\"\n        width=\"32px\"\n        height=\"32px\"\n        style={avatarStyle}\n      />\n    );\n  };\n\n  return (\n    <ParticipantItem displayName=\"Annie Lindqvist\" presence={PersonaPresence.online} onRenderAvatar={onRenderAvatar} />\n  );\n};\n"},1459:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default='import { ParticipantItem, ParticipantItemProps } from \'@azure/communication-react\';\nimport { PersonaPresence, Icon, Stack } from \'@fluentui/react\';\nimport React from \'react\';\n\nexport const CustomIconExample: () => JSX.Element = () => {\n  const onRenderIcon = (props?: ParticipantItemProps): JSX.Element | null => {\n    if (props?.displayName === \'Patrick\') {\n      return <Icon iconName="FavoriteStar" />;\n    } else if (props?.me) {\n      return null;\n    }\n    return <Icon iconName="AddFriend" />;\n  };\n\n  return (\n    <Stack>\n      <ParticipantItem\n        displayName="Spongebob"\n        presence={PersonaPresence.online}\n        me={true}\n        onRenderIcon={onRenderIcon}\n      />\n      <ParticipantItem displayName="Patrick" presence={PersonaPresence.online} onRenderIcon={onRenderIcon} />\n      <ParticipantItem displayName="Sandy" presence={PersonaPresence.online} onRenderIcon={onRenderIcon} />\n    </Stack>\n  );\n};\n'},1460:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { ParticipantItem } from '@azure/communication-react';\nimport { IContextualMenuItem, PersonaPresence } from '@fluentui/react';\nimport React from 'react';\n\nexport const ParticipantItemExample: () => JSX.Element = () => {\n  const menuItems: IContextualMenuItem[] = [\n    {\n      key: 'Mute',\n      text: 'Mute',\n      onClick: () => alert('Mute')\n    },\n    {\n      key: 'Remove',\n      text: 'Remove',\n      onClick: () => alert('Remove')\n    }\n  ];\n\n  return <ParticipantItem displayName=\"Johnny Bravo\" menuItems={menuItems} presence={PersonaPresence.online} />;\n};\n"},1461:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipant, FluentThemeProvider, ParticipantList } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nexport const DefaultCallParticipantListExample: () => JSX.Element = () => {\n  const mockParticipants: CallParticipant[] = [\n    {\n      userId: 'user1',\n      displayName: 'You',\n      state: 'Connected',\n      isMuted: true,\n      isScreenSharing: false\n    },\n    {\n      userId: 'user2',\n      displayName: 'Hal Jordan',\n      state: 'Connected',\n      isMuted: true,\n      isScreenSharing: true\n    },\n    {\n      userId: 'user3',\n      displayName: 'Barry Allen',\n      state: 'Idle',\n      isMuted: false,\n      isScreenSharing: false\n    },\n    {\n      userId: 'user4',\n      displayName: 'Bruce Wayne',\n      state: 'Connecting',\n      isMuted: false,\n      isScreenSharing: false\n    }\n  ];\n\n  return (\n    <FluentThemeProvider>\n      <Stack>\n        <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n        <ParticipantList participants={mockParticipants} myUserId={'user1'} />\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1462:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CommunicationParticipant, ParticipantList } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nexport const DefaultChatParticipantListExample: () => JSX.Element = () => {\n  const mockParticipants: CommunicationParticipant[] = [\n    {\n      userId: 'user 1',\n      displayName: 'You'\n    },\n    {\n      userId: 'user 2',\n      displayName: 'Hal Jordan'\n    },\n    {\n      userId: 'user 3',\n      displayName: 'Barry Allen'\n    },\n    {\n      userId: 'user 4',\n      displayName: 'Bruce Wayne'\n    }\n  ];\n\n  return (\n    <Stack>\n      <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n      <ParticipantList participants={mockParticipants} />\n    </Stack>\n  );\n};\n"},1463:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import {\n  CallParticipant,\n  CommunicationParticipant,\n  FluentThemeProvider,\n  ParticipantList,\n  ParticipantItem\n} from '@azure/communication-react';\nimport { Icon, IContextualMenuItem, PersonaPresence, Stack } from '@fluentui/react';\nimport React, { useState } from 'react';\n\nconst mockParticipants = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true\n  },\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker',\n    state: 'Connected',\n    isMuted: false\n  },\n  {\n    userId: 'user3',\n    displayName: 'Matthew Murdock',\n    state: 'Idle',\n    isMuted: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Frank Castiglione',\n    state: 'Connecting',\n    isMuted: false\n  }\n];\n\nexport const InteractiveCallParticipantListExample: () => JSX.Element = () => {\n  const [participants, setParticpants] = useState<any[]>(mockParticipants);\n\n  const mockMyUserId = 'user1';\n\n  const onRenderParticipant = (participant: CommunicationParticipant): JSX.Element => {\n    const participantIndex = participants.map((p) => p.userId).indexOf(participant.userId);\n\n    // Try to consider CommunicationParticipant as CallParticipant\n    const callingParticipant = participants[participantIndex] as CallParticipant;\n\n    let presence: PersonaPresence | undefined = undefined;\n    if (callingParticipant) {\n      if (callingParticipant.state === 'Connected') {\n        presence = PersonaPresence.online;\n      } else if (callingParticipant.state === 'Idle') {\n        presence = PersonaPresence.away;\n      } else if (callingParticipant.state === 'Connecting') {\n        presence = PersonaPresence.offline;\n      }\n    }\n\n    const menuItems: IContextualMenuItem[] = [\n      {\n        key: 'mute',\n        text: callingParticipant.isMuted ? 'Unmute' : 'Mute',\n        onClick: () => {\n          const newParticipants = [...participants];\n          newParticipants[participantIndex].isMuted = !participants[participantIndex].isMuted;\n          setParticpants(newParticipants);\n        }\n      }\n    ];\n\n    const onRenderIcon = callingParticipant?.isMuted ? () => <Icon iconName=\"MicOff2\" /> : () => <></>;\n\n    if (participant.displayName) {\n      return (\n        <ParticipantItem\n          displayName={participant.displayName}\n          me={participant.userId === mockMyUserId}\n          menuItems={menuItems}\n          presence={presence}\n          onRenderIcon={onRenderIcon}\n        />\n      );\n    }\n    return <></>;\n  };\n\n  return (\n    <FluentThemeProvider>\n      <Stack>\n        <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n        <ParticipantList\n          participants={participants}\n          myUserId={mockMyUserId}\n          onRenderParticipant={onRenderParticipant}\n        />\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1464:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { CallParticipant, FluentThemeProvider, ParticipantList } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst mockParticipants: CallParticipant[] = [\n  {\n    userId: 'user1',\n    displayName: 'You',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user2',\n    displayName: 'Hal Jordan',\n    state: 'Connected',\n    isMuted: true,\n    isScreenSharing: true\n  },\n  {\n    userId: 'user3',\n    displayName: 'Barry Allen',\n    state: 'Idle',\n    isMuted: false,\n    isScreenSharing: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nexport const ParticipantListWithExcludedUserExample: () => JSX.Element = () => {\n  return (\n    <FluentThemeProvider>\n      <Stack>\n        <div style={{ fontSize: '1.5rem', marginBottom: '1rem', fontFamily: 'Segoe UI' }}>Participants</div>\n        <ParticipantList participants={mockParticipants} myUserId={'user1'} excludeMe={true} />\n      </Stack>\n    </FluentThemeProvider>\n  );\n};\n"},1465:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport { Icon } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomIconExample: () => JSX.Element = () => (\n  <FluentThemeProvider>\n    <div style={{ width: '31.25rem' }}>\n      <SendBox\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n        onRenderIcon={() => <Icon iconName=\"AirplaneSolid\" />}\n      />\n    </div>\n  </FluentThemeProvider>\n);\n"},1466:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const CustomStylingExample: () => JSX.Element = () => {\n  const sendBoxStyles = {\n    root: { border: '2px solid gray', borderRadius: '10px', padding: '10px' },\n    systemMessage: { border: '1px solid darkred', background: 'lightpink' },\n    textField: { background: 'ghostwhite' }\n    // The sub-components below are also available\n    // sendMessageIconContainer: { },\n    // sendMessageIcon: { }\n  };\n  return (\n    <FluentThemeProvider>\n      <div style={{ width: '31.25rem' }}>\n        <SendBox\n          onSendMessage={async () => {\n            return;\n          }}\n          onTyping={async () => {\n            return;\n          }}\n          styles={sendBoxStyles}\n          systemMessage=\"This is a system message\"\n        />\n      </div>\n    </FluentThemeProvider>\n  );\n};\n"},1467:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const SendBoxExample: () => JSX.Element = () => (\n  <FluentThemeProvider>\n    <div style={{ width: '31.25rem' }}>\n      <SendBox\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n      />\n    </div>\n  </FluentThemeProvider>\n);\n"},1468:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { SendBox, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const SendBoxWithSystemMessageExample: () => JSX.Element = () => (\n  <FluentThemeProvider>\n    <div style={{ width: '31.25rem' }}>\n      <SendBox\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n        systemMessage=\"Please wait 30 seconds to send new messages\"\n      />\n    </div>\n  </FluentThemeProvider>\n);\n"},1469:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TypingIndicator } from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const CustomStylingSnippet: () => JSX.Element = () => {\r\n  const twoTypingUsers = [\r\n    { userId: '1', displayName: 'User1' },\r\n    { userId: '2', displayName: 'User2' }\r\n  ];\r\n\r\n  const styles = {\r\n    root: { border: '1px solid darkblue', width: '400px', padding: '5px' },\r\n    typingUserDisplayName: { font: '15px Tahoma , sans-serif;' },\r\n    typingString: { color: 'slategrey' }\r\n  };\r\n\r\n  return <TypingIndicator typingUsers={twoTypingUsers} styles={styles} />;\r\n};\r\n"},1470:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TypingIndicator, CommunicationParticipant } from '@azure/communication-react';\nimport { mergeStyles } from '@fluentui/react';\nimport React from 'react';\n\nexport const CustomUserRenderSnippet: () => JSX.Element = () => {\n  const avatarStyle = {\n    borderRadius: 20,\n    display: 'block'\n  };\n  const imageMap = {\n    ['1']: 'https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png',\n    ['2']: 'https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-male.png'\n  };\n\n  const verticallyCenterStyle = mergeStyles({ display: 'flex', alignItems: 'center' });\n  const spanStyle = mergeStyles({ whiteSpace: 'nowrap', paddingRight: '3px' });\n\n  const onRenderUser = (user: CommunicationParticipant): JSX.Element => {\n    return (\n      <div key={`${user.displayName}UserKey`} className={verticallyCenterStyle}>\n        <img src={imageMap[user.userId]} width=\"32px\" height=\"32px\" style={avatarStyle} />\n        <span className={spanStyle}>{user.displayName}</span>\n      </div>\n    );\n  };\n\n  const twoTypingUsers = [\n    { userId: '1', displayName: 'Annie Lindqvist' },\n    { userId: '2', displayName: 'Ted Randall' }\n  ];\n\n  return <TypingIndicator typingUsers={twoTypingUsers} onRenderUser={onRenderUser} />;\n};\n"},1471:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { TypingIndicator, CommunicationParticipant } from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const TypingIndicatorSnippet: () => JSX.Element = () => {\r\n  const oneTypingUsers = [{ userId: '1', displayName: 'User1' }];\r\n  const twoTypingUsers = [\r\n    { userId: '1', displayName: 'User1' },\r\n    { userId: '2', displayName: 'User2' }\r\n  ];\r\n\r\n  const twentyUsers: CommunicationParticipant[] = [];\r\n  for (let idx = 0; idx < 20; idx++) {\r\n    twentyUsers.push({ userId: `${idx}`, displayName: `User${idx}` });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <TypingIndicator typingUsers={oneTypingUsers} />\r\n      <TypingIndicator typingUsers={twoTypingUsers} />\r\n      <TypingIndicator typingUsers={twentyUsers} />\r\n      <TypingIndicator typingUsers={oneTypingUsers} />\r\n    </>\r\n  );\r\n};\r\n"},1472:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { PlaceholderProps, VideoGallery as VideoGalleryComponent } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker',\n    state: 'Connected',\n    isMuted: false\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor',\n    state: 'Connecting',\n    isMuted: false\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock',\n    state: 'Idle',\n    isMuted: false\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne',\n    state: 'Connecting',\n    isMuted: false,\n    isScreenSharing: false\n  }\n];\n\nexport const CustomAvatarVideoGalleryExample: () => JSX.Element = () => {\n  const onRenderAvatar = (\n    placeholderProps: PlaceholderProps,\n    defaultOnRender: (props: PlaceholderProps) => JSX.Element\n  ): JSX.Element => {\n    switch (placeholderProps.displayName) {\n      case 'You':\n        return (\n          <Stack>\n            <img\n              src=\"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif\"\n              style={{\n                borderRadius: '100px',\n                width: '100px',\n                position: 'absolute',\n                margin: 'auto',\n                left: 0,\n                right: 0,\n                top: 0,\n                bottom: 0\n              }}\n            />\n          </Stack>\n        );\n      case 'Thor':\n        return (\n          <Stack>\n            <img\n              src=\"https://media.giphy.com/media/7FgZWm6sGY0CNphZDJ/giphy.gif\"\n              style={{\n                width: '100px',\n                position: 'absolute',\n                margin: 'auto',\n                left: 0,\n                right: 0,\n                top: 0,\n                bottom: 0\n              }}\n            />\n          </Stack>\n        );\n      default:\n        return defaultOnRender(placeholderProps);\n    }\n  };\n\n  return (\n    <Stack style={{ height: '30rem' }}>\n      <VideoGalleryComponent\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n        onRenderAvatar={onRenderAvatar}\n      />\n    </Stack>\n  );\n};\n"},1473:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { BaseCustomStylesProps, VideoGallery as VideoGalleryComponent } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker'\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne'\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const CustomStyleVideoGalleryExample: () => JSX.Element = () => {\n  const customStyles: BaseCustomStylesProps = {\n    root: {\n      border: 'solid 5px red'\n    }\n  };\n  return (\n    <Stack style={{ height: '30rem' }}>\n      <VideoGalleryComponent\n        styles={customStyles}\n        localParticipant={MockLocalParticipant}\n        remoteParticipants={MockRemoteParticipants}\n      />\n    </Stack>\n  );\n};\n"},1474:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\n\nimport { VideoGallery as VideoGalleryComponent } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst MockLocalParticipant = {\n  userId: 'user1',\n  displayName: 'You',\n  state: 'Connected',\n  isMuted: true\n};\n\nconst MockRemoteParticipants = [\n  {\n    userId: 'user2',\n    displayName: 'Peter Parker'\n  },\n  {\n    userId: 'user3',\n    displayName: 'Thor'\n  },\n  {\n    userId: 'user4',\n    displayName: 'Matthew Murdock'\n  },\n  {\n    userId: 'user5',\n    displayName: 'Bruce Wayne'\n  }\n];\n\n// This must be the only named export from this module, and must be named to match the storybook path suffix.\n// This ensures that storybook hoists the story instead of creating a folder with a single entry.\nexport const DefaultVideoGalleryExample: () => JSX.Element = () => {\n  return (\n    <Stack style={{ height: '30rem' }}>\n      <VideoGalleryComponent localParticipant={MockLocalParticipant} remoteParticipants={MockRemoteParticipants} />\n    </Stack>\n  );\n};\n"},1475:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile, FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nexport const VideoTileExample: () => JSX.Element = () => {\n  const videoTileStyles = { root: { height: '300px', width: '400px', border: '1px solid #999' } };\n\n  return (\n    <FluentThemeProvider>\n      <VideoTile\n        styles={videoTileStyles}\n        displayName={'Maximus Aurelius'}\n        showMuteIndicator={true}\n        isMuted={true}\n        renderElement={null}\n        isMirrored={true}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1476:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { VideoTile, FluentThemeProvider } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\n\nconst onRenderPlaceholder = (): JSX.Element => (\n  <Stack>\n    <img\n      src=\"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif\"\n      style={{\n        borderRadius: '150px',\n        width: '150px',\n        position: 'absolute',\n        margin: 'auto',\n        left: 0,\n        right: 0,\n        top: 0,\n        bottom: 0\n      }}\n    />\n  </Stack>\n);\nexport const VideoTilePlaceholderExample: () => JSX.Element = () => {\n  const videoTileStyles = { root: { height: '300px', width: '400px', border: '1px solid #999' } };\n\n  return (\n    <FluentThemeProvider>\n      <VideoTile\n        userId=\"UserIdPlaceholder\"\n        styles={videoTileStyles}\n        displayName={'Maximus Aurelius'}\n        renderElement={null}\n        isMirrored={true}\n        onRenderPlaceholder={onRenderPlaceholder}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},1478:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var esm=__webpack_require__(2),dist_esm=__webpack_require__(5),src=__webpack_require__(24),jsx_runtime=__webpack_require__(1),LocalizationProvider_snippet_LocalizationProviderSnippet=function LocalizationProviderSnippet(){return Object(jsx_runtime.jsx)(src.i,{locale:src.A,children:Object(jsx_runtime.jsxs)(src.b,{children:[Object(jsx_runtime.jsx)(src.a,{showLabel:!0}),Object(jsx_runtime.jsx)(src.l,{showLabel:!0}),Object(jsx_runtime.jsx)(src.q,{showLabel:!0}),Object(jsx_runtime.jsx)(src.d,{showLabel:!0})]})})};LocalizationProvider_snippet_LocalizationProviderSnippet.displayName="LocalizationProviderSnippet",LocalizationProvider_snippet_LocalizationProviderSnippet.__docgenInfo={description:"",methods:[],displayName:"LocalizationProviderSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/LocalizationProvider.snippet.tsx"]={name:"LocalizationProviderSnippet",docgenInfo:LocalizationProvider_snippet_LocalizationProviderSnippet.__docgenInfo,path:"stories/snippets/localization/LocalizationProvider.snippet.tsx"});var CustomLocale_snippet_CustomLocaleSnippet=function CustomLocaleSnippet(){return src.z.strings.cameraButton.offLabel="Start",Object(jsx_runtime.jsx)(src.i,{locale:src.z,children:Object(jsx_runtime.jsxs)(src.b,{children:[Object(jsx_runtime.jsx)(src.a,{showLabel:!0}),Object(jsx_runtime.jsx)(src.l,{showLabel:!0}),Object(jsx_runtime.jsx)(src.q,{showLabel:!0}),Object(jsx_runtime.jsx)(src.d,{showLabel:!0})]})})};CustomLocale_snippet_CustomLocaleSnippet.displayName="CustomLocaleSnippet",CustomLocale_snippet_CustomLocaleSnippet.__docgenInfo={description:"",methods:[],displayName:"CustomLocaleSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/CustomLocale.snippet.tsx"]={name:"CustomLocaleSnippet",docgenInfo:CustomLocale_snippet_CustomLocaleSnippet.__docgenInfo,path:"stories/snippets/localization/CustomLocale.snippet.tsx"});var StringsProperty_snippet_StringsPropertySnippet=function StringsPropertySnippet(){return Object(jsx_runtime.jsxs)(src.b,{children:[Object(jsx_runtime.jsx)(src.a,{showLabel:!0,strings:{offLabel:"Start"}}),Object(jsx_runtime.jsx)(src.l,{showLabel:!0}),Object(jsx_runtime.jsx)(src.q,{showLabel:!0}),Object(jsx_runtime.jsx)(src.d,{showLabel:!0})]})};StringsProperty_snippet_StringsPropertySnippet.displayName="StringsPropertySnippet",StringsProperty_snippet_StringsPropertySnippet.__docgenInfo={description:"",methods:[],displayName:"StringsPropertySnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/StringsProperty.snippet.tsx"]={name:"StringsPropertySnippet",docgenInfo:StringsProperty_snippet_StringsPropertySnippet.__docgenInfo,path:"stories/snippets/localization/StringsProperty.snippet.tsx"});var LongTranslations_snippet_LongTranslationsSnippet=function LongTranslationsSnippet(){return Object(jsx_runtime.jsx)(src.i,{locale:src.y,children:Object(jsx_runtime.jsxs)(src.b,{children:[Object(jsx_runtime.jsx)(src.a,{showLabel:!0}),Object(jsx_runtime.jsx)(src.l,{showLabel:!0}),Object(jsx_runtime.jsx)(src.q,{showLabel:!0}),Object(jsx_runtime.jsx)(src.d,{showLabel:!0})]})})};LongTranslations_snippet_LongTranslationsSnippet.displayName="LongTranslationsSnippet",LongTranslations_snippet_LongTranslationsSnippet.__docgenInfo={description:"",methods:[],displayName:"LongTranslationsSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/LongTranslations.snippet.tsx"]={name:"LongTranslationsSnippet",docgenInfo:LongTranslations_snippet_LongTranslationsSnippet.__docgenInfo,path:"stories/snippets/localization/LongTranslations.snippet.tsx"});var Truncation_snippet_TruncationSnippet=function TruncationSnippet(){var buttonStyle={root:{width:"4rem",padding:"0"},label:{width:"2.75rem",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",margin:"0 auto"}};return Object(jsx_runtime.jsx)(src.i,{locale:src.y,children:Object(jsx_runtime.jsxs)(src.b,{children:[Object(jsx_runtime.jsx)(src.a,{showLabel:!0,styles:buttonStyle}),Object(jsx_runtime.jsx)(src.l,{showLabel:!0,styles:buttonStyle}),Object(jsx_runtime.jsx)(src.q,{showLabel:!0,styles:buttonStyle}),Object(jsx_runtime.jsx)(src.d,{showLabel:!0,styles:buttonStyle})]})})};Truncation_snippet_TruncationSnippet.displayName="TruncationSnippet",Truncation_snippet_TruncationSnippet.__docgenInfo={description:"",methods:[],displayName:"TruncationSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/Truncation.snippet.tsx"]={name:"TruncationSnippet",docgenInfo:Truncation_snippet_TruncationSnippet.__docgenInfo,path:"stories/snippets/localization/Truncation.snippet.tsx"});var SetRTL_snippet_SetRTLSnippet=function SetRTLSnippet(){return Object(jsx_runtime.jsx)(src.i,{locale:src.w,children:Object(jsx_runtime.jsx)(src.f,{rtl:!0,children:Object(jsx_runtime.jsxs)(src.b,{children:[Object(jsx_runtime.jsx)(src.a,{showLabel:!0}),Object(jsx_runtime.jsx)(src.l,{showLabel:!0}),Object(jsx_runtime.jsx)(src.q,{showLabel:!0}),Object(jsx_runtime.jsx)(src.d,{showLabel:!0})]})})})};SetRTL_snippet_SetRTLSnippet.displayName="SetRTLSnippet",SetRTL_snippet_SetRTLSnippet.__docgenInfo={description:"",methods:[],displayName:"SetRTLSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/localization/SetRTL.snippet.tsx"]={name:"SetRTLSnippet",docgenInfo:SetRTL_snippet_SetRTLSnippet.__docgenInfo,path:"stories/snippets/localization/SetRTL.snippet.tsx"});var _excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.e,{id:"localization",title:"Localization",mdxType:"Meta"}),Object(esm.b)("h1",{id:"localization"},"Localization"),Object(esm.b)("p",null,"Localization is a key to making products that can be used across the world and by people who who speak different languages.\nUI Library will provide out of the box support for some languages and capabilities such as RTL.\nDevelopers can provide their own localization files to be used for the UI Library."),Object(esm.b)("h2",{id:"localizationprovider"},"LocalizationProvider"),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"LocalizationProvider")," is a component wrapper that sets all the strings for UI Library components using a ",Object(esm.b)("inlineCode",{parentName:"p"},"Locale"),". By default, all\ncomponents use our English (US) locale. If desired, LocalizationProvider can be used to set a different locale. Out of the box,\nthe UI library includes a set of locales usable with the UI components and composites"),Object(esm.b)("h3",{id:"usage"},"Usage"),Object(esm.b)("p",null,"To use the LocalizationProvider, import it from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," and wrap it around UI Library components. Then assign a ",Object(esm.b)("inlineCode",{parentName:"p"},"Locale")," to the ",Object(esm.b)("inlineCode",{parentName:"p"},"locale")," prop.\nFor the example below, we will localize buttons in a ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar")," in French (France) by also importing locale ",Object(esm.b)("inlineCode",{parentName:"p"},"fr_FR")," from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react"),"."),Object(esm.b)(dist_esm.g,{code:"import {\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  LocalizationProvider,\r\n  MicrophoneButton,\r\n  ScreenShareButton,\r\n  fr_FR\r\n} from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const LocalizationProviderSnippet = (): JSX.Element => {\r\n  return (\r\n    <LocalizationProvider locale={fr_FR}>\r\n      <ControlBar>\r\n        <CameraButton showLabel={true} />\r\n        <MicrophoneButton showLabel={true} />\r\n        <ScreenShareButton showLabel={true} />\r\n        <EndCallButton showLabel={true} />\r\n      </ControlBar>\r\n    </LocalizationProvider>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CLocalizationProviderSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(LocalizationProvider_snippet_LocalizationProviderSnippet,{mdxType:"LocalizationProviderSnippet"})),Object(esm.b)("h3",{id:"composites"},"Composites"),Object(esm.b)("p",null,"If you want to localize your composite, assign a ",Object(esm.b)("inlineCode",{parentName:"p"},"Locale")," to the ",Object(esm.b)("inlineCode",{parentName:"p"},"locale")," prop of the composite. You may import one of our locales like ",Object(esm.b)("inlineCode",{parentName:"p"},"fr_FR")," for French (France)\nin the example below."),Object(esm.b)(dist_esm.g,{code:"import { AzureCommunicationTokenCredential } from '@azure/communication-common';\r\nimport {\r\n  CallComposite,\r\n  CallAdapter,\r\n  createAzureCommunicationCallAdapter,\r\n  ChatComposite,\r\n  ChatAdapter,\r\n  createAzureCommunicationChatAdapter,\r\n  fr_FR\r\n} from '@azure/communication-react';\r\nimport React, { useEffect, useMemo, useState } from 'react';\r\n\r\nfunction App(): JSX.Element {\r\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\r\n  const userId = '<Azure Communication Services Identifier>';\r\n  const displayName = '<Display Name>';\r\n  const token = '<Azure Communication Services Access Token>';\r\n\r\n  //Calling Variables\r\n  //For Group Id, developers can pass any GUID they can generate\r\n  const groupId = '<Developer generated GUID>';\r\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\r\n\r\n  //Chat Variables\r\n  const threadId = '<Get thread id from chat service>';\r\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\r\n\r\n  // We can't even initialize the Chat and Call adapters without a well-formed token.\r\n  const credential = useMemo(() => {\r\n    try {\r\n      return new AzureCommunicationTokenCredential(token);\r\n    } catch {\r\n      console.error('Failed to construct token credential');\r\n      return undefined;\r\n    }\r\n  }, [token]);\r\n\r\n  useEffect(() => {\r\n    const createAdapter = async (): Promise<void> => {\r\n      setChatAdapter(\r\n        await createAzureCommunicationChatAdapter({\r\n          endpointUrl,\r\n          userId: { kind: 'communicationUser', communicationUserId: userId },\r\n          displayName,\r\n          credential: new AzureCommunicationTokenCredential(token),\r\n          threadId\r\n        })\r\n      );\r\n      setCallAdapter(\r\n        await createAzureCommunicationCallAdapter({\r\n          userId: { kind: 'communicationUser', communicationUserId: userId },\r\n          displayName,\r\n          credential: new AzureCommunicationTokenCredential(token),\r\n          locator: { groupId }\r\n        })\r\n      );\r\n    };\r\n    createAdapter();\r\n  }, []);\r\n\r\n  if (!!callAdapter && !!chatAdapter) {\r\n    return (\r\n      <>\r\n        {chatAdapter && <ChatComposite adapter={chatAdapter} locale={fr_FR} />}\r\n        {callAdapter && <CallComposite adapter={callAdapter} locale={fr_FR} />}\r\n      </>\r\n    );\r\n  }\r\n  if (credential === undefined) {\r\n    return <h3>Failed to construct credential. Provided token is malformed.</h3>;\r\n  }\r\n  return <h3>Initializing...</h3>;\r\n}\r\n\r\nexport default App;\r\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"overriding-locales"},"Overriding locales"),Object(esm.b)("p",null,"There are two options to customize the locales that we provide. For the examples below, let's say you wish to have a ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar"),"\nwith strings from our English (US) locale but you want to change the label of ",Object(esm.b)("inlineCode",{parentName:"p"},"CameraButton"),' to "Start" when its state is off.'),Object(esm.b)("h3",{id:"option-1-import-and-customize-locales"},"Option 1: Import and customize locales"),Object(esm.b)("p",null,"The first option is to import and customize locales. First, import ",Object(esm.b)("inlineCode",{parentName:"p"},"en_US")," locale from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," and then reassign the\nvalue ",Object(esm.b)("inlineCode",{parentName:"p"},"strings.cameraButton.offLabel")," like shown below."),Object(esm.b)(dist_esm.g,{code:"import {\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  LocalizationProvider,\r\n  MicrophoneButton,\r\n  ScreenShareButton,\r\n  en_US\r\n} from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const CustomLocaleSnippet = (): JSX.Element => {\r\n  en_US.strings.cameraButton.offLabel = 'Start';\r\n  return (\r\n    <LocalizationProvider locale={en_US}>\r\n      <ControlBar>\r\n        <CameraButton showLabel={true} />\r\n        <MicrophoneButton showLabel={true} />\r\n        <ScreenShareButton showLabel={true} />\r\n        <EndCallButton showLabel={true} />\r\n      </ControlBar>\r\n    </LocalizationProvider>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CCustomLocaleSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(CustomLocale_snippet_CustomLocaleSnippet,{mdxType:"CustomLocaleSnippet"})),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"Locale")," stores all strings in the ",Object(esm.b)("inlineCode",{parentName:"p"},"strings")," property as a nested object. The component name is the first identifer and the string key is\nthe second identifier such that each string can be accessed in this pattern ",Object(esm.b)("inlineCode",{parentName:"p"},"strings.<componentName>.<stringKey>"),". If you are using\ntypescript and have intellisense available in your IDE, it will be easy to discover all the strings."),Object(esm.b)("h3",{id:"option-2-override-strings-prop-in-the-ui-component"},"Option 2: Override ",Object(esm.b)("inlineCode",{parentName:"h3"},"strings")," prop in the UI Component"),Object(esm.b)("p",null,"The second option is to pass custom strings directly through the ",Object(esm.b)("inlineCode",{parentName:"p"},"strings")," prop. Strings can be overriden for a UI Library\ncomponent through the optional ",Object(esm.b)("inlineCode",{parentName:"p"},"strings")," property. There is no need to use ",Object(esm.b)("inlineCode",{parentName:"p"},"LocalizationProvider")," because all\ncomponents default to English (US). Just assign the string directly through ",Object(esm.b)("inlineCode",{parentName:"p"},"CameraButton")," like shown below."),Object(esm.b)(dist_esm.g,{code:"import {\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  MicrophoneButton,\r\n  ScreenShareButton\r\n} from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const StringsPropertySnippet = (): JSX.Element => {\r\n  return (\r\n    <ControlBar>\r\n      <CameraButton showLabel={true} strings={{ offLabel: 'Start' }} />\r\n      <MicrophoneButton showLabel={true} />\r\n      <ScreenShareButton showLabel={true} />\r\n      <EndCallButton showLabel={true} />\r\n    </ControlBar>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CStringsPropertySnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(StringsProperty_snippet_StringsPropertySnippet,{mdxType:"StringsPropertySnippet"})),Object(esm.b)("p",null,"We recommend using option 1 for localization for large applications with many components because all changes to the locale are made in one place. Option 2 is\nan alternative that can be used to override the strings from the locale is certain conditions you may want to use as part of business logic."),Object(esm.b)("h2",{id:"managing-long-translations"},"Managing long translations"),Object(esm.b)("p",null,"There are cases when translations can be long and make components overall look awkward like the ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar")," below using strings from a German locale."),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CLongTranslationsSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(LongTranslations_snippet_LongTranslationsSnippet,{mdxType:"LongTranslationsSnippet"})),Object(esm.b)("p",null,"We suggest the following options to achieve a better looking interface."),Object(esm.b)("ol",null,Object(esm.b)("li",{parentName:"ol"},"Trying less literal translations. If there is a shorter text alternative that does not sacrifice clarity, then that would be an easy option."),Object(esm.b)("li",{parentName:"ol"},"Using styling to set limits and truncating long translations. The following styling in the example below is passed to each button.")),Object(esm.b)(dist_esm.g,{code:"import {\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  LocalizationProvider,\r\n  MicrophoneButton,\r\n  ScreenShareButton,\r\n  de_DE\r\n} from '@azure/communication-react';\r\nimport { IStyle } from '@fluentui/react';\r\nimport React from 'react';\r\n\r\nexport const TruncationSnippet = (): JSX.Element => {\r\n  const buttonStyle = {\r\n    root: { width: '4rem', padding: '0' },\r\n    label: {\r\n      width: '2.75rem',\r\n      textOverflow: 'ellipsis',\r\n      whiteSpace: 'nowrap',\r\n      overflow: 'hidden',\r\n      margin: '0 auto'\r\n    } as IStyle\r\n  };\r\n  return (\r\n    <LocalizationProvider locale={de_DE}>\r\n      <ControlBar>\r\n        <CameraButton showLabel={true} styles={buttonStyle} />\r\n        <MicrophoneButton showLabel={true} styles={buttonStyle} />\r\n        <ScreenShareButton showLabel={true} styles={buttonStyle} />\r\n        <EndCallButton showLabel={true} styles={buttonStyle} />\r\n      </ControlBar>\r\n    </LocalizationProvider>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxType:"Canvas"},Object(esm.b)(Truncation_snippet_TruncationSnippet,{mdxType:"TruncationSnippet"})),Object(esm.b)("p",null,"Note: All ACS UI Library components will have aria labels with the full text as part of our Accessibility promise."),Object(esm.b)("ol",{start:3},Object(esm.b)("li",{parentName:"ol"},"Using styling to reduce font size.")),Object(esm.b)("h2",{id:"setting-rtl"},"Setting rtl"),Object(esm.b)("p",null,"To set rtl of ACS UI Library components for rtl languages, use the ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," and set the ",Object(esm.b)("inlineCode",{parentName:"p"},"rtl")," prop to true like in\nthe example below localized in Arabic."),Object(esm.b)(dist_esm.g,{code:"import {\r\n  LocalizationProvider,\r\n  FluentThemeProvider,\r\n  CameraButton,\r\n  ControlBar,\r\n  EndCallButton,\r\n  MicrophoneButton,\r\n  ScreenShareButton,\r\n  ar_SA\r\n} from '@azure/communication-react';\r\nimport React from 'react';\r\n\r\nexport const SetRTLSnippet = (): JSX.Element => {\r\n  return (\r\n    <LocalizationProvider locale={ar_SA}>\r\n      <FluentThemeProvider rtl={true}>\r\n        <ControlBar>\r\n          <CameraButton showLabel={true} />\r\n          <MicrophoneButton showLabel={true} />\r\n          <ScreenShareButton showLabel={true} />\r\n          <EndCallButton showLabel={true} />\r\n        </ControlBar>\r\n      </FluentThemeProvider>\r\n    </LocalizationProvider>\r\n  );\r\n};\r\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CSetRTLSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(SetRTL_snippet_SetRTLSnippet,{mdxType:"SetRTLSnippet"})))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Localization",id:"localization",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1479:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"MessageThread",(function(){return MessageThread}));__webpack_require__(166),__webpack_require__(77),__webpack_require__(47),__webpack_require__(37),__webpack_require__(9),__webpack_require__(50),__webpack_require__(10),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var src=__webpack_require__(24),Stack=__webpack_require__(99),Persona=__webpack_require__(560),Persona_types=__webpack_require__(26),PrimaryButton=__webpack_require__(1666),Divider=__webpack_require__(1717),esm=__webpack_require__(5),react=__webpack_require__(0),constants=__webpack_require__(13),controlsUtils=__webpack_require__(6),MessageThreadContainerStyles=(__webpack_require__(90),__webpack_require__(87),{width:"100%",height:"100%",maxWidth:"50rem",maxHeight:"30rem"}),MessageThreadStyles={root:{margin:"20px auto",border:"1px solid",padding:"0 10px"}},UserOne={senderId:"user1",senderDisplayName:"Elliot Woodward"},UserTwo={senderId:"user2",senderDisplayName:"Katri Ahokas"},UserThree={senderId:"user3",senderDisplayName:"Miguel Garcia"},GetAvatarUrlByUserId=function GetAvatarUrlByUserId(userId){switch(userId){case"user1":return"images/avatars/avatar-4.jpg";case"user2":return"images/avatars/avatar-9.jpg";case"user3":return"images/avatars/avatar-6.jpg";default:return""}},GenerateMockNewChatMessage=function GenerateMockNewChatMessage(){return{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"I just sent a new Message!",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),mine:!0,attached:!1,status:"seen",type:"text"})}},GenerateMockNewChatMessageFromOthers=function GenerateMockNewChatMessageFromOthers(){return{type:"chat",payload:Object.assign({},UserThree,{messageId:Math.random().toString(),content:"Sure! Let's checkout calling UI components as well!",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),mine:!1,attached:!1,type:"text"})}},GenerateMockSystemMessage=function GenerateMockSystemMessage(){return{type:"system",payload:{type:"content",createdOn:new Date("2020-04-13T00:00:00.000+07:01"),messageId:Math.random().toString(),iconName:"PeopleAdd",content:"Elliot Woodward added Carole Poland to the chat and shared all chat history."}}},GenerateMockCustomMessage=function GenerateMockCustomMessage(){return{type:"custom",payload:{createdOn:new Date("2020-04-13T00:00:00.000+07:01"),messageId:Math.random().toString(),content:"Today"}}},GenerateMockHistoryChatMessages=function GenerateMockHistoryChatMessages(){return[{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"Hi everyone, I created this awesome group chat for us!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Nice! This looks great!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserThree,{messageId:Math.random().toString(),content:"Yeah agree, let's chat here from now on!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!1,attached:!1,type:"text"})}]};function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var GetHistoryChatMessages=function GetHistoryChatMessages(){return[{type:"chat",payload:{senderId:"user1",senderDisplayName:"Kat Larsson",messageId:Math.random().toString(),content:"Hi everyone, I created this awesome group chat for us!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,status:"seen",type:"text"}},{type:"chat",payload:{senderId:"user2",senderDisplayName:"Robert Tolbert",messageId:Math.random().toString(),content:"Nice! This looks great!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,type:"text"}},{type:"chat",payload:{senderId:"user3",senderDisplayName:"Carole Poland",messageId:Math.random().toString(),content:"Yeah agree, let's chat here from now on!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,type:"text"}}]},GetHistoryWithSystemMessages=function GetHistoryWithSystemMessages(){return[].concat(_toConsumableArray(GetHistoryChatMessages()),[{type:"system",payload:{createdOn:new Date("2020-04-13T00:00:00.000+07:01"),type:"content",messageId:Math.random().toString(),iconName:"PeopleAdd",content:"Miguel Garcia is added to the chat"}}])},GetHistoryWithCustomMessages=function GetHistoryWithCustomMessages(){return[{type:"custom",payload:{createdOn:new Date("2020-04-13T00:00:00.000+07:01"),messageId:Math.random().toString(),content:"Today"}}].concat(_toConsumableArray(GetHistoryChatMessages()))},placeholdermessages_GetAvatarUrlByUserId=function GetAvatarUrlByUserId(userId){switch(userId){case"user1":return"images/avatars/avatar-1.jpg";case"user2":return"images/avatars/avatar-2.jpg";case"user3":return"images/avatars/avatar-8.jpg";default:return""}},jsx_runtime=__webpack_require__(1),CustomAvatar_snippet_MessageThreadWithCustomAvatarExample=function MessageThreadWithCustomAvatarExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{userId:"1",messages:GetHistoryChatMessages(),onRenderAvatar:function onRenderAvatar(userId){return Object(jsx_runtime.jsx)(Persona.a,{size:Persona_types.c.size32,hidePersonaDetails:!0,presence:Persona_types.b.online,text:userId,imageUrl:placeholdermessages_GetAvatarUrlByUserId(userId)})}})})};CustomAvatar_snippet_MessageThreadWithCustomAvatarExample.displayName="MessageThreadWithCustomAvatarExample",CustomAvatar_snippet_MessageThreadWithCustomAvatarExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomAvatarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomAvatar.snippet.tsx"]={name:"MessageThreadWithCustomAvatarExample",docgenInfo:CustomAvatar_snippet_MessageThreadWithCustomAvatarExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomAvatar.snippet.tsx"});var CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample=function MessageThreadWithCustomChatContainerExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{userId:"1",messages:GetHistoryChatMessages(),styles:{chatContainer:{backgroundColor:"lightgray",padding:"15px"}}})})};CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample.displayName="MessageThreadWithCustomChatContainerExample",CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomChatContainerExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomChatContainer.snippet.tsx"]={name:"MessageThreadWithCustomChatContainerExample",docgenInfo:CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomChatContainer.snippet.tsx"});var CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample=function MessageThreadWithCustomMessageContainerExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{userId:"1",styles:{chatMessageContainer:{fontStyle:"italic",boxShadow:"0px 3.2px 7.2px rgb(0 0 0 / 13%), 0px 0.6px 1.8px rgb(0 0 0 / 11%)"},systemMessageContainer:{fontWeight:"bold",border:"double red"}},messages:GetHistoryWithSystemMessages()})})};CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample.displayName="MessageThreadWithCustomMessageContainerExample",CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomMessageContainerExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomMessageContainer.snippet.tsx"]={name:"MessageThreadWithCustomMessageContainerExample",docgenInfo:CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomMessageContainer.snippet.tsx"});var CustomMessages_snippet_MessageThreadWithCustomMessagesExample=function MessageThreadWithCustomMessagesExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{userId:"1",messages:GetHistoryWithCustomMessages(),onRenderMessage:function onRenderMessage(messageProps,defaultOnRender){return"custom"===messageProps.message.type?Object(jsx_runtime.jsx)(Divider.a,{content:messageProps.message.payload.content,color:"brand",important:!0}):defaultOnRender?defaultOnRender(messageProps):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}})})};CustomMessages_snippet_MessageThreadWithCustomMessagesExample.displayName="MessageThreadWithCustomMessagesExample",CustomMessages_snippet_MessageThreadWithCustomMessagesExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomMessagesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomMessages.snippet.tsx"]={name:"MessageThreadWithCustomMessagesExample",docgenInfo:CustomMessages_snippet_MessageThreadWithCustomMessagesExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomMessages.snippet.tsx"});var Text=__webpack_require__(1711),CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample=function MessageThreadWithCustomMessageStatusIndicatorExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{userId:"1",messages:GetHistoryChatMessages(),showMessageStatus:!0,onRenderMessageStatus:function onRenderMessageStatus(messageStatusIndicatorProps){return"seen"===messageStatusIndicatorProps.status?Object(jsx_runtime.jsx)(Text.a,{style:{fontStyle:"italic",fontWeight:"bold",color:"green"},children:"seen"}):null}})})};CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample.displayName="MessageThreadWithCustomMessageStatusIndicatorExample",CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithCustomMessageStatusIndicatorExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/CustomMessageStatusIndicator.snippet.tsx"]={name:"MessageThreadWithCustomMessageStatusIndicatorExample",docgenInfo:CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample.__docgenInfo,path:"stories/MessageThread/snippets/CustomMessageStatusIndicator.snippet.tsx"});var Default_snippet_DefaultMessageThreadExample=function DefaultMessageThreadExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{userId:"1",messages:GetHistoryChatMessages()})})};Default_snippet_DefaultMessageThreadExample.displayName="DefaultMessageThreadExample",Default_snippet_DefaultMessageThreadExample.__docgenInfo={description:"",methods:[],displayName:"DefaultMessageThreadExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/Default.snippet.tsx"]={name:"DefaultMessageThreadExample",docgenInfo:Default_snippet_DefaultMessageThreadExample.__docgenInfo,path:"stories/MessageThread/snippets/Default.snippet.tsx"});var MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample=function MessageThreadWithMessageStatusIndicatorExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{userId:"1",messages:GetHistoryChatMessages(),showMessageStatus:!0})})};MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample.displayName="MessageThreadWithMessageStatusIndicatorExample",MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithMessageStatusIndicatorExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/MessageStatusIndicator.snippet.tsx"]={name:"MessageThreadWithMessageStatusIndicatorExample",docgenInfo:MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample.__docgenInfo,path:"stories/MessageThread/snippets/MessageStatusIndicator.snippet.tsx"});var SystemMessages_snippet_MessageThreadWithSystemMessagesExample=function MessageThreadWithSystemMessagesExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{userId:"1",messages:GetHistoryWithSystemMessages()})})};SystemMessages_snippet_MessageThreadWithSystemMessagesExample.displayName="MessageThreadWithSystemMessagesExample",SystemMessages_snippet_MessageThreadWithSystemMessagesExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithSystemMessagesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/SystemMessages.snippet.tsx"]={name:"MessageThreadWithSystemMessagesExample",docgenInfo:SystemMessages_snippet_MessageThreadWithSystemMessagesExample.__docgenInfo,path:"stories/MessageThread/snippets/SystemMessages.snippet.tsx"});var WithMessageDate_snippet_MessageThreadWithMessageDateExample=function MessageThreadWithMessageDateExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.k,{userId:"1",showMessageDate:!0,messages:GetHistoryChatMessages()})})};function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function MessageThread_stories_toConsumableArray(arr){return function MessageThread_stories_arrayWithoutHoles(arr){if(Array.isArray(arr))return MessageThread_stories_arrayLikeToArray(arr)}(arr)||function MessageThread_stories_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||MessageThread_stories_unsupportedIterableToArray(arr)||function MessageThread_stories_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||MessageThread_stories_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MessageThread_stories_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return MessageThread_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?MessageThread_stories_arrayLikeToArray(o,minLen):void 0}}function MessageThread_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}WithMessageDate_snippet_MessageThreadWithMessageDateExample.displayName="MessageThreadWithMessageDateExample",WithMessageDate_snippet_MessageThreadWithMessageDateExample.__docgenInfo={description:"",methods:[],displayName:"MessageThreadWithMessageDateExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageThread/snippets/WithMessageDate.snippet.tsx"]={name:"MessageThreadWithMessageDateExample",docgenInfo:WithMessageDate_snippet_MessageThreadWithMessageDateExample.__docgenInfo,path:"stories/MessageThread/snippets/WithMessageDate.snippet.tsx"});var MessageThreadWithCustomAvatarExampleText=__webpack_require__(1448).default,MessageThreadWithCustomChatContainerExampleText=__webpack_require__(1449).default,MessageThreadWithCustomMessageContainerExampleText=__webpack_require__(1450).default,MessageThreadWithCustomMessagesExampleText=__webpack_require__(1451).default,MessageThreadWithCustomMessageStatusIndicatorExampleText=__webpack_require__(1452).default,DefaultMessageThreadExampleText=__webpack_require__(1453).default,MessageThreadWithMessageStatusIndicatorExampleText=__webpack_require__(1454).default,ExampleConstantsText=__webpack_require__(1455).default,MessageThreadWithSystemMessagesExampleText=__webpack_require__(1456).default,MessageThreadWithMessageDateExampleText=__webpack_require__(1457).default,MessageThread_stories_MessageThreadStory=function MessageThreadStory(args){var _useState2=_slicedToArray(Object(react.useState)(function GenerateMockChatMessages(){return[{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"Hey folks!",createdOn:new Date("2020-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Hey how are you?",createdOn:new Date("2020-04-13T00:00:00.000+08:09"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserThree,{messageId:Math.random().toString(),content:"Hey everyone!",createdOn:new Date("2020-04-13T00:00:00.000+08:08"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"Doing well!",createdOn:new Date("2020-04-13T00:00:00.000+08:07"),mine:!0,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Checking out the new UI Components for Azure Communication Services!",createdOn:new Date("2020-04-13T00:00:00.000+08:06"),mine:!1,attached:"top",type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"The chat thread is very responsive.",createdOn:new Date("2020-04-13T00:00:00.000+08:05"),mine:!1,attached:!0,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"It even scrolls!",createdOn:new Date("2020-04-13T00:00:00.000+08:05"),mine:!1,attached:"bottom",type:"text"})},{type:"chat",payload:Object.assign({},UserThree,{messageId:Math.random().toString(),content:"Can you customize it?",createdOn:new Date("2020-04-13T00:00:00.000+08:04"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Yes you can customize it.",createdOn:new Date("2020-04-13T00:00:00.000+08:03"),mine:!1,attached:!1,type:"text"})},{type:"chat",payload:Object.assign({},UserOne,{messageId:Math.random().toString(),content:"I saw there are also calling UI components",createdOn:new Date("2020-04-13T00:00:00.000+08:02"),mine:!0,attached:!1,status:"seen",type:"text"})},{type:"chat",payload:Object.assign({},UserTwo,{messageId:Math.random().toString(),content:"Yeah you can combine chat and calling components to build full communication experiences!",createdOn:new Date("2020-04-13T00:00:00.000+08:01"),mine:!1,attached:!1,type:"text"})}]}()),2),chatMessages=_useState2[0],setChatMessages=_useState2[1],onLoadPreviousMessages=function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return setChatMessages([].concat(MessageThread_stories_toConsumableArray(GenerateMockHistoryChatMessages()),MessageThread_stories_toConsumableArray(chatMessages))),_context.abrupt("return",!1);case 2:case"end":return _context.stop()}}),_callee)})));return function onLoadPreviousMessages(){return _ref.apply(this,arguments)}}();return Object(jsx_runtime.jsxs)(Stack.a,{style:MessageThreadContainerStyles,children:[Object(jsx_runtime.jsx)(src.k,{styles:MessageThreadStyles,userId:UserOne.senderId,messages:chatMessages,showMessageDate:args.showMessageDate,showMessageStatus:args.showMessageStatus,disableJumpToNewMessageButton:!args.enableJumpToNewMessageButton,onLoadPreviousChatMessages:onLoadPreviousMessages,onRenderMessage:function onRenderMessage(messageProps,defaultOnRender){return"custom"===messageProps.message.type?Object(jsx_runtime.jsx)(Divider.a,{content:messageProps.message.payload.content,color:"brand",important:!0}):defaultOnRender?defaultOnRender(messageProps):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},onRenderAvatar:function onRenderAvatar(userId){return Object(jsx_runtime.jsx)(Persona.a,{size:Persona_types.c.size32,hidePersonaDetails:!0,presence:Persona_types.b.online,text:userId,imageUrl:GetAvatarUrlByUserId(userId)})}}),Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"space-between",tokens:{childrenGap:"1rem"},children:[Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new message from others",onClick:function onSendNewMessageFromOthers(){setChatMessages([].concat(MessageThread_stories_toConsumableArray(chatMessages),[GenerateMockNewChatMessageFromOthers()]))}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new message",onClick:function onSendNewMessage(){var existingChatMessages=chatMessages;existingChatMessages.forEach((function(message){"chat"===message.type&&(message.payload.status=void 0)})),setChatMessages([].concat(MessageThread_stories_toConsumableArray(existingChatMessages),[GenerateMockNewChatMessage()]))}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new system message",onClick:function onSendNewSystemMessage(){setChatMessages([].concat(MessageThread_stories_toConsumableArray(chatMessages),[GenerateMockSystemMessage()]))}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Send new custom message",onClick:function onSendCustomMessage(){setChatMessages([].concat(MessageThread_stories_toConsumableArray(chatMessages),[GenerateMockCustomMessage()]))}})]})]})};MessageThread_stories_MessageThreadStory.displayName="MessageThreadStory";var MessageThread=MessageThread_stories_MessageThreadStory.bind({});__webpack_exports__.default={id:constants.a+"-messagethread",title:constants.a+"/Message Thread",component:src.k,argTypes:{showMessageDate:controlsUtils.a.showMessageDate,showMessageStatus:controlsUtils.a.showMessageStatus,enableJumpToNewMessageButton:controlsUtils.a.enableJumpToNewMessageButton,styles:controlsUtils.j,strings:controlsUtils.j,userId:controlsUtils.j,messages:controlsUtils.j,disableJumpToNewMessageButton:controlsUtils.j,numberOfChatMessagesToReload:controlsUtils.j,onMessageSeen:controlsUtils.j,onRenderMessageStatus:controlsUtils.j,onRenderAvatar:controlsUtils.j,onRenderJumpToNewMessageButton:controlsUtils.j,onLoadPreviousChatMessages:controlsUtils.j,onRenderMessage:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"MessageThread"}),Object(jsx_runtime.jsx)(esm.c,{of:src.k}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { FluentThemeProvider, MessageThread } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Sample Messages"}),Object(jsx_runtime.jsx)(esm.c,{children:"Create a `placeholdermessages.ts` file in the current folder you are working on. Then copy paste the code below into that file."}),Object(jsx_runtime.jsx)(esm.g,{code:ExampleConstantsText}),Object(jsx_runtime.jsx)(esm.d,{children:"Default MessageThread"}),Object(jsx_runtime.jsx)(esm.c,{children:"By default, MessageThread displays Chat messages with display name of only for other users and creation time of message when available."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:DefaultMessageThreadExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_DefaultMessageThreadExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"MessageThread With Message Date"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MessageThreadWithMessageDateExampleText,children:Object(jsx_runtime.jsx)(WithMessageDate_snippet_MessageThreadWithMessageDateExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"System Message"}),Object(jsx_runtime.jsx)(esm.c,{children:"The example below shows a message thread with a system message."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MessageThreadWithSystemMessagesExampleText,children:Object(jsx_runtime.jsx)(SystemMessages_snippet_MessageThreadWithSystemMessagesExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom Message"}),Object(jsx_runtime.jsx)(esm.c,{children:"The example below shows how to render a `custom` message with `onRenderMessage` in `MessageThread`"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MessageThreadWithCustomMessagesExampleText,children:Object(jsx_runtime.jsx)(CustomMessages_snippet_MessageThreadWithCustomMessagesExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Messages with Customized Chat Container"}),Object(jsx_runtime.jsx)(esm.c,{children:"The example below shows how to render a `custom` chat container with `styles.chatContainer` in `MessageThread`"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MessageThreadWithCustomChatContainerExampleText,children:Object(jsx_runtime.jsx)(CustomChatContainer_snippet_MessageThreadWithCustomChatContainerExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Messages with Customized Message Container"}),Object(jsx_runtime.jsx)(esm.c,{children:"The example below shows how to render a `custom` message container with `styles.chatMessageContainer` or `styles.systemMessageContainer` in `MessageThread`"}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: In the code example, all `%` characters were replaced by their unicode value `\\u0025` due to URI malformed issue when loading the storybook snippets"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MessageThreadWithCustomMessageContainerExampleText,children:Object(jsx_runtime.jsx)(CustomMessageContainer_snippet_MessageThreadWithCustomMessageContainerExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Default Message Status Indicator"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MessageThreadWithMessageStatusIndicatorExampleText,children:Object(jsx_runtime.jsx)(MessageStatusIndicator_snippet_MessageThreadWithMessageStatusIndicatorExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Cutom Message Status Indicator"}),Object(jsx_runtime.jsx)(esm.c,{children:"The example below shows how to render a `custom` message status indicator with `onRenderMessageStatus` in `MessageThread`"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MessageThreadWithCustomMessageStatusIndicatorExampleText,children:Object(jsx_runtime.jsx)(CustomMessageStatusIndicator_snippet_MessageThreadWithCustomMessageStatusIndicatorExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom Avatar"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MessageThreadWithCustomAvatarExampleText,children:Object(jsx_runtime.jsx)(CustomAvatar_snippet_MessageThreadWithCustomAvatarExample,{})}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: You can view the details of the [Persona](https://developer.microsoft.com/en-us/fluentui#/controls/web/persona) component"}),Object(jsx_runtime.jsx)(esm.d,{children:"Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.k})]})}()}},storyshots:{disable:!0}}};MessageThread.parameters=Object.assign({storySource:{source:'(args): JSX.Element => {\n  const [chatMessages, setChatMessages] = useState<(SystemMessage | CustomMessage | ChatMessage)[]>(\n    GenerateMockChatMessages()\n  );\n\n  const onSendNewMessage = (): void => {\n    const existingChatMessages = chatMessages;\n    // We dont want to render the status for previous messages\n    existingChatMessages.forEach((message) => {\n      if (message.type === \'chat\') {\n        message.payload.status = undefined;\n      }\n    });\n    setChatMessages([...existingChatMessages, GenerateMockNewChatMessage()]);\n  };\n\n  const onSendNewMessageFromOthers = (): void => {\n    setChatMessages([...chatMessages, GenerateMockNewChatMessageFromOthers()]);\n  };\n\n  const onLoadPreviousMessages = async (): Promise<boolean> => {\n    setChatMessages([...GenerateMockHistoryChatMessages(), ...chatMessages]);\n    return false;\n  };\n\n  const onSendNewSystemMessage = (): void => {\n    setChatMessages([...chatMessages, GenerateMockSystemMessage()]);\n  };\n\n  const onSendCustomMessage = (): void => {\n    setChatMessages([...chatMessages, GenerateMockCustomMessage()]);\n  };\n\n  const onRenderMessage = (messageProps: MessageProps, defaultOnRender?: DefaultMessageRendererType): JSX.Element => {\n    if (messageProps.message.type === \'custom\') {\n      return <Divider content={messageProps.message.payload.content} color="brand" important />;\n    }\n\n    return defaultOnRender ? defaultOnRender(messageProps) : <></>;\n  };\n\n  return (\n    <Stack style={MessageThreadContainerStyles}>\n      <MessageThreadComponent\n        styles={MessageThreadStyles}\n        userId={UserOne.senderId}\n        messages={chatMessages}\n        showMessageDate={args.showMessageDate}\n        showMessageStatus={args.showMessageStatus}\n        disableJumpToNewMessageButton={!args.enableJumpToNewMessageButton}\n        onLoadPreviousChatMessages={onLoadPreviousMessages}\n        onRenderMessage={onRenderMessage}\n        onRenderAvatar={(userId: string) => {\n          return (\n            <Persona\n              size={PersonaSize.size32}\n              hidePersonaDetails\n              presence={PersonaPresence.online}\n              text={userId}\n              imageUrl={GetAvatarUrlByUserId(userId)}\n            />\n          );\n        }}\n      />\n      {/* We need to use these two buttons to render more messages in the chat thread and showcase the "new message" button.\n      Using storybook controls would trigger the whole story to do a fresh re-render, not just components inside the story. */}\n      <Stack horizontal horizontalAlign="space-between" tokens={{ childrenGap: \'1rem\' }}>\n        <PrimaryButton text="Send new message from others" onClick={onSendNewMessageFromOthers} />\n        <PrimaryButton text="Send new message" onClick={onSendNewMessage} />\n        <PrimaryButton text="Send new system message" onClick={onSendNewSystemMessage} />\n        <PrimaryButton text="Send new custom message" onClick={onSendCustomMessage} />\n      </Stack>\n    </Stack>\n  );\n}'}},MessageThread.parameters)},1480:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10);var react=__webpack_require__(0),esm=__webpack_require__(2),dist_esm=__webpack_require__(5),src=(__webpack_require__(40),__webpack_require__(18),__webpack_require__(9),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29),__webpack_require__(24)),Stack=__webpack_require__(99),lib=__webpack_require__(20),jsx_runtime=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CallingComponents_CallingComponents=function CallingComponents(){var exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},_useState2=_slicedToArray(Object(react.useState)(!1),2),videoButtonChecked=_useState2[0],setVideoButtonChecked=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(!1),2),audioButtonChecked=_useState4[0],setAudioButtonChecked=_useState4[1],_useState6=_slicedToArray(Object(react.useState)(!1),2),screenshareButtonChecked=_useState6[0],setScreenshareButtonChecked=_useState6[1];return Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.G)({height:"100%"}),children:[Object(jsx_runtime.jsx)("div",{style:{height:"30rem",width:"30rem",border:"1px solid"},children:Object(jsx_runtime.jsx)(src.g,{children:Object(jsx_runtime.jsx)(src.v,{displayName:"Michael"})})}),Object(jsx_runtime.jsxs)(src.b,{styles:{root:{justifyContent:"center"}},children:[Object(jsx_runtime.jsx)(src.a,{checked:videoButtonChecked,onClick:function onClick(){return setVideoButtonChecked(!videoButtonChecked)}}),Object(jsx_runtime.jsx)(src.l,{checked:audioButtonChecked,onClick:function onClick(){return setAudioButtonChecked(!audioButtonChecked)}}),Object(jsx_runtime.jsx)(src.q,{checked:screenshareButtonChecked,onClick:function onClick(){return setScreenshareButtonChecked(!screenshareButtonChecked)}}),Object(jsx_runtime.jsx)(src.m,{menuProps:exampleOptionsMenuProps}),Object(jsx_runtime.jsx)(src.d,{})]})]})};CallingComponents_CallingComponents.displayName="CallingComponents",CallingComponents_CallingComponents.__docgenInfo={description:"",methods:[],displayName:"CallingComponents"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/QuickStarts/snippets/CallingComponents.tsx"]={name:"CallingComponents",docgenInfo:CallingComponents_CallingComponents.__docgenInfo,path:"stories/QuickStarts/snippets/CallingComponents.tsx"});__webpack_require__(90),__webpack_require__(87),__webpack_require__(37);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var ChatComponents_ChatComponents=function ChatComponents(){return Object(jsx_runtime.jsxs)("div",{style:{height:"30rem",width:"30rem"},children:[Object(jsx_runtime.jsx)(src.k,{userId:"1",messages:function GetHistoryChatMessages(){return[{type:"chat",payload:{type:"text",senderId:"1",senderDisplayName:"User1",messageId:Math.random().toString(),content:"Hi everyone, I created this awesome group chat for us!",createdOn:new Date("2019-04-13T00:00:00.000+08:10"),mine:!0,attached:!1,status:"seen"}},{type:"chat",payload:{type:"text",senderId:"2",senderDisplayName:"User2",messageId:Math.random().toString(),content:"Nice! This looks great!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1}},{type:"chat",payload:{type:"text",senderId:"3",senderDisplayName:"User3",messageId:Math.random().toString(),content:"Yeah agree, let's chat here from now on!",createdOn:new Date("2019-04-13T00:00:00.000+08:09"),mine:!1,attached:!1}}]}(),showMessageStatus:!0}),Object(jsx_runtime.jsx)(src.r,{disabled:!1,onSendMessage:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)})))})]})};ChatComponents_ChatComponents.displayName="ChatComponents",ChatComponents_ChatComponents.__docgenInfo={description:"",methods:[],displayName:"ChatComponents"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/QuickStarts/snippets/ChatComponents.tsx"]={name:"ChatComponents",docgenInfo:ChatComponents_ChatComponents.__docgenInfo,path:"stories/QuickStarts/snippets/ChatComponents.tsx"});function CompletedComponentsApp(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,horizontalAlign:"space-evenly",styles:{root:{width:"100%"}},children:[Object(jsx_runtime.jsx)(CallingComponents_CallingComponents,{}),Object(jsx_runtime.jsx)(ChatComponents_ChatComponents,{})]})})}CompletedComponentsApp.displayName="CompletedComponentsApp",CompletedComponentsApp.__docgenInfo={description:"",methods:[],displayName:"CompletedComponentsApp"};var snippets_CompletedComponentsApp_snippet=CompletedComponentsApp;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/QuickStarts/snippets/CompletedComponentsApp.snippet.tsx"]={name:"CompletedComponentsApp",docgenInfo:CompletedComponentsApp.__docgenInfo,path:"stories/QuickStarts/snippets/CompletedComponentsApp.snippet.tsx"});var _excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.e,{id:"quickstarts-uicomponents",title:"Quickstarts/Get started with UI Components",mdxType:"Meta"}),Object(esm.b)("h1",{id:"quickstart-get-started-with-ui-components"},"Quickstart: Get started with UI Components"),Object(esm.b)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications. In this quickstart, you'll learn how to integrate UI Library base components into your application to build communication experiences."),Object(esm.b)("p",null,"UI Library components come in two flavors: UI and Composite."),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("strong",{parentName:"li"},"UI components")," represent discrete communication capabilities; they're the basic building blocks that can be used to build complex communication experiences."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("strong",{parentName:"li"},"Composite components")," are turn-key experiences for common communication scenarios that have been built using ",Object(esm.b)("strong",{parentName:"li"},"base components")," as building blocks and packaged to be easily integrated into applications.")),Object(esm.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.b)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 12 Recommended)."),Object(esm.b)("li",{parentName:"ul"},"An active Communication Services resource. ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create a Communication Services resource"),".")),Object(esm.b)("h2",{id:"setting-up"},"Setting Up"),Object(esm.b)("p",null,"UI Library requires a React environment to be setup. Next we will do that. If you already have a React App, you can skip this section."),Object(esm.b)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.b)("p",null,"We'll use the create-react-app template for this quickstart. For more information, see: ",Object(esm.b)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-toolkit-quickstart --template typescript\n\ncd ui-toolkit-quickstart\n\n")),Object(esm.b)("p",null,"At the end of this process, you should have a full application inside the folder ",Object(esm.b)("inlineCode",{parentName:"p"},"UI-ToolKit-Quickstart"),".\nFor this quickstart, we'll be modifying files inside the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.b)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.b)("p",null,"Use the ",Object(esm.b)("inlineCode",{parentName:"p"},"npm install")," command to install the Azure Communication Services UI Library for JavaScript."),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install --save @azure/communication-react\n\n")),Object(esm.b)("p",null,"The ",Object(esm.b)("inlineCode",{parentName:"p"},"--save")," option lists the library as a dependency in your ",Object(esm.b)("strong",{parentName:"p"},"package.json")," file."),Object(esm.b)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.b)("p",null,"Let's test the Create React App installation by running:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"object-model"},"Object Model"),Object(esm.b)("p",null,"The following classes and interfaces handle some of the major features of the Azure Communication Services UI client library:"),Object(esm.b)("table",null,Object(esm.b)("thead",{parentName:"table"},Object(esm.b)("tr",{parentName:"thead"},Object(esm.b)("th",{parentName:"tr",align:null},"Name"),Object(esm.b)("th",{parentName:"tr",align:null},"Description"))),Object(esm.b)("tbody",{parentName:"table"},Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/theming--page"},"FluentThemeProvider")),Object(esm.b)("td",{parentName:"tr",align:null},"Provider that controls Theming on the components. Can be used to override theme")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/ui-components-gridlayout--grid-layout"},"GridLayout")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component that organizes video tiles into a grid")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/ui-components-videotile--video-tile"},"VideoTile")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component to render participants either with or without video")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/ui-components-controlbar--control-bar"},"ControlBar")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component to control call including mute, video, share screen")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/ui-components-messagethread--message-thread"},"MessageThread")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component that renders a chat thread with typing indicators, read receipts, etc.")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/ui-components-sendbox--send-box"},"SendBox")),Object(esm.b)("td",{parentName:"tr",align:null},"Base component that allows user to input messages that will be sent to the joined thread")))),Object(esm.b)("h2",{id:"set-up-fluent-theme-provider"},"Set Up Fluent Theme Provider"),Object(esm.b)("p",null,"The ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," is a required wrapper around the UI Library components to provide theming that makes the components look amazing!\nIt is in charge of allowing developer customize the theme of the components as well. Check out ",Object(esm.b)("a",{parentName:"p",href:"/?path=/story/theming--page"},"Theming")," for more information. ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," defaults to using light theme."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.g,{code:"import { FluentThemeProvider } from '@azure/communication-react';\nimport React from 'react';\n\nfunction App(): JSX.Element {\n  return (\n    <FluentThemeProvider>\n      <h1>Hooray! You set up Fluent Theme Provider </h1>\n    </FluentThemeProvider>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("p",null,"Inside the ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider"),", you can add additional components.\nNext we'll use various UI components to showcase a sample experience.\nYou can customize the layout of these components and add any other custom components that you want to render with them."),Object(esm.b)("h2",{id:"calling-ui-components"},"Calling UI Components"),Object(esm.b)("p",null,"For Calling, we'll use the ",Object(esm.b)("a",{parentName:"p",href:"/?path=/story/ui-components-gridlayout--grid-layout-component"},Object(esm.b)("inlineCode",{parentName:"a"},"GridLayout"))," and ",Object(esm.b)("a",{parentName:"p",href:"/?path=/story/ui-components-controlbar--control-bar"},Object(esm.b)("inlineCode",{parentName:"a"},"ControlBar"))," components.\nTo start, in the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder, create a new file called ",Object(esm.b)("inlineCode",{parentName:"p"},"CallingComponents.tsx"),".\nHere we'll initialize a function component that will hold our base components to then import in ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx"),".\nYou can add extra layout and styling around the components."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"CallingComponents.tsx")),Object(esm.b)(dist_esm.g,{code:"// Copyright (c) Microsoft Corporation.\n// Licensed under the MIT license.\nimport {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  GridLayout,\n  MicrophoneButton,\n  OptionsButton,\n  ScreenShareButton,\n  VideoTile\n} from '@azure/communication-react';\n\nimport { IContextualMenuProps, mergeStyles, Stack } from '@fluentui/react';\nimport React, { useState } from 'react';\n\nexport const CallingComponents = (): JSX.Element => {\n  const exampleOptionsMenuProps: IContextualMenuProps = {\n    items: [\n      {\n        key: '1',\n        name: 'Choose Camera',\n        iconProps: { iconName: 'LocationCircle' },\n        onClick: () => alert('Choose Camera Menu Item Clicked!')\n      }\n    ]\n  };\n\n  const controlBarStyle = {\n    root: {\n      justifyContent: 'center'\n    }\n  };\n  const [videoButtonChecked, setVideoButtonChecked] = useState<boolean>(false);\n  const [audioButtonChecked, setAudioButtonChecked] = useState<boolean>(false);\n  const [screenshareButtonChecked, setScreenshareButtonChecked] = useState<boolean>(false);\n\n  return (\n    <Stack className={mergeStyles({ height: '100%' })}>\n      {/* GridLayout Component relies on the parent's height and width, so it's required to set the height and width on its parent. */}\n      <div style={{ height: '30rem', width: '30rem', border: '1px solid' }}>\n        <GridLayout>\n          <VideoTile displayName={'Michael'} />\n        </GridLayout>\n      </div>\n\n      {/* Control Bar with default set up */}\n      <ControlBar styles={controlBarStyle}>\n        <CameraButton checked={videoButtonChecked} onClick={() => setVideoButtonChecked(!videoButtonChecked)} />\n        <MicrophoneButton checked={audioButtonChecked} onClick={() => setAudioButtonChecked(!audioButtonChecked)} />\n        <ScreenShareButton\n          checked={screenshareButtonChecked}\n          onClick={() => setScreenshareButtonChecked(!screenshareButtonChecked)}\n        />\n        <OptionsButton menuProps={exampleOptionsMenuProps} />\n        <EndCallButton />\n      </ControlBar>\n    </Stack>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)("p",null,"For this example we added a single ",Object(esm.b)("inlineCode",{parentName:"p"},"Video Tile")," to the grid, but additional can be added."),Object(esm.b)("h2",{id:"chat-ui-components"},"Chat UI Components"),Object(esm.b)("p",null,"For Chat, we will use the ",Object(esm.b)("a",{parentName:"p",href:"/?path=/docs/ui-components-chatthread--chat-thread-component"},Object(esm.b)("inlineCode",{parentName:"a"},"MessageThread"))," and ",Object(esm.b)("a",{parentName:"p",href:"/?path=/docs/ui-components-sendbox--send-box-story-book-component"},Object(esm.b)("inlineCode",{parentName:"a"},"SendBox"))," components.\nTo start, in the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder, create a new file called ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatComponents.tsx"),".\nHere we'll initialize a function component that will hold our base components to then import in ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx"),"."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"ChatComponents.tsx")),Object(esm.b)(dist_esm.g,{code:"import {\n  MessageThread,\n  ChatMessage as WebUiChatMessage,\n  SendBox,\n  MessageStatus,\n  MessageContentType\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const ChatComponents = (): JSX.Element => {\n  //A sample chat history\n  const GetHistoryChatMessages = (): WebUiChatMessage[] => {\n    return [\n      {\n        type: 'chat',\n        payload: {\n          type: 'text' as MessageContentType,\n          senderId: '1',\n          senderDisplayName: 'User1',\n          messageId: Math.random().toString(),\n          content: 'Hi everyone, I created this awesome group chat for us!',\n          createdOn: new Date('2019-04-13T00:00:00.000+08:10'),\n          mine: true,\n          attached: false,\n          status: 'seen' as MessageStatus\n        }\n      },\n      {\n        type: 'chat',\n        payload: {\n          type: 'text' as MessageContentType,\n          senderId: '2',\n          senderDisplayName: 'User2',\n          messageId: Math.random().toString(),\n          content: 'Nice! This looks great!',\n          createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n          mine: false,\n          attached: false\n        }\n      },\n      {\n        type: 'chat',\n        payload: {\n          type: 'text' as MessageContentType,\n          senderId: '3',\n          senderDisplayName: 'User3',\n          messageId: Math.random().toString(),\n          content: \"Yeah agree, let's chat here from now on!\",\n          createdOn: new Date('2019-04-13T00:00:00.000+08:09'),\n          mine: false,\n          attached: false\n        }\n      }\n    ];\n  };\n\n  return (\n    <div style={{ height: '30rem', width: '30rem' }}>\n      {/* Chat thread component with message status indicator feature enabled */}\n      <MessageThread userId={'1'} messages={GetHistoryChatMessages()} showMessageStatus={true} />\n\n      <SendBox\n        disabled={false}\n        onSendMessage={async () => {\n          return;\n        }}\n        onTyping={async () => {\n          return;\n        }}\n      />\n    </div>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"add-calling-and-chat-components"},"Add Calling and Chat Components"),Object(esm.b)("p",null,"Back in the ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx")," file, we will now add the components to the ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," like shown below."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.g,{code:"import { FluentThemeProvider } from '@azure/communication-react';\nimport { Stack } from '@fluentui/react';\nimport React from 'react';\nimport { CallingComponents } from './CallingComponents';\nimport { ChatComponents } from './ChatComponents';\n\nfunction CompletedComponentsApp(): JSX.Element {\n  const stackStyle = {\n    root: {\n      width: '100%'\n    }\n  };\n  return (\n    <FluentThemeProvider>\n      <Stack horizontal horizontalAlign=\"space-evenly\" styles={stackStyle}>\n        <CallingComponents />\n        <ChatComponents />\n      </Stack>\n    </FluentThemeProvider>\n  );\n}\n\nexport default CompletedComponentsApp;\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxType:"Canvas"},Object(esm.b)(snippets_CompletedComponentsApp_snippet,{mdxType:"CompletedComponentsApp"})),Object(esm.b)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.b)("p",null,"To run the code above use the command:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-console"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.b)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.b)("h2",{id:"next-steps"},"Next Steps"),Object(esm.b)("p",null,Object(esm.b)("a",{parentName:"p",href:"/?path=/story/quickstarts-statefulclient--page"},"Try UI Library Stateful Client")),Object(esm.b)("p",null,"For more information, see the following resources:"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/styling--page"},"UI Library Styling")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/theming--page"},"UI Library Theming"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Quickstarts/Get started with UI Components",id:"quickstarts-uicomponents",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1481:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Participants",(function(){return Participants}));__webpack_require__(81),__webpack_require__(34),__webpack_require__(73),__webpack_require__(93),__webpack_require__(53),__webpack_require__(231),__webpack_require__(10),__webpack_require__(50);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),jsx_runtime=__webpack_require__(1),Default_snippet_mockParticipantsProps={participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}]},Default_snippet_ParticipantsButtonDefaultExample=function ParticipantsButtonDefaultExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.p,{participantListProps:Default_snippet_mockParticipantsProps})})};Default_snippet_ParticipantsButtonDefaultExample.displayName="ParticipantsButtonDefaultExample",Default_snippet_ParticipantsButtonDefaultExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonDefaultExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/Default.snippet.tsx"]={name:"ParticipantsButtonDefaultExample",docgenInfo:Default_snippet_ParticipantsButtonDefaultExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/Default.snippet.tsx"});var WithCallLink_snippet_mockParticipantsProps={participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],myUserId:"user1"},WithCallLink_snippet_ParticipantsButtonWithCallLinkExample=function ParticipantsButtonWithCallLinkExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.p,{participantListProps:WithCallLink_snippet_mockParticipantsProps,callInvitationURL:"URL to invite new participants to the current call (https://...)"})})};WithCallLink_snippet_ParticipantsButtonWithCallLinkExample.displayName="ParticipantsButtonWithCallLinkExample",WithCallLink_snippet_ParticipantsButtonWithCallLinkExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithCallLinkExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithCallLink.snippet.tsx"]={name:"ParticipantsButtonWithCallLinkExample",docgenInfo:WithCallLink_snippet_ParticipantsButtonWithCallLinkExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithCallLink.snippet.tsx"});var Persona=__webpack_require__(560),Persona_types=__webpack_require__(26),Icon=__webpack_require__(821),Label=__webpack_require__(1710),WithCustomRender_snippet_customOnRenderAvatar=function customOnRenderAvatar(participant){return"user2"===participant.userId?Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif",style:{borderRadius:"32px",width:"32px",position:"relative",margin:"auto",left:0,right:0,top:0,bottom:0}},"avatar"+participant.userId):Object(jsx_runtime.jsx)(Persona.a,{text:participant.displayName,hidePersonaDetails:!0,size:Persona_types.c.size32})};WithCustomRender_snippet_customOnRenderAvatar.displayName="customOnRenderAvatar";var WithCustomRender_snippet_mockParticipantsProps={participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!0,isScreenSharing:!1}],myUserId:"user1",onRenderAvatar:function onRenderAvatar(participant){return WithCustomRender_snippet_customOnRenderAvatar(participant)}},WithCustomRender_snippet_onMuteAll=function onMuteAll(){},WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample=function ParticipantsButtonWithCustomRenderExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.p,{showLabel:!0,participantListProps:WithCustomRender_snippet_mockParticipantsProps,callInvitationURL:"URL to invite new participants to the current call (https://...)",onMuteAll:WithCustomRender_snippet_onMuteAll,onRenderIcon:function customOnRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"Group",style:{color:"orange",fontSize:"20px"}},"participantsCustomIconKey")},onRenderText:function customOnRenderText(){return Object(jsx_runtime.jsx)(Label.a,{style:{color:"darkviolet",fontStyle:"italic"},children:"who is on this call"},"participantsCustomLabelKey")}})})};WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample.displayName="ParticipantsButtonWithCustomRenderExample",WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithCustomRenderExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithCustomRender.snippet.tsx"]={name:"ParticipantsButtonWithCustomRenderExample",docgenInfo:WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithCustomRender.snippet.tsx"});var WithCustomStyles_snippet_mockParticipantsProps={participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!0,isScreenSharing:!1}],myUserId:"user1"},WithCustomStyles_snippet_onMuteAll=function onMuteAll(){},mockStyles={root:{background:"blue",color:"white"},rootHovered:{background:"crimson",color:"white"},rootExpanded:{background:"dimgrey",color:"white"},label:{color:"white",fontStyle:"italic"},participantListContainerStyle:{border:"solid 1px red"}},WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample=function ParticipantsButtonWithCustomStylesExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.p,{showLabel:!0,participantListProps:WithCustomStyles_snippet_mockParticipantsProps,callInvitationURL:"URL to invite new participants to the current call (https://...)",onMuteAll:WithCustomStyles_snippet_onMuteAll,styles:mockStyles})})};WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample.displayName="ParticipantsButtonWithCustomStylesExample",WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithCustomStylesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithCustomStyles.snippet.tsx"]={name:"ParticipantsButtonWithCustomStylesExample",docgenInfo:WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithCustomStyles.snippet.tsx"});var WithLabel_snippet_mockParticipantsProps={participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}]},WithLabel_snippet_ParticipantsButtonWithLabelExample=function ParticipantsButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.p,{showLabel:!0,participantListProps:WithLabel_snippet_mockParticipantsProps})})};WithLabel_snippet_ParticipantsButtonWithLabelExample.displayName="ParticipantsButtonWithLabelExample",WithLabel_snippet_ParticipantsButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithLabel.snippet.tsx"]={name:"ParticipantsButtonWithLabelExample",docgenInfo:WithLabel_snippet_ParticipantsButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithLabel.snippet.tsx"});var WithMuteAllOption_snippet_mockParticipantsProps={participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],myUserId:"user1"},WithMuteAllOption_snippet_onMuteAll=function onMuteAll(){},WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample=function ParticipantsButtonWithMuteAllOptionExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.p,{participantListProps:WithMuteAllOption_snippet_mockParticipantsProps,callInvitationURL:"URL to invite new participants to the current call (https://...)",onMuteAll:WithMuteAllOption_snippet_onMuteAll})})};WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample.displayName="ParticipantsButtonWithMuteAllOptionExample",WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithMuteAllOptionExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithMuteAllOption.snippet.tsx"]={name:"ParticipantsButtonWithMuteAllOptionExample",docgenInfo:WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithMuteAllOption.snippet.tsx"});var WithUserExcludeFromList_snippet_mockParticipantsProps={participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],myUserId:"user1",excludeMe:!0},WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample=function ParticipantsButtonWithUserExcludeFromListExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.p,{participantListProps:WithUserExcludeFromList_snippet_mockParticipantsProps})})};WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample.displayName="ParticipantsButtonWithUserExcludeFromListExample",WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantsButtonWithUserExcludeFromListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Participants/snippets/WithUserExcludeFromList.snippet.tsx"]={name:"ParticipantsButtonWithUserExcludeFromListExample",docgenInfo:WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample.__docgenInfo,path:"stories/ControlBar/Buttons/Participants/snippets/WithUserExcludeFromList.snippet.tsx"});var ParticipantsButtonDefaultExampleText=__webpack_require__(1414).default,ParticipantsButtonWithCallLinkExampleText=__webpack_require__(1415).default,ParticipantsButtonWithCustomRenderExampleText=__webpack_require__(1416).default,ParticipantsButtonWithCustomStylesExampleText=__webpack_require__(1417).default,ParticipantsButtonWithLabelExampleText=__webpack_require__(1418).default,ParticipantsButtonWithMuteAllOptionExampleText=__webpack_require__(1419).default,ParticipantsButtonWithUserExcludeFromListExampleText=__webpack_require__(1420).default,onlyUnique=function onlyUnique(value,index,self){return self.indexOf(value)===index},Participants_stories_ParticipantsStory=function ParticipantsStory(args){var mockParticipants=args.participants.split(",").map((function(p){return p.trim()})).filter((function(p){return p})).filter(onlyUnique).map((function(p,i){return{userId:"user"+i,displayName:p,state:i%3?"Connected":"Idle",isMuted:!(i%3),isScreenSharing:2===i}})),userIndex=mockParticipants.map((function(p){return p.displayName})).indexOf("You"),mockParticipantsProps={participants:mockParticipants,myUserId:-1!==userIndex?mockParticipants[userIndex].userId:""};return Object(jsx_runtime.jsx)(src.p,Object.assign({},args,{participantListProps:mockParticipantsProps,onMuteAll:args.isMuteAllAvailable?function onMuteAll(){}:void 0}))};Participants_stories_ParticipantsStory.displayName="ParticipantsStory";var Participants=Participants_stories_ParticipantsStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-participants",title:constants.a+"/ControlBar/Buttons/Participants",component:src.p,argTypes:{isMuteAllAvailable:controlsUtils.a.isMuteAllAvailable,showLabel:controlsUtils.a.showLabel,callInvitationURL:controlsUtils.a.callInvitationURL,participants:controlsUtils.a.participantNames,participantListProps:controlsUtils.j,styles:controlsUtils.j,onMuteAll:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ParticipantsButton"}),Object(jsx_runtime.jsx)(esm.c,{of:src.p}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, do not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { ParticipantsButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Default Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"The default `ParticipantsButton` component shows `People` icon with no label, and contains menu items displaying the number of participants with a list as sub-menu like shown in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ParticipantsButtonDefaultExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_ParticipantsButtonDefaultExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticipantsButton with default label"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can display the button label which, by default, will show below the icon as `People`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ParticipantsButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_ParticipantsButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticipantsButton with local user excluded from participant list"}),Object(jsx_runtime.jsx)(esm.c,{children:"When excluding local user from participant list, `ParticipantsButton` displays their presence to the call as a menu item above the number of remote participants like shown in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ParticipantsButtonWithUserExcludeFromListExampleText,children:Object(jsx_runtime.jsx)(WithUserExcludeFromList_snippet_ParticipantsButtonWithUserExcludeFromListExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticipantsButton with copyable call invitation link"}),Object(jsx_runtime.jsx)(esm.c,{children:"When opting to have a copyable link available, `ParticipantsButton` displays it as a menu item below the number of participants like shown in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ParticipantsButtonWithCallLinkExampleText,children:Object(jsx_runtime.jsx)(WithCallLink_snippet_ParticipantsButtonWithCallLinkExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticipantsButton with option to mute all participants"}),Object(jsx_runtime.jsx)(esm.c,{children:"When opting to have the possibility of muting all participants, `ParticipantsButton` displays this options as a sub-menu item of the number of participants, just below the list of participants, like shown in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ParticipantsButtonWithMuteAllOptionExampleText,children:Object(jsx_runtime.jsx)(WithMuteAllOption_snippet_ParticipantsButtonWithMuteAllOptionExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticipantsButton with cutom styles"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can change the styles of `ParticipantsButton` through its `styles` props as you would customize any Button styles (root, label, etc..) with the addition of customizing the participant list container like shown in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ParticipantsButtonWithCustomStylesExampleText,children:Object(jsx_runtime.jsx)(WithCustomStyles_snippet_ParticipantsButtonWithCustomStylesExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticipantsButton with custom render"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can change the render of the `ParticipantsButton` as you would do for any Button (onRenderIcon, onRenderText, etc... ) with the addition of customizing the render of the participant list (see [ParticipantList](/?path=/docs/ui-components-participantlist--participant-list) component)."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ParticipantsButtonWithCustomRenderExampleText,children:Object(jsx_runtime.jsx)(WithCustomRender_snippet_ParticipantsButtonWithCustomRenderExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticipantsButton Props"}),Object(jsx_runtime.jsx)(esm.c,{children:"`ParticipantsButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the following additional properties."}),Object(jsx_runtime.jsx)(esm.f,{of:src.p})]})}()}}}};Participants.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const mockParticipants = args.participants\n    .split(',')\n    .map((p) => p.trim())\n    .filter((p) => p)\n    .filter(onlyUnique)\n    .map((p, i) => {\n      return {\n        userId: `user${i}`,\n        displayName: p,\n        state: i % 3 ? 'Connected' : 'Idle',\n        isMuted: i % 3 ? false : true,\n        isScreenSharing: i === 2 ? true : false\n      };\n    });\n\n  const userIndex = mockParticipants.map((p) => p.displayName).indexOf('You');\n  const myUserId = userIndex !== -1 ? mockParticipants[userIndex].userId : '';\n  const mockParticipantsProps: ParticipantListProps = {\n    participants: mockParticipants,\n    myUserId: myUserId\n  };\n  const onMuteAll = (): void => {\n    // your implementation to mute all participants\n  };\n  return (\n    <ParticipantsButton\n      {...args}\n      participantListProps={mockParticipantsProps}\n      onMuteAll={args.isMuteAllAvailable ? onMuteAll : undefined}\n    />\n  );\n}"}},Participants.parameters)},1484:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var esm=__webpack_require__(2),dist_esm=__webpack_require__(5),src=__webpack_require__(24),jsx_runtime=__webpack_require__(1),FluentThemeProvider_snippet_FluentThemeProviderSnippet=function FluentThemeProviderSnippet(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.b,{children:[Object(jsx_runtime.jsx)(src.a,{}),Object(jsx_runtime.jsx)(src.l,{}),Object(jsx_runtime.jsx)(src.q,{}),Object(jsx_runtime.jsx)(src.d,{})]})})};FluentThemeProvider_snippet_FluentThemeProviderSnippet.displayName="FluentThemeProviderSnippet",FluentThemeProvider_snippet_FluentThemeProviderSnippet.__docgenInfo={description:"",methods:[],displayName:"FluentThemeProviderSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/FluentThemeProvider.snippet.tsx"]={name:"FluentThemeProviderSnippet",docgenInfo:FluentThemeProvider_snippet_FluentThemeProviderSnippet.__docgenInfo,path:"stories/snippets/FluentThemeProvider.snippet.tsx"});var DarkControlBar_snippet_DarkControlBar=function DarkControlBar(){return Object(jsx_runtime.jsx)(src.f,{fluentTheme:src.x,children:Object(jsx_runtime.jsxs)(src.b,{children:[Object(jsx_runtime.jsx)(src.a,{}),Object(jsx_runtime.jsx)(src.l,{}),Object(jsx_runtime.jsx)(src.q,{}),Object(jsx_runtime.jsx)(src.m,{}),Object(jsx_runtime.jsx)(src.d,{})]})})};DarkControlBar_snippet_DarkControlBar.displayName="DarkControlBar",DarkControlBar_snippet_DarkControlBar.__docgenInfo={description:"",methods:[],displayName:"DarkControlBar"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/DarkControlBar.snippet.tsx"]={name:"DarkControlBar",docgenInfo:DarkControlBar_snippet_DarkControlBar.__docgenInfo,path:"stories/snippets/DarkControlBar.snippet.tsx"});var DefaultButton=__webpack_require__(430),ThemedButton_snippet_ThemedButton=function ThemedButton(){var defaultButtonStyle={root:{background:Object(src.D)().palette.neutralLight}};return Object(jsx_runtime.jsx)(DefaultButton.a,{text:"exampleButton",styles:defaultButtonStyle})};ThemedButton_snippet_ThemedButton.displayName="ThemedButton",ThemedButton_snippet_ThemedButton.__docgenInfo={description:"",methods:[],displayName:"ThemedButton"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/snippets/ThemedButton.snippet.tsx"]={name:"ThemedButton",docgenInfo:ThemedButton_snippet_ThemedButton.__docgenInfo,path:"stories/snippets/ThemedButton.snippet.tsx"});var _excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.e,{id:"theming",title:"Theming",mdxType:"Meta"}),Object(esm.b)("h1",{id:"theming"},"Theming"),Object(esm.b)("p",null,"ACS UI SDK use components and icons from both ",Object(esm.b)("a",{parentName:"p",href:"https://developer.microsoft.com/en-us/fluentui#/controls/web",target:"_blank",rel:"nofollow noopener noreferrer"},"Fluent UI"),"\nand ",Object(esm.b)("a",{parentName:"p",href:"https://fluentsite.z22.web.core.windows.net",target:"_blank",rel:"nofollow noopener noreferrer"},"Fluent React Northstar"),". The ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider"),"\ncomponent ensures:"),Object(esm.b)("ol",null,Object(esm.b)("li",{parentName:"ol"},"ACS UI SDK and Fluent UI components and icons are themed together"),Object(esm.b)("li",{parentName:"ol"},"Fluent React Northstar icons are provided")),Object(esm.b)("h2",{id:"usage"},"Usage"),Object(esm.b)("p",null,"To use the FluentThemeProvider, simply import it from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," and wrap it around\nACS UI SDK components and Fluent UI components. For the example below we will provide theming and icons to\nthe ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar"),"."),Object(esm.b)(dist_esm.g,{code:"import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  ScreenShareButton\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const FluentThemeProviderSnippet = (): JSX.Element => {\n  return (\n    <FluentThemeProvider>\n      <ControlBar>\n        <CameraButton />\n        <MicrophoneButton />\n        <ScreenShareButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CFluentThemeProviderSnippet%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(FluentThemeProvider_snippet_FluentThemeProviderSnippet,{mdxType:"FluentThemeProviderSnippet"})),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," does two things here:"),Object(esm.b)("ol",null,Object(esm.b)("li",{parentName:"ol"},Object(esm.b)("inlineCode",{parentName:"li"},"FluentThemeProvider")," loads the icons used by components such as ",Object(esm.b)("inlineCode",{parentName:"li"},"CameraButton")),Object(esm.b)("li",{parentName:"ol"},Object(esm.b)("inlineCode",{parentName:"li"},"FluentThemeProvider")," applies theme (light theme by default) to the ",Object(esm.b)("inlineCode",{parentName:"li"},"ControlBar"))),Object(esm.b)("p",null,"To illustrate how another theme can be applied, import ",Object(esm.b)("inlineCode",{parentName:"p"},"darkTheme")," from ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react"),"\nand assign it to the ",Object(esm.b)("inlineCode",{parentName:"p"},"fluentTheme")," property."),Object(esm.b)(dist_esm.g,{code:"import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton,\n  OptionsButton,\n  ScreenShareButton,\n  darkTheme\n} from '@azure/communication-react';\nimport React from 'react';\n\nexport const DarkControlBar = (): JSX.Element => {\n  return (\n    <FluentThemeProvider fluentTheme={darkTheme}>\n      <ControlBar>\n        <CameraButton />\n        <MicrophoneButton />\n        <ScreenShareButton />\n        <OptionsButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CDarkControlBar%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(DarkControlBar_snippet_DarkControlBar,{mdxType:"DarkControlBar"})),Object(esm.b)("p",null,"The dark theme is applied to the ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar"),". The icon colors in the predefined button components are themed correctly\nbecause they are built using the ",Object(esm.b)("inlineCode",{parentName:"p"},"DefaultButton")," Fluent UI component."),Object(esm.b)("h2",{id:"fluentthemeprovider-props"},"FluentThemeProvider Props"),Object(esm.b)(dist_esm.f,{of:src.f,mdxType:"Props"}),Object(esm.b)("h2",{id:"creating-your-own-theme"},"Creating your own theme"),Object(esm.b)("p",null,"If you wish to use your own theme, we strongly advise using Microsoft's ",Object(esm.b)("a",{parentName:"p",href:"https://aka.ms/themedesigner",target:"_blank",rel:"nofollow noopener noreferrer"},"Fluent UI Theme Designer"),".\nPlease ensure that the Accessibility checker on the same page passes when creating your own theme."),Object(esm.b)("img",{src:"images/accessibility_checker_pass.png",alt:"Accessibility checker pass"}),Object(esm.b)("p",null,"The default light theme we export looks like this:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-typescript"},"export const lightTheme = {\n  palette: {\n    themePrimary: '#0078d4',\n    themeLighterAlt: '#f3f9fd',\n    themeLighter: '#d0e7f8',\n    themeLight: '#a9d3f2',\n    themeTertiary: '#5ca9e5',\n    themeSecondary: '#1a86d9',\n    themeDarkAlt: '#006cbe',\n    themeDark: '#005ba1',\n    themeDarker: '#004377',\n    neutralLighterAlt: '#faf9f8',\n    neutralLighter: '#f3f2f1',\n    neutralLight: '#edebe9',\n    neutralQuaternaryAlt: '#e1dfdd',\n    neutralQuaternary: '#d0d0d0',\n    neutralTertiaryAlt: '#c8c6c4',\n    neutralTertiary: '#a19f9d',\n    neutralSecondary: '#605e5c',\n    neutralPrimaryAlt: '#3b3a39',\n    neutralPrimary: '#323130',\n    neutralDark: '#201f1e',\n    black: '#000000',\n    white: '#ffffff'\n  }\n};\n")),Object(esm.b)("h2",{id:"custom-theme-mapping"},"Custom Theme Mapping"),Object(esm.b)("p",null,"The ACS UI SDK and Fluent UI components automatically handles the mapping of palette slots to components.\nIf you wish to override the mapping, we advise that you use the ",Object(esm.b)("inlineCode",{parentName:"p"},"useTheme")," hook."),Object(esm.b)(dist_esm.g,{code:"import { useTheme } from '@azure/communication-react';\nimport { DefaultButton } from '@fluentui/react';\nimport React from 'react';\n\nexport const ThemedButton = (): JSX.Element => {\n  const theme = useTheme();\n\n  const defaultButtonStyle = {\n    root: {\n      background: theme.palette.neutralLight\n    }\n  };\n  return <DefaultButton text=\"exampleButton\" styles={defaultButtonStyle} />;\n};\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CThemedButton%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(ThemedButton_snippet_ThemedButton,{mdxType:"ThemedButton"})),Object(esm.b)("p",null,"Should you override your own mappings, please note that ACS SDK UI components abide by the general Fluent UI\nmappings. Foreground colors are used for text, icons, and outlines while background colors for component\nbackgrounds. Primary colors are also used for component backgrounds or icons."),Object(esm.b)("h2",{id:"custom-fonts"},"Custom Fonts"),Object(esm.b)("p",null,"Custom Fonts can be applied to UI Components or Composites using the existing theming mechansim.\nAlong with the ability to change colors, a JSON object containing the theme palette also allows users to specify custom fonts.\nAs long as the fonts have been loaded in the application, a custom font name can be specified as shown in the example below."),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-tsx"},"export const lightTheme = {\n  defaultFontStyle: { fontFamily: 'Monaco, Menlo, Consolas', fontWeight: 'regular' },\n  palette: {\n    themePrimary: '#0078d4',\n    themeLighterAlt: '#f3f9fd'\n  }\n};\n")),Object(esm.b)("p",null,"If you wish to apply the same font to all the font weights, simply remove the ",Object(esm.b)("inlineCode",{parentName:"p"},"fontWeight")," property from the ",Object(esm.b)("inlineCode",{parentName:"p"},"defaultFontStyle")," object."))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Theming",id:"theming",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1486:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ControlBar",(function(){return ControlBar}));__webpack_require__(186),__webpack_require__(10),__webpack_require__(50);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),OptionsButtonWithKnobs_snippet=__webpack_require__(419),jsx_runtime=__webpack_require__(1),mockParticipantsProps={participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],myUserId:"user1"},AllButtonsControlBar_snippet_AllButtonsControlBarExample=function AllButtonsControlBarExample(){var exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]};return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.b,{layout:"horizontal",children:[Object(jsx_runtime.jsx)(src.a,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.l,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.q,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.p,{participantListProps:mockParticipantsProps,callInvitationURL:"URL to copy",onMuteAll:function onMuteAll(){}}),Object(jsx_runtime.jsx)(src.m,{menuProps:exampleOptionsMenuProps}),Object(jsx_runtime.jsx)(src.d,{onClick:function onClick(){}})]})})};AllButtonsControlBar_snippet_AllButtonsControlBarExample.displayName="AllButtonsControlBarExample",AllButtonsControlBar_snippet_AllButtonsControlBarExample.__docgenInfo={description:"",methods:[],displayName:"AllButtonsControlBarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/AllButtonsControlBar.snippet.tsx"]={name:"AllButtonsControlBarExample",docgenInfo:AllButtonsControlBar_snippet_AllButtonsControlBarExample.__docgenInfo,path:"stories/ControlBar/snippets/AllButtonsControlBar.snippet.tsx"});var componentMainDivStyle={display:"flex",border:"solid 0.5px lightgray",height:"24rem",alignItems:"center",justifyContent:"center"},ControlBarLayout_snippet_mockParticipantsProps={participants:[]},ControlBarLayout_snippet_ControlBarLayoutExample=function ControlBarLayoutExample(){return Object(jsx_runtime.jsx)("div",{style:componentMainDivStyle,children:Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.b,{layout:"floatingLeft",children:[Object(jsx_runtime.jsx)(src.a,{}),Object(jsx_runtime.jsx)(src.l,{}),Object(jsx_runtime.jsx)(src.q,{}),Object(jsx_runtime.jsx)(src.p,{participantListProps:ControlBarLayout_snippet_mockParticipantsProps}),Object(jsx_runtime.jsx)(src.m,{}),Object(jsx_runtime.jsx)(src.d,{})]})})})};ControlBarLayout_snippet_ControlBarLayoutExample.displayName="ControlBarLayoutExample",ControlBarLayout_snippet_ControlBarLayoutExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/ControlBarLayout.snippet.tsx"]={name:"ControlBarLayoutExample",docgenInfo:ControlBarLayout_snippet_ControlBarLayoutExample.__docgenInfo,path:"stories/ControlBar/snippets/ControlBarLayout.snippet.tsx"});var CallEnd20Filled=__webpack_require__(1675),CustomButtons_snippet_CustomButtonsExample=function CustomButtonsExample(){var CustomEndCallButton=function CustomEndCallButton(){return Object(jsx_runtime.jsx)(src.d,{styles:{root:{height:"inherit",background:"darkorange",color:"white",width:"10rem"},rootHovered:{background:"darkred",color:"white"},flexContainer:{flexFlow:"row"}},showLabel:!0,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(CallEnd20Filled.a,{primaryFill:"currentColor"},"hangupBtnIconKey")},onRenderText:function onRenderText(){return Object(jsx_runtime.jsx)("span",{style:{marginLeft:"0.5rem"},children:"End Call"},"hangupBtnTextKey")},onClick:function onClick(){}})};return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.b,{layout:"horizontal",children:[Object(jsx_runtime.jsx)(src.a,{}),Object(jsx_runtime.jsx)(src.l,{}),Object(jsx_runtime.jsx)(CustomEndCallButton,{})]})})};CustomButtons_snippet_CustomButtonsExample.displayName="CustomButtonsExample",CustomButtons_snippet_CustomButtonsExample.__docgenInfo={description:"",methods:[],displayName:"CustomButtonsExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/CustomButtons.snippet.tsx"]={name:"CustomButtonsExample",docgenInfo:CustomButtons_snippet_CustomButtonsExample.__docgenInfo,path:"stories/ControlBar/snippets/CustomButtons.snippet.tsx"});var CustomControlBarStyles_snippet_CustomControlBarStylesExample=function CustomControlBarStylesExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.b,{layout:"horizontal",styles:{root:{backgroundColor:"lightgray",border:"solid black",borderRadius:"0.3rem",maxWidth:"fit-content"}},children:[Object(jsx_runtime.jsx)(src.a,{}),Object(jsx_runtime.jsx)(src.l,{}),Object(jsx_runtime.jsx)(src.d,{})]})})};CustomControlBarStyles_snippet_CustomControlBarStylesExample.displayName="CustomControlBarStylesExample",CustomControlBarStyles_snippet_CustomControlBarStylesExample.__docgenInfo={description:"",methods:[],displayName:"CustomControlBarStylesExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/CustomControlBarStyles.snippet.tsx"]={name:"CustomControlBarStylesExample",docgenInfo:CustomControlBarStyles_snippet_CustomControlBarStylesExample.__docgenInfo,path:"stories/ControlBar/snippets/CustomControlBarStyles.snippet.tsx"});var OptionsButton_snippet_OptionsButtonExample=function OptionsButtonExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.b,{layout:"horizontal",children:[Object(jsx_runtime.jsx)(src.a,{onClick:function onClick(){}}),Object(jsx_runtime.jsx)(src.m,{menuProps:{items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"camera1",text:"Full HD Webcam",title:"Full HD Webcam",canCheck:!0,isChecked:!0},{key:"camera2",text:"Macbook Pro Webcam",title:"Macbook Pro Webcam"}]}},{key:"2",name:"Choose Microphone",iconProps:{iconName:"LocationCircle"},subMenuProps:{items:[{key:"mic1",text:"Realtek HD Audio",title:"Realtek HD Audio"},{key:"mic2",text:"Macbook Pro Mic",title:"Macbook Pro Mic",canCheck:!0,isChecked:!0}]}}]}})]})})};OptionsButton_snippet_OptionsButtonExample.displayName="OptionsButtonExample",OptionsButton_snippet_OptionsButtonExample.__docgenInfo={description:"",methods:[],displayName:"OptionsButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/snippets/OptionsButton.snippet.tsx"]={name:"OptionsButtonExample",docgenInfo:OptionsButton_snippet_OptionsButtonExample.__docgenInfo,path:"stories/ControlBar/snippets/OptionsButton.snippet.tsx"});var AllButtonsControlBarExampleText=__webpack_require__(1424).default,ControlBarLayoutExampleText=__webpack_require__(1425).default,CustomButtonsExampleText=__webpack_require__(1426).default,CustomControlBarStylesExampleText=__webpack_require__(1427).default,OptionsButtonExampleText=__webpack_require__(1428).default,ControlBar_stories_mockParticipantsProps={participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],myUserId:"user1"},ControlBar_stories_ControlBarStory=function ControlBarStory(args,_ref){var background="#f8f8f8";"Dark"===_ref.globals.theme&&(background=args.layout.startsWith("floating")?"#252423":"#161514");return Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",alignItems:"center",justifyContent:"center",display:"inherit",background:background},children:Object(jsx_runtime.jsxs)(src.b,{layout:args.layout,children:[Object(jsx_runtime.jsx)(src.a,{showLabel:args.showLabel,checked:args.checked}),Object(jsx_runtime.jsx)(src.l,{showLabel:args.showLabel,checked:args.checked}),Object(jsx_runtime.jsx)(src.q,{showLabel:args.showLabel,checked:args.checked}),Object(jsx_runtime.jsx)(src.p,{showLabel:args.showLabels,participantListProps:ControlBar_stories_mockParticipantsProps,callInvitationURL:"URL to copy",onMuteAll:function onMuteAll(){}}),Object(jsx_runtime.jsx)(OptionsButtonWithKnobs_snippet.a,Object.assign({},args)),Object(jsx_runtime.jsx)(src.d,{showLabel:args.showLabel})]})})};ControlBar_stories_ControlBarStory.displayName="ControlBarStory";var ControlBar=ControlBar_stories_ControlBarStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar",title:constants.a+"/ControlBar",component:src.b,argTypes:{layout:controlsUtils.a.controlBarLayout,checked:controlsUtils.a.checked,showLabel:controlsUtils.a.showLabel,cameras:controlsUtils.a.cameras,microphones:controlsUtils.a.microphones,speakers:controlsUtils.a.speakers,children:controlsUtils.j,styles:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ControlBar"}),Object(jsx_runtime.jsx)(esm.c,{of:src.b}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { FluentThemeProvider, ControlBar } from '@azure/communication-react';\nimport { DefaultButton } from '@fluentui/react';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"We recommend using our pre-defined buttons you can start find [here](./?path=/docs/ui-components-controlbar-buttons) or `DefaultButton`, a [Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) component from Fluent UI, as controls inside `ControlBar`. Pre-defined styles like `controlButtonStyles` or `controlButtonLabelStyles` can also be imported and used as `DefaultButton` styles for easy styling. `FluentThemeProvider` is needed around `ControlBar` to provide theming and icons. Learn more about theming [here](./?path=/docs/theming--page)."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:AllButtonsControlBarExampleText,children:Object(jsx_runtime.jsx)(AllButtonsControlBar_snippet_AllButtonsControlBarExample,{})}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: In the example above, `menuProps` is a property of `Button`. The property type is [IContextualMenuProps](https://developer.microsoft.com/en-us/fluentui#/controls/web/contextualmenu#IContextualMenuProps), an interface for defining dropdown menu items."}),Object(jsx_runtime.jsx)(esm.d,{children:"Layouts"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can change the layout of `ControlBar` by providing a preset layout to the `layout` prop. Preset layouts are `horizontal`, `vertical`, `dockedTop`, `dockedBottom`, `dockedLeft`, `dockedRight`, `floatingTop`, `floatingBottom`, `floatingLeft` and `floatingRight`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ControlBarLayoutExampleText,children:Object(jsx_runtime.jsx)(ControlBarLayout_snippet_ControlBarLayoutExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom ControlBar Styles"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can change the styles of the `ControlBar` by customizing its `styles` prop like in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomControlBarStylesExampleText,children:Object(jsx_runtime.jsx)(CustomControlBarStyles_snippet_CustomControlBarStylesExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom Buttons"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can also easily change the styles of included button components. They are built on Fluent UI `DefaultButton` and accept all the same props. In the example below we import `CameraButton` and `MicrophoneButton` for the 1st and 2nd buttons and style our own hang up button for the 3rd button. Learn more about styling [here](./?path=/docs/styling--page)."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomButtonsExampleText,children:Object(jsx_runtime.jsx)(CustomButtons_snippet_CustomButtonsExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Dropdown Options Button"}),Object(jsx_runtime.jsx)(esm.c,{children:"The `OptionsButton` can be used for any dropdown items defined through `menuProps`. For more information, check out the [official Fluent UI documentation](https://developer.microsoft.com/en-us/fluentui#/controls/web/button)"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:OptionsButtonExampleText,children:Object(jsx_runtime.jsx)(OptionsButton_snippet_OptionsButtonExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ControlBar Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.b})]})}()}}}};ControlBar.parameters=Object.assign({storySource:{source:"(args, { globals: { theme } }) => {\n  // This is code to set the color of the background div to show contrast to the control bar based on the theme like shown in the Figma design.\n  let background = '#f8f8f8';\n  if (theme === 'Dark') {\n    if (args.layout.startsWith('floating')) {\n      background = '#252423';\n    } else {\n      background = '#161514';\n    }\n  }\n\n  const onMuteAll = (): void => {\n    // your implementation to mute all participants\n  };\n\n  return (\n    <div\n      style={{\n        width: '100%',\n        height: '100%',\n        alignItems: 'center',\n        justifyContent: 'center',\n        display: 'inherit',\n        background: background\n      }}\n    >\n      <ControlBarComponent layout={args.layout}>\n        <CameraButton showLabel={args.showLabel} checked={args.checked} />\n        <MicrophoneButton showLabel={args.showLabel} checked={args.checked} />\n        <ScreenShareButton showLabel={args.showLabel} checked={args.checked} />\n        <ParticipantsButton\n          showLabel={args.showLabels}\n          participantListProps={mockParticipantsProps}\n          callInvitationURL={'URL to copy'}\n          onMuteAll={onMuteAll}\n        />\n        <OptionsButtonWithKnobs {...args} />\n        <EndCallButton showLabel={args.showLabel} />\n      </ControlBarComponent>\n    </div>\n  );\n}"}},ControlBar.parameters)},1487:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var esm=__webpack_require__(2),dist_esm=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.e,{id:"quickstarts-statefulclient",title:"Quickstarts/Get started with Stateful Client",mdxType:"Meta"}),Object(esm.b)("h1",{id:"quickstart-get-started-with-stateful-clients"},"Quickstart: Get started with Stateful Clients"),Object(esm.b)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications.\nIn this quickstart, you'll learn how to integrate UI Library stateful clients into your application to build communication experiences.\nTo learn more about how to build applications with UI Library UI Components, see ",Object(esm.b)("a",{parentName:"p",href:"/?path=/docs/quickstarts-uicomponents--page"},"Get started with UI Components"),"\nStateful clients make it easier for developers to build UI applications on top of Azure Communication Services by providing built-in state that UI components can use to render.\nFind more information about ",Object(esm.b)("a",{parentName:"p",href:"/?path=/docs/statefulclient-overview--page"},"Stateful client here."),"."),Object(esm.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.b)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 12 Recommended)."),Object(esm.b)("li",{parentName:"ul"},"An active Communication Services resource. ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create a Communication Services resource"),"."),Object(esm.b)("li",{parentName:"ul"},"Knowledge of ",Object(esm.b)("a",{parentName:"li",href:"/?path=/story/quickstarts-uicomponents--page"},"UI Library Components"),". We will be using the UI Components in this quickstart."),Object(esm.b)("li",{parentName:"ul"},"Knowledge of Azure Communication Services ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts",target:"_blank",rel:"nofollow noopener noreferrer"},"Chat patterns"),".\nYou will need to create a thread and a user to that thread to use the UI Library. Look at the ",Object(esm.b)("a",{parentName:"li",href:"/?path=/docs/usecases--page#recommended-architecture"},"recommended architecture for the UI Library"))),Object(esm.b)("h2",{id:"setting-up"},"Setting Up"),Object(esm.b)("p",null,"UI Library requires a React environment to be setup as described below. If you already have a React App, you can skip this section."),Object(esm.b)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.b)("p",null,"We'll use the ",Object(esm.b)("inlineCode",{parentName:"p"},"create-react-app")," template for this quickstart. For more information, see: ",Object(esm.b)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-toolkit-starting-with-stateful --template typescript\n\ncd ui-toolkit-quickstart\n\n")),Object(esm.b)("p",null,"At the end of this process, you should have a full application inside the folder ",Object(esm.b)("inlineCode",{parentName:"p"},"ui-toolkit-starting-with-stateful"),".\nFor this quickstart, we'll be modifying files inside the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.b)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.b)("p",null,"Use the ",Object(esm.b)("inlineCode",{parentName:"p"},"npm install")," command to install the ",Object(esm.b)("inlineCode",{parentName:"p"},"@azure/communication-react")," library."),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install --save @azure/communication-react\n\n")),Object(esm.b)("p",null,"The ",Object(esm.b)("inlineCode",{parentName:"p"},"--save")," option lists the library as a dependency in your ",Object(esm.b)("strong",{parentName:"p"},"package.json")," file."),Object(esm.b)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.b)("p",null,"Let's test the Create React App installation by running:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"object-model"},"Object Model"),Object(esm.b)("p",null,"The following classes and interfaces from the Azure Communication Services UI client library are referenced in this quickstart:"),Object(esm.b)("table",null,Object(esm.b)("thead",{parentName:"table"},Object(esm.b)("tr",{parentName:"thead"},Object(esm.b)("th",{parentName:"tr",align:null},"Name"),Object(esm.b)("th",{parentName:"tr",align:null},"Description"))),Object(esm.b)("tbody",{parentName:"table"},Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"https://azuresdkdocs.blob.core.windows.net/$web/javascript/azure-communication-chat/1.0.0/classes/chatclient.html",target:"_blank",rel:"nofollow noopener noreferrer"},"ChatClient")),Object(esm.b)("td",{parentName:"tr",align:null},"Low-level chat library client.")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/statefulclient-overview--page"},"createStatefulChatClient")),Object(esm.b)("td",{parentName:"tr",align:null},"Method to translate low-level library client into a stateful client for the UI Library")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/statefulclient-reacthooks-setup--page"},"ChatClientProvider")),Object(esm.b)("td",{parentName:"tr",align:null},"Provider allows access to the Stateful Chat Client to the components inside of it")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/statefulclient-reacthooks-setup--page"},"ChatThreadClientProvider")),Object(esm.b)("td",{parentName:"tr",align:null},"Provider allows access to the Stateful Chat Thread Client to the components inside of it")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor")),Object(esm.b)("td",{parentName:"tr",align:null},"Hook to generate required props to enable UI Components")))),Object(esm.b)("h2",{id:"instantiate-stateful-chat-client-and-chat-thread-client"},"Instantiate Stateful Chat Client and Chat Thread Client"),Object(esm.b)("p",null,"Update the ",Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")," file to create a ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient")," off the low-level ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatClient")," using the method ",Object(esm.b)("inlineCode",{parentName:"p"},"createStatefulChatClient"),".\nMake sure to populate the constants at the top of the App code with information from your Azure Communication Services Resource.\nThese properties will be used to instantiate the ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatClient")," and ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient"),". Review ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/chat/concepts",target:"_blank",rel:"nofollow noopener noreferrer"},"Chat patterns")," for questions on these properties."),Object(esm.b)("p",null,"Once the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient")," is instantiated, we will then generate the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatThreadClient")," off it to join the desired chat thread."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.g,{code:"import { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport { createStatefulChatClient } from '@azure/communication-react';\nimport React from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n  const threadId = '<Get thread id from chat service>';\n  const displayName = '<Display Name>';\n\n  // Instantiate the statefulChatClient\n  const statefulChatClient = createStatefulChatClient({\n    userId: { kind: 'communicationUser', communicationUserId: userId },\n    displayName: displayName,\n    endpoint: endpointUrl,\n    credential: tokenCredential\n  });\n\n  const chatThreadClient = statefulChatClient.getChatThreadClient(threadId);\n\n  //Listen to notifications\n  statefulChatClient.startRealtimeNotifications();\n\n  return <>{chatThreadClient && <h1>Hooray! You set up chat client </h1>};</>;\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"add-providers"},"Add Providers"),Object(esm.b)("p",null,"Next we will add three providers that will encapsulate our UI components.\nFirst, the ",Object(esm.b)("inlineCode",{parentName:"p"},"FluentThemeProvider")," which provides visual theme to the underlying components.\nSecond, the ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatClientProvider")," which provides state from the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient")," to the components. For this provider, we will pass the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatClient")," as a prop to the provider.\nThird, the ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatThreadClientProvider")," which provides state from the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatThreadClient")," to the components. For this provider, we will pass the ",Object(esm.b)("inlineCode",{parentName:"p"},"statefulChatThreadClient")," as a prop to the provider."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.g,{code:"import { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  createStatefulChatClient,\n  FluentThemeProvider,\n  ChatClientProvider,\n  ChatThreadClientProvider\n} from '@azure/communication-react';\nimport React from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n  const threadId = '<Get thread id from chat service>';\n  const displayName = '<Display Name>';\n\n  //Instatiate the statefulChatClient\n  const statefulChatClient = createStatefulChatClient({\n    userId: { kind: 'communicationUser', communicationUserId: userId },\n    displayName: displayName,\n    endpoint: endpointUrl,\n    credential: tokenCredential\n  });\n\n  const chatThreadClient = statefulChatClient.getChatThreadClient(threadId);\n\n  //Listen to notifications\n  statefulChatClient.startRealtimeNotifications();\n\n  return (\n    <FluentThemeProvider>\n      <ChatClientProvider chatClient={statefulChatClient}>\n        <ChatThreadClientProvider chatThreadClient={chatThreadClient}>\n          <h1>Hooray! You set up providers </h1>\n        </ChatThreadClientProvider>\n      </ChatClientProvider>\n    </FluentThemeProvider>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("p",null,"Similarly to how we used chat providers for this example, you can use calling providers.\nFor more information on ",Object(esm.b)("a",{parentName:"p",href:"/?path=/story/statefulclient-reacthooks-setup--page"},"Calling Providers"),"."),Object(esm.b)("h2",{id:"compose-chat-components"},"Compose Chat Components"),Object(esm.b)("p",null,"Now that we have our structure ready, we will now create our chat experience using UI Components.\nFor Chat, we will use the ",Object(esm.b)("a",{parentName:"p",href:"/?path=/docs/ui-components-messagethread--message-thread"},"MessageThread")," and ",Object(esm.b)("a",{parentName:"p",href:"/?path=/docs/ui-components-sendbox--send-box"},"SendBox")," components.\nTo start add the code below to a new file ",Object(esm.b)("inlineCode",{parentName:"p"},"ChatComponentsStateful.tsx"),".\nFor more information on getting started with UI Components follow the ",Object(esm.b)("a",{parentName:"p",href:"/?path=/story/quickstarts-uicomponents--page"},"quickstart"),"\nHere we will use the ",Object(esm.b)("inlineCode",{parentName:"p"},"usePropsFor")," hook to connect our components to the stateful clients.\nThe ",Object(esm.b)("inlineCode",{parentName:"p"},"usePropsFor")," method takes in the component for which we want props generated, in this case ",Object(esm.b)("inlineCode",{parentName:"p"},"MessageThread")," and ",Object(esm.b)("inlineCode",{parentName:"p"},"SendBox"),"."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"ChatComponentsStateful.tsx")),Object(esm.b)(dist_esm.g,{code:"import { usePropsFor, MessageThread, SendBox } from '@azure/communication-react';\nimport React from 'react';\n\nfunction ChatComponents(): JSX.Element {\n  const messageThreadProps = usePropsFor(MessageThread);\n  const sendBoxProps = usePropsFor(SendBox);\n\n  return (\n    <div style={{ height: '50rem', width: '50rem' }}>\n      {/*Props are updated asynchronously, so only render the component once props are populated.*/}\n      {messageThreadProps && <MessageThread {...messageThreadProps} />}\n      {sendBoxProps && <SendBox {...sendBoxProps} />}\n    </div>\n  );\n}\n\nexport default ChatComponents;\n",mdxType:"Source"}),Object(esm.b)("p",null,"Similarly to how we used ",Object(esm.b)("inlineCode",{parentName:"p"},"usePropsFor")," with chat UI Components, it can be used for calling UI Components.\nFor more information on ",Object(esm.b)("a",{parentName:"p",href:"/?path=/story/statefulclient-reacthooks-usepropsfor--page"},"usePropsFor"),"."),Object(esm.b)("h2",{id:"add-components-to-app"},"Add Components to App"),Object(esm.b)("p",null,"Now that we have configured our providers and the chat components we can put them together."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.g,{code:"import { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  createStatefulChatClient,\n  FluentThemeProvider,\n  ChatClientProvider,\n  ChatThreadClientProvider\n} from '@azure/communication-react';\nimport React from 'react';\nimport ChatComponents from './ChatComponentsStateful';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userAccessToken = '<Azure Communication Services Resource Access Token>';\n  const userId = '<User Id associated to the token>';\n  const tokenCredential = new AzureCommunicationTokenCredential(userAccessToken);\n  const threadId = '<Get thread id from chat service>';\n  const displayName = '<Display Name>';\n\n  //Instantiate the statefulChatClient\n  const statefulChatClient = createStatefulChatClient({\n    userId: { kind: 'communicationUser', communicationUserId: userId },\n    displayName: displayName,\n    endpoint: endpointUrl,\n    credential: tokenCredential\n  });\n\n  const chatThreadClient = statefulChatClient.getChatThreadClient(threadId);\n\n  //Listen to notifications\n  statefulChatClient.startRealtimeNotifications();\n\n  return (\n    <FluentThemeProvider>\n      <ChatClientProvider chatClient={statefulChatClient}>\n        <ChatThreadClientProvider chatThreadClient={chatThreadClient}>\n          <ChatComponents />\n        </ChatThreadClientProvider>\n      </ChatClientProvider>\n    </FluentThemeProvider>\n  );\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.b)("p",null,"At this point your app should have two UI Components hooked up to\nTo run the code above use the command:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-console"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.b)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.b)("h2",{id:"next-steps"},"Next Steps"),Object(esm.b)("p",null,Object(esm.b)("a",{parentName:"p",href:"/?path=/docs/quickstarts-composites--page"},"Try UI Library Composite Components")),Object(esm.b)("p",null,"For more information, see the following resources:"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/styling--page"},"UI Library Styling")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/theming--page"},"UI Library Theming"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Quickstarts/Get started with Stateful Client",id:"quickstarts-statefulclient",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1488:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ParticipantList",(function(){return ParticipantList}));__webpack_require__(47),__webpack_require__(34),__webpack_require__(14),__webpack_require__(50),__webpack_require__(10),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(9),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(29),__webpack_require__(21);var src=__webpack_require__(24),Stack=__webpack_require__(99),esm=__webpack_require__(5),react=__webpack_require__(0),constants=__webpack_require__(13),controlsUtils=__webpack_require__(6),jsx_runtime=__webpack_require__(1),DefaultCall_snippet_DefaultCallParticipantListExample=function DefaultCallParticipantListExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.o,{participants:[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],myUserId:"user1"})]})})};DefaultCall_snippet_DefaultCallParticipantListExample.displayName="DefaultCallParticipantListExample",DefaultCall_snippet_DefaultCallParticipantListExample.__docgenInfo={description:"",methods:[],displayName:"DefaultCallParticipantListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/DefaultCall.snippet.tsx"]={name:"DefaultCallParticipantListExample",docgenInfo:DefaultCall_snippet_DefaultCallParticipantListExample.__docgenInfo,path:"stories/ParticipantList/snippets/DefaultCall.snippet.tsx"});var DefaultChat_snippet_DefaultChatParticipantListExample=function DefaultChatParticipantListExample(){return Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.o,{participants:[{userId:"user 1",displayName:"You"},{userId:"user 2",displayName:"Hal Jordan"},{userId:"user 3",displayName:"Barry Allen"},{userId:"user 4",displayName:"Bruce Wayne"}]})]})};DefaultChat_snippet_DefaultChatParticipantListExample.displayName="DefaultChatParticipantListExample",DefaultChat_snippet_DefaultChatParticipantListExample.__docgenInfo={description:"",methods:[],displayName:"DefaultChatParticipantListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/DefaultChat.snippet.tsx"]={name:"DefaultChatParticipantListExample",docgenInfo:DefaultChat_snippet_DefaultChatParticipantListExample.__docgenInfo,path:"stories/ParticipantList/snippets/DefaultChat.snippet.tsx"});__webpack_require__(81);var Persona_types=__webpack_require__(26),Icon=__webpack_require__(821);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var InteractiveCall_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0},{userId:"user2",displayName:"Peter Parker",state:"Connected",isMuted:!1},{userId:"user3",displayName:"Matthew Murdock",state:"Idle",isMuted:!1},{userId:"user4",displayName:"Frank Castiglione",state:"Connecting",isMuted:!1}],InteractiveCall_snippet_InteractiveCallParticipantListExample=function InteractiveCallParticipantListExample(){var _useState2=_slicedToArray(Object(react.useState)(InteractiveCall_snippet_mockParticipants),2),participants=_useState2[0],setParticpants=_useState2[1];return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.o,{participants:participants,myUserId:"user1",onRenderParticipant:function onRenderParticipant(participant){var participantIndex=participants.map((function(p){return p.userId})).indexOf(participant.userId),callingParticipant=participants[participantIndex],presence=void 0;callingParticipant&&("Connected"===callingParticipant.state?presence=Persona_types.b.online:"Idle"===callingParticipant.state?presence=Persona_types.b.away:"Connecting"===callingParticipant.state&&(presence=Persona_types.b.offline));var menuItems=[{key:"mute",text:callingParticipant.isMuted?"Unmute":"Mute",onClick:function onClick(){var newParticipants=_toConsumableArray(participants);newParticipants[participantIndex].isMuted=!participants[participantIndex].isMuted,setParticpants(newParticipants)}}],onRenderIcon=null!=callingParticipant&&callingParticipant.isMuted?function(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"MicOff2"})}:function(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})};return participant.displayName?Object(jsx_runtime.jsx)(src.n,{displayName:participant.displayName,me:"user1"===participant.userId,menuItems:menuItems,presence:presence,onRenderIcon:onRenderIcon}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}})]})})};InteractiveCall_snippet_InteractiveCallParticipantListExample.displayName="InteractiveCallParticipantListExample",InteractiveCall_snippet_InteractiveCallParticipantListExample.__docgenInfo={description:"",methods:[],displayName:"InteractiveCallParticipantListExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/InteractiveCall.snippet.tsx"]={name:"InteractiveCallParticipantListExample",docgenInfo:InteractiveCall_snippet_InteractiveCallParticipantListExample.__docgenInfo,path:"stories/ParticipantList/snippets/InteractiveCall.snippet.tsx"});var WithExcludedUser_snippet_mockParticipants=[{userId:"user1",displayName:"You",state:"Connected",isMuted:!0,isScreenSharing:!1},{userId:"user2",displayName:"Hal Jordan",state:"Connected",isMuted:!0,isScreenSharing:!0},{userId:"user3",displayName:"Barry Allen",state:"Idle",isMuted:!1,isScreenSharing:!1},{userId:"user4",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],WithExcludedUser_snippet_ParticipantListWithExcludedUserExample=function ParticipantListWithExcludedUserExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)("div",{style:{fontSize:"1.5rem",marginBottom:"1rem",fontFamily:"Segoe UI"},children:"Participants"}),Object(jsx_runtime.jsx)(src.o,{participants:WithExcludedUser_snippet_mockParticipants,myUserId:"user1",excludeMe:!0})]})})};function ParticipantList_stories_toConsumableArray(arr){return function ParticipantList_stories_arrayWithoutHoles(arr){if(Array.isArray(arr))return ParticipantList_stories_arrayLikeToArray(arr)}(arr)||function ParticipantList_stories_iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function ParticipantList_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantList_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantList_stories_arrayLikeToArray(o,minLen)}(arr)||function ParticipantList_stories_nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ParticipantList_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}WithExcludedUser_snippet_ParticipantListWithExcludedUserExample.displayName="ParticipantListWithExcludedUserExample",WithExcludedUser_snippet_ParticipantListWithExcludedUserExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantListWithExcludedUserExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantList/snippets/WithExcludedUser.snippet.tsx"]={name:"ParticipantListWithExcludedUserExample",docgenInfo:WithExcludedUser_snippet_ParticipantListWithExcludedUserExample.__docgenInfo,path:"stories/ParticipantList/snippets/WithExcludedUser.snippet.tsx"});var DefaultCallParticipantListExampleText=__webpack_require__(1461).default,DefaultChatParticipantListExampleText=__webpack_require__(1462).default,InteractiveCallParticipantListExampleText=__webpack_require__(1463).default,ParticipantListWithExcludedUserExampleText=__webpack_require__(1464).default,ParticipantList_stories_ParticipantListStory=function ParticipantListStory(args){var mockParticipants=[].concat(ParticipantList_stories_toConsumableArray(args.remoteParticipants),ParticipantList_stories_toConsumableArray(args.localParticipant)).map((function(p,i){return{userId:"userId "+i,displayName:p.name,state:p.status,isMuted:p.isMuted,isScreenSharing:p.isScreenSharing}})),myUserId=mockParticipants[mockParticipants.length-1].userId;return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(src.o,{participants:mockParticipants,myUserId:myUserId,excludeMe:args.excludeMe,onParticipantRemove:function onParticipantRemove(_userId){}})})};ParticipantList_stories_ParticipantListStory.displayName="ParticipantListStory";var ParticipantList=ParticipantList_stories_ParticipantListStory.bind({});__webpack_exports__.default={id:constants.a+"-participantlist",title:constants.a+"/Participant List",component:src.o,argTypes:{excludeMe:controlsUtils.a.excludeMeFromList,localParticipant:controlsUtils.a.localParticipant,remoteParticipants:controlsUtils.a.remoteParticipants,participants:controlsUtils.j,myUserId:controlsUtils.j,onRenderParticipant:controlsUtils.j,onRenderAvatar:controlsUtils.j,onParticipantRemove:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"Participant List"}),Object(jsx_runtime.jsx)(esm.c,{of:src.o}),Object(jsx_runtime.jsx)(esm.d,{children:"Default example for Chat"}),Object(jsx_runtime.jsx)(esm.c,{children:"The ParticipantList for chat is by default a list of [PartipantItem](./?path=/docs/ui-components-participantitem--participant-item) components linked with state around each chat participant."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:DefaultChatParticipantListExampleText,children:Object(jsx_runtime.jsx)(DefaultChat_snippet_DefaultChatParticipantListExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Default example for Calling"}),Object(jsx_runtime.jsx)(esm.c,{children:"ParticipantList for calling is by default a list of [PartipantItem](./?path=/docs/ui-components-participantitem--participant-item) components with presence linked to the participant call state, as well as icons for microphone and screen sharing states"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:DefaultCallParticipantListExampleText,children:Object(jsx_runtime.jsx)(DefaultCall_snippet_DefaultCallParticipantListExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ParticipantList with local user excluded from the list"}),Object(jsx_runtime.jsx)(esm.c,{children:"Local user can be excluded from the participant list like shown in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ParticipantListWithExcludedUserExampleText,children:Object(jsx_runtime.jsx)(WithExcludedUser_snippet_ParticipantListWithExcludedUserExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Interactive Call example"}),Object(jsx_runtime.jsx)(esm.c,{children:"ParticpantList is designed with a rendering override, `onRenderParticipant`, which allows you to have your own design or use the your own [PartipantItem](./?path=/docs/ui-components-participantitem--participant-item) components with their context menu style enabling interaction with this participant. For example, let us add menu items and icons to the participants using `menuItems` and `onRenderIcon` properties of [ParticipantItem](./?path=/docs/ui-components-participantitem--participant-item#props) like in the code below."}),Object(jsx_runtime.jsx)(esm.c,{children:"For simplicity, we are using React `useState` to keep the state of every participant to decide which menu items and icons to show. You can now mute and unmute by clicking a participant in the rendered example below."}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: Each `ParticipantItem` needs a unique key to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:InteractiveCallParticipantListExampleText,children:Object(jsx_runtime.jsx)(InteractiveCall_snippet_InteractiveCallParticipantListExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.o})]})}()}}}};ParticipantList.parameters=Object.assign({storySource:{source:"(args) => {\n  const participantsControls = [...args.remoteParticipants, ...args.localParticipant];\n\n  const mockParticipants = participantsControls.map((p, i) => {\n    return {\n      userId: `userId ${i}`,\n      displayName: p.name,\n      state: p.status,\n      isMuted: p.isMuted,\n      isScreenSharing: p.isScreenSharing\n    };\n  });\n\n  const myUserId = mockParticipants[mockParticipants.length - 1].userId;\n\n  \n  const onParticipantRemove = (_userId: string): void => {\n    // Do something when remove a participant from list\n  };\n\n  return (\n    <Stack>\n      <ParticipantListComponent\n        participants={mockParticipants}\n        myUserId={myUserId}\n        excludeMe={args.excludeMe}\n        onParticipantRemove={onParticipantRemove}\n      />\n    </Stack>\n  );\n}"}},ParticipantList.parameters)},1489:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SendBox",(function(){return SendBox}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(50),__webpack_require__(10);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(821),jsx_runtime=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var CustomIcon_snippet_CustomIconExample=function CustomIconExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.r,{onSendMessage:_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)}))),onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"AirplaneSolid"})}})})})};function CustomStyling_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomStyling_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomStyling_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomStyling_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}CustomIcon_snippet_CustomIconExample.displayName="CustomIconExample",CustomIcon_snippet_CustomIconExample.__docgenInfo={description:"",methods:[],displayName:"CustomIconExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/CustomIcon.snippet.tsx"]={name:"CustomIconExample",docgenInfo:CustomIcon_snippet_CustomIconExample.__docgenInfo,path:"stories/SendBox/snippets/CustomIcon.snippet.tsx"});var CustomStyling_snippet_CustomStylingExample=function CustomStylingExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.r,{onSendMessage:CustomStyling_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:CustomStyling_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)}))),styles:{root:{border:"2px solid gray",borderRadius:"10px",padding:"10px"},systemMessage:{border:"1px solid darkred",background:"lightpink"},textField:{background:"ghostwhite"}},systemMessage:"This is a system message"})})})};function SendBox_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SendBox_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SendBox_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SendBox_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}CustomStyling_snippet_CustomStylingExample.displayName="CustomStylingExample",CustomStyling_snippet_CustomStylingExample.__docgenInfo={description:"",methods:[],displayName:"CustomStylingExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/CustomStyling.snippet.tsx"]={name:"CustomStylingExample",docgenInfo:CustomStyling_snippet_CustomStylingExample.__docgenInfo,path:"stories/SendBox/snippets/CustomStyling.snippet.tsx"});var SendBox_snippet_SendBoxExample=function SendBoxExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.r,{onSendMessage:SendBox_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:SendBox_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)})))})})})};function SendBoxWithSystemMessage_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SendBoxWithSystemMessage_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SendBoxWithSystemMessage_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SendBoxWithSystemMessage_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}SendBox_snippet_SendBoxExample.displayName="SendBoxExample",SendBox_snippet_SendBoxExample.__docgenInfo={description:"",methods:[],displayName:"SendBoxExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/SendBox.snippet.tsx"]={name:"SendBoxExample",docgenInfo:SendBox_snippet_SendBoxExample.__docgenInfo,path:"stories/SendBox/snippets/SendBox.snippet.tsx"});var SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample=function SendBoxWithSystemMessageExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.r,{onSendMessage:SendBoxWithSystemMessage_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return");case 1:case"end":return _context.stop()}}),_callee)}))),onTyping:SendBoxWithSystemMessage_snippet_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return");case 1:case"end":return _context2.stop()}}),_callee2)}))),systemMessage:"Please wait 30 seconds to send new messages"})})})};function SendBox_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample.displayName="SendBoxWithSystemMessageExample",SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample.__docgenInfo={description:"",methods:[],displayName:"SendBoxWithSystemMessageExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/SendBox/snippets/SendBoxWithSystemMessage.snippet.tsx"]={name:"SendBoxWithSystemMessageExample",docgenInfo:SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample.__docgenInfo,path:"stories/SendBox/snippets/SendBoxWithSystemMessage.snippet.tsx"});var CustomIconExampleText=__webpack_require__(1465).default,CustomStylingExampleText=__webpack_require__(1466).default,SendBoxExampleText=__webpack_require__(1467).default,SendBoxWithSystemMessageExampleText=__webpack_require__(1468).default,SendBox_stories_SendBoxStory=function SendBoxStory(args){return Object(jsx_runtime.jsx)("div",{style:{width:"31.25rem"},children:Object(jsx_runtime.jsx)(src.r,{disabled:args.disabled,onSendMessage:function(){var _ref=function SendBox_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SendBox_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SendBox_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(message){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",alert("sent message: "+message+" "));case 1:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref.apply(this,arguments)}}(),onTyping:function onTyping(){return console.log("sending typing notifications"),Promise.resolve()},systemMessage:args.hasWarning?args.warningMessage:void 0})})};SendBox_stories_SendBoxStory.displayName="SendBoxStory";var SendBox=SendBox_stories_SendBoxStory.bind({});__webpack_exports__.default={id:constants.a+"-sendbox",title:constants.a+"/Send Box",component:src.r,argTypes:{disabled:controlsUtils.a.disabled,hasWarning:controlsUtils.a.isSendBoxWithWarning,warningMessage:controlsUtils.a.sendBoxWarningMessage,systemMessage:controlsUtils.j,onSendMessage:controlsUtils.j,onTyping:controlsUtils.j,onRenderSystemMessage:controlsUtils.j,supportNewline:controlsUtils.j,onRenderIcon:controlsUtils.j,styles:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"SendBox"}),Object(jsx_runtime.jsx)(esm.c,{of:src.r}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"import { SendBox } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:SendBoxExampleText,children:Object(jsx_runtime.jsx)(SendBox_snippet_SendBoxExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Add a system message"}),Object(jsx_runtime.jsx)(esm.c,{children:"To add a system message, use the systemMessage property like in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:SendBoxWithSystemMessageExampleText,children:Object(jsx_runtime.jsx)(SendBoxWithSystemMessage_snippet_SendBoxWithSystemMessageExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Customize send icon"}),Object(jsx_runtime.jsx)(esm.c,{children:"To customize the send icon, use the `onRenderIcon` property like in the example below. A Fluent UI [Icon](https://developer.microsoft.com/en-us/fluentui#/controls/web/icon) is used in this example but you can use any `JSX.Element`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomIconExampleText,children:Object(jsx_runtime.jsx)(CustomIcon_snippet_CustomIconExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Customize styling"}),Object(jsx_runtime.jsx)(esm.c,{children:"To customize the style of SendBox, use the `styles` property like in the example below. Notice that the keys of `styles` property are the root and sub-components of `SendBox`, each of which can be styled independently."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomStylingExampleText,children:Object(jsx_runtime.jsx)(CustomStyling_snippet_CustomStylingExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.r})]})}()}}}};SendBox.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return (\n    <div style={{ width: '31.25rem' }}>\n      <SendBoxComponent\n        disabled={args.disabled}\n        onSendMessage={async (message) => alert(`sent message: ${message} `)}\n        onTyping={(): Promise<void> => {\n          console.log(`sending typing notifications`);\n          return Promise.resolve();\n        }}\n        systemMessage={args.hasWarning ? args.warningMessage : undefined}\n      />\n    </div>\n  );\n}"}},SendBox.parameters)},1491:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var preview_namespaceObject={};__webpack_require__.r(preview_namespaceObject),__webpack_require__.d(preview_namespaceObject,"parameters",(function(){return parameters})),__webpack_require__.d(preview_namespaceObject,"decorators",(function(){return decorators})),__webpack_require__.d(preview_namespaceObject,"globalTypes",(function(){return globalTypes}));__webpack_require__(38),__webpack_require__(8),__webpack_require__(73),__webpack_require__(711),__webpack_require__(166),__webpack_require__(77),__webpack_require__(1191),__webpack_require__(1192),__webpack_require__(115);var client_api=__webpack_require__(1715),esm=__webpack_require__(32),react=(__webpack_require__(10),__webpack_require__(14),__webpack_require__(34),__webpack_require__(0)),react_default=__webpack_require__.n(react),src=__webpack_require__(24),lib=__webpack_require__(20),font_icons_mdl2_lib=__webpack_require__(1694),blocks=__webpack_require__(401),dist=(__webpack_require__(40),__webpack_require__(18),__webpack_require__(9),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(29),__webpack_require__(542)),jsx_runtime=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var TOC_TOC=function TOC(props){var _useState2=_slicedToArray(Object(react.useState)(window.matchMedia("(max-width: 1200px)").matches),2),narrowDocs=_useState2[0],setNarrowDocs=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(window.matchMedia("(max-width: 900px)").matches),2),hideToc=_useState4[0],setHideToc=_useState4[1];Object(react.useEffect)((function(){var setNarrowDocsHandler=function setNarrowDocsHandler(e){return setNarrowDocs(e.matches)},setHideTocHandler=function setHideTocHandler(e){return setHideToc(e.matches)};return window.matchMedia("(max-width: 1200px)").addEventListener("change",setNarrowDocsHandler),window.matchMedia("(max-width: 900px)").addEventListener("change",setHideTocHandler),function(){window.matchMedia("(max-width: 1200px)").removeEventListener("change",setNarrowDocsHandler),window.matchMedia("(max-width: 900px)").removeEventListener("change",setHideTocHandler)}}));var tocStyles=Object(lib.G)({display:hideToc?"none":"block",fontFamily:"Segoe UI Regular",fontSize:"12px","& nav":{top:0,maxWidth:"10rem",right:0,"div > ol > li.toc-list-item":{padding:"0 0.5rem"},"div > ol > li > a.toc-link":{whiteSpace:"break-spaces !important",marginBottom:"4px",marginTop:"4px"},"a.toc-link":{whiteSpace:"break-spaces !important",marginBottom:"2px",marginTop:"2px"}}});return Object(jsx_runtime.jsxs)(react_default.a.Fragment,{children:[Object(jsx_runtime.jsx)("div",{className:tocStyles,children:Object(jsx_runtime.jsx)(dist.TableOfContents,{})}),Object(jsx_runtime.jsx)("div",{style:narrowDocs?{maxWidth:"768px"}:{},children:props.children}),Object(jsx_runtime.jsx)("div",{className:Object(lib.G)({"> button":{right:16}}),children:Object(jsx_runtime.jsx)(dist.BackToTop,{})})]})};TOC_TOC.displayName="TOC",TOC_TOC.__docgenInfo={description:"Table Of Contents component used for displaying a floating table of content\ninside Storybook Docs.\n@param props \n@returns",methods:[],displayName:"TOC",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES[".storybook/TOC.tsx"]={name:"TOC",docgenInfo:TOC_TOC.__docgenInfo,path:".storybook/TOC.tsx"});var constants=__webpack_require__(13),THEMES={Light:{name:"Light",theme:src.B},Dark:{name:"Dark",theme:src.x}};Object(lib.E)({}),Object(font_icons_mdl2_lib.a)();var parameters={layout:"fullscreen",docs:{container:function container(props){return Object(jsx_runtime.jsx)(TOC_TOC,{children:Object(jsx_runtime.jsxs)(blocks.DocsContainer,{context:props.context,children:[Object(jsx_runtime.jsx)(blocks.Anchor,{storyId:props.context.id}),props.children]})})}},options:{storySort:{order:["Overview","Use Cases","Styling","Theming","Localization","Accessibility","Custom User Data Model","Feedback",constants.e,["Overview","Best Practices","React Hooks",["Setting up","UsePropsFor","UseSelector"],"Adapters"],constants.d,constants.b,constants.a,constants.c]}}},preview_withThemeProvider=function withThemeProvider(Story,context){var _THEMES$themeName,themeName=context.globals.theme,theme=null===(_THEMES$themeName=THEMES[themeName])||void 0===_THEMES$themeName?void 0:_THEMES$themeName.theme;if(context.globals.customTheme)try{theme=JSON.parse(context.globals.customTheme)}catch(e){console.log("Could not parse the following theme JSON: "+context.globals.customTheme)}var rtl="rtl"===context.globals.rtl;return Object(jsx_runtime.jsx)(src.f,{fluentTheme:theme,rtl:rtl,children:Object(jsx_runtime.jsx)(Story,Object.assign({},context,{theme:theme}))})};preview_withThemeProvider.displayName="withThemeProvider";var preview_withLocalization=function withLocalization(Story,context){var localeKey=context.globals.locale;return Object(jsx_runtime.jsx)(src.i,{locale:src.C[localeKey].locale,children:Object(jsx_runtime.jsx)(Story,Object.assign({},context))})};preview_withLocalization.displayName="withLocalization";var preview_withCenterStory=function withCenterStory(Story){return Object(jsx_runtime.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",height:"100vh"},children:Object(jsx_runtime.jsx)(Story,{})})};preview_withCenterStory.displayName="withCenterStory";var decorators=[preview_withCenterStory,preview_withThemeProvider,preview_withLocalization],globalTypes={theme:{name:"Theme",description:"Global theme for components",defaultValue:THEMES.Light.name},customTheme:{name:"Custom theme",description:"Custom global theme for components",defaultValue:""},locale:{name:"Locale",description:"Locale for components",defaultValue:"en-US",toolbar:{icon:"globe",items:Object.keys(src.C).map((function(key){return{title:src.C[key].englishName,value:key}}))}},rtl:{name:"RTL",description:"Whether the direction of components is right-to-left or left-to-right",defaultValue:"ltr",toolbar:{icon:"transfer",items:[{value:"ltr",title:"Left-to-right"},{value:"rtl",title:"Right-to-left"}]}}};function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}Object.keys(preview_namespaceObject).forEach((function(key){var value=preview_namespaceObject[key];switch(key){case"args":case"argTypes":return esm.a.warn("Invalid args/argTypes in config, ignoring.",JSON.stringify(value));case"decorators":return value.forEach((function(decorator){return Object(client_api.c)(decorator,!1)}));case"loaders":return value.forEach((function(loader){return Object(client_api.d)(loader,!1)}));case"parameters":return Object(client_api.e)(function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){_defineProperty(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({},value),!1);case"argTypesEnhancers":return value.forEach((function(enhancer){return Object(client_api.a)(enhancer)}));case"argsEnhancers":return value.forEach((function(enhancer){return Object(client_api.b)(enhancer)}));case"render":return Object(client_api.g)(value);case"globals":case"globalTypes":var v={};return v[key]=value,Object(client_api.e)(v,!1);default:return console.log(key+" was not supported :( !")}}))},1492:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Camera",(function(){return Camera}));__webpack_require__(10),__webpack_require__(50);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(821),Label=__webpack_require__(1710),jsx_runtime=__webpack_require__(1),Custom_snippet_CustomCameraButtonExample=function CustomCameraButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Camera",style:{color:"green",fontSize:"25px"}},"CameraIconKey"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Camera",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"CameraIconKey")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Label.a,{style:{fontStyle:"italic"},children:"Turn off"},"CameraLabelKey"):Object(jsx_runtime.jsx)(Label.a,{children:"Turn on"},"CameraLabelKey")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.a,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"camera 1"),Object(jsx_runtime.jsx)(src.a,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"camera 2")]})};Custom_snippet_CustomCameraButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomCameraButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/Custom.snippet.tsx"]={name:"CustomCameraButtonExample",docgenInfo:Custom_snippet_CustomCameraButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/Custom.snippet.tsx"});var Default_snippet_CameraButtonExample=function CameraButtonExample(){return Object(jsx_runtime.jsxs)(src.f,{children:[Object(jsx_runtime.jsx)(src.a,{checked:!0},"camBtn1"),Object(jsx_runtime.jsx)(src.a,{},"camBtn2")]})};Default_snippet_CameraButtonExample.displayName="CameraButtonExample",Default_snippet_CameraButtonExample.__docgenInfo={description:"",methods:[],displayName:"CameraButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/Default.snippet.tsx"]={name:"CameraButtonExample",docgenInfo:Default_snippet_CameraButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/Default.snippet.tsx"});var WithLabel_snippet_CameraButtonWithLabelExample=function CameraButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.a,{showLabel:!0,checked:!0})})};WithLabel_snippet_CameraButtonWithLabelExample.displayName="CameraButtonWithLabelExample",WithLabel_snippet_CameraButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"CameraButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Camera/snippets/WithLabel.snippet.tsx"]={name:"CameraButtonWithLabelExample",docgenInfo:WithLabel_snippet_CameraButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Camera/snippets/WithLabel.snippet.tsx"});var CustomButtonExampleText=__webpack_require__(1399).default,DefaultButtonExampleText=__webpack_require__(1400).default,ButtonWithLabelExampleText=__webpack_require__(1401).default,Camera_stories_CameraStory=function CameraStory(args){return Object(jsx_runtime.jsx)(src.a,Object.assign({},args))};Camera_stories_CameraStory.displayName="CameraStory";var Camera=Camera_stories_CameraStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-camera",title:constants.a+"/ControlBar/Buttons/Camera",component:src.a,argTypes:{checked:controlsUtils.a.checked,showLabel:controlsUtils.a.showLabel,onToggleCamera:controlsUtils.j,localVideoViewOption:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"CameraButton"}),Object(jsx_runtime.jsx)(esm.c,{of:src.a}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { CameraButton } from '@azure/communication-ui';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"The default `CameraButton` component shows a Camera icon with no label. The following example displays the `CameraButton` with camera turned on and off."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:DefaultButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_CameraButtonExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Camera with default label"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can display the button label which, by default, will show below the icon as `Turn on` or `Turn off`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_CameraButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom CameraButton Styles"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can change the styles of the `CameraButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomCameraButtonExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"CameraButton Props"}),Object(jsx_runtime.jsx)(esm.c,{children:"`CameraButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the following additional properties:"}),Object(jsx_runtime.jsx)(esm.f,{of:src.a})]})}()}},storyshots:{disable:!0}}};Camera.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <CameraButton {...args} />;\n}"}},Camera.parameters)},1493:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Default",(function(){return Default}));__webpack_require__(10),__webpack_require__(50);var src=__webpack_require__(24),Airplane20Filled=__webpack_require__(1686),VehicleBus20Filled=__webpack_require__(1688),VehicleShip20Filled=__webpack_require__(1687),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(821),Text=__webpack_require__(1711),Label=__webpack_require__(1710),jsx_runtime=__webpack_require__(1),Custom_snippet_CustomControlBarButtonExample=function CustomControlBarButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Airplane",style:{color:"green",fontSize:"25px"}},"customIcon1"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Bus",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"customIcon2")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Text.a,{style:{fontStyle:"italic"},children:"unmuted"},"customText"):Object(jsx_runtime.jsx)(Label.a,{children:"muted"},"customLabel")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.c,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"customBtn1"),Object(jsx_runtime.jsx)(src.c,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"customBtn2")]})};Custom_snippet_CustomControlBarButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomControlBarButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ControlBarButton/snippets/Custom.snippet.tsx"]={name:"CustomControlBarButtonExample",docgenInfo:Custom_snippet_CustomControlBarButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ControlBarButton/snippets/Custom.snippet.tsx"});var Default_snippet_ControlBarButtonExample=function ControlBarButtonExample(){return Object(jsx_runtime.jsxs)(src.f,{children:[Object(jsx_runtime.jsx)(src.c,{onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Airplane20Filled.a,{primaryFill:"currentColor"},"airplaneIconKey")}},"btn1"),Object(jsx_runtime.jsx)(src.c,{onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(VehicleShip20Filled.a,{primaryFill:"currentColor"},"shipIconKey")}},"btn1")]})};Default_snippet_ControlBarButtonExample.displayName="ControlBarButtonExample",Default_snippet_ControlBarButtonExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ControlBarButton/snippets/Default.snippet.tsx"]={name:"ControlBarButtonExample",docgenInfo:Default_snippet_ControlBarButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ControlBarButton/snippets/Default.snippet.tsx"});var WithLabel_snippet_ControlBarButtonWithLabelExample=function ControlBarButtonWithLabelExample(){return Object(jsx_runtime.jsxs)(src.f,{children:[Object(jsx_runtime.jsx)(src.c,{onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Airplane20Filled.a,{primaryFill:"currentColor"},"airplaneIconKey")},strings:{label:"airplane"},labelKey:"airplaneButtonLabel",showLabel:!0},"btn1"),Object(jsx_runtime.jsx)(src.c,{onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(VehicleShip20Filled.a,{primaryFill:"currentColor"},"shipIconKey")},strings:{label:"ship"},labelKey:"shipButtonLabel",showLabel:!0},"btn1")]})};WithLabel_snippet_ControlBarButtonWithLabelExample.displayName="ControlBarButtonWithLabelExample",WithLabel_snippet_ControlBarButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ControlBarButton/snippets/WithLabel.snippet.tsx"]={name:"ControlBarButtonWithLabelExample",docgenInfo:WithLabel_snippet_ControlBarButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/ControlBarButton/snippets/WithLabel.snippet.tsx"});var CustomControlBarButtonExampleText=__webpack_require__(1402).default,ControlBarButtonExampleText=__webpack_require__(1403).default,ControlBarButtonWithLabelExampleText=__webpack_require__(1404).default,iconDict={airplane:Object(jsx_runtime.jsx)(Airplane20Filled.a,{primaryFill:"currentColor"},"airplaneIconKey"),bus:Object(jsx_runtime.jsx)(VehicleBus20Filled.a,{primaryFill:"currentColor"},"busIconKey"),ship:Object(jsx_runtime.jsx)(VehicleShip20Filled.a,{primaryFill:"currentColor"},"shipIconKey")},ControlBarButton_stories_ControlBarButtonStory=function ControlBarButtonStory(args){var icon=iconDict[args.icons];return Object(jsx_runtime.jsx)(src.c,Object.assign({},args,{onRenderIcon:function onRenderIcon(){return icon},strings:{label:args.icons},labelKey:args.icons}))};ControlBarButton_stories_ControlBarButtonStory.displayName="ControlBarButtonStory";var Default=ControlBarButton_stories_ControlBarButtonStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-base",title:constants.a+"/ControlBar/Buttons/Default",component:src.c,argTypes:{showLabel:controlsUtils.a.showLabel,icons:controlsUtils.a.controlBarDefaultIcons,labelKey:controlsUtils.j,strings:controlsUtils.j,onRenderOnIcon:controlsUtils.j,onRenderOffIcon:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ControlBarButton"}),Object(jsx_runtime.jsx)(esm.c,{of:src.c}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, do not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { ControlBarButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"Here we see a `ControlBarButton` with some custom icons set:"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ControlBarButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_ControlBarButtonExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ControlBar with default label"}),Object(jsx_runtime.jsx)(esm.c,{children:"Here we see the same icons but with labels set to show:"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ControlBarButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_ControlBarButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom ControlBarButton Styles"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can override the styles of the `ControlBarButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomControlBarButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomControlBarButtonExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ControlBarButton Props"}),Object(jsx_runtime.jsx)(esm.c,{children:"`ControlBarButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the additional following properties."}),Object(jsx_runtime.jsx)(esm.f,{of:src.c})]})}()}}}};Default.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const icon = iconDict[args.icons];\n\n  return <ControlBarButton {...args} onRenderIcon={() => icon} strings={{ label: args.icons }} labelKey={args.icons} />;\n}"}},Default.parameters)},1494:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"EndCall",(function(){return EndCall}));__webpack_require__(10),__webpack_require__(50);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(821),Label=__webpack_require__(1710),jsx_runtime=__webpack_require__(1),Custom_snippet_EndCallButtonCustomExample=function EndCallButtonCustomExample(){return Object(jsx_runtime.jsx)(src.d,{style:{background:"cyan"},showLabel:!0,onRenderIcon:function customOnRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"DeclineCall",style:{color:"black",fontSize:"25px"}},"endCallCustomIconKey")},onRenderText:function customOnRenderText(){return Object(jsx_runtime.jsx)(Label.a,{style:{color:"blue",fontStyle:"italic"},children:"end call"},"endCallCustomLabelKey")}},"endCallCustomBtnKey")};Custom_snippet_EndCallButtonCustomExample.displayName="EndCallButtonCustomExample",Custom_snippet_EndCallButtonCustomExample.__docgenInfo={description:"",methods:[],displayName:"EndCallButtonCustomExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/EndCall/snippets/Custom.snippet.tsx"]={name:"EndCallButtonCustomExample",docgenInfo:Custom_snippet_EndCallButtonCustomExample.__docgenInfo,path:"stories/ControlBar/Buttons/EndCall/snippets/Custom.snippet.tsx"});var Default_snippet_EndCallButtonDefaultExample=function EndCallButtonDefaultExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.d,{})})};Default_snippet_EndCallButtonDefaultExample.displayName="EndCallButtonDefaultExample",Default_snippet_EndCallButtonDefaultExample.__docgenInfo={description:"",methods:[],displayName:"EndCallButtonDefaultExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/EndCall/snippets/Default.snippet.tsx"]={name:"EndCallButtonDefaultExample",docgenInfo:Default_snippet_EndCallButtonDefaultExample.__docgenInfo,path:"stories/ControlBar/Buttons/EndCall/snippets/Default.snippet.tsx"});var WithLabel_snippet_EndCallButtonWithLabelExample=function EndCallButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.d,{showLabel:!0})})};WithLabel_snippet_EndCallButtonWithLabelExample.displayName="EndCallButtonWithLabelExample",WithLabel_snippet_EndCallButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"EndCallButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/EndCall/snippets/WithLabel.snippet.tsx"]={name:"EndCallButtonWithLabelExample",docgenInfo:WithLabel_snippet_EndCallButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/EndCall/snippets/WithLabel.snippet.tsx"});var EndCallButtonCustomExampleText=__webpack_require__(1405).default,EndCallButtonDefaultExampleText=__webpack_require__(1406).default,EndCallButtonWithLabelExampleText=__webpack_require__(1407).default,EndCall_stories_EndCallStory=function EndCallStory(args){return Object(jsx_runtime.jsx)(src.d,Object.assign({},args))};EndCall_stories_EndCallStory.displayName="EndCallStory";var EndCall=EndCall_stories_EndCallStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-endcall",title:constants.a+"/ControlBar/Buttons/End Call",component:src.d,argTypes:{showLabel:controlsUtils.a.showLabel,onHangUp:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"EndCallButton"}),Object(jsx_runtime.jsx)(esm.c,{of:src.d}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { EndCallButton, FluentThemeProvider } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"The default `EndCallButton` component shows a hangup icon with no label as in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:EndCallButtonDefaultExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_EndCallButtonDefaultExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"EndCallButton with default label"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can display the button label which, by default, will show below the icon as `Hangup`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:EndCallButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_EndCallButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom EndCallButton Styles"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can change the styles of the `EndCallButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:EndCallButtonCustomExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_EndCallButtonCustomExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"EndCallButton Props"}),Object(jsx_runtime.jsx)(esm.c,{children:"`EndCallButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the following additional properties."}),Object(jsx_runtime.jsx)(esm.f,{of:src.d})]})}()}}}};EndCall.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <EndCallButton {...args} />;\n}"}},EndCall.parameters)},1495:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Microphone",(function(){return Microphone}));__webpack_require__(10),__webpack_require__(50);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(821),Text=__webpack_require__(1711),Label=__webpack_require__(1710),jsx_runtime=__webpack_require__(1),Custom_snippet_CustomMicrophoneButtonExample=function CustomMicrophoneButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Microphone",style:{color:"green",fontSize:"25px"}},"micCustomIcon1"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Microphone",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"micCustomIcon2")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Text.a,{style:{fontStyle:"italic"},children:"unmuted"},"micCustomText"):Object(jsx_runtime.jsx)(Label.a,{children:"muted"},"micCustomLabel")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.l,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"micCustomBtn1"),Object(jsx_runtime.jsx)(src.l,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText},"micCustomBtn2")]})};Custom_snippet_CustomMicrophoneButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomMicrophoneButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/Custom.snippet.tsx"]={name:"CustomMicrophoneButtonExample",docgenInfo:Custom_snippet_CustomMicrophoneButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/Custom.snippet.tsx"});var Default_snippet_MicrophoneButtonExample=function MicrophoneButtonExample(){return Object(jsx_runtime.jsxs)(src.f,{children:[Object(jsx_runtime.jsx)(src.l,{checked:!0},"micBtn1"),Object(jsx_runtime.jsx)(src.l,{},"micBtn2")]})};Default_snippet_MicrophoneButtonExample.displayName="MicrophoneButtonExample",Default_snippet_MicrophoneButtonExample.__docgenInfo={description:"",methods:[],displayName:"MicrophoneButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/Default.snippet.tsx"]={name:"MicrophoneButtonExample",docgenInfo:Default_snippet_MicrophoneButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/Default.snippet.tsx"});var WithLabel_snippet_MicrophoneButtonWithLabelExample=function MicrophoneButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.l,{showLabel:!0,checked:!0})})};WithLabel_snippet_MicrophoneButtonWithLabelExample.displayName="MicrophoneButtonWithLabelExample",WithLabel_snippet_MicrophoneButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"MicrophoneButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Microphone/snippets/WithLabel.snippet.tsx"]={name:"MicrophoneButtonWithLabelExample",docgenInfo:WithLabel_snippet_MicrophoneButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Microphone/snippets/WithLabel.snippet.tsx"});var CustomMicrophoneButtonExampleText=__webpack_require__(1408).default,MicrophoneButtonExampleText=__webpack_require__(1409).default,MicrophoneButtonWithLabelExampleText=__webpack_require__(1410).default,Microphone_stories_MicrophoneStory=function MicrophoneStory(args){return Object(jsx_runtime.jsx)(src.l,Object.assign({},args))};Microphone_stories_MicrophoneStory.displayName="MicrophoneStory";var Microphone=Microphone_stories_MicrophoneStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-microphone",title:constants.a+"/ControlBar/Buttons/Microphone",component:src.l,argTypes:{checked:controlsUtils.a.checked,showLabel:controlsUtils.a.showLabel,onToggleMicrophone:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"MicrophoneButton"}),Object(jsx_runtime.jsx)(esm.c,{of:src.l}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { MicrophoneButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"The default `MicrophoneButton` component shows a microphone icon with no label. The following example displays an unmuted `MicrophoneButton` and a muted `MicrophoneButton`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MicrophoneButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_MicrophoneButtonExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Microphone with default label"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can display the button label which, by default, will show below the icon as `Mute` or `Unmute`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:MicrophoneButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_MicrophoneButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom MicrophoneButton Styles"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can change the styles of the `MicrophoneButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomMicrophoneButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomMicrophoneButtonExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"MicrophoneButton Props"}),Object(jsx_runtime.jsx)(esm.c,{children:"`MicrophoneButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the additional following properties."}),Object(jsx_runtime.jsx)(esm.f,{of:src.l})]})}()}}}};Microphone.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <MicrophoneButton {...args} />;\n}"}},Microphone.parameters)},1496:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Options",(function(){return Options}));__webpack_require__(10),__webpack_require__(50);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(821),Label=__webpack_require__(1710),jsx_runtime=__webpack_require__(1),exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"Camera"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},Custom_snippet_OptionsButtonCustomExample=function OptionsButtonCustomExample(){return Object(jsx_runtime.jsx)(src.m,{showLabel:!0,menuProps:exampleOptionsMenuProps,onRenderIcon:function customOnRenderIcon(){return Object(jsx_runtime.jsx)(Icon.a,{iconName:"CircleAddition",style:{color:"orange",fontSize:"20px"}},"optionsCustomIconKey")},onRenderText:function customOnRenderText(){return Object(jsx_runtime.jsx)(Label.a,{style:{color:"darkviolet",fontStyle:"italic"},children:"More"},"optionsCustomLabelKey")}},"optionsCustomBtnKey")};Custom_snippet_OptionsButtonCustomExample.displayName="OptionsButtonCustomExample",Custom_snippet_OptionsButtonCustomExample.__docgenInfo={description:"",methods:[],displayName:"OptionsButtonCustomExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Options/snippets/Custom.snippet.tsx"]={name:"OptionsButtonCustomExample",docgenInfo:Custom_snippet_OptionsButtonCustomExample.__docgenInfo,path:"stories/ControlBar/Buttons/Options/snippets/Custom.snippet.tsx"});var Default_snippet_exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},Default_snippet_OptionsButtonDefaultExample=function OptionsButtonDefaultExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.m,{menuProps:Default_snippet_exampleOptionsMenuProps})})};Default_snippet_OptionsButtonDefaultExample.displayName="OptionsButtonDefaultExample",Default_snippet_OptionsButtonDefaultExample.__docgenInfo={description:"",methods:[],displayName:"OptionsButtonDefaultExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Options/snippets/Default.snippet.tsx"]={name:"OptionsButtonDefaultExample",docgenInfo:Default_snippet_OptionsButtonDefaultExample.__docgenInfo,path:"stories/ControlBar/Buttons/Options/snippets/Default.snippet.tsx"});var OptionsButtonWithKnobs_snippet=__webpack_require__(419),WithLabel_snippet_exampleOptionsMenuProps={items:[{key:"1",name:"Choose Camera",iconProps:{iconName:"LocationCircle"},onClick:function onClick(){return alert("Choose Camera Menu Item Clicked!")}}]},WithLabel_snippet_OptionsButtonWithLabelExample=function OptionsButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.m,{showLabel:!0,menuProps:WithLabel_snippet_exampleOptionsMenuProps})})};WithLabel_snippet_OptionsButtonWithLabelExample.displayName="OptionsButtonWithLabelExample",WithLabel_snippet_OptionsButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"OptionsButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Options/snippets/WithLabel.snippet.tsx"]={name:"OptionsButtonWithLabelExample",docgenInfo:WithLabel_snippet_OptionsButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/Options/snippets/WithLabel.snippet.tsx"});var OptionsButtonCustomExampleText=__webpack_require__(1411).default,OptionsButtonDefaultExampleText=__webpack_require__(1412).default,OptionsButtonWithLabelExampleText=__webpack_require__(1413).default,Options_stories_OptionsStory=function OptionsStory(args){return Object(jsx_runtime.jsx)(OptionsButtonWithKnobs_snippet.a,Object.assign({},args))};Options_stories_OptionsStory.displayName="OptionsStory";var Options=Options_stories_OptionsStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-options",title:constants.a+"/ControlBar/Buttons/Options",component:src.m,argTypes:{showLabel:controlsUtils.a.showLabel,cameras:controlsUtils.a.cameras,microphones:controlsUtils.a.microphones,speakers:controlsUtils.a.speakers,selectedMicrophone:controlsUtils.j,selectedSpeaker:controlsUtils.j,selectedCamera:controlsUtils.j,onSelectCamera:controlsUtils.j,onSelectMicrophone:controlsUtils.j,onSelectSpeaker:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"OptionsButton"}),Object(jsx_runtime.jsx)(esm.c,{of:src.m}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { OptionsButton } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"The default `OptionsButton` component shows an horizontal `More` icon with no label as in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:OptionsButtonDefaultExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_OptionsButtonDefaultExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"OptionsButton with default label"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can display the button label which, by default, will show below the icon as `Options`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:OptionsButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_OptionsButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom OptionsButton Styles"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can change the styles of the `OptionsButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:OptionsButtonCustomExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_OptionsButtonCustomExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"OptionsButton Props"}),Object(jsx_runtime.jsx)(esm.c,{children:"`OptionsButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the following additional properties."}),Object(jsx_runtime.jsx)(esm.f,{of:src.m})]})}()}}}};Options.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <OptionsButtonWithKnobs {...args} />;\n}"}},Options.parameters)},1497:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ScreenShare",(function(){return ScreenShare}));__webpack_require__(10),__webpack_require__(50);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Icon=__webpack_require__(821),Label=__webpack_require__(1710),jsx_runtime=__webpack_require__(1),Custom_snippet_CustomScreenShareButtonExample=function CustomScreenShareButtonExample(){var customOnRenderIcon=function customOnRenderIcon(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Icon.a,{iconName:"Presentation",style:{color:"green",fontSize:"25px"}},"screenShareIconKey"):Object(jsx_runtime.jsx)(Icon.a,{iconName:"Presentation",style:{color:"red",fontSize:"25px",fontWeight:"bolder"}},"screenShareIconKey")},customOnRenderText=function customOnRenderText(props){return null!=props&&props.checked?Object(jsx_runtime.jsx)(Label.a,{style:{fontStyle:"italic"},children:"sharing screen"},"screenShareLabelKey"):Object(jsx_runtime.jsx)(Label.a,{children:"not sharing screen"},"screenShareLabelKey")};return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.q,{checked:!0,showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText}),Object(jsx_runtime.jsx)(src.q,{showLabel:!0,onRenderIcon:customOnRenderIcon,onRenderText:customOnRenderText})]})};Custom_snippet_CustomScreenShareButtonExample.__docgenInfo={description:"",methods:[],displayName:"CustomScreenShareButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ScreenShare/snippets/Custom.snippet.tsx"]={name:"CustomScreenShareButtonExample",docgenInfo:Custom_snippet_CustomScreenShareButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ScreenShare/snippets/Custom.snippet.tsx"});var Default_snippet_ScreenShareButtonExample=function ScreenShareButtonExample(){return Object(jsx_runtime.jsxs)(src.f,{children:[Object(jsx_runtime.jsx)(src.q,{checked:!0},"micBtn1"),Object(jsx_runtime.jsx)(src.q,{},"micBtn2")]})};Default_snippet_ScreenShareButtonExample.displayName="ScreenShareButtonExample",Default_snippet_ScreenShareButtonExample.__docgenInfo={description:"",methods:[],displayName:"ScreenShareButtonExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ScreenShare/snippets/Default.snippet.tsx"]={name:"ScreenShareButtonExample",docgenInfo:Default_snippet_ScreenShareButtonExample.__docgenInfo,path:"stories/ControlBar/Buttons/ScreenShare/snippets/Default.snippet.tsx"});var WithLabel_snippet_ScreenShareButtonWithLabelExample=function ScreenShareButtonWithLabelExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.q,{showLabel:!0,checked:!0})})};WithLabel_snippet_ScreenShareButtonWithLabelExample.displayName="ScreenShareButtonWithLabelExample",WithLabel_snippet_ScreenShareButtonWithLabelExample.__docgenInfo={description:"",methods:[],displayName:"ScreenShareButtonWithLabelExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/ScreenShare/snippets/WithLabel.snippet.tsx"]={name:"ScreenShareButtonWithLabelExample",docgenInfo:WithLabel_snippet_ScreenShareButtonWithLabelExample.__docgenInfo,path:"stories/ControlBar/Buttons/ScreenShare/snippets/WithLabel.snippet.tsx"});var CustomButtonExampleText=__webpack_require__(1421).default,DefaultButtonExampleText=__webpack_require__(1422).default,ButtonWithLabelExampleText=__webpack_require__(1423).default,ScreenShare_stories_ScreenShareStory=function ScreenShareStory(args){return Object(jsx_runtime.jsx)(src.q,Object.assign({},args))};ScreenShare_stories_ScreenShareStory.displayName="ScreenShareStory";var ScreenShare=ScreenShare_stories_ScreenShareStory.bind({});__webpack_exports__.default={id:constants.a+"-controlbar-buttons-screenshare",title:constants.a+"/ControlBar/Buttons/Screen Share",component:src.q,argTypes:{checked:controlsUtils.a.checked,showLabel:controlsUtils.a.showLabel,onToggleScreenShare:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ScreenShareButton"}),Object(jsx_runtime.jsx)(esm.c,{of:src.q}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: When overriding a render, like using `onRenderIcon` or `onRenderText`, don not forget to add a unique key to each element to avoid warning for children in a list."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { ScreenShareButton } from '@azure/communication-ui';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"The default `ScreenShareButton` component shows a ScreenShare icon with no label. The following example displays the `ScreenShareButton` with screen sharing enabled and disabled."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:DefaultButtonExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_ScreenShareButtonExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ScreenShare with default label"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can display the button label which, by default, will show below the icon as `Share` or `Stop`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ButtonWithLabelExampleText,children:Object(jsx_runtime.jsx)(WithLabel_snippet_ScreenShareButtonWithLabelExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom ScreenShareButton Styles"}),Object(jsx_runtime.jsx)(esm.c,{children:"You can change the styles of the `ScreenShareButton` as you would customized any Button (styles, primary, onRenderIcon, onRenderText, etc... )."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomButtonExampleText,children:Object(jsx_runtime.jsx)(Custom_snippet_CustomScreenShareButtonExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"ScreenShareButton Props"}),Object(jsx_runtime.jsx)(esm.c,{children:"`ScreenShareButton` features all props a [FluentUI Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) offers, with the following additional properties:"}),Object(jsx_runtime.jsx)(esm.f,{of:src.q})]})}()}}}};ScreenShare.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <ScreenShareButton {...args} />;\n}"}},ScreenShare.parameters)},1498:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ParticipantItem",(function(){return ParticipantItem}));__webpack_require__(81),__webpack_require__(34),__webpack_require__(73),__webpack_require__(93),__webpack_require__(53),__webpack_require__(231),__webpack_require__(50),__webpack_require__(10);var src=__webpack_require__(24),Stack=__webpack_require__(99),lib=__webpack_require__(20),ShareScreenStart20Filled=__webpack_require__(1669),MicOff20Filled=__webpack_require__(1670),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Persona_types=__webpack_require__(26),jsx_runtime=__webpack_require__(1),CustomAvatar_snippet_CustomAvatarExample=function CustomAvatarExample(){var avatarStyle={borderRadius:20,display:"block"};return Object(jsx_runtime.jsx)(src.n,{displayName:"Annie Lindqvist",presence:Persona_types.b.online,onRenderAvatar:function onRenderAvatar(){return Object(jsx_runtime.jsx)("img",{src:"https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png",width:"32px",height:"32px",style:avatarStyle})}})};CustomAvatar_snippet_CustomAvatarExample.displayName="CustomAvatarExample",CustomAvatar_snippet_CustomAvatarExample.__docgenInfo={description:"",methods:[],displayName:"CustomAvatarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantItem/snippets/CustomAvatar.snippet.tsx"]={name:"CustomAvatarExample",docgenInfo:CustomAvatar_snippet_CustomAvatarExample.__docgenInfo,path:"stories/ParticipantItem/snippets/CustomAvatar.snippet.tsx"});var Icon=__webpack_require__(821),CustomIcon_snippet_CustomIconExample=function CustomIconExample(){var onRenderIcon=function onRenderIcon(props){return"Patrick"===(null==props?void 0:props.displayName)?Object(jsx_runtime.jsx)(Icon.a,{iconName:"FavoriteStar"}):null!=props&&props.me?null:Object(jsx_runtime.jsx)(Icon.a,{iconName:"AddFriend"})};return Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)(src.n,{displayName:"Spongebob",presence:Persona_types.b.online,me:!0,onRenderIcon:onRenderIcon}),Object(jsx_runtime.jsx)(src.n,{displayName:"Patrick",presence:Persona_types.b.online,onRenderIcon:onRenderIcon}),Object(jsx_runtime.jsx)(src.n,{displayName:"Sandy",presence:Persona_types.b.online,onRenderIcon:onRenderIcon})]})};CustomIcon_snippet_CustomIconExample.displayName="CustomIconExample",CustomIcon_snippet_CustomIconExample.__docgenInfo={description:"",methods:[],displayName:"CustomIconExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantItem/snippets/CustomIcon.snippet.tsx"]={name:"CustomIconExample",docgenInfo:CustomIcon_snippet_CustomIconExample.__docgenInfo,path:"stories/ParticipantItem/snippets/CustomIcon.snippet.tsx"});var ParticipantItem_snippet_ParticipantItemExample=function ParticipantItemExample(){var menuItems=[{key:"Mute",text:"Mute",onClick:function onClick(){return alert("Mute")}},{key:"Remove",text:"Remove",onClick:function onClick(){return alert("Remove")}}];return Object(jsx_runtime.jsx)(src.n,{displayName:"Johnny Bravo",menuItems:menuItems,presence:Persona_types.b.online})};ParticipantItem_snippet_ParticipantItemExample.displayName="ParticipantItemExample",ParticipantItem_snippet_ParticipantItemExample.__docgenInfo={description:"",methods:[],displayName:"ParticipantItemExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ParticipantItem/snippets/ParticipantItem.snippet.tsx"]={name:"ParticipantItemExample",docgenInfo:ParticipantItem_snippet_ParticipantItemExample.__docgenInfo,path:"stories/ParticipantItem/snippets/ParticipantItem.snippet.tsx"});var CustomAvatarExampleText=__webpack_require__(1458).default,CustomIconExampleText=__webpack_require__(1459).default,ParticipantItemExampleText=__webpack_require__(1460).default,onlyUnique=function onlyUnique(value,index,self){return self.indexOf(value)===index},ParticipantItem_stories_ParticipantItemStory=function ParticipantItemStory(args){var menuItems=args.menuItemsStr.split(",").map((function(menuItem){return menuItem.trim()})).filter(onlyUnique).map((function(menuItem){return{key:menuItem,text:menuItem}})),tokenProps={childrenGap:"0.5rem"};return Object(jsx_runtime.jsx)("div",{style:{width:"12rem"},children:Object(jsx_runtime.jsx)(src.n,{displayName:args.displayName,me:args.me,menuItems:menuItems,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:tokenProps,children:[args.isScreenSharing&&Object(jsx_runtime.jsx)(ShareScreenStart20Filled.a,{primaryFill:"currentColor",className:Object(lib.G)({height:"0.875rem"})}),args.isMuted&&Object(jsx_runtime.jsx)(MicOff20Filled.a,{primaryFill:"currentColor",className:Object(lib.G)({height:"0.875rem"})})]})}})})};ParticipantItem_stories_ParticipantItemStory.displayName="ParticipantItemStory";var ParticipantItem=ParticipantItem_stories_ParticipantItemStory.bind({});__webpack_exports__.default={id:constants.a+"-participantitem",title:constants.a+"/Participant Item",component:src.n,argTypes:{displayName:controlsUtils.a.displayName,isScreenSharing:controlsUtils.a.isScreenSharing,isMuted:controlsUtils.a.isMuted,me:controlsUtils.a.isMe,menuItemsStr:controlsUtils.a.participantItemMenuItemsStr,onRenderAvatar:controlsUtils.j,menuItems:controlsUtils.j,onRenderIcon:controlsUtils.j,presence:controlsUtils.j,styles:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"ParticipantItem"}),Object(jsx_runtime.jsx)(esm.c,{of:src.n}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { ParticipantItem, ParticipantItemProps } from '@azure/communication-react';\nimport { IContextualMenuItem, PersonaPresence } from '@fluentui/react';"}),Object(jsx_runtime.jsx)(esm.d,{children:"Usage"}),Object(jsx_runtime.jsx)(esm.c,{children:"Here is an example of how to use `ParticipantItem.` In this example, the `menuItems` property is used to add a context menu. The type of `menuItems` is an array of [IContextualMenuItem](https://developer.microsoft.com/en-us/fluentui#/controls/web/contextualmenu#IContextualMenuItem). Click on the rendered participant below to see the menu items."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ParticipantItemExampleText,children:Object(jsx_runtime.jsx)(ParticipantItem_snippet_ParticipantItemExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom avatar"}),Object(jsx_runtime.jsx)(esm.c,{children:"To customize the avatar, use the `onRenderAvatar` property like in the example below. We recommend the avatar element to be within 32 by 32 pixels."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomAvatarExampleText,children:Object(jsx_runtime.jsx)(CustomAvatar_snippet_CustomAvatarExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Add icon"}),Object(jsx_runtime.jsx)(esm.c,{children:"To add an icon, use the `onRenderIcon` property like in the example below."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomIconExampleText,children:Object(jsx_runtime.jsx)(CustomIcon_snippet_CustomIconExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.n})]})}()}}}};ParticipantItem.parameters=Object.assign({storySource:{source:"(args) => {\n  const menuItems = args.menuItemsStr\n    .split(',')\n    .map((menuItem) => menuItem.trim())\n    .filter(onlyUnique)\n    .map((menuItem) => {\n      return {\n        key: menuItem,\n        text: menuItem\n      };\n    });\n\n  const containerStyle = { width: '12rem' };\n\n  const tokenProps = { childrenGap: '0.5rem' };\n\n  return (\n    <div style={containerStyle}>\n      <ParticipantItemComponent\n        displayName={args.displayName}\n        me={args.me}\n        menuItems={menuItems}\n        onRenderIcon={() => (\n          <Stack horizontal={true} tokens={tokenProps}>\n            {args.isScreenSharing && (\n              <ShareScreenStart20Filled primaryFill=\"currentColor\" className={mergeStyles({ height: '0.875rem' })} />\n            )}\n            {args.isMuted && (\n              <MicOff20Filled primaryFill=\"currentColor\" className={mergeStyles({ height: '0.875rem' })} />\n            )}\n          </Stack>\n        )}\n      />\n    </div>\n  );\n}"}},ParticipantItem.parameters)},1499:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"TypingIndicator",(function(){return TypingIndicator}));__webpack_require__(50),__webpack_require__(10);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),jsx_runtime=__webpack_require__(1),CustomStyling_snippet_CustomStylingSnippet=function CustomStylingSnippet(){return Object(jsx_runtime.jsx)(src.t,{typingUsers:[{userId:"1",displayName:"User1"},{userId:"2",displayName:"User2"}],styles:{root:{border:"1px solid darkblue",width:"400px",padding:"5px"},typingUserDisplayName:{font:"15px Tahoma , sans-serif;"},typingString:{color:"slategrey"}}})};CustomStyling_snippet_CustomStylingSnippet.displayName="CustomStylingSnippet",CustomStyling_snippet_CustomStylingSnippet.__docgenInfo={description:"",methods:[],displayName:"CustomStylingSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/TypingIndicator/snippets/CustomStyling.snippet.tsx"]={name:"CustomStylingSnippet",docgenInfo:CustomStyling_snippet_CustomStylingSnippet.__docgenInfo,path:"stories/TypingIndicator/snippets/CustomStyling.snippet.tsx"});var lib=__webpack_require__(20),CustomUserRender_snippet_CustomUserRenderSnippet=function CustomUserRenderSnippet(){var _imageMap,avatarStyle={borderRadius:20,display:"block"},imageMap=((_imageMap={})[1]="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-female.png",_imageMap[2]="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-react-assets/persona-male.png",_imageMap),verticallyCenterStyle=Object(lib.G)({display:"flex",alignItems:"center"}),spanStyle=Object(lib.G)({whiteSpace:"nowrap",paddingRight:"3px"});return Object(jsx_runtime.jsx)(src.t,{typingUsers:[{userId:"1",displayName:"Annie Lindqvist"},{userId:"2",displayName:"Ted Randall"}],onRenderUser:function onRenderUser(user){return Object(jsx_runtime.jsxs)("div",{className:verticallyCenterStyle,children:[Object(jsx_runtime.jsx)("img",{src:imageMap[user.userId],width:"32px",height:"32px",style:avatarStyle}),Object(jsx_runtime.jsx)("span",{className:spanStyle,children:user.displayName})]},user.displayName+"UserKey")}})};CustomUserRender_snippet_CustomUserRenderSnippet.displayName="CustomUserRenderSnippet",CustomUserRender_snippet_CustomUserRenderSnippet.__docgenInfo={description:"",methods:[],displayName:"CustomUserRenderSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/TypingIndicator/snippets/CustomUserRender.snippet.tsx"]={name:"CustomUserRenderSnippet",docgenInfo:CustomUserRender_snippet_CustomUserRenderSnippet.__docgenInfo,path:"stories/TypingIndicator/snippets/CustomUserRender.snippet.tsx"});var TypingIndicator_snippet_TypingIndicatorSnippet=function TypingIndicatorSnippet(){for(var oneTypingUsers=[{userId:"1",displayName:"User1"}],twentyUsers=[],idx=0;idx<20;idx++)twentyUsers.push({userId:""+idx,displayName:"User"+idx});return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(src.t,{typingUsers:oneTypingUsers}),Object(jsx_runtime.jsx)(src.t,{typingUsers:[{userId:"1",displayName:"User1"},{userId:"2",displayName:"User2"}]}),Object(jsx_runtime.jsx)(src.t,{typingUsers:twentyUsers}),Object(jsx_runtime.jsx)(src.t,{typingUsers:oneTypingUsers})]})};TypingIndicator_snippet_TypingIndicatorSnippet.__docgenInfo={description:"",methods:[],displayName:"TypingIndicatorSnippet"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/TypingIndicator/snippets/TypingIndicator.snippet.tsx"]={name:"TypingIndicatorSnippet",docgenInfo:TypingIndicator_snippet_TypingIndicatorSnippet.__docgenInfo,path:"stories/TypingIndicator/snippets/TypingIndicator.snippet.tsx"});var CustomStylingSnippetText=__webpack_require__(1469).default,CustomUserRenderSnippetText=__webpack_require__(1470).default,TypingIndicatorSnippetText=__webpack_require__(1471).default,TypingIndicator_stories_TypingIndicatorStory=function TypingIndicatorStory(args){return Object(jsx_runtime.jsx)(src.t,{typingUsers:args.typingUsers})};TypingIndicator_stories_TypingIndicatorStory.displayName="TypingIndicatorStory";var TypingIndicator=TypingIndicator_stories_TypingIndicatorStory.bind({});__webpack_exports__.default={id:constants.a+"-typingindicator",title:constants.a+"/Typing Indicator",component:src.t,argTypes:{typingUsers:controlsUtils.a.typingUsers,onRenderUser:controlsUtils.j,styles:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"TypingIndicator"}),Object(jsx_runtime.jsx)(esm.c,{of:src.t}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"import { TypingIndicator } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:TypingIndicatorSnippetText,children:Object(jsx_runtime.jsx)(TypingIndicator_snippet_TypingIndicatorSnippet,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Customize style"}),Object(jsx_runtime.jsx)(esm.c,{children:"To customize the style of `TypingIndicator`, use the `styles` property like in the example below. Notice that the keys of `styles` property are the root and sub-components of `TypingIndicator`, each of which can be styled independently."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomStylingSnippetText,children:Object(jsx_runtime.jsx)(CustomStyling_snippet_CustomStylingSnippet,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Customize user rendering"}),Object(jsx_runtime.jsx)(esm.c,{children:"To customize user rendering of `TypingIndicator`, use the `onRenderUsers` property like in the example below. Note when this property is assigned you must apply style directly. The `styles` property will not apply."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomUserRenderSnippetText,children:Object(jsx_runtime.jsx)(CustomUserRender_snippet_CustomUserRenderSnippet,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.t})]})}()}}}};TypingIndicator.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <TypingIndicatorComponent typingUsers={args.typingUsers} />;\n}"}},TypingIndicator.parameters)},1500:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"VideoGallery",(function(){return VideoGallery}));__webpack_require__(81),__webpack_require__(34),__webpack_require__(73),__webpack_require__(93),__webpack_require__(53),__webpack_require__(231),__webpack_require__(50),__webpack_require__(10);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Stack=__webpack_require__(99),jsx_runtime=__webpack_require__(1),MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker",state:"Connected",isMuted:!1},{userId:"user3",displayName:"Thor",state:"Connecting",isMuted:!1},{userId:"user4",displayName:"Matthew Murdock",state:"Idle",isMuted:!1},{userId:"user5",displayName:"Bruce Wayne",state:"Connecting",isMuted:!1,isScreenSharing:!1}],CustomAvatar_snippet_CustomAvatarVideoGalleryExample=function CustomAvatarVideoGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"30rem"},children:Object(jsx_runtime.jsx)(src.u,{localParticipant:MockLocalParticipant,remoteParticipants:MockRemoteParticipants,onRenderAvatar:function onRenderAvatar(placeholderProps,defaultOnRender){switch(placeholderProps.displayName){case"You":return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif",style:{borderRadius:"100px",width:"100px",position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0}})});case"Thor":return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/7FgZWm6sGY0CNphZDJ/giphy.gif",style:{width:"100px",position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0}})});default:return defaultOnRender(placeholderProps)}}})})};CustomAvatar_snippet_CustomAvatarVideoGalleryExample.displayName="CustomAvatarVideoGalleryExample",CustomAvatar_snippet_CustomAvatarVideoGalleryExample.__docgenInfo={description:"",methods:[],displayName:"CustomAvatarVideoGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/CustomAvatar.snippet.tsx"]={name:"CustomAvatarVideoGalleryExample",docgenInfo:CustomAvatar_snippet_CustomAvatarVideoGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/CustomAvatar.snippet.tsx"});var CustomStyle_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},CustomStyle_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne"}],CustomStyle_snippet_CustomStyleVideoGalleryExample=function CustomStyleVideoGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"30rem"},children:Object(jsx_runtime.jsx)(src.u,{styles:{root:{border:"solid 5px red"}},localParticipant:CustomStyle_snippet_MockLocalParticipant,remoteParticipants:CustomStyle_snippet_MockRemoteParticipants})})};CustomStyle_snippet_CustomStyleVideoGalleryExample.displayName="CustomStyleVideoGalleryExample",CustomStyle_snippet_CustomStyleVideoGalleryExample.__docgenInfo={description:"",methods:[],displayName:"CustomStyleVideoGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/CustomStyle.snippet.tsx"]={name:"CustomStyleVideoGalleryExample",docgenInfo:CustomStyle_snippet_CustomStyleVideoGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/CustomStyle.snippet.tsx"});var Default_snippet_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},Default_snippet_MockRemoteParticipants=[{userId:"user2",displayName:"Peter Parker"},{userId:"user3",displayName:"Thor"},{userId:"user4",displayName:"Matthew Murdock"},{userId:"user5",displayName:"Bruce Wayne"}],Default_snippet_DefaultVideoGalleryExample=function DefaultVideoGalleryExample(){return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"30rem"},children:Object(jsx_runtime.jsx)(src.u,{localParticipant:Default_snippet_MockLocalParticipant,remoteParticipants:Default_snippet_MockRemoteParticipants})})};Default_snippet_DefaultVideoGalleryExample.displayName="DefaultVideoGalleryExample",Default_snippet_DefaultVideoGalleryExample.__docgenInfo={description:"",methods:[],displayName:"DefaultVideoGalleryExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoGallery/snippets/Default.snippet.tsx"]={name:"DefaultVideoGalleryExample",docgenInfo:Default_snippet_DefaultVideoGalleryExample.__docgenInfo,path:"stories/VideoGallery/snippets/Default.snippet.tsx"});var CustomAvatarVideoGalleryExampleText=__webpack_require__(1472).default,CustomStyleVideoGalleryExampleText=__webpack_require__(1473).default,DefaultVideoGalleryExampleText=__webpack_require__(1474).default,VideoGallery_stories_MockLocalParticipant={userId:"user1",displayName:"You",state:"Connected",isMuted:!0},onlyUnique=function onlyUnique(value,index,self){return self.indexOf(value)===index},VideoGallery_stories_VideoGalleryStory=function VideoGalleryStory(args){var remoteParticipants=args.remoteParticipants.split(",").map((function(p){return p.trim()})).filter((function(p){return p})).filter(onlyUnique).map((function(p,i){return{userId:"user"+i,displayName:p}}));return Object(jsx_runtime.jsx)(src.u,{layout:args.layout,localParticipant:VideoGallery_stories_MockLocalParticipant,remoteParticipants:remoteParticipants})};VideoGallery_stories_VideoGalleryStory.displayName="VideoGalleryStory";var VideoGallery=VideoGallery_stories_VideoGalleryStory.bind({});__webpack_exports__.default={id:constants.a+"-videogallery",title:constants.a+"/Video Gallery",component:src.u,argTypes:{remoteParticipants:controlsUtils.a.remoteParticipantNames,layout:controlsUtils.a.videoGallerylayout,styles:controlsUtils.j,localParticipant:controlsUtils.j,localVideoViewOption:controlsUtils.j,remoteVideoViewOption:controlsUtils.j,onCreateLocalStreamView:controlsUtils.j,onDisposeLocalStreamView:controlsUtils.j,onRenderLocalVideoTile:controlsUtils.j,onCreateRemoteStreamView:controlsUtils.j,onRenderRemoteVideoTile:controlsUtils.j,onDisposeRemoteStreamView:controlsUtils.j,onRenderAvatar:controlsUtils.j,showMuteIndicator:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"Video Gallery"}),Object(jsx_runtime.jsx)(esm.c,{of:src.u}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"import { VideoGallery } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.d,{children:"Default Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"VideoGallery is by default a grid of [VideoTile](./?path=/docs/ui-components-videotile--video-tile) components representing each participant to the call."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:DefaultVideoGalleryExampleText,children:Object(jsx_runtime.jsx)(Default_snippet_DefaultVideoGalleryExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom Avatar"}),Object(jsx_runtime.jsx)(esm.c,{children:"Rendering of avatars can be customized through the VideoGallery callback `onRenderAvatar`."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomAvatarVideoGalleryExampleText,children:Object(jsx_runtime.jsx)(CustomAvatar_snippet_CustomAvatarVideoGalleryExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Custom Style"}),Object(jsx_runtime.jsx)(esm.c,{children:"Style of the VideoGallery container can be customized through its `styles` props."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:CustomStyleVideoGalleryExampleText,children:Object(jsx_runtime.jsx)(CustomStyle_snippet_CustomStyleVideoGalleryExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.u})]})}()}}}};VideoGallery.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const remoteParticipants = args.remoteParticipants\n    .split(',')\n    .map((p) => p.trim())\n    .filter((p) => p)\n    .filter(onlyUnique)\n    .map((p, i) => {\n      return {\n        userId: `user${i}`,\n        displayName: p\n      };\n    });\n\n  return (\n    <VideoGalleryComponent\n      layout={args.layout}\n      localParticipant={MockLocalParticipant}\n      remoteParticipants={remoteParticipants}\n    />\n  );\n}"}},VideoGallery.parameters)},1501:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"_CallBackend_",(function(){return _CallBackend_})),__webpack_require__.d(__webpack_exports__,"_ChatBackend_",(function(){return _ChatBackend_}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var esm=__webpack_require__(2),dist_esm=__webpack_require__(5),IdentityManagement_stories=__webpack_require__(293),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.e,{id:"identitymanagement",title:"Identity Managemment",mdxType:"Meta"}),Object(esm.b)("h1",{id:"identity-management"},"Identity Management"),Object(esm.b)("p",null,"Azure Communication Services is an ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/en-us/azure/communication-services/concepts/identity-model",target:"_blank",rel:"nofollow noopener noreferrer"},"identity-agnostic service"),".\nGenerating Azure Communication Services identities and tokens for users is a privileged operation. Typically:"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"Customers deploy a secure backend service for generating Azure Communication Services identity tokens."),Object(esm.b)("li",{parentName:"ul"},"This secure service interacts with the identity service, and optionally customers' own backends to generate the\nAzure Communication Services identity tokens for users."),Object(esm.b)("li",{parentName:"ul"},"The identity tokens are supplied to the client application to be used with API calls to the Azure Communication\nServices Chat and Calling backends.")),Object(esm.b)("h2",{id:"calling"},"Calling"),Object(esm.b)("p",null,"Azure Communication Services Calling SDK requires a user identity, token and an identifier for the call to join."),Object(esm.b)("p",null,"A typical implementation of the backend service that mints the user token might look so:"),Object(esm.b)(dist_esm.g,{code:"// Logic to create an Azure Communication Services Calling user and group.\n// Resides in a secure backend server. The connection string is never exposed to the client application.\n\nimport { CommunicationIdentityClient } from '@azure/communication-identity';\nimport { v1 as createGUID } from 'uuid';\n\nexport const createUserAndGroup = async (resourceConnectionString: string): Promise<any> => {\n  const tokenClient = new CommunicationIdentityClient(resourceConnectionString);\n  const user = await tokenClient.createUserAndToken(['voip']);\n  return {\n    userId: user.user.communicationUserId,\n    token: user.token,\n    endpointUrl: new URL(resourceConnectionString.replace('endpoint=', '').split(';')[0]).toString(),\n\n    // Backend server creates a group call and provides the group ID to the client application.\n    // Alternatively, the client application could join an existing teams meeting.\n    //\n    // In this trivial example, a random ID is generated each time.\n    locator: createGUID()\n  };\n};\n",mdxType:"Source"}),Object(esm.b)("p",null,"The following utility canvas is backed by the same logic to mint tokens. You can use this to generate the data needed for\nthe ",Object(esm.b)("a",{parentName:"p",href:"/?path=/story/composites-call-basicexample--basic-example"},Object(esm.b)("inlineCode",{parentName:"a"},"CallComposite")," stories in this storybook"),"."),Object(esm.b)(dist_esm.b,{withSource:"none",mdxType:"Canvas"},Object(esm.b)(dist_esm.h,{story:IdentityManagement_stories.CallBackend,name:"_CallBackend_",mdxType:"Story"})),Object(esm.b)("h2",{id:"chat"},"Chat"),Object(esm.b)("p",null,"Azure Communication Services Chat SDK requires a user identity and token. Additionally, participants in a chat must be explicitly\nadded to the chat thread (Compare this to Calling SDK, where a participant may join a call using the group ID)."),Object(esm.b)("p",null,"A typical implementation of the backend service that mints the user tokens and adds them to a chat thread might look so:"),Object(esm.b)(dist_esm.g,{code:"// Logic to create an Azure Communication Services Chat thread and users, and add users to the thread.\n// Resides in a secure backend server. The connection string is never exposed to the client application.\n\nimport { ChatClient } from '@azure/communication-chat';\nimport { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport { CommunicationIdentityClient, CommunicationUserToken } from '@azure/communication-identity';\n\nexport const createUserAndThread = async (resourceConnectionString: string, displayNames: string[]): Promise<any> => {\n  if (displayNames.length === 0) {\n    return [];\n  }\n\n  const endpointUrl = new URL(resourceConnectionString.replace('endpoint=', '').split(';')[0]).toString();\n  const tokenClient = new CommunicationIdentityClient(resourceConnectionString);\n  const userAndTokens: CommunicationUserToken[] = [];\n  for (let i = 0; i < displayNames.length; i++) {\n    userAndTokens.push(await tokenClient.createUserAndToken(['chat']));\n  }\n\n  const chatClient = new ChatClient(endpointUrl, new AzureCommunicationTokenCredential(userAndTokens[0].token));\n  const threadId =\n    (\n      await chatClient.createChatThread(\n        { topic: 'DemoThread' },\n        {\n          participants: displayNames.map((displayName, i) => ({ id: userAndTokens[i].user, displayName: displayName }))\n        }\n      )\n    ).chatThread?.id ?? '';\n\n  return displayNames.map((displayName, i) => ({\n    userId: userAndTokens[i].user,\n    token: userAndTokens[i].token,\n    endpointUrl,\n    displayName,\n    threadId\n  }));\n};\n",mdxType:"Source"}),Object(esm.b)("p",null,"The following utility canvas is backed by the same logic to mint tokens and create threads. You can use this to generate the\ndata needed for the ",Object(esm.b)("a",{parentName:"p",href:"/?path=/docs/composites-chat-basicexample--basic-example"},Object(esm.b)("inlineCode",{parentName:"a"},"ChatComposite")," stories in this storybook"),"."),Object(esm.b)(dist_esm.b,{withSource:"none",mdxType:"Canvas"},Object(esm.b)(dist_esm.h,{story:IdentityManagement_stories.ChatBackend,name:"_ChatBackend_",mdxType:"Story"})))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var _CallBackend_=IdentityManagement_stories.CallBackend,_ChatBackend_=IdentityManagement_stories.ChatBackend,componentMeta={title:"Identity Managemment",id:"identitymanagement",includeStories:["_CallBackend_","_ChatBackend_"]},mdxStoryNameToKey={_CallBackend_:"_CallBackend_",_ChatBackend_:"_ChatBackend_"};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1502:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var esm=__webpack_require__(2),dist_esm=__webpack_require__(5),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.e,{id:"quickstarts-composites",title:"Quickstarts/Get started with Composites",mdxType:"Meta"}),Object(esm.b)("h1",{id:"quickstart-get-started-with-composites"},"Quickstart: Get started with Composites"),Object(esm.b)("p",null,"Get started with Azure Communication Services by using the UI Library to quickly integrate communication experiences into your applications. In this quickstart, you'll learn how to integrate UI Library base components into your application to build communication experiences."),Object(esm.b)("p",null,"UI Library components come in two flavors: UI and Composite."),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("strong",{parentName:"li"},"UI components")," represent discrete communication capabilities; they're the basic building blocks that can be used to build complex communication experiences."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("strong",{parentName:"li"},"Composite components")," are turn-key experiences for common communication scenarios that have been built using ",Object(esm.b)("strong",{parentName:"li"},"base components")," as building blocks and packaged to be easily integrated into applications.")),Object(esm.b)("h2",{id:"prerequisites"},"Prerequisites"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},"An Azure account with an active subscription. ",Object(esm.b)("a",{parentName:"li",href:"https://azure.microsoft.com/free/?WT.mc_id=A261C142F",target:"_blank",rel:"nofollow noopener noreferrer"},"Create an account for free"),"."),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"https://nodejs.org/",target:"_blank",rel:"nofollow noopener noreferrer"},"Node.js")," Active LTS and Maintenance LTS versions (Node 12 Recommended)."),Object(esm.b)("li",{parentName:"ul"},"An active Communication Services resource. ",Object(esm.b)("a",{parentName:"li",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp",target:"_blank",rel:"nofollow noopener noreferrer"},"Create a Communication Services resource"),".")),Object(esm.b)("h2",{id:"setting-up"},"Setting Up"),Object(esm.b)("p",null,"UI Library requires a React environment to be setup. Next we will do that. If you already have a React App, you can skip this section."),Object(esm.b)("h3",{id:"set-up-react-app"},"Set Up React App"),Object(esm.b)("p",null,"We'll use the create-react-app template for this quickstart. For more information, see: ",Object(esm.b)("a",{parentName:"p",href:"https://reactjs.org/docs/create-a-new-react-app.html",target:"_blank",rel:"nofollow noopener noreferrer"},"Get Started with React")),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpx create-react-app ui-toolkit-quickstart-composites --template typescript\n\ncd ui-toolkit-quickstart-composites\n\n")),Object(esm.b)("p",null,"At the end of this process, you should have a full application inside of the folder ",Object(esm.b)("inlineCode",{parentName:"p"},"ui-toolkit-quickstart-composites"),".\nFor this quickstart, we'll be modifying files inside of the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder."),Object(esm.b)("h3",{id:"install-the-package"},"Install the Package"),Object(esm.b)("p",null,"Use the ",Object(esm.b)("inlineCode",{parentName:"p"},"npm install")," command to install the Azure Communication Services UI Library for JavaScript."),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm install --save @azure/communication-react\n\n")),Object(esm.b)("p",null,"The ",Object(esm.b)("inlineCode",{parentName:"p"},"--save")," option lists the library as a dependency in your ",Object(esm.b)("strong",{parentName:"p"},"package.json")," file."),Object(esm.b)("h3",{id:"run-create-react-app"},"Run Create React App"),Object(esm.b)("p",null,"Let's test the Create React App installation by running:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"object-model"},"Object Model"),Object(esm.b)("p",null,"The following classes and interfaces handle some of the major features of the Azure Communication Services UI client library:"),Object(esm.b)("table",null,Object(esm.b)("thead",{parentName:"table"},Object(esm.b)("tr",{parentName:"thead"},Object(esm.b)("th",{parentName:"tr",align:null},"Name"),Object(esm.b)("th",{parentName:"tr",align:null},"Description"))),Object(esm.b)("tbody",{parentName:"table"},Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/composites-call-basicexample--basic-example"},"CallComposite")),Object(esm.b)("td",{parentName:"tr",align:null},"Composite component that renders a calling experience with participant gallery and controls.")),Object(esm.b)("tr",{parentName:"tbody"},Object(esm.b)("td",{parentName:"tr",align:null},Object(esm.b)("a",{parentName:"td",href:"/?path=/story/composites-chat-basicexample--basic-example"},"ChatComposite")),Object(esm.b)("td",{parentName:"tr",align:null},"Composite component that renders a chat experience with chat thread and input")))),Object(esm.b)("h2",{id:"set-up-adapters"},"Set Up Adapters"),Object(esm.b)("p",null,"Before we initialize the actual composite components, we need to set up the adapters that will power them.\nThese adapters take care of the entire state of the composites truly making them a turn-key solution.\nTo setup the adapters, developers needs to pass information on the call or chat they want to join."),Object(esm.b)("p",null,"The adapters require access tokens, group IDs, or thread IDs to be setup.\nThese elements come from services that go through the proper steps to generate these IDs and pass them to the client application.\nFor more information, see: ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/concepts/client-and-server-architecture",target:"_blank",rel:"nofollow noopener noreferrer"},"Client Server Architecture"),".\nFor Example: The Group Chat composite expects that the ",Object(esm.b)("inlineCode",{parentName:"p"},"userId")," associated to the ",Object(esm.b)("inlineCode",{parentName:"p"},"token")," being used to initialize it has already been joined to the ",Object(esm.b)("inlineCode",{parentName:"p"},"threadId")," being provided.\nIf the token hasn't been joined to the thread ID, then the Group Chat composite will fail.\nFor more information on chat, see: ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/chat/get-started?pivots=programming-language-csharp",target:"_blank",rel:"nofollow noopener noreferrer"},"Getting Started with Chat")),Object(esm.b)("p",null,"Go to the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder inside of ",Object(esm.b)("inlineCode",{parentName:"p"},"ui-toolkit-quickstart-composites")," and look for the file ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx"),"."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.g,{code:"import { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  CallAdapter,\n  createAzureCommunicationCallAdapter,\n  ChatAdapter,\n  createAzureCommunicationChatAdapter\n} from '@azure/communication-react';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userId = '<Azure Communication Services Identifier>';\n  const displayName = '<Display Name>';\n  const token = '<Azure Communication Services Access Token>';\n\n  //Calling Variables\n  //For Group Id, developers can pass any GUID they can generate\n  const groupId = '<Developer generated GUID>';\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\n\n  //Chat Variables\n  const threadId = '<Get thread id from chat service>';\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\n\n  // We can't even initialize the Chat and Call adapters without a well-formed token.\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [token]);\n\n  useEffect(() => {\n    if (credential !== undefined) {\n      const createAdapter = async (credential: AzureCommunicationTokenCredential): Promise<void> => {\n        setChatAdapter(\n          await createAzureCommunicationChatAdapter({\n            endpointUrl,\n            userId: { kind: 'communicationUser', communicationUserId: userId },\n            displayName,\n            credential,\n            threadId\n          })\n        );\n        setCallAdapter(\n          await createAzureCommunicationCallAdapter({\n            userId: { kind: 'communicationUser', communicationUserId: userId },\n            displayName,\n            credential,\n            locator: { groupId }\n          })\n        );\n      };\n      createAdapter(credential);\n    }\n  }, [credential]);\n\n  if (!!callAdapter && !!chatAdapter) {\n    return <h1>Hooray! You set up adapters </h1>;\n  }\n  if (credential === undefined) {\n    return <h3>Failed to construct credential. Provided token is malformed.</h3>;\n  }\n  return <h3>Initializing...</h3>;\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("p",null,"Next we will initialize the composite components with the adapters."),Object(esm.b)("h2",{id:"initialize-composites"},"Initialize Composites"),Object(esm.b)("p",null,"Go to the ",Object(esm.b)("inlineCode",{parentName:"p"},"src")," folder inside of ",Object(esm.b)("inlineCode",{parentName:"p"},"ui-toolkit-quickstart-composites")," and look for the file ",Object(esm.b)("inlineCode",{parentName:"p"},"app.tsx"),".\nHere we'll drop the following code to initialize our Composite Components for Chat and Calling using the adapters we set up above.\nYou can choose which one to use depending on the type of communication experience you're building.\nIf needed, you can use both at the same time."),Object(esm.b)("p",null,Object(esm.b)("inlineCode",{parentName:"p"},"App.tsx")),Object(esm.b)(dist_esm.g,{code:"import { AzureCommunicationTokenCredential } from '@azure/communication-common';\nimport {\n  CallComposite,\n  CallAdapter,\n  createAzureCommunicationCallAdapter,\n  ChatComposite,\n  ChatAdapter,\n  createAzureCommunicationChatAdapter\n} from '@azure/communication-react';\nimport React, { useEffect, useMemo, useState } from 'react';\n\nfunction App(): JSX.Element {\n  const endpointUrl = '<Azure Communication Services Resource Endpoint>';\n  const userId = '<Azure Communication Services Identifier>';\n  const displayName = '<Display Name>';\n  const token = '<Azure Communication Services Access Token>';\n\n  //Calling Variables\n  //For Group Id, developers can pass any GUID they can generate\n  const groupId = '<Developer generated GUID>';\n  const [callAdapter, setCallAdapter] = useState<CallAdapter>();\n\n  //Chat Variables\n  const threadId = '<Get thread id from chat service>';\n  const [chatAdapter, setChatAdapter] = useState<ChatAdapter>();\n\n  // We can't even initialize the Chat and Call adapters without a well-formed token.\n  const credential = useMemo(() => {\n    try {\n      return new AzureCommunicationTokenCredential(token);\n    } catch {\n      console.error('Failed to construct token credential');\n      return undefined;\n    }\n  }, [token]);\n\n  useEffect(() => {\n    const createAdapter = async (): Promise<void> => {\n      setChatAdapter(\n        await createAzureCommunicationChatAdapter({\n          endpointUrl,\n          userId: { kind: 'communicationUser', communicationUserId: userId },\n          displayName,\n          credential: new AzureCommunicationTokenCredential(token),\n          threadId\n        })\n      );\n      setCallAdapter(\n        await createAzureCommunicationCallAdapter({\n          userId: { kind: 'communicationUser', communicationUserId: userId },\n          displayName,\n          credential: new AzureCommunicationTokenCredential(token),\n          locator: { groupId }\n        })\n      );\n    };\n    createAdapter();\n  }, []);\n\n  if (!!callAdapter && !!chatAdapter) {\n    return (\n      <>\n        <ChatComposite adapter={chatAdapter} />\n        <CallComposite adapter={callAdapter} />\n      </>\n    );\n  }\n  if (credential === undefined) {\n    return <h3>Failed to construct credential. Provided token is malformed.</h3>;\n  }\n  return <h3>Initializing...</h3>;\n}\n\nexport default App;\n",mdxType:"Source"}),Object(esm.b)("h2",{id:"run-quickstart"},"Run Quickstart"),Object(esm.b)("p",null,"To run the code above use the command:"),Object(esm.b)("pre",null,Object(esm.b)("code",{parentName:"pre",className:"language-bash"},"\nnpm run start\n\n")),Object(esm.b)("h2",{id:"clean-up-resources"},"Clean Up Resources"),Object(esm.b)("p",null,"If you want to clean up and remove a Communication Services subscription, you can delete the resource or resource group.\nDeleting the resource group also deletes any other resources associated with it.\nLearn more about ",Object(esm.b)("a",{parentName:"p",href:"https://docs.microsoft.com/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#clean-up-resources",target:"_blank",rel:"nofollow noopener noreferrer"},"cleaning up resources"),"."),Object(esm.b)("h2",{id:"next-steps"},"Next Steps"),Object(esm.b)("p",null,Object(esm.b)("a",{parentName:"p",href:"/?path=/story/quickstarts-uicomponents--page"},"Try UI Library UI Components")),Object(esm.b)("p",null,"For more information, see the following resources:"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/use-cases--page"},"UI Library Use Cases")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/styling--page"},"UI Library Styling")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/theming--page"},"UI Library Theming")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("a",{parentName:"li",href:"/?path=/story/localization--page#composites"},"UI Library Localization"))))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Quickstarts/Get started with Composites",id:"quickstarts-composites",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1503:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"__page",(function(){return __page}));__webpack_require__(38),__webpack_require__(81),__webpack_require__(8),__webpack_require__(10),__webpack_require__(0);var esm=__webpack_require__(2),dist_esm=__webpack_require__(5),src=__webpack_require__(24),jsx_runtime=__webpack_require__(1),styles={root:{background:"white",border:"2px solid firebrick","& button":{":hover":{background:"black",color:"white"}}}},StylingControlBar_snippet_ControlBarExample=function ControlBarExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsxs)(src.b,{styles:styles,children:[Object(jsx_runtime.jsx)(src.a,{}),Object(jsx_runtime.jsx)(src.l,{}),Object(jsx_runtime.jsx)(src.d,{})]})})};StylingControlBar_snippet_ControlBarExample.displayName="ControlBarExample",StylingControlBar_snippet_ControlBarExample.__docgenInfo={description:"",methods:[],displayName:"ControlBarExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Styling/snippets/StylingControlBar.snippet.tsx"]={name:"ControlBarExample",docgenInfo:StylingControlBar_snippet_ControlBarExample.__docgenInfo,path:"stories/Styling/snippets/StylingControlBar.snippet.tsx"});var StylingVideoTile_snippet=__webpack_require__(418),snippets_StylingVideoTile_snippet=__webpack_require__(540),_excluded=["components"];function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _objectWithoutProperties(source,excluded){if(null==source)return{};var key,i,target=function _objectWithoutPropertiesLoose(source,excluded){if(null==source)return{};var key,i,target={},sourceKeys=Object.keys(source);for(i=0;i<sourceKeys.length;i++)key=sourceKeys[i],excluded.indexOf(key)>=0||(target[key]=source[key]);return target}(source,excluded);if(Object.getOwnPropertySymbols){var sourceSymbolKeys=Object.getOwnPropertySymbols(source);for(i=0;i<sourceSymbolKeys.length;i++)key=sourceSymbolKeys[i],excluded.indexOf(key)>=0||Object.prototype.propertyIsEnumerable.call(source,key)&&(target[key]=source[key])}return target}var layoutProps={};function MDXContent(_ref){var components=_ref.components,props=_objectWithoutProperties(_ref,_excluded);return Object(esm.b)("wrapper",_extends({},layoutProps,props,{components:components,mdxType:"MDXLayout"}),Object(esm.b)(dist_esm.e,{id:"styling",title:"Styling",mdxType:"Meta"}),Object(esm.b)("h1",{id:"styling"},"Styling"),Object(esm.b)("p",null,"The ability to style components using custom CSS is an important feature of Azure Communication UI Library.\nAll the UI Components have complete CSS support and provide complex styling capabilities."),Object(esm.b)("h2",{id:"overview"},"Overview"),Object(esm.b)("ul",null,Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("p",{parentName:"li"},"UI Components expose a ",Object(esm.b)("inlineCode",{parentName:"p"},"prop")," named ",Object(esm.b)("inlineCode",{parentName:"p"},"styles")," that accepts an Object containing custom CSS for the component root as well as it's child components.")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("p",{parentName:"li"},"Users can always provide the ",Object(esm.b)("inlineCode",{parentName:"p"},"root")," property in ",Object(esm.b)("inlineCode",{parentName:"p"},"styles")," object and apply custom CSS to the component root.")),Object(esm.b)("li",{parentName:"ul"},Object(esm.b)("p",{parentName:"li"},"Properties in ",Object(esm.b)("inlineCode",{parentName:"p"},"styles")," object will vary from component to component."))),Object(esm.b)("h2",{id:"example---controlbar"},"Example - ControlBar"),Object(esm.b)("p",null,"Let's style the ",Object(esm.b)("inlineCode",{parentName:"p"},"ControlBar")," component and components inside it using the ",Object(esm.b)("inlineCode",{parentName:"p"},"root")," styles property."),Object(esm.b)(dist_esm.g,{code:"import {\n  CameraButton,\n  ControlBar,\n  EndCallButton,\n  FluentThemeProvider,\n  MicrophoneButton\n} from '@azure/communication-react';\nimport React from 'react';\n\n// ControlBar component accepts a `styles` prop with only the `root` key as a valid property.\nconst styles = {\n  root: {\n    background: 'white',\n    border: '2px solid firebrick',\n    '& button': {\n      ':hover': {\n        background: 'black',\n        color: 'white'\n      }\n    }\n  }\n};\n\nexport const ControlBarExample = (): JSX.Element => {\n  return (\n    <FluentThemeProvider>\n      <ControlBar styles={styles}>\n        <CameraButton />\n        <MicrophoneButton />\n        <EndCallButton />\n      </ControlBar>\n    </FluentThemeProvider>\n  );\n};\n",mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CControlBarExample%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(StylingControlBar_snippet_ControlBarExample,{mdxType:"ControlBarExample"})),Object(esm.b)("h2",{id:"example---videotile"},"Example - VideoTile"),Object(esm.b)("p",null,"Let's style the ",Object(esm.b)("inlineCode",{parentName:"p"},"VideoTile")," component.\n",Object(esm.b)("inlineCode",{parentName:"p"},"VideoTile")," component allows you to style its ",Object(esm.b)("inlineCode",{parentName:"p"},"root")," element, the ",Object(esm.b)("inlineCode",{parentName:"p"},"Video Container")," and the ",Object(esm.b)("inlineCode",{parentName:"p"},"Overlay Container")," (Content rendered in front of the Video Container)."),Object(esm.b)(dist_esm.g,{code:snippets_StylingVideoTile_snippet.default,mdxType:"Source"}),Object(esm.b)(dist_esm.b,{withSource:"none",mdxSource:"%0A%3CVideoTileExample%20/%3E%0A",mdxType:"Canvas"},Object(esm.b)(StylingVideoTile_snippet.a,{mdxType:"VideoTileExample"})))}MDXContent.displayName="MDXContent",MDXContent.isMDXComponent=!0;var __page=function __page(){throw new Error("Docs-only story")};__page.parameters={docsOnly:!0};var componentMeta={title:"Styling",id:"styling",includeStories:["__page"]},mdxStoryNameToKey={};componentMeta.parameters=componentMeta.parameters||{},componentMeta.parameters.docs=Object.assign({},componentMeta.parameters.docs||{},{page:function page(){return Object(esm.b)(dist_esm.a,{mdxStoryNameToKey:mdxStoryNameToKey,mdxComponentMeta:componentMeta},Object(esm.b)(MDXContent,null))}});__webpack_exports__.default=componentMeta},1504:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"VideoTile",(function(){return VideoTile}));__webpack_require__(50),__webpack_require__(10);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),StylingVideoTile_snippet=__webpack_require__(418),utils=__webpack_require__(155),jsx_runtime=__webpack_require__(1),VideoTile_snippet_VideoTileExample=function VideoTileExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.v,{styles:{root:{height:"300px",width:"400px",border:"1px solid #999"}},displayName:"Maximus Aurelius",showMuteIndicator:!0,isMuted:!0,renderElement:null,isMirrored:!0})})};VideoTile_snippet_VideoTileExample.displayName="VideoTileExample",VideoTile_snippet_VideoTileExample.__docgenInfo={description:"",methods:[],displayName:"VideoTileExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoTile/snippets/VideoTile.snippet.tsx"]={name:"VideoTileExample",docgenInfo:VideoTile_snippet_VideoTileExample.__docgenInfo,path:"stories/VideoTile/snippets/VideoTile.snippet.tsx"});var Stack=__webpack_require__(99),VideoTilePlaceholder_snippet_onRenderPlaceholder=function onRenderPlaceholder(){return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)("img",{src:"https://media.giphy.com/media/4Zo41lhzKt6iZ8xff9/giphy.gif",style:{borderRadius:"150px",width:"150px",position:"absolute",margin:"auto",left:0,right:0,top:0,bottom:0}})})};VideoTilePlaceholder_snippet_onRenderPlaceholder.displayName="onRenderPlaceholder";var VideoTilePlaceholder_snippet_VideoTilePlaceholderExample=function VideoTilePlaceholderExample(){return Object(jsx_runtime.jsx)(src.f,{children:Object(jsx_runtime.jsx)(src.v,{userId:"UserIdPlaceholder",styles:{root:{height:"300px",width:"400px",border:"1px solid #999"}},displayName:"Maximus Aurelius",renderElement:null,isMirrored:!0,onRenderPlaceholder:VideoTilePlaceholder_snippet_onRenderPlaceholder})})};VideoTilePlaceholder_snippet_VideoTilePlaceholderExample.displayName="VideoTilePlaceholderExample",VideoTilePlaceholder_snippet_VideoTilePlaceholderExample.__docgenInfo={description:"",methods:[],displayName:"VideoTilePlaceholderExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/VideoTile/snippets/VideoTilePlaceholder.snippet.tsx"]={name:"VideoTilePlaceholderExample",docgenInfo:VideoTilePlaceholder_snippet_VideoTilePlaceholderExample.__docgenInfo,path:"stories/VideoTile/snippets/VideoTilePlaceholder.snippet.tsx"});var VideoTileStylineExampleText=__webpack_require__(540).default,VideoTileExampleText=__webpack_require__(1475).default,VideoTilePlaceholderText=__webpack_require__(1476).default,VideoTile_stories_VideoTileStory=function VideoTileStory(args){var videoTileStyles={root:{height:args.height+"px",width:args.width+"px"}},videoStreams=Object(utils.a)(1),videoStreamElement=args.isVideoReady?videoStreams[0]:null;return Object(jsx_runtime.jsx)(src.v,{renderElement:args.isVideoReady?Object(jsx_runtime.jsx)(src.s,{videoStreamElement:videoStreamElement}):void 0,displayName:args.displayName,showMuteIndicator:args.showMuteIndicator,isMirrored:args.isMirrored,isMuted:args.isMuted,styles:videoTileStyles})};VideoTile_stories_VideoTileStory.displayName="VideoTileStory";var VideoTile=VideoTile_stories_VideoTileStory.bind({});__webpack_exports__.default={id:constants.a+"-videotile",title:constants.a+"/Video Tile",component:src.v,argTypes:{displayName:controlsUtils.a.displayName,showMuteIndicator:controlsUtils.a.showMuteIndicator,isVideoReady:controlsUtils.a.isVideoReady,isMirrored:controlsUtils.a.isVideoMirrored,isMuted:controlsUtils.a.isMuted,width:controlsUtils.a.videoTileWidth,height:controlsUtils.a.videoTileHeight,userId:controlsUtils.j,noVideoAvailableAriaLabel:controlsUtils.j,children:controlsUtils.j,styles:controlsUtils.j,renderElement:controlsUtils.j,onRenderPlaceholder:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"VideoTile"}),Object(jsx_runtime.jsx)(esm.c,{children:"The VideoTile component displays a static component or the available video stream of a participant."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"import { VideoTile } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.i,{children:"Default Usage"}),Object(jsx_runtime.jsx)(esm.c,{children:"The default VideoTile component shows a displayName and a Persona with the initials of `displayName` when no video is available."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:VideoTileExampleText,children:Object(jsx_runtime.jsx)(VideoTile_snippet_VideoTileExample,{})}),Object(jsx_runtime.jsx)(esm.i,{children:"Custom Placeholder"}),Object(jsx_runtime.jsx)(esm.c,{children:"A custom placeholder can be provided to override the default Persona avatar by providing a JSX element to the `placeholder` prop."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:VideoTilePlaceholderText,children:Object(jsx_runtime.jsx)(VideoTilePlaceholder_snippet_VideoTilePlaceholderExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Styling"}),Object(jsx_runtime.jsx)(esm.c,{children:"A VideoTile component can be styled just like other components using the `styles` property."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:VideoTileStylineExampleText,children:Object(jsx_runtime.jsx)(StylingVideoTile_snippet.a,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.v})]})}()}}}};VideoTile.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const videoTileStyles = {\n    root: {\n      height: `${args.height}px`,\n      width: `${args.width}px`\n    }\n  };\n\n  const videoStreams = useVideoStreams(1);\n  const videoStreamElement = args.isVideoReady ? videoStreams[0] : null;\n\n  return (\n    <VideoTileComponent\n      renderElement={args.isVideoReady ? <StreamMedia videoStreamElement={videoStreamElement} /> : undefined}\n      displayName={args.displayName}\n      showMuteIndicator={args.showMuteIndicator}\n      isMirrored={args.isMirrored}\n      isMuted={args.isMuted}\n      styles={videoTileStyles}\n    />\n  );\n}"}},VideoTile.parameters)},1507:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CustomDataModelExample",(function(){return CustomDataModelExample}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(50),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var src=__webpack_require__(123),Stack=__webpack_require__(99),react=__webpack_require__(0),constants=__webpack_require__(13),controlsUtils=__webpack_require__(6),CallCompositeDocs=__webpack_require__(218),communicationTokenCredential=(__webpack_require__(186),__webpack_require__(201)),jsx_runtime=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer=function CustomDataModelExampleContainer(props){var _useState2=_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];Object(react.useEffect)((function(){if(props.token&&props.locator){var callLocator=isTeamsMeetingLink(props.locator)?{meetingLink:props.locator}:{groupId:props.locator};(function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(src.d)({userId:{kind:"communicationUser",communicationUserId:props.userId.communicationUserId},displayName:props.displayName,credential:new communicationTokenCredential.a(props.token),locator:callLocator});case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(){return _ref.apply(this,arguments)}})()()}}),[props]),Object(react.useEffect)((function(){return function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(adapter){_context2.next=2;break}return _context2.abrupt("return");case 2:return _context2.next=4,adapter.leaveCall().catch((function(e){console.error("Failed to leave call",e)}));case 4:adapter.dispose();case 5:case"end":return _context2.stop()}}),_callee2)})))()}}),[adapter]);var onRenderAvatar=Object(react.useCallback)((function(onRenderAvatarprops,defaultOnRender){return onRenderAvatarprops.displayName=""+props.avatarInitials,defaultOnRender(onRenderAvatarprops)}),[props.avatarInitials]);return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:adapter&&Object(jsx_runtime.jsx)(src.a,{fluentTheme:props.fluentTheme,adapter:adapter,onRenderAvatar:onRenderAvatar,callInvitationURL:null==props?void 0:props.callInvitationURL})})},isTeamsMeetingLink=function isTeamsMeetingLink(link){return link.startsWith("https://teams.microsoft.com/l/meetup-join")};CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo={description:"",methods:[],displayName:"CustomDataModelExampleContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},locator:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},avatarInitials:{required:!0,tsType:{name:"string"},description:""},callInvitationURL:{required:!1,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"]={name:"CustomDataModelExampleContainer",docgenInfo:CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo,path:"stories/CallComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"});var Server_snippet=__webpack_require__(283),Utils=__webpack_require__(219);function CustomDataModelExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomDataModelExample_stories_slicedToArray(arr,i){return function CustomDataModelExample_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomDataModelExample_stories_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomDataModelExample_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomDataModelExample_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomDataModelExample_stories_arrayLikeToArray(o,minLen)}(arr,i)||function CustomDataModelExample_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomDataModelExample_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CustomDataModelExample_stories_CustomDataModelStory=function CustomDataModelStory(args,context){var _useState2=CustomDataModelExample_stories_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];return Object(react.useEffect)((function(){(function(){var _ref=function CustomDataModelExample_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomDataModelExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomDataModelExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!args.connectionString||!args.displayName){_context.next=7;break}return _context.next=3,Object(Server_snippet.a)(args.connectionString);case 3:newProps=_context.sent,setContainerProps(newProps),_context.next=8;break;case 7:setContainerProps(void 0);case 8:case"end":return _context.stop()}}),_callee)})));return function fetchContainerProps(){return _ref.apply(this,arguments)}})()()}),[args.connectionString,args.displayName]),Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:constants.f,children:containerProps?Object(jsx_runtime.jsx)(CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer,Object.assign({fluentTheme:context.theme,displayName:args.displayName,avatarInitials:args.avatarInitials},containerProps,{callInvitationURL:args.callInvitationURL})):Object(jsx_runtime.jsx)(Utils.a,{})})};CustomDataModelExample_stories_CustomDataModelStory.displayName="CustomDataModelStory";var CustomDataModelExample=CustomDataModelExample_stories_CustomDataModelStory.bind({});__webpack_exports__.default={id:constants.b+"-call-customdatamodelexample",title:constants.b+"/CallComposite/Custom Data Model Example",component:src.a,argTypes:Object.assign({connectionString:controlsUtils.a.connectionString,displayName:controlsUtils.a.displayName,avatarInitials:controlsUtils.a.avatarInitials,callInvitationURL:controlsUtils.a.callInvitationURL},controlsUtils.b),parameters:{docs:{page:function page(){return Object(CallCompositeDocs.a)()}}}};CustomDataModelExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const [containerProps, setContainerProps] = useState();\n\n  useEffect(() => {\n    const fetchContainerProps = async (): Promise<void> => {\n      if (args.connectionString && args.displayName) {\n        const newProps = await createUserAndGroup(args.connectionString);\n        setContainerProps(newProps);\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchContainerProps();\n  }, [args.connectionString, args.displayName]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <CustomDataModelExampleContainer\n          fluentTheme={context.theme}\n          displayName={args.displayName}\n          avatarInitials={args.avatarInitials}\n          {...containerProps}\n          callInvitationURL={args.callInvitationURL}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},CustomDataModelExample.parameters)},1508:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CustomBehaviorExample",(function(){return CustomBehaviorExample}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(50),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var src=__webpack_require__(123),Stack=__webpack_require__(99),react=__webpack_require__(0),constants=__webpack_require__(13),controlsUtils=__webpack_require__(6),ChatCompositeDocs=__webpack_require__(180),identifierModels=__webpack_require__(329),communicationTokenCredential=__webpack_require__(201),jsx_runtime=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CustomBehaviorExampleContainer_ContosoChatContainer=function ContosoChatContainer(props){var _useState2=_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];return Object(react.useEffect)((function(){props&&function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var newAdapter,superSendMessage;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(src.e)({endpointUrl:props.endpointUrl,userId:Object(identifierModels.a)(props.userId),displayName:props.displayName,credential:new communicationTokenCredential.a(props.token),threadId:props.threadId});case 2:newAdapter=_context2.sent,superSendMessage=newAdapter.sendMessage.bind(newAdapter),newAdapter.sendMessage=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(content){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,superSendMessage(content.toUpperCase());case 2:case"end":return _context.stop()}}),_callee)})));return function(_x){return _ref2.apply(this,arguments)}}(),setAdapter(newAdapter);case 6:case"end":return _context2.stop()}}),_callee2)})));return function createAdapter(){return _ref.apply(this,arguments)}}()()}),[props]),Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:adapter?Object(jsx_runtime.jsx)(src.b,{fluentTheme:props.fluentTheme,adapter:adapter}):Object(jsx_runtime.jsx)("h3",{children:"Loading..."})})};CustomBehaviorExampleContainer_ContosoChatContainer.__docgenInfo={description:"",methods:[],displayName:"ContosoChatContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},threadId:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/CustomBehaviorExampleContainer.tsx"]={name:"ContosoChatContainer",docgenInfo:CustomBehaviorExampleContainer_ContosoChatContainer.__docgenInfo,path:"stories/ChatComposite/CustomBehaviorExampleContainer.tsx"});var Server_snippet=__webpack_require__(220),Utils=__webpack_require__(133);function CustomBehavior_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomBehavior_stories_slicedToArray(arr,i){return function CustomBehavior_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomBehavior_stories_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomBehavior_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomBehavior_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomBehavior_stories_arrayLikeToArray(o,minLen)}(arr,i)||function CustomBehavior_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomBehavior_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var messageArray=["Welcome to an example on how to add powerful customizations to the ChatComposite","In this example, Contoso intercepts the messages being sent by the local user and CAPITALIZES THEM ALL.","The adapter pattern allows for very powerful customizations, should you need them.","Have fun!"],CustomBehavior_stories_CustomBehaviorStory=function CustomBehaviorStory(args,context){var _useState2=CustomBehavior_stories_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];return Object(react.useEffect)((function(){(function(){var _ref=function CustomBehavior_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomBehavior_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomBehavior_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newProps;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!args.connectionString||!args.displayName){_context.next=9;break}return _context.next=3,Object(Server_snippet.a)(args.connectionString,args.displayName);case 3:return newProps=_context.sent,_context.next=6,Object(Utils.c)(args.connectionString,newProps.token,newProps.threadId,messageArray);case 6:setContainerProps(newProps),_context.next=10;break;case 9:setContainerProps(void 0);case 10:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.connectionString,args.displayName]),Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:constants.f,children:containerProps?Object(jsx_runtime.jsx)(CustomBehaviorExampleContainer_ContosoChatContainer,Object.assign({fluentTheme:context.theme},containerProps)):Object(jsx_runtime.jsx)(Utils.a,{})})};CustomBehavior_stories_CustomBehaviorStory.displayName="CustomBehaviorStory";var CustomBehaviorExample=CustomBehavior_stories_CustomBehaviorStory.bind({});__webpack_exports__.default={id:constants.b+"-chat-custombehaviorexample",title:constants.b+"/ChatComposite/Custom Behavior Example",component:src.b,argTypes:Object.assign({connectionString:controlsUtils.a.connectionString,displayName:controlsUtils.a.displayName},controlsUtils.c),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(ChatCompositeDocs.a)()}}}};CustomBehaviorExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const [containerProps, setContainerProps] = useState<ContainerProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.connectionString && args.displayName) {\n        const newProps = await createUserAndThread(args.connectionString, args.displayName);\n        await addParrotBotToThread(args.connectionString, newProps.token, newProps.threadId, messageArray);\n        setContainerProps(newProps);\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.connectionString, args.displayName]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? <ContosoChatContainer fluentTheme={context.theme} {...containerProps} /> : <ConfigHintBanner />}\n    </Stack>\n  );\n}'}},CustomBehaviorExample.parameters)},1509:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CustomDataModelExample",(function(){return CustomDataModelExample}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(50),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var src=__webpack_require__(36),react_composites_src=__webpack_require__(123),Stack=__webpack_require__(99),react=__webpack_require__(0),constants=__webpack_require__(13),controlsUtils=__webpack_require__(6),ChatCompositeDocs=__webpack_require__(180),identifierModels=__webpack_require__(329),communicationTokenCredential=__webpack_require__(201),jsx_runtime=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer=function CustomDataModelExampleContainer(props){var _useState2=_slicedToArray(Object(react.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];Object(react.useEffect)((function(){props&&function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(react_composites_src.e)({endpointUrl:props.endpointUrl,userId:Object(identifierModels.a)(props.userId),displayName:props.displayName,credential:new communicationTokenCredential.a(props.token),threadId:props.threadId});case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(){return _ref.apply(this,arguments)}}()()}),[props]);var onRenderAvatar=Object(react.useCallback)((function(userId){return userId===props.botUserId?Object(jsx_runtime.jsx)("label",{children:props.botAvatar}):Object(jsx_runtime.jsx)("label",{children:"?"})}),[props.botUserId,props.botAvatar]);return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:adapter?Object(jsx_runtime.jsx)(react_composites_src.b,{fluentTheme:props.fluentTheme,adapter:adapter,onRenderAvatar:onRenderAvatar,options:{showParticipantPane:!0,showTopic:!0}}):Object(jsx_runtime.jsx)("h3",{children:"Loading..."})})};CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo={description:"",methods:[],displayName:"CustomDataModelExampleContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},threadId:{required:!0,tsType:{name:"string"},description:""},botUserId:{required:!0,tsType:{name:"string"},description:""},botAvatar:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"]={name:"CustomDataModelExampleContainer",docgenInfo:CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer.__docgenInfo,path:"stories/ChatComposite/snippets/CustomDataModelExampleContainer.snippet.tsx"});var Server_snippet=__webpack_require__(220),Utils=__webpack_require__(133);function CustomDataModelExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CustomDataModelExample_stories_slicedToArray(arr,i){return function CustomDataModelExample_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CustomDataModelExample_stories_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CustomDataModelExample_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CustomDataModelExample_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CustomDataModelExample_stories_arrayLikeToArray(o,minLen)}(arr,i)||function CustomDataModelExample_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CustomDataModelExample_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var messageArray=["Welcome to the custom data model example!","Your display name is shown in the participant list, so is mine: A simple bot.","Additionally, you can change my avatar from the default Robot symbol to furrier creatures.","Have fun!"],CustomDataModelExample_stories_CustomDataModelStory=function CustomDataModelStory(args,context){var _useState2=CustomDataModelExample_stories_slicedToArray(Object(react.useState)(),2),containerProps=_useState2[0],setContainerProps=_useState2[1];return Object(react.useEffect)((function(){(function(){var _ref=function CustomDataModelExample_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CustomDataModelExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CustomDataModelExample_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){var newPrerequisites,botUserToken;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!args.connectionString||!args.displayName){_context.next=10;break}return _context.next=3,Object(Server_snippet.a)(args.connectionString,args.displayName);case 3:return newPrerequisites=_context.sent,_context.next=6,Object(Utils.c)(args.connectionString,newPrerequisites.token,newPrerequisites.threadId,messageArray);case 6:botUserToken=_context.sent,setContainerProps(Object.assign({},newPrerequisites,{botUserId:Object(src.d)(botUserToken.user)})),_context.next=11;break;case 10:setContainerProps(void 0);case 11:case"end":return _context.stop()}}),_callee)})));return function fetchToken(){return _ref.apply(this,arguments)}})()()}),[args.connectionString,args.displayName]),Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"center",verticalAlign:"center",styles:constants.f,children:containerProps?Object(jsx_runtime.jsx)(CustomDataModelExampleContainer_snippet_CustomDataModelExampleContainer,Object.assign({fluentTheme:context.theme},containerProps,{botAvatar:Object(controlsUtils.h)(args.avatar)})):Object(jsx_runtime.jsx)(Utils.a,{})})};CustomDataModelExample_stories_CustomDataModelStory.displayName="CustomDataModelStory";var CustomDataModelExample=CustomDataModelExample_stories_CustomDataModelStory.bind({});__webpack_exports__.default={id:constants.b+"-chat-customdatamodelexample",title:constants.b+"/ChatComposite/Custom Data Model Example",component:react_composites_src.b,argTypes:Object.assign({connectionString:controlsUtils.a.connectionString,displayName:controlsUtils.a.displayName,avatar:controlsUtils.a.botAvatar},controlsUtils.c),parameters:{useMaxHeightParent:!0,useMaxWidthParent:!0,docs:{page:function page(){return Object(ChatCompositeDocs.a)()}}}};CustomDataModelExample.parameters=Object.assign({storySource:{source:'(args, context): JSX.Element => {\n  const [containerProps, setContainerProps] = useState<CustomDataModelExampleContainerProps>();\n\n  useEffect(() => {\n    const fetchToken = async (): Promise<void> => {\n      if (args.connectionString && args.displayName) {\n        const newPrerequisites = await createUserAndThread(args.connectionString, args.displayName);\n        const botUserToken = await addParrotBotToThread(\n          args.connectionString,\n          newPrerequisites.token,\n          newPrerequisites.threadId,\n          messageArray\n        );\n        setContainerProps({\n          ...newPrerequisites,\n          botUserId: toFlatCommunicationIdentifier(botUserToken.user)\n        });\n      } else {\n        setContainerProps(undefined);\n      }\n    };\n    fetchToken();\n  }, [args.connectionString, args.displayName]);\n\n  return (\n    <Stack horizontalAlign="center" verticalAlign="center" styles={compositeExperienceContainerStyle}>\n      {containerProps ? (\n        <CustomDataModelExampleContainer\n          fluentTheme={context.theme}\n          {...containerProps}\n          botAvatar={getControlledBotAvatarSymbol(args.avatar)}\n        />\n      ) : (\n        <ConfigHintBanner />\n      )}\n    </Stack>\n  );\n}'}},CustomDataModelExample.parameters)},1510:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"DeviceSettings",(function(){return DeviceSettings}));__webpack_require__(50),__webpack_require__(10);var Stack=__webpack_require__(99),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),src=(__webpack_require__(34),__webpack_require__(24)),Dropdown=__webpack_require__(1695),jsx_runtime=__webpack_require__(1),DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample=function DeviceSettingDropdownExample(_ref){var devices=_ref.devices,onChange=_ref.onChange,theme=Object(src.D)();return Object(jsx_runtime.jsx)(src.f,{fluentTheme:theme,children:Object(jsx_runtime.jsx)(Dropdown.a,{style:{width:"15rem",overflow:"hidden"},placeholder:"Select an option",onChange:onChange,options:devices.map((function(device){return{selected:!1,key:device,text:device}}))})})};DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample.displayName="DeviceSettingDropdownExample",DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample.__docgenInfo={description:"",methods:[],displayName:"DeviceSettingDropdownExample",props:{devices:{required:!0,tsType:{name:"Array",elements:[{name:"string"}],raw:"string[]"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(event: React.FormEvent<HTMLDivElement>, option?: IDropdownOption, index?: number) => void",signature:{arguments:[{name:"event",type:{name:"ReactFormEvent",raw:"React.FormEvent<HTMLDivElement>",elements:[{name:"HTMLDivElement"}]}},{name:"option",type:{name:"IDropdownOption"}},{name:"index",type:{name:"number"}}],return:{name:"void"}}},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/DevicesDropdown/snippets/DeviceSettingsDropdown.snippet.tsx"]={name:"DeviceSettingDropdownExample",docgenInfo:DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample.__docgenInfo,path:"stories/Examples/DevicesDropdown/snippets/DeviceSettingsDropdown.snippet.tsx"});var DevicesDropdownExampleText=__webpack_require__(1430).default,cameraOptions=["Logitech C920S HD Pro Webcam","Lenovo Essential FHD Webcam","Aukey PC-LM1E Full HD Webcam","AVerMedia PW315","Razer Kiyo"],DeviceSettingsDropDown_stories_DeviceSettingsStory=function DeviceSettingsStory(){return Object(jsx_runtime.jsx)(Stack.a,{children:Object(jsx_runtime.jsx)(DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample,{devices:cameraOptions,onChange:function onChange(_,option){alert(null==option?void 0:option.text)}})})};DeviceSettingsDropDown_stories_DeviceSettingsStory.displayName="DeviceSettingsStory";var DeviceSettings=DeviceSettingsDropDown_stories_DeviceSettingsStory.bind({});__webpack_exports__.default={id:constants.c+"-devicesettings",title:constants.c+"/Device Settings",component:DeviceSettings,parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"Device Setting"}),Object(jsx_runtime.jsx)(esm.d,{children:"Create a dropdown of cameras to select"}),Object(jsx_runtime.jsx)(esm.c,{children:"To build a UI component for device settings, we recommend using the Fluent UI [Dropdown](https://developer.microsoft.com/en-us/fluentui#/controls/web/dropdown). Using the retrieved devices from the calling sdk, apply the devices as options in the dropdown. When a user selects an element from the dropdown, use the `onChange` callback to save the result. For this case we are just going to use an array of placeholder cameras (strings) and we are going to demonstrate how to use a FluentUI `Dropdown` to create a list of devices for a user to select."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:DevicesDropdownExampleText,children:Object(jsx_runtime.jsx)(DeviceSettingsDropdown_snippet_DeviceSettingDropdownExample,{devices:cameraOptions,onChange:function onChange(_,option){alert(null==option?void 0:option.text)}})})]})}()}}}};DeviceSettings.parameters=Object.assign({storySource:{source:"() => {\n  return (\n    <Stack>\n      <DeviceSettingDropdownExample\n        devices={cameraOptions}\n        onChange={(_, option) => {\n          alert(option?.text);\n        }}\n      />\n    </Stack>\n  );\n}"}},DeviceSettings.parameters)},1511:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"LocalPreview",(function(){return LocalPreview}));__webpack_require__(10),__webpack_require__(50);var esm=__webpack_require__(5),react=__webpack_require__(0),constants=__webpack_require__(13),controlsUtils=__webpack_require__(6),src=(__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(9),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29),__webpack_require__(24)),lib=__webpack_require__(20),Stack=__webpack_require__(99),Text=__webpack_require__(1711),VideoOff20Filled=__webpack_require__(1674),utils=__webpack_require__(155),jsx_runtime=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var LocalPreviewExample_snippet_LocalPreviewExample=function LocalPreviewExample(_ref){var isVideoAvailable=_ref.isVideoAvailable,isCameraEnabled=_ref.isCameraEnabled,isMicrophoneEnabled=_ref.isMicrophoneEnabled,_useState2=_slicedToArray(Object(react.useState)(!0),2),microphone=_useState2[0],setMicrophone=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(!0),2),camera=_useState4[0],setCamera=_useState4[1],theme=Object(src.D)(),palette=theme.palette,localPreviewContainerStyle=Object(lib.G)({minWidth:"25rem",width:"100%",height:"100%",maxHeight:"18.75rem",minHeight:"16.875rem",margin:"0 auto",background:palette.neutralLighter,color:palette.neutralTertiary}),cameraOffLabelStyle=Object(lib.G)({fontFamily:"Segoe UI Regular",fontSize:"0.625rem",color:palette.neutralTertiary}),renderCameraOffPlaceholder=Object(react.useCallback)((function(){return Object(jsx_runtime.jsxs)(Stack.a,{style:{width:"100%",height:"100%"},verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(VideoOff20Filled.a,{primaryFill:"currentColor"})}),Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(Text.a,{className:cameraOffLabelStyle,children:"Your camera is turned off"})})]})}),[cameraOffLabelStyle]),videoStreams=Object(utils.a)(1),videoStreamElement=isVideoAvailable?videoStreams[0]:null;return Object(jsx_runtime.jsx)(src.f,{fluentTheme:theme,children:Object(jsx_runtime.jsx)(Stack.a,{style:{width:"100%",height:"100%"},verticalAlign:"center",children:Object(jsx_runtime.jsx)(Stack.a.Item,{align:"center",children:Object(jsx_runtime.jsx)(Stack.a,{className:localPreviewContainerStyle,children:Object(jsx_runtime.jsx)(src.v,{styles:{root:{minHeight:"14rem"}},renderElement:isVideoAvailable&&isCameraEnabled&&camera?Object(jsx_runtime.jsx)(src.s,{videoStreamElement:videoStreamElement}):void 0,onRenderPlaceholder:renderCameraOffPlaceholder,children:Object(jsx_runtime.jsxs)(src.b,{layout:"floatingBottom",children:[Object(jsx_runtime.jsx)(src.a,{disabled:!isCameraEnabled,checked:!!isCameraEnabled&&camera,onClick:function onClick(){return setCamera(!camera)}}),Object(jsx_runtime.jsx)(src.l,{disabled:!isMicrophoneEnabled,checked:!!isMicrophoneEnabled&&microphone,onClick:function onClick(){return setMicrophone(!microphone)}})]})})})})})})};LocalPreviewExample_snippet_LocalPreviewExample.displayName="LocalPreviewExample",LocalPreviewExample_snippet_LocalPreviewExample.__docgenInfo={description:"",methods:[],displayName:"LocalPreviewExample",props:{isVideoAvailable:{required:!0,tsType:{name:"boolean"},description:""},isCameraEnabled:{required:!0,tsType:{name:"boolean"},description:""},isMicrophoneEnabled:{required:!0,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/LocalPreview/snippets/LocalPreviewExample.snippet.tsx"]={name:"LocalPreviewExample",docgenInfo:LocalPreviewExample_snippet_LocalPreviewExample.__docgenInfo,path:"stories/Examples/LocalPreview/snippets/LocalPreviewExample.snippet.tsx"});var LocalPreviewExampleText=__webpack_require__(1437).default,LocalPreview_stories_LocalPreviewStory=function LocalPreviewStory(args){return Object(jsx_runtime.jsx)(LocalPreviewExample_snippet_LocalPreviewExample,Object.assign({},args))};LocalPreview_stories_LocalPreviewStory.displayName="LocalPreviewStory";var LocalPreview=LocalPreview_stories_LocalPreviewStory.bind({});__webpack_exports__.default={id:constants.c+"-localpreview",title:constants.c+"/Local Preview",component:LocalPreview,argTypes:{isVideoAvailable:controlsUtils.a.isVideoAvailable,isCameraEnabled:controlsUtils.a.isCameraEnabled,isMicrophoneEnabled:controlsUtils.a.isMicrophoneEnabled},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"Local Preview"}),Object(jsx_runtime.jsx)(esm.d,{children:"Basic example"}),Object(jsx_runtime.jsx)(esm.c,{children:"To build a local preview, we recommend using the Fluent UI [Stack](https://developer.microsoft.com/en-us/fluentui#/controls/web/stack) as a container as shown in the code below. For enabling and disabling the camera or microphone we suggest using the [Toggle](https://developer.microsoft.com/en-us/fluentui#/controls/web/toggle) component. The area for showing your local preview is a [VideoTile](./?path=/docs/ui-components-videotile--video-tile) which can also be used in our video grid layouts."}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: In the code example, all `%` characters were replaced by their unicode value `\\u0025` due to URI malformed issue when loading the storybook snippets"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:LocalPreviewExampleText,children:Object(jsx_runtime.jsx)("div",{style:{height:"17.188rem"},children:Object(jsx_runtime.jsx)(LocalPreviewExample_snippet_LocalPreviewExample,{isVideoAvailable:!0,isCameraEnabled:!0,isMicrophoneEnabled:!0})})})]})}()}}}};LocalPreview.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return <LocalPreviewExample {...args} />;\n}"}},LocalPreview.parameters)},1512:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"ComplianceBanner",(function(){return ComplianceBanner_stories_ComplianceBanner}));__webpack_require__(50),__webpack_require__(10),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(9),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var Stack=__webpack_require__(99),PrimaryButton=__webpack_require__(1666),react=__webpack_require__(0),constants=__webpack_require__(13),Link=__webpack_require__(1705),MessageBar=__webpack_require__(1707),jsx_runtime=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ComplianceBanner_snippet_ComplianceBanner=function ComplianceBanner(props){var _useState2=_slicedToArray(Object(react.useState)(!1),2),previousCallTranscribeState=_useState2[0],setPreviousCallTranscribeState=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(!1),2),previousCallRecordState=_useState4[0],setPreviousCallRecordState=_useState4[1],_useState6=_slicedToArray(Object(react.useState)(0),2),variant=_useState6[0],setVariant=_useState6[1],callTranscribeState=props.callTranscribeState,callRecordState=props.callRecordState;function PrivacyPolicy(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://privacy.microsoft.com/en-US/privacystatement#mainnoticetoendusersmodule",target:"_blank",underline:!0,children:"Privacy policy"})}function LearnMore(){return Object(jsx_runtime.jsx)(Link.a,{href:"https://support.microsoft.com/en-us/office/record-a-meeting-in-teams-34dfbe7f-b07d-4a27-b4c6-de62f1348c24",target:"_blank",underline:!0,children:"Learn more"})}return Object(react.useEffect)((function(){previousCallRecordState&&previousCallTranscribeState?setVariant(callRecordState&&!callTranscribeState?1:!callRecordState&&callTranscribeState?2:callRecordState||callTranscribeState?0:3):previousCallRecordState&&!previousCallTranscribeState?setVariant(callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?5:callRecordState||callTranscribeState?0:6):!previousCallRecordState&&previousCallTranscribeState?setVariant(callRecordState&&callTranscribeState?4:!callRecordState&&callTranscribeState?7:callRecordState||callTranscribeState?0:8):previousCallRecordState||previousCallTranscribeState||setVariant(callRecordState&&callTranscribeState?4:callRecordState&&!callTranscribeState?7:!callRecordState&&callTranscribeState?5:0),setPreviousCallTranscribeState(callTranscribeState),setPreviousCallRecordState(callRecordState)}),[callTranscribeState,callRecordState]),0===variant?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Object(jsx_runtime.jsx)(MessageBar.a,{onDismiss:function onDismiss(){setVariant(0)},dismissButtonAriaLabel:"Close",children:function getBannerMessage(variant){switch(variant){case 1:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has stopped."})," You are now only recording this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 2:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has stopped."})," You are now only transcribing this meeting.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 3:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription are being saved. "})," Recording and transcription have stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 4:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording and transcription have started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 5:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 6:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording is being saved."})," Recording has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]});case 7:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Recording has started."})," By joining, you are giving consent for this meeting to be transcribed.",Object(jsx_runtime.jsx)(PrivacyPolicy,{})]});case 8:return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)("b",{children:"Transcription is being saved."})," Transcription has stopped.",Object(jsx_runtime.jsx)(LearnMore,{})]})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}(variant)})};ComplianceBanner_snippet_ComplianceBanner.__docgenInfo={description:"",methods:[],displayName:"ComplianceBanner",props:{callTranscribeState:{required:!1,tsType:{name:"boolean"},description:""},callRecordState:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/TeamsInterop/snippets/ComplianceBanner.snippet.tsx"]={name:"ComplianceBanner",docgenInfo:ComplianceBanner_snippet_ComplianceBanner.__docgenInfo,path:"stories/Examples/TeamsInterop/snippets/ComplianceBanner.snippet.tsx"});var TeamsInteropDocs=__webpack_require__(421);function ComplianceBanner_stories_slicedToArray(arr,i){return function ComplianceBanner_stories_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ComplianceBanner_stories_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ComplianceBanner_stories_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ComplianceBanner_stories_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ComplianceBanner_stories_arrayLikeToArray(o,minLen)}(arr,i)||function ComplianceBanner_stories_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ComplianceBanner_stories_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ComplianceBanner_stories_ComplianceBannerStory=function ComplianceBannerStory(){var _useState2=ComplianceBanner_stories_slicedToArray(Object(react.useState)({recordingEnabled:!1,transcriptionEnabled:!1}),2),teamsInterop=_useState2[0],setTeamsInterop=_useState2[1];return Object(jsx_runtime.jsxs)(Stack.a,{tokens:{childrenGap:"1rem"},style:{minWidth:"50%",minHeight:"50%"},children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:{childrenGap:"1rem"},children:[Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Toggle Recording",onClick:function toggleRecording(){setTeamsInterop({recordingEnabled:!teamsInterop.recordingEnabled,transcriptionEnabled:teamsInterop.transcriptionEnabled})}}),Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Toggle Transcription",onClick:function toggleTranscription(){setTeamsInterop({recordingEnabled:teamsInterop.recordingEnabled,transcriptionEnabled:!teamsInterop.transcriptionEnabled})}})]}),Object(jsx_runtime.jsx)(ComplianceBanner_snippet_ComplianceBanner,{callRecordState:teamsInterop.recordingEnabled,callTranscribeState:teamsInterop.transcriptionEnabled})]})};ComplianceBanner_stories_ComplianceBannerStory.displayName="ComplianceBannerStory";var ComplianceBanner_stories_ComplianceBanner=ComplianceBanner_stories_ComplianceBannerStory.bind({});__webpack_exports__.default={id:constants.c+"-teamsinterop-compliancebanner",title:constants.c+"/Teams Interop/Compliance Banner",component:ComplianceBanner_stories_ComplianceBanner,parameters:{docs:{page:function page(){return Object(TeamsInteropDocs.a)()}}}};ComplianceBanner_stories_ComplianceBanner.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  const [teamsInterop, setTeamsInterop] = useState({\n    recordingEnabled: false,\n    transcriptionEnabled: false\n  });\n\n  const toggleRecording = (): void => {\n    setTeamsInterop({\n      recordingEnabled: !teamsInterop.recordingEnabled,\n      transcriptionEnabled: teamsInterop.transcriptionEnabled\n    });\n  };\n\n  const toggleTranscription = (): void => {\n    setTeamsInterop({\n      recordingEnabled: teamsInterop.recordingEnabled,\n      transcriptionEnabled: !teamsInterop.transcriptionEnabled\n    });\n  };\n\n  // TODO: Fix dark theming.\n  // Once https://github.com/Azure/communication-ui-library/pull/169 lands, same fix should be applied here.\n  return (\n    <Stack tokens={{ childrenGap: '1rem' }} style={{ minWidth: '50%', minHeight: '50%' }}>\n      {/* We need to use these two buttons here to toggle recording and transcription.\n    Using storybook controls would trigger the whole story to do a fresh re-render, not just components inside the story. */}\n      <Stack horizontal tokens={{ childrenGap: '1rem' }}>\n        <PrimaryButton text=\"Toggle Recording\" onClick={toggleRecording} />\n        <PrimaryButton text=\"Toggle Transcription\" onClick={toggleTranscription} />\n      </Stack>\n      <Banner callRecordState={teamsInterop.recordingEnabled} callTranscribeState={teamsInterop.transcriptionEnabled} />\n    </Stack>\n  );\n}"}},ComplianceBanner_stories_ComplianceBanner.parameters)},1513:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Lobby",(function(){return Lobby_stories_Lobby}));__webpack_require__(10),__webpack_require__(50),__webpack_require__(0);var constants=__webpack_require__(13),controlsUtils=__webpack_require__(6),src=__webpack_require__(24),utils=__webpack_require__(155),jsx_runtime=__webpack_require__(1),Lobby_snippet_Lobby=function Lobby(props){var theme=Object(src.D)(),palette=theme.palette,ControlBarStyles={root:{background:theme.palette.white,minHeight:"4.25rem",alignItems:"center"}},videoStreams=Object(utils.a)(1),videoStreamElement=props.isVideoReady?videoStreams[0]:void 0,videoRenderElement=videoStreamElement?Object(jsx_runtime.jsx)(src.s,{videoStreamElement:videoStreamElement}):void 0;return Object(jsx_runtime.jsxs)(src.v,{styles:{root:{height:"100%",width:"100%"},overlayContainer:{}},isMirrored:!0,onRenderPlaceholder:function onRenderPlaceholder(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},renderElement:videoRenderElement,children:[Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",position:"absolute",background:props.isVideoReady?"#201f1e":palette.neutralLight,opacity:.75}}),Object(jsx_runtime.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",marginTop:"-2.125rem"},children:[Object(jsx_runtime.jsxs)("p",{style:{fontSize:"1.75rem",color:props.isVideoReady?"white":palette.neutralPrimary,textAlign:"center",margin:"0"},children:[" ",Object(jsx_runtime.jsx)("br",{})," ",props.callStateText," ",Object(jsx_runtime.jsx)("br",{})]}),Object(jsx_runtime.jsx)("p",{style:{fontSize:"0.75rem",color:props.isVideoReady?"white":palette.neutralPrimary,textAlign:"center",margin:"0"},children:props.callStateSubText})]}),Object(jsx_runtime.jsxs)(src.b,{layout:"dockedBottom",styles:ControlBarStyles,children:[Object(jsx_runtime.jsx)(src.a,{showLabel:!0,checked:!0}),Object(jsx_runtime.jsx)(src.l,{showLabel:!0,checked:!0}),Object(jsx_runtime.jsx)(src.m,{showLabel:!0}),Object(jsx_runtime.jsx)(src.d,{showLabel:!0,style:{borderRadius:"0.25rem",marginLeft:"0.25rem"}})]})]})};Lobby_snippet_Lobby.displayName="Lobby",Lobby_snippet_Lobby.__docgenInfo={description:"",methods:[],displayName:"Lobby",props:{isVideoReady:{required:!0,tsType:{name:"boolean"},description:""},callStateText:{required:!0,tsType:{name:"string"},description:""},callStateSubText:{required:!0,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/TeamsInterop/snippets/Lobby.snippet.tsx"]={name:"Lobby",docgenInfo:Lobby_snippet_Lobby.__docgenInfo,path:"stories/Examples/TeamsInterop/snippets/Lobby.snippet.tsx"});var TeamsInteropDocs=__webpack_require__(421),Lobby_stories_LobbyStory=function LobbyStory(args){return Object(jsx_runtime.jsx)(Lobby_snippet_Lobby,Object.assign({},args))};Lobby_stories_LobbyStory.displayName="LobbyStory";var Lobby_stories_Lobby=Lobby_stories_LobbyStory.bind({});__webpack_exports__.default={id:constants.c+"-teamsinterop-lobby",title:constants.c+"/Teams Interop/Lobby",component:Lobby_stories_Lobby,argTypes:{callStateText:controlsUtils.a.callStateText,callStateSubText:controlsUtils.a.callStateSubText,isVideoReady:controlsUtils.a.isVideoReady},parameters:{docs:{page:function page(){return Object(TeamsInteropDocs.a)()}}}};Lobby_stories_Lobby.parameters=Object.assign({storySource:{source:"(args) => {\n  return <LobbyComponent {...args} />;\n}"}},Lobby_stories_Lobby.parameters)},1514:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Teams",(function(){return Teams}));__webpack_require__(50),__webpack_require__(10);var esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),src=__webpack_require__(24),lib=__webpack_require__(20),Stack=__webpack_require__(99),jsx_runtime=__webpack_require__(1),teamsTheme={palette:{themePrimary:"#4b53bc",themeLighterAlt:"#030308",themeLighter:"#0c0d1e",themeLight:"#171939",themeTertiary:"#2d3271",themeSecondary:"#4249a6",themeDarkAlt:"#5a61c3",themeDark:"#6f76cd",themeDarker:"#9196da",neutralLighterAlt:"#1e1e1e",neutralLighter:"#1d1d1d",neutralLight:"#1c1c1c",neutralQuaternaryAlt:"#1a1a1a",neutralQuaternary:"#191919",neutralTertiaryAlt:"#181818",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#1f1f1f"}},TeamsTheme_snippet_TeamsTheme=function TeamsTheme(){return Object(jsx_runtime.jsx)("div",{style:{width:"100%",height:"100%",maxWidth:"50rem",maxHeight:"30rem"},children:Object(jsx_runtime.jsx)(src.f,{fluentTheme:teamsTheme,children:Object(jsx_runtime.jsx)(TeamsTheme_snippet_App,{})})})};TeamsTheme_snippet_TeamsTheme.displayName="TeamsTheme";var TeamsTheme_snippet_App=function App(){var theme=Object(src.D)(),headerContainer=Object(lib.G)({width:"100%",height:"3.875rem",overflow:"hidden",flexDirection:"row",justifyContent:"flex-end",alignItems:"center",marginBottom:2,background:theme.palette.white}),teamsButtonStyle={root:{minWidth:"2.75rem"},rootHovered:{color:theme.palette.themePrimary,background:"none"}},videoTileStyle={root:{background:theme.palette.white}};return Object(jsx_runtime.jsxs)(Stack.a,{style:{height:"100%",width:"100%",background:theme.palette.neutralQuaternaryAlt},children:[Object(jsx_runtime.jsx)(Stack.a,{className:headerContainer,children:Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsxs)(src.b,{styles:{root:{marginRight:".5rem",alignItems:"center"}},children:[Object(jsx_runtime.jsx)(src.a,{onClick:function onClick(){},styles:teamsButtonStyle}),Object(jsx_runtime.jsx)(src.l,{onClick:function onClick(){},styles:teamsButtonStyle}),Object(jsx_runtime.jsx)(src.q,{onClick:function onClick(){},styles:teamsButtonStyle}),Object(jsx_runtime.jsx)(src.d,{onClick:function onClick(){},showLabel:!0,onRenderText:function onRenderText(){return Object(jsx_runtime.jsx)("span",{style:{marginLeft:"0.5rem"},children:"Leave"},"endCallBtnTextKey")},styles:{root:{height:"2rem",minHeight:"2rem",width:"6.5rem",borderRadius:"0.125rem"}}})]})})}),Object(jsx_runtime.jsx)(src.g,{children:Object(jsx_runtime.jsx)(src.v,{displayName:"Michael",styles:videoTileStyle})})]})};TeamsTheme_snippet_App.displayName="App",TeamsTheme_snippet_TeamsTheme.__docgenInfo={description:"",methods:[],displayName:"TeamsTheme"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Themes/snippets/TeamsTheme.snippet.tsx"]={name:"TeamsTheme",docgenInfo:TeamsTheme_snippet_TeamsTheme.__docgenInfo,path:"stories/Examples/Themes/snippets/TeamsTheme.snippet.tsx"});var exampleTeamsTheme=__webpack_require__(1441).default,TeamsTheme_stories_TeamsStory=function TeamsStory(){return Object(jsx_runtime.jsx)(TeamsTheme_snippet_TeamsTheme,{})};TeamsTheme_stories_TeamsStory.displayName="TeamsStory";var Teams=TeamsTheme_stories_TeamsStory.bind({});__webpack_exports__.default={id:constants.c+"-themes-teams",title:constants.c+"/Themes/Teams",parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"Themes"}),Object(jsx_runtime.jsx)(esm.c,{children:"Example Themes that can be leveraged by developers to provide color schemes to UI Components"}),Object(jsx_runtime.jsx)(esm.d,{children:"Teams-Like Theme"}),Object(jsx_runtime.jsx)(esm.g,{code:exampleTeamsTheme})]})}()}}}};Teams.parameters=Object.assign({storySource:{source:"() => {\n  return <TeamsTheme />;\n}"}},Teams.parameters)},1515:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"GridLayout",(function(){return GridLayout}));__webpack_require__(73),__webpack_require__(34),__webpack_require__(50),__webpack_require__(10);var src=__webpack_require__(24),esm=__webpack_require__(5),react=__webpack_require__(0),constants=__webpack_require__(13),controlsUtils=__webpack_require__(6),utils=__webpack_require__(155),jsx_runtime=__webpack_require__(1),GridLayout_snippet_GridLayoutExample=function GridLayoutExample(){var videoTileStyles={root:{padding:"10px",border:"1px solid #999"}};return Object(jsx_runtime.jsx)("div",{style:{height:"530px",width:"830px"},children:Object(jsx_runtime.jsxs)(src.g,{children:[Object(jsx_runtime.jsx)(src.v,{styles:videoTileStyles,displayName:"Michael"}),Object(jsx_runtime.jsx)(src.v,{styles:videoTileStyles,displayName:"Jim"}),Object(jsx_runtime.jsx)(src.v,{styles:videoTileStyles,displayName:"Pam"}),Object(jsx_runtime.jsx)(src.v,{styles:videoTileStyles,displayName:"Dwight"})]})})};GridLayout_snippet_GridLayoutExample.displayName="GridLayoutExample",GridLayout_snippet_GridLayoutExample.__docgenInfo={description:"",methods:[],displayName:"GridLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/GridLayout/snippets/GridLayout.snippet.tsx"]={name:"GridLayoutExample",docgenInfo:GridLayout_snippet_GridLayoutExample.__docgenInfo,path:"stories/GridLayout/snippets/GridLayout.snippet.tsx"});var GridLayoutExampleText=__webpack_require__(1442).default,GridLayout_stories_GridLayoutStory=function GridLayoutStory(args){var videoStreamElements=Object(utils.a)(args.participants.filter((function(participant){return participant.isVideoReady})).length),participantsComponents=Object(react.useMemo)((function(){var videoStreamElementIndex=0;return args.participants.map((function(participant,index){var videoRenderElement=void 0;if(participant.isVideoReady){var videoStreamElement=videoStreamElements[videoStreamElementIndex];videoStreamElementIndex++,videoRenderElement=Object(jsx_runtime.jsx)(src.s,{videoStreamElement:videoStreamElement})}return Object(jsx_runtime.jsx)(src.v,{renderElement:videoRenderElement,displayName:participant.displayName},index)}))}),[args.participants,videoStreamElements]);return Object(jsx_runtime.jsx)("div",{style:{height:args.height+"px",width:args.width+"px"},children:Object(jsx_runtime.jsx)(src.g,{children:participantsComponents})})};GridLayout_stories_GridLayoutStory.displayName="GridLayoutStory";var GridLayout=GridLayout_stories_GridLayoutStory.bind({});__webpack_exports__.default={id:constants.a+"-gridlayout",title:constants.a+"/Grid Layout",component:src.g,argTypes:{width:controlsUtils.a.layoutWidth,height:controlsUtils.a.layoutHeight,participants:controlsUtils.a.gridParticipants,children:controlsUtils.j,layout:controlsUtils.j,styles:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"GridLayout"}),Object(jsx_runtime.jsx)(esm.c,{children:"The `GridLayout` organizes components passed to it as children in a grid layout. It can display a grid of call participants through the use of `VideoTile` component."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"\nimport { GridLayout, VideoTile } from '@azure/communication-react';\n"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.c,{children:"The following example shows how you can render `VideoTile` components inside a grid layout. For styling the children video tiles, please read the [VideoTile component docs](./?path=/docs/ui-components-videotile--video-tile)."}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:GridLayoutExampleText,children:Object(jsx_runtime.jsx)(GridLayout_snippet_GridLayoutExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.g})]})}()}}}};GridLayout.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  const videoStreamElements = useVideoStreams(\n    args.participants.filter((participant) => {\n      return participant.isVideoReady;\n    }).length\n  );\n\n  const participantsComponents = useMemo(() => {\n    let videoStreamElementIndex = 0;\n    return args.participants.map((participant, index) => {\n      let videoRenderElement: JSX.Element | undefined = undefined;\n      if (participant.isVideoReady) {\n        const videoStreamElement = videoStreamElements[videoStreamElementIndex];\n        videoStreamElementIndex++;\n        videoRenderElement = <StreamMedia videoStreamElement={videoStreamElement} />;\n      }\n      return <VideoTile renderElement={videoRenderElement} displayName={participant.displayName} key={index} />;\n    });\n  }, [args.participants, videoStreamElements]);\n\n  return (\n    <div\n      style={{\n        height: `${args.height}px`,\n        width: `${args.width}px`\n      }}\n    >\n      <GridLayoutComponent>{participantsComponents}</GridLayoutComponent>\n    </div>\n  );\n}"}},GridLayout.parameters)},1516:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"MessageStatusIndicator",(function(){return MessageStatusIndicator}));__webpack_require__(50),__webpack_require__(10);var src=__webpack_require__(24),esm=__webpack_require__(5),constants=(__webpack_require__(0),__webpack_require__(13)),controlsUtils=__webpack_require__(6),Stack=__webpack_require__(99),jsx_runtime=__webpack_require__(1),AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample=function DefaultMessageStatusIndicatorsExample(){return Object(jsx_runtime.jsxs)(Stack.a,{children:[Object(jsx_runtime.jsx)(src.j,{status:"delivered"}),Object(jsx_runtime.jsx)(src.j,{status:"seen"}),Object(jsx_runtime.jsx)(src.j,{status:"sending"}),Object(jsx_runtime.jsx)(src.j,{status:"failed"})]})};AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample.displayName="DefaultMessageStatusIndicatorsExample",AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample.__docgenInfo={description:"",methods:[],displayName:"DefaultMessageStatusIndicatorsExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MessageStatusIndicator/snippets/AllDefaultIndicators.snippet.tsx"]={name:"DefaultMessageStatusIndicatorsExample",docgenInfo:AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample.__docgenInfo,path:"stories/MessageStatusIndicator/snippets/AllDefaultIndicators.snippet.tsx"});var DefaultMessageStatusIndicatorsExampleText=__webpack_require__(1447).default,MessageStatusIndicator_stories_MessageStatusIndicatorStory=function MessageStatusIndicatorStory(args){return Object(jsx_runtime.jsx)(src.j,{status:args.status,strings:{deliveredTooltipText:args.deliveredTooltipText,sendingTooltipText:args.sendingTooltipText,seenTooltipText:args.seenTooltipText,failedToSendTooltipText:args.failedToSendTooltipText}})};MessageStatusIndicator_stories_MessageStatusIndicatorStory.displayName="MessageStatusIndicatorStory";var MessageStatusIndicator=MessageStatusIndicator_stories_MessageStatusIndicatorStory.bind({});__webpack_exports__.default={id:constants.a+"-messagestatusindicator",title:constants.a+"/Message Status Indicator",component:src.j,argTypes:{status:controlsUtils.a.messageStatus,deliveredTooltipText:controlsUtils.a.messageDeliveredTooltipText,sendingTooltipText:controlsUtils.a.messageSendingTooltipText,seenTooltipText:controlsUtils.a.messageSeenTooltipText,failedToSendTooltipText:controlsUtils.a.messageFailedToSendTooltipText,styles:controlsUtils.j,strings:controlsUtils.j},parameters:{docs:{page:function page(){return function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"MessageStatusIndicator"}),Object(jsx_runtime.jsx)(esm.c,{children:"MessageStatusIndicator is used to indicate whether a message has been read, delivered, currently sending, or failed to send."}),Object(jsx_runtime.jsx)(esm.d,{children:"Importing"}),Object(jsx_runtime.jsx)(esm.g,{code:"import { MessageStatus, MessageStatusIndicator } from '@azure/communication-react';"}),Object(jsx_runtime.jsx)(esm.d,{children:"Example"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:DefaultMessageStatusIndicatorsExampleText,children:Object(jsx_runtime.jsx)(AllDefaultIndicators_snippet_DefaultMessageStatusIndicatorsExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Props"}),Object(jsx_runtime.jsx)(esm.f,{of:src.j})]})}()}}}};MessageStatusIndicator.parameters=Object.assign({storySource:{source:"(args): JSX.Element => {\n  return (\n    <MessageStatusIndicatorComponent\n      status={args.status as MessageStatus}\n      strings={{\n        deliveredTooltipText: args.deliveredTooltipText,\n        sendingTooltipText: args.sendingTooltipText,\n        seenTooltipText: args.seenTooltipText,\n        failedToSendTooltipText: args.failedToSendTooltipText\n      }}\n    />\n  );\n}"}},MessageStatusIndicator.parameters)},155:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return useVideoStreams}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29),__webpack_require__(16),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(17),__webpack_require__(40);var react__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(0);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e3){didErr=!0,err=_e3},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var renderVideoStream=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(scalingMode){var _navigator$mediaDevic,video;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(null===(_navigator$mediaDevic=navigator.mediaDevices)||void 0===_navigator$mediaDevic||!_navigator$mediaDevic.getUserMedia){_context.next=16;break}return(video=document.createElement("video")).autoplay=!0,video.style.height="100%",video.style.width="100%",video.style.objectFit=null!=scalingMode?scalingMode:"cover",_context.prev=6,_context.next=9,navigator.mediaDevices.getUserMedia({video:!0});case 9:video.srcObject=_context.sent,_context.next=15;break;case 12:_context.prev=12,_context.t0=_context.catch(6),console.log("Unable to get stream for video",_context.t0);case 15:return _context.abrupt("return",video);case 16:return _context.abrupt("return",null);case 17:case"end":return _context.stop()}}),_callee,null,[[6,12]])})));return function renderVideoStream(_x){return _ref.apply(this,arguments)}}(),stopRenderVideoStream=function stopRenderVideoStream(video){if(video){var mediaProvider=video.srcObject;if(mediaProvider){var stream=mediaProvider;if(stream.getVideoTracks){var _step,_iterator=_createForOfIteratorHelper(stream.getVideoTracks());try{for(_iterator.s();!(_step=_iterator.n()).done;){_step.value.stop()}}catch(err){_iterator.e(err)}finally{_iterator.f()}}}}},useVideoStreams=function useVideoStreams(numberOfStreams){var mounted=Object(react__WEBPACK_IMPORTED_MODULE_12__.useRef)(!1);Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){return mounted.current=!0,function(){mounted.current=!1}}));var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_12__.useState)([]),2),videoStreamElements=_useState2[0],setVideoStreamElements=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){var newVideoStreamElements=[];(function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var i,videoStreamElement,_iterator2,_step2,_videoStreamElement;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:i=0;case 1:if(!(i<numberOfStreams)){_context2.next=9;break}return _context2.next=4,renderVideoStream();case 4:videoStreamElement=_context2.sent,newVideoStreamElements.push(videoStreamElement);case 6:i++,_context2.next=1;break;case 9:if(mounted.current)setVideoStreamElements(newVideoStreamElements);else{_iterator2=_createForOfIteratorHelper(newVideoStreamElements);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)_videoStreamElement=_step2.value,stopRenderVideoStream(_videoStreamElement)}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}case 10:case"end":return _context2.stop()}}),_callee2)})));return function loadVideos(){return _ref2.apply(this,arguments)}})()()}),[numberOfStreams]),Object(react__WEBPACK_IMPORTED_MODULE_12__.useEffect)((function(){return function(){var _step3,_iterator3=_createForOfIteratorHelper(videoStreamElements);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var videoStreamElement=_step3.value;stopRenderVideoStream(videoStreamElement)}}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}}),[videoStreamElements]),videoStreamElements}},169:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return COMPOSITE_STRING_CONNECTIONSTRING})),__webpack_require__.d(__webpack_exports__,"b",(function(){return CompositeConnectionParamsErrMessage}));__webpack_require__(34),__webpack_require__(0);var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),COMPOSITE_STRING_CONNECTIONSTRING="Connection String",CompositeConnectionParamsErrMessage=function CompositeConnectionParamsErrMessage(errors){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:errors.map((function(error){return error?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)("span",{children:error},error):null}))})};CompositeConnectionParamsErrMessage.__docgenInfo={description:"",methods:[],displayName:"CompositeConnectionParamsErrMessage"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CompositeStringUtils.tsx"]={name:"CompositeConnectionParamsErrMessage",docgenInfo:CompositeConnectionParamsErrMessage.__docgenInfo,path:"stories/CompositeStringUtils.tsx"})},180:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(0),__webpack_require__(1)),containerText=__webpack_require__(1393).default,customDataModelExampleContainerText=__webpack_require__(1394).default,customBehaviorExampleText=__webpack_require__(1395).default,serverText=__webpack_require__(1396).default,getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.j,{children:"ChatComposite"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"ChatComposite brings together key components to provide a full chat experience out of the box."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Basic usage"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"There are two parts to the composite - a `ChatComposite` react component and a `ChatAdapter` that connects the react component to the backend APIs."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"The key thing to note is that initialization of `ChatAdapter` is asynchronous. Thus, the initialization step requires special handling, as the example code below shows."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:containerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Prerequisites"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"ChatComposite provides the UI for an *existing user* in an *existing thread*. Thus, the user and thread must be created beforehand. Typically, the user and thread are created on a Contoso-owned service and authentication tokens are served to the client application that then passes it to the ChatComposite."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:serverText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Theming"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"ChatComposite can be themed with Fluent UI themes, just like the base components. Look at the [ChatComposite themes canvas](./?path=/story/composites-chat-themeexample--theme-example) to see theming in action or the [overall theming example](./?path=/story/theming--page) to see how theming works for all the components in this UI library."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Fonts"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"Custom fonts can be applied to the ChatComposite using the in built theming mechanism. Look at the [ChatComposite themes canvas](./?path=/story/composites-chat-themeexample--theme-example) to see custom fonts in action or the [overall theming example](./?path=/story/theming--page) to see how theming works for all the components in this UI library. Read more about fonts in [Fluent UI Typography here](https://developer.microsoft.com/en-us/fluentui#/styles/web/typography)."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Custom Data Model"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"It is a primary tenet of Azure Communication Services that customers bring their own user identities. Customers then use the Azure Communication Services identity service to create corresponding authentication tokens for their users. The ChatComposite allows developers to easily inject custom data associated with these user identities. Look at the [example canvas](./?path=/story/composites-chat-customdatamodelexample--custom-data-model-example) to see how the name and avatar displayed for users can be provided by Contoso."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:customDataModelExampleContainerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"See the [Custom data model example documentation](./?path=/docs/customuserdatamodel--page) to understand how custom data model can be injected for all the components in this UI library."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Customize Behavior"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"The `ChatAdapter` makes it possible to arbitrarily modify the communication between the `ChatComposite` component and the Azure Communication Services backend. This adds powerful customization possibilities. The [Customized Behavior Example](./?path=/story/composites-chat-custombehaviorexample--custom-behavior-example) shows a way to intercept messages entered by the user and modify them before sending them on to the backend."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:customBehaviorExampleText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Joining existing Chat"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"The [join existing chat thread](./?path=/story/composites-chat-joinexistingchatthread--join-existing-chat-thread) provides an easy playground to join an existing Azure Communication Services chat thread. This is useful if you want to explore the composite with multiple users."})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/ChatCompositeDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/ChatComposite/ChatCompositeDocs.tsx"})},218:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(0),__webpack_require__(1)),containerText=__webpack_require__(1387).default,serverText=__webpack_require__(1388).default,getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.j,{children:"CallComposite"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"CallComposite brings together key components to provide a full calling experience out of the box."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Basic usage"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"There are two parts to the composite - a `CallComposite` react component and a `CallAdapter` that connects the react component to the backend APIs."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"The key thing to note is that initialization of `CallAdapter` is asynchronous. Thus, the initialization step requires special handling, as the example code below shows."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:containerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Prerequisites"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"CallComposite provides the UI for an *existing user* to join a call. The user must be created beforehand. Typically, the user and group call or teams meeting are created on a Contoso-owned service and provided to the client application that then passes it to the CallComposite."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:serverText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Styling"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"CallComposite is designed to fill the space of the parent it is in. By default these examples put the composite in a container of a set height and width. If your composite is living outside of any parent container and you wish for it to fill the page, we recommend ensuring your react app is set to fill the screen by adding the following css to your primary css file:"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:"\nhtml,\nbody,\n#root {\n  height: 100%;\n}\n"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Theming"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"CallComposite can be themed with Fluent UI themes, just like the base components. Look at the [CallComposite theme example](./?path=/story/composites-call-themeexample--theme-example) to see theming in action or the [overall theming example](./?path=/docs/theming--page) to see how theming works for all the components in this UI library."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Fonts"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"Custom fonts can be applied to the CallComposite using the in built theming mechanism. Look at the [CallComposite themes canvas](./?path=/story/composites-call-themeexample--theme-example) to see custom fonts in action or the [overall theming example](./?path=/story/theming--page) to see how theming works for all the components in this UI library. Read more about fonts in [Fluent UI Typography](https://developer.microsoft.com/en-us/fluentui#/styles/web/typography)."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Joining an existing Call"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"The [join existing call](./?path=/story/composites-call-joinexistingcall--join-existing-call) provides an easy playground to join an existing Azure Communication Services group call or an existing Teams meeting. This is useful if you want to explore the composite with multiple users."})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/CallCompositeDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/CallComposite/CallCompositeDocs.tsx"})},219:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ConfigHintBanner})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ConfigJoinCallHintBanner}));__webpack_require__(0);var _CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(169),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),ConfigHintBanner=function ConfigHintBanner(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__.b)(["Please provide the connection string and display name to use."])})},ConfigJoinCallHintBanner=function ConfigJoinCallHintBanner(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__.b)(["Please provide a token, call locator, and display name to use."])})};ConfigHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/Utils.tsx"]={name:"ConfigHintBanner",docgenInfo:ConfigHintBanner.__docgenInfo,path:"stories/CallComposite/snippets/Utils.tsx"}),ConfigJoinCallHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigJoinCallHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/Utils.tsx"]={name:"ConfigJoinCallHintBanner",docgenInfo:ConfigJoinCallHintBanner.__docgenInfo,path:"stories/CallComposite/snippets/Utils.tsx"})},220:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createUserAndThread}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(90),__webpack_require__(87),__webpack_require__(179),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(93),__webpack_require__(53),__webpack_require__(83);var _azure_communication_chat__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(444),_azure_communication_common__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(201),_azure_communication_identity__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(445);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var createUserAndThread=function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(resourceConnectionString,displayName){var _yield$chatClient$cre,_yield$chatClient$cre2,tokenClient,user,endpointUrl,chatClient,threadId;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return tokenClient=new _azure_communication_identity__WEBPACK_IMPORTED_MODULE_13__.a(resourceConnectionString),_context.next=3,tokenClient.createUserAndToken(["chat"]);case 3:return user=_context.sent,endpointUrl=new URL(resourceConnectionString.replace("endpoint=","").split(";")[0]).toString(),chatClient=new _azure_communication_chat__WEBPACK_IMPORTED_MODULE_11__.a(endpointUrl,new _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__.a(user.token)),_context.next=8,chatClient.createChatThread({topic:"Chat with a friendly bot"},{participants:[{id:user.user,displayName:displayName}]});case 8:if(_context.t2=_yield$chatClient$cre2=_context.sent.chatThread,_context.t1=null===_context.t2,_context.t1){_context.next=12;break}_context.t1=void 0===_yield$chatClient$cre2;case 12:if(!_context.t1){_context.next=16;break}_context.t3=void 0,_context.next=17;break;case 16:_context.t3=_yield$chatClient$cre2.id;case 17:if(_context.t4=_yield$chatClient$cre=_context.t3,_context.t0=null!==_context.t4,!_context.t0){_context.next=21;break}_context.t0=void 0!==_yield$chatClient$cre;case 21:if(!_context.t0){_context.next=25;break}_context.t5=_yield$chatClient$cre,_context.next=26;break;case 25:_context.t5="";case 26:return threadId=_context.t5,_context.abrupt("return",{userId:user.user,token:user.token,endpointUrl:endpointUrl,displayName:displayName,threadId:threadId});case 28:case"end":return _context.stop()}}),_callee)})));return function createUserAndThread(_x,_x2){return _ref.apply(this,arguments)}}()},24:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"t",(function(){return TypingIndicator_TypingIndicator})),__webpack_require__.d(__webpack_exports__,"e",(function(){return ErrorBar_ErrorBar})),__webpack_require__.d(__webpack_exports__,"g",(function(){return GridLayout_GridLayout})),__webpack_require__.d(__webpack_exports__,"r",(function(){return SendBox_SendBox})),__webpack_require__.d(__webpack_exports__,"j",(function(){return MessageStatusIndicator_MessageStatusIndicator})),__webpack_require__.d(__webpack_exports__,"k",(function(){return MessageThread_MessageThread})),__webpack_require__.d(__webpack_exports__,"s",(function(){return StreamMedia_StreamMedia})),__webpack_require__.d(__webpack_exports__,"n",(function(){return ParticipantItem_ParticipantItem})),__webpack_require__.d(__webpack_exports__,"o",(function(){return ParticipantList_ParticipantList})),__webpack_require__.d(__webpack_exports__,"u",(function(){return VideoGallery_VideoGallery})),__webpack_require__.d(__webpack_exports__,"a",(function(){return CameraButton_CameraButton})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ControlBar_ControlBar})),__webpack_require__.d(__webpack_exports__,"c",(function(){return ControlBarButton_ControlBarButton})),__webpack_require__.d(__webpack_exports__,"d",(function(){return EndCallButton_EndCallButton})),__webpack_require__.d(__webpack_exports__,"l",(function(){return MicrophoneButton_MicrophoneButton})),__webpack_require__.d(__webpack_exports__,"m",(function(){return OptionsButton_OptionsButton})),__webpack_require__.d(__webpack_exports__,"p",(function(){return ParticipantsButton_ParticipantsButton})),__webpack_require__.d(__webpack_exports__,"q",(function(){return ScreenShareButton_ScreenShareButton})),__webpack_require__.d(__webpack_exports__,"v",(function(){return VideoTile_VideoTile})),__webpack_require__.d(__webpack_exports__,"i",(function(){return LocalizationProvider_LocalizationProvider})),__webpack_require__.d(__webpack_exports__,"z",(function(){return locales_en_US})),__webpack_require__.d(__webpack_exports__,"y",(function(){return locales_de_DE})),__webpack_require__.d(__webpack_exports__,"A",(function(){return locales_fr_FR})),__webpack_require__.d(__webpack_exports__,"w",(function(){return locales_ar_SA})),__webpack_require__.d(__webpack_exports__,"C",(function(){return namedLocales})),__webpack_require__.d(__webpack_exports__,"B",(function(){return lightTheme})),__webpack_require__.d(__webpack_exports__,"x",(function(){return darkTheme})),__webpack_require__.d(__webpack_exports__,"f",(function(){return FluentThemeProvider_FluentThemeProvider})),__webpack_require__.d(__webpack_exports__,"D",(function(){return FluentThemeProvider_useTheme})),__webpack_require__.d(__webpack_exports__,"h",(function(){return IdentifierProvider_IdentifierProvider}));__webpack_require__(166),__webpack_require__(77),__webpack_require__(73),__webpack_require__(10),__webpack_require__(21),__webpack_require__(9),__webpack_require__(14),__webpack_require__(29),__webpack_require__(16),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(15),__webpack_require__(17),__webpack_require__(40);var lib=__webpack_require__(20),typingIndicatorContainerStyle=Object(lib.G)({height:"2.125rem"}),typingIndicatorStringStyle=Object(lib.G)({fontWeight:400,whiteSpace:"pre",display:"flex",alignItems:"center"}),react=(Object(lib.G)({width:"2.125rem",height:"2.125rem",paddingRight:"0.1875rem"}),__webpack_require__(0)),react_default=__webpack_require__.n(react),Stack=__webpack_require__(99),en_US=__webpack_require__(405),jsx_runtime=__webpack_require__(1),LocaleContext=Object(react.createContext)({strings:en_US}),LocalizationProvider_LocalizationProvider=function LocalizationProvider(props){var locale=props.locale,children=props.children;return Object(jsx_runtime.jsx)(LocaleContext.Provider,{value:locale,children:children})};LocalizationProvider_LocalizationProvider.displayName="LocalizationProvider";var LocalizationProvider_useLocale=function useLocale(){return Object(react.useContext)(LocaleContext)};LocalizationProvider_LocalizationProvider.__docgenInfo={description:"@description Provider to provide localized strings for this library's react components.\n@remarks Components will be provided localized strings in English (US) by default if this\nprovider is not used",methods:[],displayName:"LocalizationProvider",props:{locale:{required:!0,tsType:{name:"Locale"},description:"Locale context to provide components"},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Children to provide locale context."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/localization/LocalizationProvider.tsx"]={name:"LocalizationProvider",docgenInfo:LocalizationProvider_LocalizationProvider.__docgenInfo,path:"../react-components/src/localization/LocalizationProvider.tsx"});__webpack_require__(841),__webpack_require__(53),__webpack_require__(90),__webpack_require__(83);var formatString=function formatString(str,vars){if(!str)return"";if(!vars)return str;return str.replace(/{(\w+)}/g,(function(_,k){return vars[k]||"{"+k+"}"}))},defaultIdentifiers={sendboxTextfield:"sendbox-textfield",participantList:"participant-list",messageContent:"message-content",messageTimestamp:"message-timestamp",typingIndicator:"typing-indicator",videoGallery:"video-gallery"},IdentifierContext=Object(react.createContext)(defaultIdentifiers),IdentifierProvider_IdentifierProvider=function IdentifierProvider(props){var identifiers=props.identifiers,children=props.children;return Object(jsx_runtime.jsx)(IdentifierContext.Provider,{value:null!=identifiers?identifiers:defaultIdentifiers,children:children})};IdentifierProvider_IdentifierProvider.displayName="IdentifierProvider";var IdentifierProvider_useIdentifiers=function useIdentifiers(){return Object(react.useContext)(IdentifierContext)};function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function F(){};return{s:F,n:function n(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function e(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function s(){it=it.call(o)},n:function n(){var step=it.next();return normalCompletion=step.done,step},e:function e(_e2){didErr=!0,err=_e2},f:function f(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}IdentifierProvider_IdentifierProvider.__docgenInfo={description:"",methods:[],displayName:"IdentifierProvider",props:{identifiers:{required:!1,tsType:{name:"Identifiers"},description:""},children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/identifiers/IdentifierProvider.tsx"]={name:"IdentifierProvider",docgenInfo:IdentifierProvider_IdentifierProvider.__docgenInfo,path:"../react-components/src/identifiers/IdentifierProvider.tsx"});var TypingIndicator_getUsersElement=function getUsersElement(typingUsers,delimiter,onRenderUser,styles){var userElements=[];return typingUsers.forEach((function(user,index){userElements.push(onRenderUser?onRenderUser(user):Object(jsx_runtime.jsx)("span",{children:user.displayName},"user-"+index)),userElements.push(Object(jsx_runtime.jsx)("span",{children:""+delimiter},"comma-"+index))})),userElements.pop(),Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,className:Object(lib.G)(typingIndicatorStringStyle,styles),children:userElements})};TypingIndicator_getUsersElement.displayName="getUsersElement";var TypingIndicator_getSpanElements=function getSpanElements(strings,usersElement,numTypingUsers,numTypingUsersAbbreviated){var variables={},typingString="";return 1===numTypingUsers?(typingString=strings.singleUser,variables={user:usersElement}):numTypingUsers>1&&0===numTypingUsersAbbreviated?(typingString=strings.multipleUsers,variables={users:usersElement}):numTypingUsers>1&&1===numTypingUsersAbbreviated?(typingString=strings.multipleUsersAbbreviateOne,variables={users:usersElement}):numTypingUsers>1&&numTypingUsersAbbreviated>1&&(typingString=strings.multipleUsersAbbreviateMany,variables={users:usersElement,numOthers:Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:numTypingUsersAbbreviated})}),function formatSpanElements(str,vars){if(!str)return[];if(!vars)return[];for(var elements=[],regex=RegExp(/{(\w+)}/g),array=regex.exec(str),prev=0,elementKey=1;null!==array;)prev!==array.index&&elements.push(Object(jsx_runtime.jsx)("span",{children:str.substring(prev,array.index)},elementKey++)),elements.push(Object(jsx_runtime.jsx)("span",{children:vars[array[0].substring(1,array[0].length-1)]},elementKey++)),prev=regex.lastIndex,array=regex.exec(str);return elements.push(Object(jsx_runtime.jsx)("span",{children:str.substring(prev)},elementKey++)),elements}(typingString,variables)},TypingIndicator_IndicatorComponent=function IndicatorComponent(typingUsers,strings,onRenderUser,styles){var _step,typingUsersMentioned=[],totalCharacterCount=0,ids=IdentifierProvider_useIdentifiers(),_iterator=_createForOfIteratorHelper(typingUsers);try{for(_iterator.s();!(_step=_iterator.n()).done;){var typingUser=_step.value;if(typingUser.displayName){var additionalCharCount=typingUser.displayName.length;if(typingUsersMentioned.length>0&&(additionalCharCount+=strings.delimiter.length),!(totalCharacterCount+additionalCharCount<=35||0===typingUsersMentioned.length))break;typingUsersMentioned.push(typingUser),totalCharacterCount+=additionalCharCount}}}catch(err){_iterator.e(err)}finally{_iterator.f()}var usersElement=TypingIndicator_getUsersElement(typingUsersMentioned,strings.delimiter,onRenderUser,null==styles?void 0:styles.typingUserDisplayName),numUserNotMentioned=typingUsers.length-typingUsersMentioned.length,spanElements=TypingIndicator_getSpanElements(strings,usersElement,typingUsersMentioned.length,numUserNotMentioned);return Object(jsx_runtime.jsx)(Stack.a,{horizontal:!0,"data-ui-id":ids.typingIndicator,className:Object(lib.G)(typingIndicatorStringStyle,null==styles?void 0:styles.typingString),children:spanElements},"typingStringKey")};TypingIndicator_IndicatorComponent.displayName="IndicatorComponent";var TypingIndicator_TypingIndicator=function TypingIndicator(props){var typingUsers=props.typingUsers,onRenderUser=props.onRenderUser,styles=props.styles,strings=LocalizationProvider_useLocale().strings,typingUsersToRender=typingUsers.filter((function(typingUser){return void 0!==typingUser.displayName})),indicatorComponent=TypingIndicator_IndicatorComponent(typingUsersToRender,Object.assign({},strings.typingIndicator,props.strings),onRenderUser,styles);return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(typingIndicatorContainerStyle,null==styles?void 0:styles.root),children:indicatorComponent})};TypingIndicator_TypingIndicator.displayName="TypingIndicator",TypingIndicator_TypingIndicator.__docgenInfo={description:"Typing Indicator is used to notify users if there are any other users typing in the thread.",methods:[],displayName:"TypingIndicator",props:{typingUsers:{required:!0,tsType:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"},description:"List of the typing users."},onRenderUser:{required:!1,tsType:{name:"signature",type:"function",raw:"(users: CommunicationParticipant) => JSX.Element",signature:{arguments:[{name:"users",type:{name:"CommunicationParticipant"}}],return:{name:"JSX.Element"}}},description:"Callback to render typing users"},styles:{required:!1,tsType:{name:"TypingIndicatorStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<TypingIndicator styles={{ root: { background: 'blue' } }} />\n```"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"TypingIndicatorStrings"}],raw:"Partial<TypingIndicatorStrings>"},description:"Optional strings to override in component"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/TypingIndicator.tsx"]={name:"TypingIndicator",docgenInfo:TypingIndicator_TypingIndicator.__docgenInfo,path:"../react-components/src/components/TypingIndicator.tsx"});__webpack_require__(34);var MessageBar=__webpack_require__(1707),MessageBar_types=__webpack_require__(56),de_DE=__webpack_require__(793),ar_SA=__webpack_require__(794),fr_FR=__webpack_require__(795),locales_en_US={strings:en_US},locales_de_DE={strings:de_DE},locales_fr_FR={strings:fr_FR},locales_ar_SA={strings:ar_SA},namedLocales={"en-US":{locale:locales_en_US,englishName:"English (US)",displayName:"English (US)"},"fr-FR":{locale:locales_fr_FR,englishName:"French (France)",displayName:"Franais (France)"},"de-DE":{locale:locales_de_DE,englishName:"German (Germany)",displayName:"Deutsche (Deutschland)"},"ar-SA":{locale:locales_ar_SA,englishName:"Arabic (Saudi Arabia)",displayName:" (  )"}},ErrorBar_ErrorBar=function ErrorBar(props){var _props$strings,localeStrings=LocalizationProvider_useLocale().strings.errorBar,strings=null!==(_props$strings=props.strings)&&void 0!==_props$strings?_props$strings:localeStrings;return 0===props.activeErrors.length?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):Object(jsx_runtime.jsx)(Stack.a,{children:props.activeErrors.map((function(activeError){return Object(react.createElement)(MessageBar.a,Object.assign({},props,{key:activeError,messageBarType:MessageBar_types.a.error,onDismiss:function onDismiss(){return props.onDismissErrors([activeError])}}),strings[activeError])}))})};ErrorBar_ErrorBar.displayName="ErrorBar",ErrorBar_ErrorBar.__docgenInfo={description:"A component to show error messages on the UI.\nAll strings that can be shown are accepted as the {@link ErrorBarProps.strings} so that they can be localized.\nActive errors are selected by {@link ErrorBarProps.activeErrors}.\n\nUses {@link @fluentui/react#MessageBar} UI element.",methods:[],displayName:"ErrorBar",props:{strings:{required:!1,tsType:{name:"ErrorBarStrings"},description:"Strings shown on the UI on errors."},activeErrors:{required:!0,tsType:{name:"Array",elements:[{name:"unknown"}],raw:"ErrorType[]"},description:"Currently active errors.\n\nWhen the error is cleared, the {@link ErrorBar} must be removed instead of clearing {@link ErrorBarProps.activeError}."},onDismissErrors:{required:!0,tsType:{name:"signature",type:"function",raw:"(errorTypes: ErrorType[]) => void",signature:{arguments:[{name:"errorTypes",type:{name:"Array",elements:[{name:"unknown"}],raw:"ErrorType[]"}}],return:{name:"void"}}},description:"Callback trigerred when the {@link MessageBar} for an active error is dismissed."}},composes:["IMessageBarProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ErrorBar.tsx"]={name:"ErrorBar",docgenInfo:ErrorBar_ErrorBar.__docgenInfo,path:"../react-components/src/components/ErrorBar.tsx"});var gridLayoutStyle=Object(lib.G)({height:"100%",display:"grid",flexGrow:"1",gap:".5rem",padding:".5rem"});function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function GridLayout_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return GridLayout_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GridLayout_arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function GridLayout_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var GridLayout_GridLayout=function GridLayout(props){var _useState2=_slicedToArray(Object(react.useState)(1),2),gridCol=_useState2[0],setGridCol=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(1),2),gridRow=_useState4[0],setGridRow=_useState4[1],children=props.children,_props$layout=props.layout,layout=void 0===_props$layout?"standard":_props$layout,styles=props.styles,numberOfChildren=react_default.a.Children.count(children);switch(layout){case"standard":var numberOfColumns=function calculateStandardLayoutColumns(numberOfItems){return numberOfItems>0?Math.ceil(Math.sqrt(numberOfItems)):1}(numberOfChildren);gridCol!==numberOfColumns&&setGridCol(numberOfColumns);var numberOfRows=function calculateStandardLayoutRows(numberOfItems,gridCol){return Math.ceil(numberOfItems/gridCol)}(numberOfChildren,gridCol);gridRow!==numberOfRows&&setGridRow(numberOfRows)}return Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(gridLayoutStyle,null==styles?void 0:styles.root),style:{gridTemplateRows:"repeat("+gridRow+", minmax(0, 1fr))",gridTemplateColumns:"repeat("+gridCol+", 1fr)"},children:children})};GridLayout_GridLayout.displayName="GridLayout",GridLayout_GridLayout.__docgenInfo={description:"",methods:[],displayName:"GridLayout",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},layout:{required:!1,tsType:{name:"literal",value:"'standard'"},description:""},styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<GridLayout styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/GridLayout.tsx"]={name:"GridLayout",docgenInfo:GridLayout_GridLayout.__docgenInfo,path:"../react-components/src/components/GridLayout.tsx"});var TextField=__webpack_require__(1701),Send20Filled=__webpack_require__(1660),Send20Regular=__webpack_require__(1661),sendBoxWrapperStyle=Object(lib.G)({padding:"0.0625rem"}),sendBoxStyle=Object(lib.G)({minHeight:"2.25rem",maxHeight:"8.25rem",outline:"red 5px",fontWeight:400,fontSize:"0.875rem",width:"100%",height:"2.25rem",lineHeight:"1.5rem","::-webkit-input-placeholder":{fontSize:"0.875rem"},"::-moz-placeholder":{fontSize:"0.875rem"},":-moz-placeholder":{fontSize:"0.875rem"}}),sendButtonStyle=Object(lib.G)({color:"grey",cursor:"pointer",display:"flex",justifyContent:"center",position:"absolute",top:"0.75rem"}),sendIconStyle=Object(lib.G)({width:"1.0625rem",height:"1.0625rem"}),isDarkThemed=(__webpack_require__(1202),__webpack_require__(230),__webpack_require__(517),function isDarkThemed(theme){var themeBlackBrightness=getPerceptualBrightnessOfHexColor(theme.palette.black),themeWhiteBrightness=getPerceptualBrightnessOfHexColor(theme.palette.white);return!Number.isNaN(themeBlackBrightness)&&!Number.isNaN(themeWhiteBrightness)&&themeBlackBrightness>themeWhiteBrightness}),getPerceptualBrightnessOfHexColor=function getPerceptualBrightnessOfHexColor(hexColor){return/^#[0-9A-Fa-f]{6}$/i.test(hexColor)?(parseInt(hexColor.substring(1,3),16)+parseInt(hexColor.substring(3,5),16)+parseInt(hexColor.substring(5,7),16))/3:NaN},lightTheme={palette:{themePrimary:"#0078d4",themeLighterAlt:"#eff6fc",themeLighter:"#deecf9",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeSecondary:"#2b88d8",themeDarkAlt:"#106ebe",themeDark:"#59b0f7",themeDarker:"#004578",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"},callingPalette:{callRed:"#c4314b",callRedDark:"#a42e43",callRedDarker:"#8b2c3d"}},darkTheme={palette:{themePrimary:"#2899f5",themeLighterAlt:"#02060a",themeLighter:"#061827",themeLight:"#0c2e49",themeTertiary:"#185b93",themeSecondary:"#2286d7",themeDarkAlt:"#3ca2f6",themeDark:"#59b0f7",themeDarker:"#84c5f9",neutralLighterAlt:"#302e2d",neutralLighter:"#383735",neutralLight:"#464443",neutralQuaternaryAlt:"#4e4d4b",neutralQuaternary:"#4d4b49",neutralTertiaryAlt:"#72706e",neutralTertiary:"#c8c8c8",neutralSecondary:"#d0d0d0",neutralPrimaryAlt:"#dadada",neutralPrimary:"#ffffff",neutralDark:"#f4f4f4",black:"#f8f8f8",white:"#252423"},callingPalette:{callRed:"#a42e43",callRedDark:"#8b2c3d",callRedDarker:"#772a38"}},mergeThemes=__webpack_require__(825),ThemeProvider=__webpack_require__(1698),es_mergeThemes=__webpack_require__(839),teams=__webpack_require__(1690),Provider=__webpack_require__(1691),wrapper=Object(lib.G)({height:"100%",width:"100%",overflow:"auto"}),defaultTheme=Object(mergeThemes.a)(Object(lib.B)(),lightTheme),ThemeContext=Object(react.createContext)(defaultTheme),initialFluentNorthstarTheme=Object(es_mergeThemes.f)(teams.a,{componentVariables:{ChatMessage:{linkColor:void 0,linkColorMine:void 0}}}),FluentThemeProvider_FluentThemeProvider=function FluentThemeProvider(props){var fluentTheme=props.fluentTheme,rtl=props.rtl,children=props.children,fluentUITheme=Object(mergeThemes.a)(defaultTheme,fluentTheme);fluentUITheme=Object(mergeThemes.a)(fluentUITheme,{rtl:rtl});var fluentNorthstarTheme=Object(es_mergeThemes.f)(initialFluentNorthstarTheme,{componentVariables:{Chat:{backgroundColor:fluentUITheme.palette.white},ChatMessage:{authorColor:fluentUITheme.palette.neutralPrimary,contentColor:fluentUITheme.palette.neutralPrimary,backgroundColor:fluentUITheme.palette.neutralLighter,backgroundColorMine:fluentUITheme.palette.themeLight}},componentStyles:{ChatMessage:{timestamp:{WebkitTextFillColor:fluentUITheme.palette.neutralSecondary}}}});return Object(jsx_runtime.jsx)(ThemeContext.Provider,{value:fluentUITheme,children:Object(jsx_runtime.jsx)(ThemeProvider.a,{theme:fluentUITheme,className:wrapper,children:Object(jsx_runtime.jsx)(Provider.a,{theme:fluentNorthstarTheme,className:wrapper,rtl:rtl,children:children})})})};FluentThemeProvider_FluentThemeProvider.displayName="FluentThemeProvider";var FluentThemeProvider_useTheme=function useTheme(){return Object(react.useContext)(ThemeContext)};function SendBox_slicedToArray(arr,i){return function SendBox_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function SendBox_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function SendBox_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return SendBox_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SendBox_arrayLikeToArray(o,minLen)}(arr,i)||function SendBox_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function SendBox_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}FluentThemeProvider_FluentThemeProvider.__docgenInfo={description:"@description Provider to apply a Fluent theme across this library's react components.\n@remarks Components in this library are composed primarily from [Fluent UI](https://developer.microsoft.com/en-us/fluentui#/controls/web),\ncontrols, and also from [Fluent React Northstar](https://fluentsite.z22.web.core.windows.net/0.53.0) controls.\nThis provider handles applying any theme provided to both the underlying Fluent UI controls, as well as the Fluent React Northstar controls.",methods:[],displayName:"FluentThemeProvider",props:{children:{required:!0,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"Children to be themed."},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:"Theme for components. Defaults to a light theme if not provided."},rtl:{required:!1,tsType:{name:"boolean"},description:"Whether components are displayed right-to-left\n@defaultValue `false`"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/theming/FluentThemeProvider.tsx"]={name:"FluentThemeProvider",docgenInfo:FluentThemeProvider_FluentThemeProvider.__docgenInfo,path:"../react-components/src/theming/FluentThemeProvider.tsx"});var EMPTY_MESSAGE_REGEX=/^\s*$/,SendBox_SendBox=function SendBox(props){var disabled=props.disabled,systemMessage=props.systemMessage,supportNewline=props.supportNewline,onSendMessage=props.onSendMessage,onTyping=props.onTyping,onRenderIcon=props.onRenderIcon,onRenderSystemMessage=props.onRenderSystemMessage,styles=props.styles,theme=FluentThemeProvider_useTheme(),localeStrings=LocalizationProvider_useLocale().strings.sendBox,strings=Object.assign({},localeStrings,props.strings),ids=IdentifierProvider_useIdentifiers(),_useState2=SendBox_slicedToArray(Object(react.useState)(""),2),textValue=_useState2[0],setTextValue=_useState2[1],_useState4=SendBox_slicedToArray(Object(react.useState)(!1),2),textValueOverflow=_useState4[0],setTextValueOverflow=_useState4[1],_useState6=SendBox_slicedToArray(Object(react.useState)(!1),2),isMouseOverSendIcon=_useState6[0],setIsMouseOverSendIcon=_useState6[1],sendTextFieldRef=react_default.a.useRef(null),sendMessageOnClick=function sendMessageOnClick(){var _sendTextFieldRef$cur;disabled||textValueOverflow||(EMPTY_MESSAGE_REGEX.test(textValue)||(onSendMessage&&onSendMessage(textValue),setTextValue("")),null===(_sendTextFieldRef$cur=sendTextFieldRef.current)||void 0===_sendTextFieldRef$cur||_sendTextFieldRef$cur.focus())},errorMessage=null!=systemMessage?systemMessage:textValueOverflow?"Your message is over the limit of 8000 characters":void 0,mergedRootStyle=Object(lib.G)(sendBoxWrapperStyle,null==styles?void 0:styles.root),mergedTextFieldStyle=Object(lib.q)(function textFieldStyle(errorColor,hasErrorMessage,disabled){var borderColor=hasErrorMessage?errorColor:"none";return{root:{width:"100%",minHeight:"0",fontSize:"8.25rem"},wrapper:{},fieldGroup:{height:"auto",minHeight:"0",borderRadius:"0.25rem",borderColor:borderColor,borderWidth:disabled?"0px":"1px",":hover":{borderColor:borderColor},":active":{borderColor:borderColor},":after":{borderColor:borderColor,borderRadius:"0.25rem"}},field:{borderRadius:"0.25rem"},errorMessage:{color:errorColor}}}(isDarkThemed(theme)?"#f1707b":"#a80000",!!errorMessage,!!disabled),{fieldGroup:null==styles?void 0:styles.textField,errorMessage:null==styles?void 0:styles.systemMessage}),mergedSendButtonStyle=Object(react.useMemo)((function(){return Object(lib.G)(sendButtonStyle,theme.rtl?{left:"0.9rem"}:{right:"0.9rem"},null==styles?void 0:styles.sendMessageIconContainer)}),[null==styles?void 0:styles.sendMessageIconContainer,theme.rtl]),hasText=!!textValue,mergedSendIconStyle=Object(react.useMemo)((function(){return Object(lib.G)(sendIconStyle,{color:errorMessage||!hasText&&!isMouseOverSendIcon?theme.palette.neutralTertiary:theme.palette.themePrimary},null==styles?void 0:styles.sendMessageIcon)}),[errorMessage,isMouseOverSendIcon,hasText,theme,null==styles?void 0:styles.sendMessageIcon]);return Object(jsx_runtime.jsx)(Stack.a,{className:mergedRootStyle,children:Object(jsx_runtime.jsxs)("div",{style:{position:"relative",padding:"0.1875rem"},children:[Object(jsx_runtime.jsx)(TextField.a,{"data-ui-id":ids.sendboxTextfield,multiline:!0,autoAdjustHeight:!0,multiple:!1,resizable:!1,componentRef:sendTextFieldRef,id:"sendbox",ariaLabel:"Type",inputClassName:sendBoxStyle,placeholder:strings.placeholderText,value:textValue,onChange:function setText(event,newValue){void 0!==newValue&&(newValue.length>8e3?setTextValueOverflow(!0):setTextValueOverflow(!1),setTextValue(newValue))},autoComplete:"off",onKeyDown:function onKeyDown(ev){"Enter"!==ev.key||!1!==ev.shiftKey&&supportNewline||textValueOverflow||(ev.preventDefault(),sendMessageOnClick()),onTyping&&onTyping()},styles:mergedTextFieldStyle,disabled:disabled,errorMessage:onRenderSystemMessage?onRenderSystemMessage(errorMessage):errorMessage}),Object(jsx_runtime.jsx)("div",{className:mergedSendButtonStyle,onClick:function onClick(e){textValueOverflow||sendMessageOnClick(),e.stopPropagation()},id:"sendIconWrapper",onMouseEnter:function onMouseEnter(){setIsMouseOverSendIcon(!0)},onMouseLeave:function onMouseLeave(){setIsMouseOverSendIcon(!1)},children:onRenderIcon?onRenderIcon(props,isMouseOverSendIcon):isMouseOverSendIcon?Object(jsx_runtime.jsx)(Send20Filled.a,{className:mergedSendIconStyle,primaryFill:"currentColor"}):Object(jsx_runtime.jsx)(Send20Regular.a,{className:mergedSendIconStyle,primaryFill:"currentColor"})})]})})};SendBox_SendBox.displayName="SendBox",SendBox_SendBox.__docgenInfo={description:"`SendBox` is a component for users to send messages and typing notifications. An optional message\ncan also be shown below the `SendBox`.",methods:[],displayName:"SendBox",props:{disabled:{required:!1,tsType:{name:"boolean"},description:"Optional boolean to disable text box\n@defaultValue false"},systemMessage:{required:!1,tsType:{name:"string"},description:"Optional text for system message below text box"},onSendMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(content: string) => Promise<void>",signature:{arguments:[{name:"content",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback called when message is sent"},onTyping:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback called when user is typing"},onRenderSystemMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(systemMessage: string | undefined) => React.ReactElement",signature:{arguments:[{name:"systemMessage",type:{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}}],return:{name:"ReactReactElement",raw:"React.ReactElement"}}},description:"Optional callback to render system message below the SendBox.\n@defaultValue MessageBar"},supportNewline:{required:!1,tsType:{name:"boolean"},description:"Optional boolean to support new line in SendBox.\n@defaultValue false"},onRenderIcon:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: SendBoxProps, isMouseOverSendIcon: boolean) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"SendBoxProps"}},{name:"isMouseOverSendIcon",type:{name:"boolean"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to render send button icon to the right of the SendBox.\n@defaultValue SendIcon"},styles:{required:!1,tsType:{name:"SendBoxStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<SendBox styles={{ root: { background: 'blue' } }} />\n```"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"SendBoxStrings"}],raw:"Partial<SendBoxStrings>"},description:"Optional strings to override in component"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/SendBox.tsx"]={name:"SendBox",docgenInfo:SendBox_SendBox.__docgenInfo,path:"../react-components/src/components/SendBox.tsx"});var TooltipHost=__webpack_require__(1699),MessageStatusIndicatorErrorIconStyle=Object(lib.G)({marginRight:"-0.06rem",fontSize:"1.06rem"}),MessageStatusIndicatorIconStyle=Object(lib.G)({fontSize:"1rem"}),ErrorCircle20Regular=__webpack_require__(1662),Circle20Regular=__webpack_require__(1663),EyeShow20Filled=__webpack_require__(1664),CheckmarkCircle20Regular=__webpack_require__(1665),MessageStatusIndicator_MessageStatusIndicator=function MessageStatusIndicator(props){var status=props.status,styles=props.styles,localeStrings=LocalizationProvider_useLocale().strings.messageStatusIndicator,strings=Object.assign({},localeStrings,props.strings),theme=FluentThemeProvider_useTheme();switch(status){case"failed":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:strings.failedToSendTooltipText,children:Object(jsx_runtime.jsx)(ErrorCircle20Regular.a,{className:Object(lib.G)(MessageStatusIndicatorErrorIconStyle,{color:theme.palette.redDark},null==styles?void 0:styles.root)})});case"sending":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:strings.sendingTooltipText,children:Object(jsx_runtime.jsx)(Circle20Regular.a,{className:Object(lib.G)(MessageStatusIndicatorIconStyle,{color:theme.palette.themePrimary},null==styles?void 0:styles.root)})});case"seen":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:strings.seenTooltipText,children:Object(jsx_runtime.jsx)(EyeShow20Filled.a,{className:Object(lib.G)({color:theme.palette.black},null==styles?void 0:styles.root)})});case"delivered":return Object(jsx_runtime.jsx)(TooltipHost.a,{content:strings.deliveredTooltipText,children:Object(jsx_runtime.jsx)(CheckmarkCircle20Regular.a,{className:Object(lib.G)(MessageStatusIndicatorIconStyle,{color:theme.palette.themePrimary},null==styles?void 0:styles.root)})});default:return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}};MessageStatusIndicator_MessageStatusIndicator.__docgenInfo={description:"MessageStatusIndicator component.",methods:[],displayName:"MessageStatusIndicator",props:{status:{required:!1,tsType:{name:"MessageStatus"},description:"Message status that determines the icon to display."},styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<MessageStatus styles={{ root: { background: 'blue' } }} />\n```"},strings:{required:!1,tsType:{name:"MessageStatusIndicatorStrings"},description:"Optional strings to override in component"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/MessageStatusIndicator.tsx"]={name:"MessageStatusIndicator",docgenInfo:MessageStatusIndicator_MessageStatusIndicator.__docgenInfo,path:"../react-components/src/components/MessageStatusIndicator.tsx"});__webpack_require__(104),__webpack_require__(87),__webpack_require__(37);var dist=__webpack_require__(815),dist_default=__webpack_require__.n(dist),Chat=__webpack_require__(1706),Text=__webpack_require__(248),Flex=__webpack_require__(1716),Ref=__webpack_require__(1708),messageThreadContainerStyle=Object(lib.G)({height:"100%",width:"100%",maxHeight:"100%",overflow:"auto",position:"relative"}),noMessageStatusStyle=Object(lib.G)({width:"1.25rem"}),chatStyle={paddingBottom:"0.5rem",border:"none",overflow:"auto"},newMessageButtonContainerStyle=Object(lib.G)({position:"absolute",zIndex:1,bottom:0,right:"1.5rem"}),chatMessageStyle={overflowY:"hidden"},chatMessageDateStyle={fontWeight:600},MessageThread_styles_messageStatusContainerStyle=function messageStatusContainerStyle(mine){return Object(lib.G)({marginLeft:mine?"1rem":"0rem"})},newMessageButtonStyle=Object(lib.G)({float:"right",width:"fit-content"}),DownIconStyle=(Object(lib.G)({border:"none",minHeight:"1.5rem","&:hover":{background:"none"},"&:active":{background:"none"}}),Object(lib.G)({marginRight:"0.5em"})),PrimaryButton=__webpack_require__(1666),Icon_Icon=__webpack_require__(821),Link=__webpack_require__(1705),Persona=__webpack_require__(560),Persona_types=__webpack_require__(26),es=__webpack_require__(441),formatTimeForChatMessage=function formatTimeForChatMessage(messageDate){var hours=messageDate.getHours(),minutes=messageDate.getMinutes().toString(),isAm=hours<12;return hours>12&&(hours-=12),0===hours&&(hours=12),minutes.length<2&&(minutes="0"+minutes),hours.toString()+":"+minutes+" "+(isAm?"a.m.":"p.m.")},formatDateForChatMessage=function formatDateForChatMessage(messageDate){var year=messageDate.getFullYear().toString(),month=(messageDate.getMonth()+1).toString(),day=messageDate.getDate().toString();return 1===month.length&&(month="0"+month),1===day.length&&(day="0"+day),year+"-"+month+"-"+day},formatTimestampForChatMessage=function formatTimestampForChatMessage(messageDate,todayDate,dateStrings){if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()))return formatTimeForChatMessage(messageDate);if(messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-1))return dateStrings.yesterday+" "+formatTimeForChatMessage(messageDate);var weekDay=todayDate.getDay();return 0===weekDay?formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate):messageDate>new Date(todayDate.getFullYear(),todayDate.getMonth(),todayDate.getDate()-weekDay)?dayToDayName(messageDate.getDay(),dateStrings)+" "+formatTimeForChatMessage(messageDate):formatDateForChatMessage(messageDate)+" "+formatTimeForChatMessage(messageDate)},dayToDayName=function dayToDayName(day,dateStrings){switch(day){case 0:return dateStrings.sunday;case 1:return dateStrings.monday;case 2:return dateStrings.tuesday;case 3:return dateStrings.wednesday;case 4:return dateStrings.thursday;case 5:return dateStrings.friday;case 6:return dateStrings.saturday;default:throw new Error("Invalid day ["+day+"] passed")}},delay=(__webpack_require__(520),function delay(_delay){return new Promise((function(resolve){setTimeout(resolve,_delay)}))}),src=__webpack_require__(36),FontIcon=__webpack_require__(798),systemMessageIconStyle=Object(lib.G)({margin:"0 0.688rem 0 0"}),SystemMessage_SystemMessage=function SystemMessage(props){var iconName=props.iconName,content=props.content,Icon=Object(jsx_runtime.jsx)(FontIcon.a,{iconName:iconName,className:Object(lib.G)(systemMessageIconStyle)});return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.G)(null==props?void 0:props.containerStyle),children:[Icon,Object(jsx_runtime.jsx)("span",{children:content})]})};SystemMessage_SystemMessage.displayName="SystemMessage",SystemMessage_SystemMessage.__docgenInfo={description:"",methods:[],displayName:"SystemMessage",props:{iconName:{required:!0,tsType:{name:"union",raw:"'PeopleAdd' | 'PeopleBlock' | 'Edit'",elements:[{name:"literal",value:"'PeopleAdd'"},{name:"literal",value:"'PeopleBlock'"},{name:"literal",value:"'Edit'"}]},description:"Icon name for the system message. iconName should match the iconName in fluentUI icon."},content:{required:!0,tsType:{name:"string"},description:"Content string for the system message."},containerStyle:{required:!1,tsType:{name:"ComponentSlotStyle"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/SystemMessage.tsx"]={name:"SystemMessage",docgenInfo:SystemMessage_SystemMessage.__docgenInfo,path:"../react-components/src/components/SystemMessage.tsx"});var html_to_react=__webpack_require__(816);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function MessageThread_slicedToArray(arr,i){return function MessageThread_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function MessageThread_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function MessageThread_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return MessageThread_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return MessageThread_arrayLikeToArray(o,minLen)}(arr,i)||function MessageThread_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MessageThread_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var isMessageSame=function isMessageSame(first,second){return first.messageId===second.messageId&&first.content===second.content&&first.type===second.type&&JSON.stringify(first.createdOn)===JSON.stringify(second.createdOn)&&first.senderId===second.senderId&&first.senderDisplayName===second.senderDisplayName&&first.status===second.status},getLatestChatMessage=function getLatestChatMessage(messages){for(var latestChatMessage=void 0,i=messages.length-1;i>=0;i--){var message=messages[i];if("chat"===message.type){var payload=message.payload;if(void 0!==payload.createdOn){latestChatMessage=payload;break}}}return latestChatMessage},MessageThread_DefaultJumpToNewMessageButton=function DefaultJumpToNewMessageButton(props){var onClick=props.onClick;return Object(jsx_runtime.jsxs)(PrimaryButton.a,{className:newMessageButtonStyle,onClick:onClick,children:[Object(jsx_runtime.jsx)(Icon_Icon.a,{iconName:"Down",className:DownIconStyle}),"New Messages"]})};MessageThread_DefaultJumpToNewMessageButton.displayName="DefaultJumpToNewMessageButton";var MessageThread_ParticipantSystemMessageComponent=function ParticipantSystemMessageComponent(_ref){var _payload$iconName,payload=_ref.payload,style=_ref.style,strings=LocalizationProvider_useLocale().strings,participantsStr=function generateParticipantsStr(participants){return participants.map((function(participant){return""+(participant.displayName&&""!==participant.displayName?participant.displayName:"No name")})).join(", ")}(payload.participants),messageSuffix="participantAdded"===payload.type?strings.messageThread.participantJoined:strings.messageThread.participantLeft;return""!==participantsStr?Object(jsx_runtime.jsx)(SystemMessage_SystemMessage,{iconName:null!==(_payload$iconName=payload.iconName)&&void 0!==_payload$iconName?_payload$iconName:"",content:participantsStr+" "+messageSuffix,containerStyle:style}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},MessageThread_DefaultSystemMessageRenderer=function DefaultSystemMessageRenderer(props){if("system"===props.message.type){var _payload$iconName2,_payload$content,payload=props.message.payload;if("content"===payload.type)return Object(jsx_runtime.jsx)(SystemMessage_SystemMessage,{iconName:null!==(_payload$iconName2=payload.iconName)&&void 0!==_payload$iconName2?_payload$iconName2:"",content:null!==(_payload$content=payload.content)&&void 0!==_payload$content?_payload$content:"",containerStyle:null==props?void 0:props.messageContainerStyle});if("participantAdded"===payload.type||"participantRemoved"===payload.type)return Object(jsx_runtime.jsx)(MessageThread_ParticipantSystemMessageComponent,{payload:payload,style:props.messageContainerStyle})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})};var MessageThread_GenerateRichTextHTMLMessageContent=function GenerateRichTextHTMLMessageContent(payload){var s,span,htmlToReactParser=new html_to_react.Parser,liveAuthor=payload.senderDisplayName+" says ";return Object(jsx_runtime.jsxs)("div",{"data-ui-status":payload.status,children:[Object(jsx_runtime.jsx)(es.b,{message:(payload.mine?"":liveAuthor)+" "+(s=payload.content||"",span=document.createElement("span"),span.innerHTML=s,span.textContent||span.innerText),"aria-live":"polite"}),htmlToReactParser.parse(payload.content)]})};MessageThread_GenerateRichTextHTMLMessageContent.displayName="GenerateRichTextHTMLMessageContent";var MessageThread_GenerateTextMessageContent=function GenerateTextMessageContent(payload){var liveAuthor=payload.senderDisplayName+" says ";return Object(jsx_runtime.jsxs)("div",{"data-ui-status":payload.status,children:[Object(jsx_runtime.jsx)(es.b,{message:(payload.mine?"":liveAuthor)+" "+payload.content,"aria-live":"polite"}),Object(jsx_runtime.jsx)(dist_default.a,{componentDecorator:function componentDecorator(decoratedHref,decoratedText,key){return Object(jsx_runtime.jsx)(Link.a,{href:decoratedHref,children:decoratedText},key)},children:payload.content})]})};MessageThread_GenerateTextMessageContent.displayName="GenerateTextMessageContent";var MessageThread_DefaultChatMessageRenderer=function DefaultChatMessageRenderer(props,ids){if("chat"===props.message.type){var payload=props.message.payload,messageContentItem=function GenerateMessageContent(payload){switch(payload.type){case"text":return MessageThread_GenerateTextMessageContent(payload);case"html":case"richtext/html":return MessageThread_GenerateRichTextHTMLMessageContent(payload);default:return console.warn("unknown message content type"),Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})}}(payload);return Object(jsx_runtime.jsx)(Chat.a.Message,{className:Object(lib.G)(chatMessageStyle,props.messageContainerStyle),content:messageContentItem,author:Object(jsx_runtime.jsx)(Text.a,{className:Object(lib.G)(chatMessageDateStyle),children:payload.senderDisplayName}),mine:payload.mine,timestamp:Object(jsx_runtime.jsx)(Text.a,{"data-ui-id":null==ids?void 0:ids.messageTimestamp,children:payload.createdOn?props.showDate?formatTimestampForChatMessage(payload.createdOn,new Date,props.strings):formatTimeForChatMessage(payload.createdOn):void 0})})}return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},memoizeAllMessages=Object(src.c)((function(_messageKey,message,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultStatusRenderer,defaultChatMessageRenderer,strings,_attached,statusToRender,onRenderMessage){var messageProps={message:message,strings:strings,showDate:showMessageDate};if("chat"===message.type){var _payload$senderId,_payload$mine,_payload$mine2,payload=message.payload;messageProps.messageContainerStyle=null==styles?void 0:styles.chatMessageContainer;var chatMessageComponent=void 0===onRenderMessage?defaultChatMessageRenderer(messageProps):onRenderMessage(messageProps,MessageThread_DefaultChatMessageRenderer);return{gutter:payload.mine?"":onRenderAvatar?onRenderAvatar(null!==(_payload$senderId=payload.senderId)&&void 0!==_payload$senderId?_payload$senderId:""):Object(jsx_runtime.jsx)(Persona.a,{text:payload.senderDisplayName,hidePersonaDetails:!0,size:Persona_types.c.size32}),contentPosition:payload.mine?"end":"start",message:Object(jsx_runtime.jsxs)(Flex.a,{vAlign:"end",children:[chatMessageComponent,Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(MessageThread_styles_messageStatusContainerStyle(null!==(_payload$mine=payload.mine)&&void 0!==_payload$mine&&_payload$mine),null!=styles&&styles.messageStatusContainer?styles.messageStatusContainer(null!==(_payload$mine2=payload.mine)&&void 0!==_payload$mine2&&_payload$mine2):""),children:showMessageStatus&&statusToRender?onRenderMessageStatus?onRenderMessageStatus({status:statusToRender}):defaultStatusRenderer(statusToRender):Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(noMessageStatusStyle)})})]}),attached:payload.attached,key:_messageKey}}return"system"===message.type?(messageProps.messageContainerStyle=null==styles?void 0:styles.systemMessageContainer,{children:void 0===onRenderMessage?Object(jsx_runtime.jsx)(MessageThread_DefaultSystemMessageRenderer,Object.assign({},messageProps)):onRenderMessage(messageProps,(function(props){return Object(jsx_runtime.jsx)(MessageThread_DefaultSystemMessageRenderer,Object.assign({},props))})),key:_messageKey}):{children:void 0===onRenderMessage?Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{}):onRenderMessage(messageProps),key:_messageKey}})),getLastChatMessageIdWithStatus=function getLastChatMessageIdWithStatus(messages,status){for(var i=messages.length-1;i>=0;i--){var message=messages[i];if("chat"===message.type&&message.payload.status===status&&message.payload.mine)return message.payload.messageId}},MessageThread_MessageThread=function MessageThread(props){var _chatThreadRef$curren,newMessages=props.messages,userId=props.userId,styles=props.styles,_props$disableJumpToN=props.disableJumpToNewMessageButton,disableJumpToNewMessageButton=void 0!==_props$disableJumpToN&&_props$disableJumpToN,_props$showMessageDat=props.showMessageDate,showMessageDate=void 0!==_props$showMessageDat&&_props$showMessageDat,_props$showMessageSta=props.showMessageStatus,showMessageStatus=void 0!==_props$showMessageSta&&_props$showMessageSta,_props$numberOfChatMe=props.numberOfChatMessagesToReload,numberOfChatMessagesToReload=void 0===_props$numberOfChatMe?0:_props$numberOfChatMe,onMessageSeen=props.onMessageSeen,onRenderMessageStatus=props.onRenderMessageStatus,onRenderAvatar=props.onRenderAvatar,onLoadPreviousChatMessages=props.onLoadPreviousChatMessages,onRenderJumpToNewMessageButton=props.onRenderJumpToNewMessageButton,onRenderMessage=props.onRenderMessage,_useState2=MessageThread_slicedToArray(Object(react.useState)([]),2),messages=_useState2[0],setMessages=_useState2[1],_useState4=MessageThread_slicedToArray(Object(react.useState)(!1),2),chatMessagesInitialized=_useState4[0],setChatMessagesInitialized=_useState4[1],_useState6=MessageThread_slicedToArray(Object(react.useState)(!0),2),isAtBottomOfScroll=_useState6[0],setIsAtBottomOfScroll=_useState6[1],_useState8=MessageThread_slicedToArray(Object(react.useState)(0),2),forceUpdate=_useState8[0],setForceUpdate=_useState8[1],_useState10=MessageThread_slicedToArray(Object(react.useState)(void 0),2),latestPreviousChatMessage=_useState10[0],setLatestPreviousChatMessage=_useState10[1],_useState12=MessageThread_slicedToArray(Object(react.useState)(void 0),2),latestCurrentChatMessage=_useState12[0],setLatestCurrentChatMessage=_useState12[1],_useState14=MessageThread_slicedToArray(Object(react.useState)(!1),2),existsNewChatMessage=_useState14[0],setExistsNewChatMessage=_useState14[1],_useState16=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastSeenChatMessage=_useState16[0],setLastSeenChatMessage=_useState16[1],_useState18=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastDeliveredChatMessage=_useState18[0],setLastDeliveredChatMessage=_useState18[1],_useState20=MessageThread_slicedToArray(Object(react.useState)(void 0),2),lastSendingChatMessage=_useState20[0],setLastSendingChatMessage=_useState20[1],isAllChatMessagesLoadedRef=Object(react.useRef)(!1),previousTopRef=Object(react.useRef)(-1),previousHeightRef=Object(react.useRef)(-1),messageIdSeenByMeRef=Object(react.useRef)(""),chatScrollDivRef=Object(react.useRef)(null),chatThreadRef=Object(react.useRef)(null),isLoadingChatMessagesRef=Object(react.useRef)(!1),ids=IdentifierProvider_useIdentifiers(),messagesRef=Object(react.useRef)(messages),isAtBottomOfScrollRef=Object(react.useRef)(isAtBottomOfScroll),setIsAtBottomOfScrollRef=function setIsAtBottomOfScrollRef(isAtBottomOfScrollValue){isAtBottomOfScrollRef.current=isAtBottomOfScrollValue,setIsAtBottomOfScroll(isAtBottomOfScrollValue)},chatMessagesInitializedRef=Object(react.useRef)(chatMessagesInitialized),sendMessageStatusIfAtBottom=Object(react.useCallback)(_asyncToGenerator(regeneratorRuntime.mark((function _callee(){var messagesWithId,lastMessage;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(isAtBottomOfScrollRef.current&&document.hasFocus()&&messagesRef.current&&0!==messagesRef.current.length&&showMessageStatus){_context.next=2;break}return _context.abrupt("return");case 2:if(0!==(messagesWithId=messagesRef.current.filter((function(message){return"chat"===message.type&&!message.payload.mine&&!!message.payload.messageId}))).length){_context.next=5;break}return _context.abrupt("return");case 5:if(lastMessage=messagesWithId[messagesWithId.length-1],_context.prev=6,!(onMessageSeen&&lastMessage&&lastMessage.payload.messageId&&lastMessage.payload.messageId!==messageIdSeenByMeRef.current)){_context.next=11;break}return _context.next=10,onMessageSeen(lastMessage.payload.messageId);case 10:messageIdSeenByMeRef.current=lastMessage.payload.messageId;case 11:_context.next=16;break;case 13:_context.prev=13,_context.t0=_context.catch(6),console.log("onMessageSeen Error",lastMessage,_context.t0);case 16:case"end":return _context.stop()}}),_callee,null,[[6,13]])}))),[showMessageStatus,onMessageSeen]),scrollToBottom=Object(react.useCallback)((function(){chatScrollDivRef.current&&(chatScrollDivRef.current.scrollTop=chatScrollDivRef.current.scrollHeight),setExistsNewChatMessage(!1),setIsAtBottomOfScrollRef(!0),sendMessageStatusIfAtBottom()}),[sendMessageStatusIfAtBottom]),handleScrollToTheBottom=Object(react.useCallback)((function(){if(chatScrollDivRef.current){var atBottom=Math.floor(chatScrollDivRef.current.scrollTop)>=chatScrollDivRef.current.scrollHeight-chatScrollDivRef.current.clientHeight;atBottom&&(sendMessageStatusIfAtBottom(),isAtBottomOfScrollRef.current||scrollToBottom()),setIsAtBottomOfScrollRef(atBottom)}}),[scrollToBottom,sendMessageStatusIfAtBottom]),fetchNewMessageWhenAtTop=Object(react.useCallback)(_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!chatScrollDivRef.current||isLoadingChatMessagesRef.current){_context2.next=12;break}if(!onLoadPreviousChatMessages){_context2.next=12;break}isLoadingChatMessagesRef.current=!0;case 3:if(isAllChatMessagesLoadedRef.current||!(chatScrollDivRef.current.scrollTop<=500)){_context2.next=11;break}return _context2.next=6,onLoadPreviousChatMessages(numberOfChatMessagesToReload);case 6:return isAllChatMessagesLoadedRef.current=_context2.sent,_context2.next=9,delay(200);case 9:_context2.next=3;break;case 11:isLoadingChatMessagesRef.current=!1;case 12:case"end":return _context2.stop()}}),_callee2)}))),[numberOfChatMessagesToReload,onLoadPreviousChatMessages]),handleInfiniteScroll=Object(react.useCallback)((function(){chatScrollDivRef.current&&fetchNewMessageWhenAtTop()}),[fetchNewMessageWhenAtTop]);Object(react.useEffect)((function(){chatScrollDivRef.current&&(previousTopRef.current=chatScrollDivRef.current.scrollTop,previousHeightRef.current=chatScrollDivRef.current.scrollHeight)}),[newMessages]),Object(react.useEffect)((function(){if(chatScrollDivRef.current&&0===previousTopRef.current){var currentHeight=chatScrollDivRef.current.scrollHeight;chatScrollDivRef.current.scrollTop=chatScrollDivRef.current.scrollTop+currentHeight-previousHeightRef.current}}),[messages]),Object(react.useEffect)((function(){fetchNewMessageWhenAtTop()}),[fetchNewMessageWhenAtTop]),Object(react.useEffect)((function(){return window&&window.addEventListener("click",sendMessageStatusIfAtBottom),window&&window.addEventListener("focus",sendMessageStatusIfAtBottom),function(){window&&window.removeEventListener("click",sendMessageStatusIfAtBottom),window&&window.removeEventListener("focus",sendMessageStatusIfAtBottom)}}),[sendMessageStatusIfAtBottom]),Object(react.useEffect)((function(){var chatScrollDiv=chatScrollDivRef.current;return null==chatScrollDiv||chatScrollDiv.addEventListener("scroll",handleScrollToTheBottom),null==chatScrollDiv||chatScrollDiv.addEventListener("scroll",handleInfiniteScroll),function(){null==chatScrollDiv||chatScrollDiv.removeEventListener("scroll",handleScrollToTheBottom),null==chatScrollDiv||chatScrollDiv.removeEventListener("scroll",handleInfiniteScroll)}}),[handleInfiniteScroll,handleScrollToTheBottom]);var clientHeight=null===(_chatThreadRef$curren=chatThreadRef.current)||void 0===_chatThreadRef$curren?void 0:_chatThreadRef$curren.clientHeight;Object(react.useEffect)((function(){void 0!==clientHeight?isAtBottomOfScrollRef.current&&scrollToBottom():setForceUpdate(forceUpdate+1)}),[clientHeight,forceUpdate,scrollToBottom,chatMessagesInitialized]),Object(react.useEffect)((function(){setLatestPreviousChatMessage(getLatestChatMessage(messagesRef.current)),setLatestCurrentChatMessage(getLatestChatMessage(newMessages)),function setMessagesRef(messagesWithAttachedValue){messagesRef.current=messagesWithAttachedValue,setMessages(messagesWithAttachedValue)}(newMessages),!chatMessagesInitializedRef.current&&function setChatMessagesInitializedRef(chatMessagesInitialized){chatMessagesInitializedRef.current=chatMessagesInitialized,setChatMessagesInitialized(chatMessagesInitialized)}(!0),setLastDeliveredChatMessage(getLastChatMessageIdWithStatus(newMessages,"delivered")),setLastSeenChatMessage(getLastChatMessageIdWithStatus(newMessages,"seen")),setLastSendingChatMessage(getLastChatMessageIdWithStatus(newMessages,"sending"))}),[newMessages]),Object(react.useEffect)((function(){!function isThereNewMessageNotFromCurrentUser(latestMessageFromPreviousMessages,latestMessageFromNewMessages,userId){return void 0!==latestMessageFromNewMessages&&(void 0===latestMessageFromPreviousMessages||!isMessageSame(latestMessageFromNewMessages,latestMessageFromPreviousMessages))&&latestMessageFromNewMessages.senderId!==userId}(latestPreviousChatMessage,latestCurrentChatMessage,userId)||isAtBottomOfScrollRef.current?(function didUserSendTheLatestMessage(latestMessageFromPreviousMessages,latestMessageFromNewMessages,userId){return void 0!==latestMessageFromNewMessages&&(void 0===latestMessageFromPreviousMessages||!isMessageSame(latestMessageFromNewMessages,latestMessageFromPreviousMessages))&&latestMessageFromNewMessages.senderId===userId}(latestPreviousChatMessage,latestCurrentChatMessage,userId)||isAtBottomOfScrollRef.current)&&scrollToBottom():setExistsNewChatMessage(!0)}),[messages]);var defaultChatMessageRenderer=Object(react.useCallback)((function(messageProps){return MessageThread_DefaultChatMessageRenderer(messageProps,{messageTimestamp:ids.messageTimestamp})}),[(new Date).toDateString()]),localeStrings=LocalizationProvider_useLocale().strings.messageThread,strings=Object(react.useMemo)((function(){return Object.assign({},localeStrings,props.strings)}),[localeStrings,props.strings]),defaultStatusRenderer=Object(react.useCallback)((function(status){return Object(jsx_runtime.jsx)(MessageStatusIndicator_MessageStatusIndicator,{status:status})}),[]),messagesToDisplay=Object(react.useMemo)((function(){return memoizeAllMessages((function(memoizedMessageFn){return messages.map((function(message,index){var _key,key=message.payload.messageId;"chat"!==message.type||message.payload.messageId&&""!==message.payload.messageId||(key=message.payload.clientMessageId);var statusToRender=void 0;if("chat"===message.type){if(showMessageStatus&&message.payload.mine)switch(message.payload.messageId){case lastSeenChatMessage:statusToRender="seen";break;case lastSendingChatMessage:statusToRender="sending";break;case lastDeliveredChatMessage:statusToRender="delivered"}message.payload.mine&&"failed"===message.payload.status&&(statusToRender="failed")}return memoizedMessageFn(null!==(_key=key)&&void 0!==_key?_key:"id_"+index,message,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultStatusRenderer,defaultChatMessageRenderer,strings,"chat"===message.type?message.payload.attached:void 0,statusToRender,onRenderMessage)}))}))}),[messages,showMessageDate,showMessageStatus,onRenderAvatar,styles,onRenderMessageStatus,defaultStatusRenderer,defaultChatMessageRenderer,lastSeenChatMessage,lastSendingChatMessage,lastDeliveredChatMessage,onRenderMessage,strings]),chatBody=Object(react.useMemo)((function(){var _styles$chatContainer;return Object(jsx_runtime.jsx)(es.a,{children:Object(jsx_runtime.jsx)(Chat.a,{styles:null!==(_styles$chatContainer=null==styles?void 0:styles.chatContainer)&&void 0!==_styles$chatContainer?_styles$chatContainer:chatStyle,items:messagesToDisplay})})}),[null==styles?void 0:styles.chatContainer,messagesToDisplay]);return Object(jsx_runtime.jsx)(Ref.a,{innerRef:chatThreadRef,children:Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.G)(messageThreadContainerStyle,null==styles?void 0:styles.root),grow:!0,children:[Object(jsx_runtime.jsx)(Ref.a,{innerRef:chatScrollDivRef,children:chatBody}),existsNewChatMessage&&!disableJumpToNewMessageButton&&Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(newMessageButtonContainerStyle,null==styles?void 0:styles.newMessageButtonContainer),children:onRenderJumpToNewMessageButton?onRenderJumpToNewMessageButton({onClick:scrollToBottom}):Object(jsx_runtime.jsx)(MessageThread_DefaultJumpToNewMessageButton,{onClick:scrollToBottom})})]})})};MessageThread_MessageThread.displayName="MessageThread",MessageThread_MessageThread.__docgenInfo={description:"`MessageThread` allows you to easily create a component for rendering chat messages, handling scrolling behavior of new/old messages and customizing icons & controls inside the chat thread.\n@param props - of type MessageThreadProps\n\nUsers will need to provide at least chat messages and userId to render the `MessageThread` component.\nUsers can also customize `MessageThread` by passing in their own Avatar, `MessageStatusIndicator` icon, `JumpToNewMessageButton`, `LoadPreviousMessagesButton` and the behavior of these controls.\n\n`MessageThread` internally uses the `Chat` & `Chat.Message` component from `@fluentui/react-northstar`. You can checkout the details about these [two components](https://fluentsite.z22.web.core.windows.net/0.53.0/components/chat/props).",methods:[],displayName:"MessageThread",props:{userId:{required:!0,tsType:{name:"string"},description:"UserId of the current user."},messages:{required:!0,tsType:{name:"Array",elements:[{name:"unknown"}],raw:"(ChatMessage | SystemMessage | CustomMessage)[]"},description:"Messages to render in message thread. A message can be of type `ChatMessage`, `SystemMessage` or `CustomMessage`."},styles:{required:!1,tsType:{name:"MessageThreadStylesProps"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<MessageThread styles={{ root: { background: 'blue' } }} />\n```"},disableJumpToNewMessageButton:{required:!1,tsType:{name:"boolean"},description:"Whether the new message button is disabled or not.\n\n@defaultValue `false`"},showMessageDate:{required:!1,tsType:{name:"boolean"},description:"Whether the date of each message is displayed or not.\n\n@defaultValue `false`"},showMessageStatus:{required:!1,tsType:{name:"boolean"},description:"Whether the status indicator for each message is displayed or not.\n\n@defaultValue `false`"},numberOfChatMessagesToReload:{required:!1,tsType:{name:"number"},description:"Number of chat messaegs to reload each time onLoadPreviousChatMessages is called.\n\n@defaultValue 0"},onMessageSeen:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageId: string) => Promise<void>",signature:{arguments:[{name:"messageId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Optional callback to override actions on message being seen.\n\n@param messageId - message Id"},onRenderMessageStatus:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageStatusIndicatorProps: MessageStatusIndicatorProps) => JSX.Element | null",signature:{arguments:[{name:"messageStatusIndicatorProps",type:{name:"MessageStatusIndicatorProps"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to override render of the message status indicator.\n\n@param messageStatusIndicatorProps - props of type MessageStatusIndicatorProps"},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => JSX.Element",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"JSX.Element"}}},description:"Optional callback to override render of the avatar.\n\n@param userId - user Id"},onRenderJumpToNewMessageButton:{required:!1,tsType:{name:"signature",type:"function",raw:"(newMessageButtonProps: JumpToNewMessageButtonProps) => JSX.Element",signature:{arguments:[{name:"newMessageButtonProps",type:{name:"JumpToNewMessageButtonProps"}}],return:{name:"JSX.Element"}}},description:"Optional callback to override render of the button for jumping to the new message.\n\n@param newMessageButtonProps - button props of type JumpToNewMessageButtonProps"},onLoadPreviousChatMessages:{required:!1,tsType:{name:"signature",type:"function",raw:"(messagesToLoad: number) => Promise<boolean>",signature:{arguments:[{name:"messagesToLoad",type:{name:"number"}}],return:{name:"Promise",elements:[{name:"boolean"}],raw:"Promise<boolean>"}}},description:"Optional callback to override loading of previous messages.\nIt accepts the number of history chat messages that we want to load and return a boolean Promise indicating if we have got all the history messages.\nIf the promise resolves to `true`, we have load all chat messages into the message thread and `loadPreviousMessagesButton` will not be rendered anymore."},onRenderMessage:{required:!1,tsType:{name:"signature",type:"function",raw:"(messageProps: MessageProps, defaultOnRender?: DefaultMessageRendererType) => JSX.Element",signature:{arguments:[{name:"messageProps",type:{name:"signature",type:"object",raw:"{\n  /**\n   * Message to render. It can type `ChatMessage` or `SystemMessage` or `CustomMessage`.\n   */\n  message: ChatMessage | SystemMessage | CustomMessage;\n  /**\n   * Strings from parent MessageThread component\n   */\n  strings: MessageThreadStrings;\n  /**\n   * Custom CSS styles for chat message container.\n   */\n  messageContainerStyle?: ComponentSlotStyle;\n  /**\n   * Whether the date of a message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n  showDate?: boolean;\n}",signature:{properties:[{key:"message",value:{name:"union",raw:"ChatMessage | SystemMessage | CustomMessage",elements:[{name:"ChatMessage"},{name:"SystemMessage"},{name:"CustomMessage"}],required:!0}},{key:"strings",value:{name:"MessageThreadStrings",required:!0}},{key:"messageContainerStyle",value:{name:"ComponentSlotStyle",required:!1}},{key:"showDate",value:{name:"boolean",required:!1}}]}}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: MessageProps, ids?: { messageTimestamp?: string }) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"signature",type:"object",raw:"{\n  /**\n   * Message to render. It can type `ChatMessage` or `SystemMessage` or `CustomMessage`.\n   */\n  message: ChatMessage | SystemMessage | CustomMessage;\n  /**\n   * Strings from parent MessageThread component\n   */\n  strings: MessageThreadStrings;\n  /**\n   * Custom CSS styles for chat message container.\n   */\n  messageContainerStyle?: ComponentSlotStyle;\n  /**\n   * Whether the date of a message is displayed or not.\n   *\n   * @defaultValue `false`\n   */\n  showDate?: boolean;\n}",signature:{properties:[{key:"message",value:{name:"union",raw:"ChatMessage | SystemMessage | CustomMessage",elements:[{name:"ChatMessage"},{name:"SystemMessage"},{name:"CustomMessage"}],required:!0}},{key:"strings",value:{name:"MessageThreadStrings",required:!0}},{key:"messageContainerStyle",value:{name:"ComponentSlotStyle",required:!1}},{key:"showDate",value:{name:"boolean",required:!1}}]}}},{name:"ids",type:{name:"signature",type:"object",raw:"{ messageTimestamp?: string }",signature:{properties:[{key:"messageTimestamp",value:{name:"string",required:!1}}]}}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:"Optional callback to override render of a message.\n\n@param messageProps - props of type MessageProps\n@param defaultOnRender - default render of type DefaultMessageRendererType\n\n@remarks\n`defaultOnRender` is not provided for `CustomMessage` and thus only available for `ChatMessage` and `SystemMessage`."},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"MessageThreadStrings"}],raw:"Partial<MessageThreadStrings>"},description:"Optional strings to override in component"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/MessageThread.tsx"]={name:"MessageThread",docgenInfo:MessageThread_MessageThread.__docgenInfo,path:"../react-components/src/components/MessageThread.tsx"});var mediaContainer=Object(lib.G)({position:"relative",height:"100%",width:"100%",background:"transparent",display:"flex","& video":{borderRadius:".25rem"}}),invertedVideoStyle=Object(lib.G)(mediaContainer,{transform:"rotateY(180deg)"}),StreamMedia_StreamMedia=function StreamMedia(props){var containerEl=Object(react.useRef)(null),isMirrored=props.isMirrored,videoStreamElement=props.videoStreamElement,styles=props.styles;return Object(react.useEffect)((function(){var container=containerEl.current;if(container)return container.innerHTML="",videoStreamElement&&container.appendChild(videoStreamElement),function(){container.innerHTML=""}}),[videoStreamElement]),Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(isMirrored?invertedVideoStyle:mediaContainer,null==styles?void 0:styles.root),ref:containerEl})};StreamMedia_StreamMedia.displayName="StreamMedia",StreamMedia_StreamMedia.__docgenInfo={description:"StreamMedia component converts a HTMLElement to a JSX Element.\nThis component becomes very handy when you get the video stream HTMLElement from the calling sdk and want to render it in components like VideoTile.",methods:[],displayName:"StreamMedia",props:{videoStreamElement:{required:!0,tsType:{name:"union",raw:"HTMLElement | null",elements:[{name:"HTMLElement"},{name:"null"}]},description:"Video stream element to render."},isMirrored:{required:!1,tsType:{name:"boolean"},description:"Decides whether to mirror the video or not."},styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<StreamMedia styles={{ root: { background: 'blue' } }} />\n```"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/StreamMedia.tsx"]={name:"StreamMedia",docgenInfo:StreamMedia_StreamMedia.__docgenInfo,path:"../react-components/src/components/StreamMedia.tsx"});var participantItemContainerStyle=Object(lib.G)({paddingTop:"0.25rem",paddingBottom:"0.25rem",display:"flex",position:"relative",maxWidth:"20rem",minWidth:"12rem",cursor:"pointer",alignItems:"center"}),iconContainerStyle=(Object(lib.G)({fontSize:"0.875rem",fontWeight:400,marginTop:"0.3125rem",marginRight:"0.25rem",paddingLeft:"0.25rem",overflowY:"hidden"}),Object(lib.G)({fontSize:"0.875rem",fontWeight:400,color:"#A19F9D",marginTop:"0.3125rem"}),Object(lib.G)({position:"absolute",display:"flex",right:"1rem",alignItems:"center"})),ContextualMenu=__webpack_require__(1696),DirectionalHint=__webpack_require__(65),MoreHorizontal20Regular=__webpack_require__(1667),MoreHorizontal20Filled=__webpack_require__(1668);function ParticipantItem_slicedToArray(arr,i){return function ParticipantItem_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function ParticipantItem_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function ParticipantItem_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantItem_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantItem_arrayLikeToArray(o,minLen)}(arr,i)||function ParticipantItem_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ParticipantItem_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ParticipantItem_ParticipantItem=function ParticipantItem(props){var _props$strings$isMeTe,_props$strings,_props$strings$menuTi,_props$strings2,displayName=props.displayName,onRenderAvatar=props.onRenderAvatar,menuItems=props.menuItems,onRenderIcon=props.onRenderIcon,presence=props.presence,styles=props.styles,me=props.me,_useState2=ParticipantItem_slicedToArray(Object(react.useState)(!1),2),itemHovered=_useState2[0],setItemHovered=_useState2[1],_useState4=ParticipantItem_slicedToArray(Object(react.useState)(!1),2),menuButtonHovered=_useState4[0],setMenuButtonHovered=_useState4[1],_useState6=ParticipantItem_slicedToArray(Object(react.useState)(!0),2),menuHidden=_useState6[0],setMenuHidden=_useState6[1],containerRef=Object(react.useRef)(null),theme=FluentThemeProvider_useTheme(),strings=LocalizationProvider_useLocale().strings,isMeText=null!==(_props$strings$isMeTe=null===(_props$strings=props.strings)||void 0===_props$strings?void 0:_props$strings.isMeText)&&void 0!==_props$strings$isMeTe?_props$strings$isMeTe:strings.participantItem.isMeText,menuTitle=null!==(_props$strings$menuTi=null===(_props$strings2=props.strings)||void 0===_props$strings2?void 0:_props$strings2.menuTitle)&&void 0!==_props$strings$menuTi?_props$strings$menuTi:strings.participantItem.menuTitle,avatarToUse=Object(jsx_runtime.jsx)(Persona.a,{text:displayName,size:Persona_types.c.size32,presence:presence,onRenderPersonaCoin:onRenderAvatar?function(){return onRenderAvatar(props)}:void 0,className:Object(lib.G)(null==styles?void 0:styles.avatar),initialsTextColor:"white"}),meTextStyle=Object(lib.G)({color:theme.palette.neutralTertiary},null==styles?void 0:styles.me),contextualMenuStyle=Object(lib.G)({background:theme.palette.neutralLighterAlt},null==styles?void 0:styles.menu),menuButtonContainerStyle=Object(lib.G)({root:{"&:hover":{background:"none"},"&:active":{background:"none"}}});return Object(jsx_runtime.jsxs)("div",{ref:containerRef,className:Object(lib.G)(participantItemContainerStyle,null==styles?void 0:styles.root),onMouseEnter:function onMouseEnter(){return setItemHovered(!0)},onMouseLeave:function onMouseLeave(){return setItemHovered(!1)},children:[avatarToUse,me&&Object(jsx_runtime.jsx)(Stack.a,{className:meTextStyle,children:isMeText}),onRenderIcon&&Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.G)(iconContainerStyle,null==styles?void 0:styles.iconContainer),children:[menuItems&&menuItems.length>0&&(itemHovered||!menuHidden)?Object(jsx_runtime.jsx)("div",{onMouseEnter:function onMouseEnter(){return setMenuButtonHovered(!0)},onMouseLeave:function onMouseLeave(){return setMenuButtonHovered(!1)},title:menuTitle,className:menuButtonContainerStyle,onClick:function onClick(){return setMenuHidden(!1)},children:menuButtonHovered?Object(jsx_runtime.jsx)(MoreHorizontal20Filled.a,{primaryFill:"currentColor"}):Object(jsx_runtime.jsx)(MoreHorizontal20Regular.a,{primaryFill:"currentColor"})}):onRenderIcon(props),menuItems&&menuItems.length>0&&Object(jsx_runtime.jsx)(ContextualMenu.a,{items:menuItems,hidden:menuHidden,target:containerRef,onItemClick:function onItemClick(){return setMenuHidden(!0)},onDismiss:function onDismiss(){return setMenuHidden(!0)},directionalHint:DirectionalHint.a.bottomRightEdge,className:contextualMenuStyle})]})]})};ParticipantItem_ParticipantItem.displayName="ParticipantItem",ParticipantItem_ParticipantItem.__docgenInfo={description:"`ParticipantItem` represents a participant in Calling or Chat. `ParticipantItem` displays a participant's avatar,\ndisplayName and status as well as optional icons and context menu.",methods:[],displayName:"ParticipantItem",props:{displayName:{required:!0,tsType:{name:"string"},description:"Name of participant."},me:{required:!1,tsType:{name:"boolean"},description:"Optional indicator to show participant is the user."},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props?: ParticipantItemProps) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"ParticipantItemProps"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback returning a JSX element to override avatar."},menuItems:{required:!1,tsType:{name:"Array",elements:[{name:"IContextualMenuItem"}],raw:"IContextualMenuItem[]"},description:"Optional array of IContextualMenuItem for contextual menu."},onRenderIcon:{required:!1,tsType:{name:"signature",type:"function",raw:"(props?: ParticipantItemProps) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"ParticipantItemProps"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback returning a JSX element rendered on the right portion of the ParticipantItem. Intended for adding icons."},presence:{required:!1,tsType:{name:"PersonaPresence"},description:"Optional PersonaPresence to show participant presence. This will not have an effect if property avatar is assigned."},styles:{required:!1,tsType:{name:"ParticipantItemStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<ParticipantItem styles={{ root: { background: 'blue' } }} />\n```"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"ParticipantItemStrings"}],raw:"Partial<ParticipantItemStrings>"},description:"Optional strings to override in component"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ParticipantItem.tsx"]={name:"ParticipantItem",docgenInfo:ParticipantItem_ParticipantItem.__docgenInfo,path:"../react-components/src/components/ParticipantItem.tsx"});__webpack_require__(81),__webpack_require__(269);var ShareScreenStart20Filled=__webpack_require__(1669),MicOff20Filled=__webpack_require__(1670),participantListStyle=Object(lib.G)({height:"100%",paddingLeft:"1.125rem",paddingRight:"1.125rem"});function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return ParticipantList_arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function ParticipantList_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return ParticipantList_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ParticipantList_arrayLikeToArray(o,minLen)}(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ParticipantList_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ParticipantList_onRenderParticipantsDefault=function onRenderParticipantsDefault(participants,myUserId,onParticipantRemove,onRenderAvatar){return participants.map((function(participant){var callingParticipant=participant,presence=void 0;callingParticipant&&("Connected"===callingParticipant.state?presence=Persona_types.b.online:"Idle"===callingParticipant.state&&(presence=Persona_types.b.away));var menuItems=[];participant.userId!==myUserId&&onParticipantRemove&&menuItems.push({key:"Remove",text:"Remove",onClick:function onClick(){return onParticipantRemove(participant.userId)}});var iconStyles=Object(lib.G)({height:"0.875rem"}),onRenderIcon=null!=callingParticipant&&callingParticipant.isScreenSharing||null!=callingParticipant&&callingParticipant.isMuted?function(){return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:{childrenGap:"0.5rem"},children:[callingParticipant.isScreenSharing&&Object(jsx_runtime.jsx)(ShareScreenStart20Filled.a,{className:iconStyles,primaryFill:"currentColor"}),callingParticipant.isMuted&&Object(jsx_runtime.jsx)(MicOff20Filled.a,{className:iconStyles,primaryFill:"currentColor"})]})}:function(){return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})},renderAvatar=onRenderAvatar?function(){return onRenderAvatar(participant)}:void 0;return participant.displayName?Object(jsx_runtime.jsx)(ParticipantItem_ParticipantItem,{displayName:participant.displayName,me:!!myUserId&&participant.userId===myUserId,menuItems:menuItems,presence:presence,onRenderIcon:onRenderIcon,onRenderAvatar:renderAvatar},participant.userId):null}))},ParticipantList_ParticipantList=function ParticipantList(props){var _props$excludeMe=props.excludeMe,excludeMe=void 0!==_props$excludeMe&&_props$excludeMe,myUserId=props.myUserId,participants=props.participants,onParticipantRemove=props.onParticipantRemove,onRenderAvatar=props.onRenderAvatar,onRenderParticipant=props.onRenderParticipant,ids=IdentifierProvider_useIdentifiers(),allParticipants=Object(react.useMemo)((function(){if(void 0===participants)return[];if(!excludeMe||!myUserId)return _toConsumableArray(participants);var userIndex=participants.map((function(p){return p.userId})).indexOf(myUserId);if(-1===userIndex)return _toConsumableArray(participants);var remoteParticipants=_toConsumableArray(participants);return remoteParticipants.splice(userIndex,1),remoteParticipants}),[participants,excludeMe,myUserId]);return Object(jsx_runtime.jsx)(Stack.a,{"data-ui-id":ids.participantList,className:participantListStyle,children:onRenderParticipant?participants.map((function(participant){return onRenderParticipant(participant)})):ParticipantList_onRenderParticipantsDefault(allParticipants,myUserId,onParticipantRemove,onRenderAvatar)})};ParticipantList_ParticipantList.displayName="ParticipantList",ParticipantList_ParticipantList.__docgenInfo={description:"`ParticipantList` renders a list of participants in Calling or Chat. If property `onRenderParticipant` is not\nassigned then each participant is rendered with `ParticipantItem`.",methods:[],displayName:"ParticipantList",props:{participants:{required:!0,tsType:{name:"Array",elements:[{name:"CommunicationParticipant"}],raw:"CommunicationParticipant[]"},description:"Participants in user call or chat"},myUserId:{required:!1,tsType:{name:"string"},description:"User ID of user"},excludeMe:{required:!1,tsType:{name:"boolean"},description:"If set to `true`, excludes the local participant from the participant list with use of `myUserId` props (required in this case).\n\n@defaultValue `false`"},onRenderParticipant:{required:!1,tsType:{name:"signature",type:"function",raw:"(participant: CommunicationParticipant) => JSX.Element | null",signature:{arguments:[{name:"participant",type:{name:"CommunicationParticipant"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to render each participant. If no callback is provided, each participant will be rendered with `ParticipantItem`"},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(participant: CommunicationParticipant) => JSX.Element | null",signature:{arguments:[{name:"participant",type:{name:"CommunicationParticipant"}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Optional callback to render the avatar for each participant. This property will have no effect if `onRenderParticipant` is assigned."},onParticipantRemove:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => void",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"void"}}},description:"Optional callback to render the context menu for each participant"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ParticipantList.tsx"]={name:"ParticipantList",docgenInfo:ParticipantList_ParticipantList.__docgenInfo,path:"../react-components/src/components/ParticipantList.tsx"});__webpack_require__(738);var Modal=__webpack_require__(1700),VideoGallery_styles_theme=Object(lib.B)(),videoBaseStyle=Object(lib.G)({border:0}),gridStyle=Object(lib.G)(videoBaseStyle,{width:"100%",height:"100%"}),videoGalleryContainerStyle={root:{position:"relative",height:"100%"}},floatingLocalVideoModalStyle={root:{width:"100%",height:"100%",overflow:"hidden"},main:{minWidth:"11.25rem",minHeight:"7rem",boxShadow:VideoGallery_styles_theme.effects.elevation8,borderRadius:VideoGallery_styles_theme.effects.roundedCorner4,position:"absolute",bottom:"1rem",right:"1rem"}},floatingLocalVideoTileStyle={root:{position:"absolute",zIndex:1,bottom:"0",right:"0",width:"11.25rem",height:"7rem",borderRadius:VideoGallery_styles_theme.effects.roundedCorner4}},Text_Text=__webpack_require__(1711),MicOff16Filled=__webpack_require__(1671),MicOn16Filled=__webpack_require__(1672),VideoTile_styles_theme=Object(lib.B)(),rootStyles={position:"relative",height:"100%",width:"100%",borderRadius:VideoTile_styles_theme.effects.roundedCorner4},videoContainerStyles={position:"absolute",top:"0",left:"0",width:"100%",height:"100%",minWidth:"100%",minHeight:"100%",objectPosition:"center",objectFit:"cover",zIndex:0},overlayContainerStyles={width:"100%",height:"100%",zIndex:5},disabledVideoHint=Object(lib.G)({backgroundColor:"inherit",bottom:"0.46875rem",boxShadow:"none",textAlign:"left",left:"0.5rem",overflow:"hidden",position:"absolute",whiteSpace:"nowrap",maxWidth:"95%",borderRadius:VideoTile_styles_theme.effects.roundedCorner4,alignItems:"center",padding:"0.15rem"}),videoHint=Object(lib.G)(disabledVideoHint,{backgroundColor:"rgba(255, 255, 255, 0.8)",alignItems:"center",padding:"0.15rem"}),displayNameStyle={padding:"0.1rem",fontSize:"0.75rem",fontWeight:600},VideoTile_styles_iconContainerStyle={padding:"0.1rem",height:"100%",alignItems:"center","& svg":{display:"block"}};function VideoTile_slicedToArray(arr,i){return function VideoTile_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VideoTile_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function VideoTile_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return VideoTile_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VideoTile_arrayLikeToArray(o,minLen)}(arr,i)||function VideoTile_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VideoTile_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var VideoTile_DefaultPlaceholder=function DefaultPlaceholder(props){var _personaRef$current,_personaRef$current$p,_personaRef$current2,_personaRef$current2$,displayName=props.displayName,noVideoAvailableAriaLabel=props.noVideoAvailableAriaLabel,personaRef=Object(react.useRef)(null),_useState2=VideoTile_slicedToArray(Object(react.useState)(100),2),coinSize=_useState2[0],setCoinSize=_useState2[1];return Object(react.useLayoutEffect)((function(){if(personaRef.current&&personaRef.current.parentElement){var minSize=Math.min(personaRef.current.parentElement.clientHeight,personaRef.current.parentElement.clientWidth,200);setCoinSize(minSize/2)}}),[null===(_personaRef$current=personaRef.current)||void 0===_personaRef$current||null===(_personaRef$current$p=_personaRef$current.parentElement)||void 0===_personaRef$current$p?void 0:_personaRef$current$p.clientHeight,null===(_personaRef$current2=personaRef.current)||void 0===_personaRef$current2||null===(_personaRef$current2$=_personaRef$current2.parentElement)||void 0===_personaRef$current2$?void 0:_personaRef$current2$.clientWidth]),Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)({position:"absolute",height:"100%",width:"100%"}),children:Object(jsx_runtime.jsx)(Ref.a,{innerRef:personaRef,children:Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto",maxHeight:"100%"}},coinSize:coinSize,hidePersonaDetails:!0,text:null!=displayName?displayName:"",initialsTextColor:"white","aria-label":null!=noVideoAvailableAriaLabel?noVideoAvailableAriaLabel:""})})})};VideoTile_DefaultPlaceholder.displayName="DefaultPlaceholder";var VideoTile_VideoTile=function VideoTile(props){var children=props.children,displayName=props.displayName,isMirrored=props.isMirrored,isMuted=props.isMuted,onRenderPlaceholder=props.onRenderPlaceholder,renderElement=props.renderElement,_props$showMuteIndica=props.showMuteIndicator,showMuteIndicator=void 0===_props$showMuteIndica||_props$showMuteIndica,styles=props.styles,placeHolderProps={userId:props.userId,displayName:displayName,noVideoAvailableAriaLabel:props.noVideoAvailableAriaLabel},theme=FluentThemeProvider_useTheme(),isVideoRendered=!!renderElement;return Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.G)(rootStyles,{background:theme.palette.neutralLighter},null==styles?void 0:styles.root),children:[isVideoRendered?Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(videoContainerStyles,isMirrored&&{transform:"scaleX(-1)"},null==styles?void 0:styles.videoContainer),children:renderElement}):Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(videoContainerStyles),children:onRenderPlaceholder?onRenderPlaceholder(placeHolderProps,VideoTile_DefaultPlaceholder):Object(jsx_runtime.jsx)(VideoTile_DefaultPlaceholder,Object.assign({},placeHolderProps))}),Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,className:Object(lib.G)(isVideoRendered?videoHint:disabledVideoHint,{color:isVideoRendered?lib.c.neutralPrimary:theme.palette.neutralPrimary},null==styles?void 0:styles.displayNameContainer),children:[Object(jsx_runtime.jsx)(Stack.a,{children:displayName&&Object(jsx_runtime.jsx)(Text_Text.a,{className:Object(lib.G)(displayNameStyle,{color:isVideoRendered?lib.c.neutralPrimary:theme.palette.neutralPrimary}),children:displayName})}),Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(VideoTile_styles_iconContainerStyle),children:showMuteIndicator&&void 0!==isMuted&&(isMuted?Object(jsx_runtime.jsx)(MicOff16Filled.a,{primaryFill:"currentColor"},"microphoneOffIconKey"):Object(jsx_runtime.jsx)(MicOn16Filled.a,{primaryFill:"currentColor"},"microphoneIconKey"))})]}),children&&Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(overlayContainerStyles,null==styles?void 0:styles.overlayContainer),children:children})]})};function VideoGallery_slicedToArray(arr,i){return function VideoGallery_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function VideoGallery_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function VideoGallery_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return VideoGallery_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VideoGallery_arrayLikeToArray(o,minLen)}(arr,i)||function VideoGallery_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function VideoGallery_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}VideoTile_VideoTile.displayName="VideoTile",VideoTile_VideoTile.__docgenInfo={description:"",methods:[],displayName:"VideoTile",props:{userId:{required:!1,tsType:{name:"string"},description:"user id for the VideoTile placeholder."},displayName:{required:!1,tsType:{name:"string"},description:"Optional participant display name for the VideoTile default placeholder."},noVideoAvailableAriaLabel:{required:!1,tsType:{name:"string"},description:"Optional property to set the aria label of the video tile if there is no available stream."},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"React Child components. Child Components will show as overlay component in the VideoTile."},styles:{required:!1,tsType:{name:"VideoTileStylesProps"},description:"Allows users to pass in an object contains custom CSS styles.\n@Example\n```\n<VideoTile styles={{ root: { background: 'blue' } }} />\n```"},renderElement:{required:!1,tsType:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]},description:"Component with the video stream."},isMirrored:{required:!1,tsType:{name:"boolean"},description:"Determines if the video is mirrored or not."},onRenderPlaceholder:{required:!1,tsType:{name:"signature",type:"function",raw:"(\n  props: PlaceholderProps,\n  defaultOnRender: (props: PlaceholderProps) => JSX.Element\n) => JSX.Element | null",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"union",raw:"JSX.Element | null",elements:[{name:"JSX.Element"},{name:"null"}]}}},description:"Custom render Component function for no video is available. Render a Persona Icon if undefined."},showMuteIndicator:{required:!1,tsType:{name:"boolean"},description:"Whether to display a mute icon beside the user's display name."},isMuted:{required:!1,tsType:{name:"boolean"},description:"Whether the video is muted or not."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/VideoTile.tsx"]={name:"VideoTile",docgenInfo:VideoTile_VideoTile.__docgenInfo,path:"../react-components/src/components/VideoTile.tsx"});var emptyStyles={},DRAG_OPTIONS={moveMenuItemText:"Move",closeMenuItemText:"Close",menu:ContextualMenu.a,keepInBounds:!0},VideoGallery_VideoGallery=function VideoGallery(props){var localParticipant=props.localParticipant,remoteParticipants=props.remoteParticipants,localVideoViewOption=props.localVideoViewOption,remoteVideoViewOption=props.remoteVideoViewOption,onRenderLocalVideoTile=props.onRenderLocalVideoTile,onRenderRemoteVideoTile=props.onRenderRemoteVideoTile,onCreateLocalStreamView=props.onCreateLocalStreamView,onCreateRemoteStreamView=props.onCreateRemoteStreamView,onDisposeRemoteStreamView=props.onDisposeRemoteStreamView,styles=props.styles,layout=props.layout,onRenderAvatar=props.onRenderAvatar,showMuteIndicator=props.showMuteIndicator,_useState2=VideoGallery_slicedToArray(Object(react.useState)([]),2),sortedRemoteParticipants=_useState2[0],setSortedRemoteParticipants=_useState2[1],ids=IdentifierProvider_useIdentifiers();Object(react.useEffect)((function(){setSortedRemoteParticipants(function sortParticipants(participants){return participants?participants.sort((function(p1,p2){var _p1$videoStream,_p1$videoStream$rende,_p2$videoStream,_p2$videoStream$rende,_p1$videoStream2,_p1$videoStream2$rend,_p2$videoStream2,_p2$videoStream2$rend;return null!=p1&&null!==(_p1$videoStream=p1.videoStream)&&void 0!==_p1$videoStream&&null!==(_p1$videoStream$rende=_p1$videoStream.renderElement)&&void 0!==_p1$videoStream$rende&&_p1$videoStream$rende.childElementCount||null!=p2&&null!==(_p2$videoStream=p2.videoStream)&&void 0!==_p2$videoStream&&null!==(_p2$videoStream$rende=_p2$videoStream.renderElement)&&void 0!==_p2$videoStream$rende&&_p2$videoStream$rende.childElementCount?null!=p1&&null!==(_p1$videoStream2=p1.videoStream)&&void 0!==_p1$videoStream2&&null!==(_p1$videoStream2$rend=_p1$videoStream2.renderElement)&&void 0!==_p1$videoStream2$rend&&_p1$videoStream2$rend.childElementCount?null!=p2&&null!==(_p2$videoStream2=p2.videoStream)&&void 0!==_p2$videoStream2&&null!==(_p2$videoStream2$rend=_p2$videoStream2.renderElement)&&void 0!==_p2$videoStream2$rend&&_p2$videoStream2$rend.childElementCount?0:-1:1:0})):[]}(remoteParticipants))}),[remoteParticipants]);var shouldFloatLocalVideo=Object(react.useCallback)((function(){return!!("floatingLocalVideo"===layout&&remoteParticipants&&remoteParticipants.length>0)}),[layout,remoteParticipants]),defaultOnRenderLocalVideoTile=Object(react.useMemo)((function(){var localVideoStream=null==localParticipant?void 0:localParticipant.videoStream;if(onRenderLocalVideoTile)return onRenderLocalVideoTile(localParticipant);var localVideoTileStyles={};return shouldFloatLocalVideo()&&(localVideoTileStyles=floatingLocalVideoTileStyle),localVideoStream&&!localVideoStream.renderElement&&onCreateLocalStreamView&&onCreateLocalStreamView(localVideoViewOption),Object(jsx_runtime.jsx)(VideoTile_VideoTile,{userId:localParticipant.userId,renderElement:null!=localVideoStream&&localVideoStream.renderElement?Object(jsx_runtime.jsx)(StreamMedia_StreamMedia,{videoStreamElement:localVideoStream.renderElement}):void 0,displayName:null==localParticipant?void 0:localParticipant.displayName,styles:localVideoTileStyles,onRenderPlaceholder:onRenderAvatar,isMuted:localParticipant.isMuted,showMuteIndicator:showMuteIndicator})}),[localParticipant,localParticipant.videoStream,onCreateLocalStreamView,onRenderLocalVideoTile,onRenderAvatar]),defaultOnRenderRemoteParticipants=Object(react.useMemo)((function(){return onRenderRemoteVideoTile?sortedRemoteParticipants.map((function(participant){return onRenderRemoteVideoTile(participant)})):sortedRemoteParticipants.map((function(participant){var remoteVideoStream=participant.videoStream;return Object(jsx_runtime.jsx)(RemoteVideoTile,{userId:participant.userId,onCreateRemoteStreamView:onCreateRemoteStreamView,onDisposeRemoteStreamView:onDisposeRemoteStreamView,isAvailable:null==remoteVideoStream?void 0:remoteVideoStream.isAvailable,isMuted:participant.isMuted,renderElement:null==remoteVideoStream?void 0:remoteVideoStream.renderElement,displayName:participant.displayName,remoteVideoViewOption:remoteVideoViewOption,onRenderAvatar:onRenderAvatar,showMuteIndicator:showMuteIndicator},participant.userId)}))}),[sortedRemoteParticipants,onRenderRemoteVideoTile,onCreateRemoteStreamView,onDisposeRemoteStreamView,remoteVideoViewOption,onRenderAvatar,showMuteIndicator]);if(shouldFloatLocalVideo()){return Object(jsx_runtime.jsxs)(Stack.a,{id:"UILibraryFloatingTileHost",grow:!0,styles:videoGalleryContainerStyle,children:[Object(jsx_runtime.jsx)(Modal.a,{isOpen:!0,isModeless:!0,dragOptions:DRAG_OPTIONS,styles:floatingLocalVideoModalStyle,layerProps:{hostId:"UILibraryFloatingTileHost"},children:localParticipant&&defaultOnRenderLocalVideoTile}),Object(jsx_runtime.jsx)(GridLayout_GridLayout,{styles:null!=styles?styles:emptyStyles,children:defaultOnRenderRemoteParticipants})]})}return Object(jsx_runtime.jsxs)(GridLayout_GridLayout,{styles:null!=styles?styles:emptyStyles,children:[Object(jsx_runtime.jsx)(Stack.a,{"data-ui-id":ids.videoGallery,horizontalAlign:"center",verticalAlign:"center",className:gridStyle,grow:!0,children:localParticipant&&defaultOnRenderLocalVideoTile}),defaultOnRenderRemoteParticipants]})};VideoGallery_VideoGallery.displayName="VideoGallery";var RemoteVideoTile=react_default.a.memo((function(props){var isAvailable=props.isAvailable,isMuted=props.isMuted,onCreateRemoteStreamView=props.onCreateRemoteStreamView,onDisposeRemoteStreamView=props.onDisposeRemoteStreamView,remoteVideoViewOption=props.remoteVideoViewOption,renderElement=props.renderElement,userId=props.userId,displayName=props.displayName,onRenderAvatar=props.onRenderAvatar,showMuteIndicator=props.showMuteIndicator;Object(react.useEffect)((function(){isAvailable&&!renderElement&&onCreateRemoteStreamView&&onCreateRemoteStreamView(userId,remoteVideoViewOption),isAvailable||onDisposeRemoteStreamView&&onDisposeRemoteStreamView(userId)}),[isAvailable,onCreateRemoteStreamView,onDisposeRemoteStreamView,remoteVideoViewOption,renderElement,userId]),Object(react.useEffect)((function(){return function(){onDisposeRemoteStreamView&&onDisposeRemoteStreamView(userId)}}),[onDisposeRemoteStreamView,userId]);var renderVideoStreamElement=Object(react.useMemo)((function(){if(renderElement&&renderElement.childElementCount)return Object(jsx_runtime.jsx)(StreamMedia_StreamMedia,{videoStreamElement:renderElement})}),[renderElement,null==renderElement?void 0:renderElement.childElementCount]);return Object(jsx_runtime.jsx)(Stack.a,{className:gridStyle,grow:!0,children:Object(jsx_runtime.jsx)(VideoTile_VideoTile,{userId:userId,renderElement:renderVideoStreamElement,displayName:displayName,onRenderPlaceholder:onRenderAvatar,isMuted:isMuted,showMuteIndicator:showMuteIndicator})},userId)}));VideoGallery_VideoGallery.__docgenInfo={description:"VideoGallery represents a `GridLayout` of video tiles for a specific call.\nIt displays a `VideoTile` for the local user as well as for each remote participants who joined the call.\n\n@param props - of type `VideoGalleryProps`\n\n@returns a JSX Element",methods:[],displayName:"VideoGallery",props:{styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass an object containing custom CSS styles for the gallery container.\n\n@Example\n```\n<VideoGallery styles={{ root: { border: 'solid 1px red' } }} />\n```"},layout:{required:!1,tsType:{name:"union",raw:"'default' | 'floatingLocalVideo'",elements:[{name:"literal",value:"'default'"},{name:"literal",value:"'floatingLocalVideo'"}]},description:"Layout of the video tiles."},localParticipant:{required:!0,tsType:{name:"VideoGalleryLocalParticipant"},description:"Local video particpant"},remoteParticipants:{required:!1,tsType:{name:"Array",elements:[{name:"VideoGalleryRemoteParticipant"}],raw:"VideoGalleryRemoteParticipant[]"},description:"List of remote video particpants"},localVideoViewOption:{required:!1,tsType:{name:"VideoStreamOptions"},description:"Local video view options"},remoteVideoViewOption:{required:!1,tsType:{name:"VideoStreamOptions"},description:"Remote videos view options"},onCreateLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback to create the local video stream view"},onDisposeLocalStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Callback to dispose of the local video stream view"},onRenderLocalVideoTile:{required:!1,tsType:{name:"signature",type:"function",raw:"(localParticipant: VideoGalleryLocalParticipant) => JSX.Element",signature:{arguments:[{name:"localParticipant",type:{name:"VideoGalleryLocalParticipant"}}],return:{name:"JSX.Element"}}},description:"Callback to render the local video tile"},onCreateRemoteStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string, options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"userId",type:{name:"string"}},{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback to create a remote video stream view"},onRenderRemoteVideoTile:{required:!1,tsType:{name:"signature",type:"function",raw:"(remoteParticipant: VideoGalleryRemoteParticipant) => JSX.Element",signature:{arguments:[{name:"remoteParticipant",type:{name:"VideoGalleryRemoteParticipant"}}],return:{name:"JSX.Element"}}},description:"Callback to render a remote video tile"},onDisposeRemoteStreamView:{required:!1,tsType:{name:"signature",type:"function",raw:"(userId: string) => Promise<void>",signature:{arguments:[{name:"userId",type:{name:"string"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:""},onRenderAvatar:{required:!1,tsType:{name:"signature",type:"function",raw:"(props: PlaceholderProps, defaultOnRender: (props: PlaceholderProps) => JSX.Element) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}},{name:"defaultOnRender",type:{name:"signature",type:"function",raw:"(props: PlaceholderProps) => JSX.Element",signature:{arguments:[{name:"props",type:{name:"PlaceholderProps"}}],return:{name:"JSX.Element"}}}}],return:{name:"JSX.Element"}}},description:"Callback to render a particpant avatar"},showMuteIndicator:{required:!1,tsType:{name:"boolean"},description:"Whether to display a mute icon beside the user's display name.\n@defaultValue `true`"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/VideoGallery.tsx"]={name:"VideoGallery",docgenInfo:VideoGallery_VideoGallery.__docgenInfo,path:"../react-components/src/components/VideoGallery.tsx"});var Video20Filled=__webpack_require__(1673),VideoOff20Filled=__webpack_require__(1674),Label=__webpack_require__(1710),DefaultButton=__webpack_require__(430),ControlBar_styles_theme=Object(lib.B)(),palette=ControlBar_styles_theme.palette,controlBarStyles={horizontal:{flexFlow:"row nowrap"},vertical:{flexFlow:"column nowrap",maxWidth:"3.5rem"},dockedTop:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",top:0,left:0,width:"100%"},dockedBottom:{flexFlow:"row nowrap",justifyContent:"center",overflow:"hidden",position:"absolute",bottom:0,left:0,width:"100%"},dockedLeft:{justifyContent:"center",overflow:"hidden",position:"absolute",top:0,left:0,height:"100%"},dockedRight:{justifyContent:"center",overflow:"hidden",position:"absolute",top:0,right:0,height:"100%"},floatingTop:{flexFlow:"row nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",top:"1rem",left:"50%",transform:"translateX(-50%)",zIndex:10},floatingBottom:{flexFlow:"row nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",bottom:"1rem",left:"50%",transform:"translateX(-50%)",zIndex:10},floatingLeft:{flexFlow:"column nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",top:"50%",left:"1rem",transform:"translateY(-50%)",zIndex:10},floatingRight:{flexFlow:"column nowrap",justifyContent:"center",boxShadow:ControlBar_styles_theme.effects.elevation16,borderRadius:ControlBar_styles_theme.effects.roundedCorner6,overflow:"hidden",position:"absolute",top:"50%",right:"1rem",transform:"translateY(-50%)",zIndex:10}},controlButtonStyles={root:{background:"none",border:"none",borderRadius:0,minHeight:"3.5rem",minWidth:"3.5rem",svg:{verticalAlign:"text-top"}},flexContainer:{flexFlow:"column",display:"contents"}},controlButtonLabelStyles={fontSize:"0.625rem",lineHeight:"1rem",cursor:"pointer"},endCallControlButtonStyles=Object(lib.q)(controlButtonStyles,{root:{color:palette.white},rootHovered:{color:palette.white},rootPressed:{color:palette.white},label:{color:palette.white}}),participantsButtonMenuPropsStyle={title:{background:"initial",paddingLeft:".5rem",fontWeight:600,fontSize:".75rem"}},defaultParticipantListContainerStyle={maxHeight:"20rem"},ControlBarButton_DefaultRenderText=function DefaultRenderText(props){var _ref,_props$text,_props$strings,_props$strings2,_props$strings3,_props$styles,labelText=null!==(_ref=null!==(_props$text=null==props?void 0:props.text)&&void 0!==_props$text?_props$text:null==props||null===(_props$strings=props.strings)||void 0===_props$strings?void 0:_props$strings.label)&&void 0!==_ref?_ref:null!=props&&props.checked?null==props||null===(_props$strings2=props.strings)||void 0===_props$strings2?void 0:_props$strings2.onLabel:null==props||null===(_props$strings3=props.strings)||void 0===_props$strings3?void 0:_props$strings3.offLabel;return Object(jsx_runtime.jsx)(Label.a,{className:Object(lib.G)(controlButtonLabelStyles,null==props||null===(_props$styles=props.styles)||void 0===_props$styles?void 0:_props$styles.label),children:labelText},null==props?void 0:props.labelKey)};ControlBarButton_DefaultRenderText.displayName="DefaultRenderText";var DefaultRenderIcon=function DefaultRenderIcon(props){return null!=props&&props.checked?null!=props&&props.onRenderOnIcon?null==props?void 0:props.onRenderOnIcon():null:null!=props&&props.onRenderOffIcon?null==props?void 0:props.onRenderOffIcon():null},ControlBarButton_ControlBarButton=function ControlBarButton(props){var _props$styles2,_props$onRenderText,_props$onRenderIcon,componentStyles=Object(lib.q)(controlButtonStyles,null!==(_props$styles2=props.styles)&&void 0!==_props$styles2?_props$styles2:{});return Object(jsx_runtime.jsx)(DefaultButton.a,Object.assign({},props,{styles:componentStyles,onRenderText:props.showLabel?null!==(_props$onRenderText=props.onRenderText)&&void 0!==_props$onRenderText?_props$onRenderText:ControlBarButton_DefaultRenderText:void 0,onRenderIcon:null!==(_props$onRenderIcon=props.onRenderIcon)&&void 0!==_props$onRenderIcon?_props$onRenderIcon:DefaultRenderIcon}))};function CameraButton_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function CameraButton_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){CameraButton_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){CameraButton_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function CameraButton_slicedToArray(arr,i){return function CameraButton_arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function CameraButton_iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function CameraButton_unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return CameraButton_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CameraButton_arrayLikeToArray(o,minLen)}(arr,i)||function CameraButton_nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function CameraButton_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}ControlBarButton_ControlBarButton.displayName="ControlBarButton",ControlBarButton_ControlBarButton.__docgenInfo={description:"Default button styled for the Control Bar. This can be used to create custom buttons that are styled the same as other buttons provided by the UI Library.",methods:[],displayName:"ControlBarButton",props:{showLabel:{required:!1,tsType:{name:"boolean"},description:"Whether the label is displayed or not.\n\n@defaultValue `false`"},labelKey:{required:!1,tsType:{name:"string"},description:"Key to use for the Label component"},strings:{required:!1,tsType:{name:"ControlBarButtonStrings"},description:"Optional strings to override in component."},onRenderOnIcon:{required:!1,tsType:{name:"IRenderFunction",elements:[{name:"IButtonProps"}],raw:"IRenderFunction<IButtonProps>"},description:"Icon to render when the button is checked."},onRenderOffIcon:{required:!1,tsType:{name:"IRenderFunction",elements:[{name:"IButtonProps"}],raw:"IRenderFunction<IButtonProps>"},description:"Icon to render when the button is not checked."}},composes:["IButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ControlBarButton.tsx"]={name:"ControlBarButton",docgenInfo:ControlBarButton_ControlBarButton.__docgenInfo,path:"../react-components/src/components/ControlBarButton.tsx"});var defaultLocalVideoViewOption={scalingMode:"Crop",isMirrored:!0},CameraButton_onRenderCameraOnIcon=function onRenderCameraOnIcon(){return Object(jsx_runtime.jsx)(Video20Filled.a,{primaryFill:"currentColor"},"videoIconKey")};CameraButton_onRenderCameraOnIcon.displayName="onRenderCameraOnIcon";var CameraButton_onRenderCameraOffIcon=function onRenderCameraOffIcon(){return Object(jsx_runtime.jsx)(VideoOff20Filled.a,{primaryFill:"currentColor"},"videoOffIconKey")};CameraButton_onRenderCameraOffIcon.displayName="onRenderCameraOffIcon";var CameraButton_CameraButton=function CameraButton(props){var _props$onRenderOnIcon,_props$onRenderOffIco,_props$labelKey,localVideoViewOption=props.localVideoViewOption,onToggleCamera=props.onToggleCamera,_useState2=CameraButton_slicedToArray(Object(react.useState)(!1),2),waitForCamera=_useState2[0],setWaitForCamera=_useState2[1],localeStrings=LocalizationProvider_useLocale().strings.cameraButton,strings=Object.assign({},localeStrings,props.strings),onToggleClick=Object(react.useCallback)(CameraButton_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!onToggleCamera){_context.next=5;break}return setWaitForCamera(!0),_context.next=4,onToggleCamera(null!=localVideoViewOption?localVideoViewOption:defaultLocalVideoViewOption);case 4:setWaitForCamera(!1);case 5:case"end":return _context.stop()}}),_callee)}))),[localVideoViewOption,onToggleCamera]);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{disabled:props.disabled||waitForCamera,onClick:onToggleCamera?onToggleClick:props.onClick,onRenderOnIcon:null!==(_props$onRenderOnIcon=props.onRenderOnIcon)&&void 0!==_props$onRenderOnIcon?_props$onRenderOnIcon:CameraButton_onRenderCameraOnIcon,onRenderOffIcon:null!==(_props$onRenderOffIco=props.onRenderOffIcon)&&void 0!==_props$onRenderOffIco?_props$onRenderOffIco:CameraButton_onRenderCameraOffIcon,strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"cameraButtonLabel"}))};CameraButton_CameraButton.displayName="CameraButton",CameraButton_CameraButton.__docgenInfo={description:"`CameraButton` allows you to easily create a component for rendering a camera button.\nIt can be used in your ControlBar component for example.\n\n@param props - of type CameraButtonProps",methods:[],displayName:"CameraButton",props:{onToggleCamera:{required:!1,tsType:{name:"signature",type:"function",raw:"(options?: VideoStreamOptions) => Promise<void>",signature:{arguments:[{name:"options",type:{name:"VideoStreamOptions"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."},localVideoViewOption:{required:!1,tsType:{name:"VideoStreamOptions"},description:"Options for rendering local video view."},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"CameraButtonStrings"}],raw:"Partial<CameraButtonStrings>"},description:"Optional strings to override in component"}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/CameraButton.tsx"]={name:"CameraButton",docgenInfo:CameraButton_CameraButton.__docgenInfo,path:"../react-components/src/components/CameraButton.tsx"});__webpack_require__(186);var mainDivStyle={position:"relative",height:"100%",width:"100%"},ControlBar_ControlBar=function ControlBar(props){var styles=props.styles,layout=props.layout,theme=FluentThemeProvider_useTheme(),controlBarClassName=Object(react.useMemo)((function(){var controlBarStyle=controlBarStyles[null!=layout?layout:"horizontal"],backgroundStyle={background:isDarkThemed(theme)&&null!=layout&&layout.startsWith("floating")?theme.palette.neutralQuaternaryAlt:theme.palette.white},transformOverrideStyle=!theme.rtl||"floatingTop"!==layout&&"floatingBottom"!==layout?{}:{transform:"translateX(50%)"};return Object(lib.G)(controlBarStyle,backgroundStyle,transformOverrideStyle,null==styles?void 0:styles.root)}),[layout,null==styles?void 0:styles.root,theme]);return Object(jsx_runtime.jsx)("div",{className:Object(lib.G)(mainDivStyle),children:Object(jsx_runtime.jsx)(Stack.a,{className:controlBarClassName,children:props.children})})};ControlBar_ControlBar.displayName="ControlBar",ControlBar_ControlBar.__docgenInfo={description:"`ControlBar` allows you to easily create a component for call controls using\n[Button](https://developer.microsoft.com/en-us/fluentui#/controls/web/button) component from\nFluent UI. Users will need to provide methods to Button components used inside `ControlBar`\nfor altering call behavior.",methods:[],displayName:"ControlBar",props:{children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:"React Child components."},styles:{required:!1,tsType:{name:"BaseCustomStylesProps"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<ControlBar styles={{ root: { background: 'blue' } }} />\n```"},layout:{required:!1,tsType:{name:"union",raw:"| 'horizontal'\n| 'vertical'\n| 'dockedTop'\n| 'dockedBottom'\n| 'dockedLeft'\n| 'dockedRight'\n| 'floatingTop'\n| 'floatingBottom'\n| 'floatingLeft'\n| 'floatingRight'",elements:[{name:"literal",value:"'horizontal'"},{name:"literal",value:"'vertical'"},{name:"literal",value:"'dockedTop'"},{name:"literal",value:"'dockedBottom'"},{name:"literal",value:"'dockedLeft'"},{name:"literal",value:"'dockedRight'"},{name:"literal",value:"'floatingTop'"},{name:"literal",value:"'floatingBottom'"},{name:"literal",value:"'floatingLeft'"},{name:"literal",value:"'floatingRight'"}]},description:"Changes the layout of the control bar.\nAvailable layouts are `horizontal`, `vertical`, `dockedTop`, `dockedBottom`,\n`dockedLeft`, `dockedRight`, `floatingTop`, `floatingBottom`, `floatingLeft`,\n`floatingRight`\nDefaults to a `horizontal` layout."}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ControlBar.tsx"]={name:"ControlBar",docgenInfo:ControlBar_ControlBar.__docgenInfo,path:"../react-components/src/components/ControlBar.tsx"});var CallEnd20Filled=__webpack_require__(1675),EndCallButton_onRenderEndCallIcon=function onRenderEndCallIcon(){return Object(jsx_runtime.jsx)(CallEnd20Filled.a,{primaryFill:"currentColor"},"callEndIconKey")};EndCallButton_onRenderEndCallIcon.displayName="onRenderEndCallIcon";var EndCallButton_EndCallButton=function EndCallButton(props){var _props$onHangUp,_props$onRenderIcon,_props$labelKey,styles=props.styles,localeStrings=LocalizationProvider_useLocale().strings.endCallButton,strings=Object.assign({},localeStrings,props.strings),isDarkTheme=isDarkThemed(FluentThemeProvider_useTheme()),componentStyles=Object(lib.q)(endCallControlButtonStyles,{root:{background:isDarkTheme?darkTheme.callingPalette.callRed:lightTheme.callingPalette.callRed},rootHovered:{background:isDarkTheme?darkTheme.callingPalette.callRedDark:lightTheme.callingPalette.callRedDark},rootPressed:{background:isDarkTheme?darkTheme.callingPalette.callRedDarker:lightTheme.callingPalette.callRedDarker}},null!=styles?styles:{});return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{onClick:null!==(_props$onHangUp=props.onHangUp)&&void 0!==_props$onHangUp?_props$onHangUp:props.onClick,styles:componentStyles,onRenderIcon:null!==(_props$onRenderIcon=props.onRenderIcon)&&void 0!==_props$onRenderIcon?_props$onRenderIcon:EndCallButton_onRenderEndCallIcon,strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"endCallButtonLabel"}))};EndCallButton_EndCallButton.displayName="EndCallButton",EndCallButton_EndCallButton.__docgenInfo={description:"`EndCallButton` allows you to easily create a component for rendering a end call button. It can be used in your ControlBar component for example.\n\n@param props - of type EndCallButtonProps",methods:[],displayName:"EndCallButton",props:{onHangUp:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."},strings:{required:!1,tsType:{name:"EndCallButtonStrings"},description:"Optional strings to override in component"}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/EndCallButton.tsx"]={name:"EndCallButton",docgenInfo:EndCallButton_EndCallButton.__docgenInfo,path:"../react-components/src/components/EndCallButton.tsx"});var MicOn20Filled=__webpack_require__(1676),MicrophoneButton_onRenderMicOnIcon=function onRenderMicOnIcon(){return Object(jsx_runtime.jsx)(MicOn20Filled.a,{primaryFill:"currentColor"},"microphoneIconKey")};MicrophoneButton_onRenderMicOnIcon.displayName="onRenderMicOnIcon";var MicrophoneButton_onRenderMicOffIcon=function onRenderMicOffIcon(){return Object(jsx_runtime.jsx)(MicOff20Filled.a,{primaryFill:"currentColor"},"microphoneOffIconKey")};MicrophoneButton_onRenderMicOffIcon.displayName="onRenderMicOffIcon";var MicrophoneButton_MicrophoneButton=function MicrophoneButton(props){var _props$onToggleMicrop,_props$onRenderOnIcon,_props$onRenderOffIco,_props$labelKey,localeStrings=LocalizationProvider_useLocale().strings.microphoneButton,strings=Object.assign({},localeStrings,props.strings);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{onClick:null!==(_props$onToggleMicrop=props.onToggleMicrophone)&&void 0!==_props$onToggleMicrop?_props$onToggleMicrop:props.onClick,onRenderOnIcon:null!==(_props$onRenderOnIcon=props.onRenderOnIcon)&&void 0!==_props$onRenderOnIcon?_props$onRenderOnIcon:MicrophoneButton_onRenderMicOnIcon,onRenderOffIcon:null!==(_props$onRenderOffIco=props.onRenderOffIcon)&&void 0!==_props$onRenderOffIco?_props$onRenderOffIco:MicrophoneButton_onRenderMicOffIcon,strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"microphoneButtonLabel"}))};MicrophoneButton_MicrophoneButton.displayName="MicrophoneButton",MicrophoneButton_MicrophoneButton.__docgenInfo={description:"`MicrophoneButton` allows you to easily create a component for rendering an audio button. It can be used in your ControlBar component for example.\n@param props - of type MicrophoneButtonProps",methods:[],displayName:"MicrophoneButton",props:{onToggleMicrophone:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"MicrophoneButtonStrings"}],raw:"Partial<MicrophoneButtonStrings>"},description:"Optional strings to override in component"}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/MicrophoneButton.tsx"]={name:"MicrophoneButton",docgenInfo:MicrophoneButton_MicrophoneButton.__docgenInfo,path:"../react-components/src/components/MicrophoneButton.tsx"});var Video20Regular=__webpack_require__(1677),ContextualMenu_types=__webpack_require__(142),iconStyle={display:"flex",alignItems:"center"},OptionsButton_onRenderOptionsIcon=function onRenderOptionsIcon(){return Object(jsx_runtime.jsx)(MoreHorizontal20Filled.a,{primaryFill:"currentColor"},"optionsIconKey")};OptionsButton_onRenderOptionsIcon.displayName="onRenderOptionsIcon";var OptionsButton_OptionsButton=function OptionsButton(props){var _props$menuProps,_props$labelKey,onRenderIcon=props.onRenderIcon,theme=FluentThemeProvider_useTheme(),localeStrings=LocalizationProvider_useLocale().strings.optionsButton,strings=Object.assign({},localeStrings,props.strings),defaultMenuProps=function generateDefaultMenuProps(props,strings,theme){var microphones=props.microphones,speakers=props.speakers,cameras=props.cameras,selectedMicrophone=props.selectedMicrophone,selectedSpeaker=props.selectedSpeaker,selectedCamera=props.selectedCamera,onSelectCamera=props.onSelectCamera,onSelectMicrophone=props.onSelectMicrophone,onSelectSpeaker=props.onSelectSpeaker,defaultMenuProps={items:[],calloutProps:{styles:{root:{maxWidth:"100%"}}}};if(cameras&&selectedCamera&&onSelectCamera&&defaultMenuProps.items.push({key:"sectionCamera",title:strings.cameraMenuTooltip,itemType:ContextualMenu_types.a.Section,sectionProps:{title:strings.cameraMenuTitle,items:cameras.map((function(camera){return{key:camera.id,text:camera.name,title:camera.name,onRenderIcon:function onRenderIcon(){return Object(jsx_runtime.jsx)(Video20Regular.a,{style:Object.assign({},iconStyle,{color:theme.palette.themePrimary})})},canCheck:!0,isChecked:camera.id===(null==selectedCamera?void 0:selectedCamera.id),onClick:function onClick(){camera.id!==(null==selectedCamera?void 0:selectedCamera.id)&&onSelectCamera(camera)}}}))}}),microphones&&selectedMicrophone&&onSelectMicrophone&&defaultMenuProps.items.push({key:"sectionMicrophone",title:strings.microphoneMenuTooltip,itemType:ContextualMenu_types.a.Section,sectionProps:{title:strings.microphoneMenuTitle,items:microphones.map((function(microphone){return{key:microphone.id,text:microphone.name,title:microphone.name,iconProps:{iconName:"Microphone"},canCheck:!0,isChecked:microphone.id===(null==selectedMicrophone?void 0:selectedMicrophone.id),onClick:function onClick(){microphone.id!==(null==selectedMicrophone?void 0:selectedMicrophone.id)&&onSelectMicrophone(microphone)}}}))}}),speakers&&selectedSpeaker&&onSelectSpeaker&&defaultMenuProps.items.push({key:"sectionSpeaker",title:strings.speakerMenuTooltip,itemType:ContextualMenu_types.a.Section,sectionProps:{title:strings.speakerMenuTitle,items:speakers.map((function(speaker){return{key:speaker.id,text:speaker.name,title:speaker.name,iconProps:{iconName:"Volume1"},canCheck:!0,isChecked:speaker.id===(null==selectedSpeaker?void 0:selectedSpeaker.id),onClick:function onClick(){speaker.id!==(null==selectedSpeaker?void 0:selectedSpeaker.id)&&onSelectSpeaker(speaker)}}}))}}),0!==defaultMenuProps.items.length)return defaultMenuProps}(props,strings,theme);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{menuProps:null!==(_props$menuProps=props.menuProps)&&void 0!==_props$menuProps?_props$menuProps:defaultMenuProps,menuIconProps:{hidden:!0},onRenderIcon:null!=onRenderIcon?onRenderIcon:OptionsButton_onRenderOptionsIcon,strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"optionsButtonLabel"}))};OptionsButton_OptionsButton.displayName="OptionsButton",OptionsButton_OptionsButton.__docgenInfo={description:"`OptionsButton` allows you to easily create a component for rendering an options button. It can be used in your ControlBar component for example.\nThis button should contain dropdown menu items you can define through its property `menuProps`.\nThis `menuProps` property is of type [IContextualMenuProps](https://developer.microsoft.com/en-us/fluentui#/controls/web/contextualmenu#IContextualMenuProps).\n\n@param props - of type OptionsButtonProps",methods:[],displayName:"OptionsButton",props:{microphones:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available microphones for selection"},speakers:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available speakers for selection"},cameras:{required:!1,tsType:{name:"Array",elements:[{name:"OptionsDevice"}],raw:"OptionsDevice[]"},description:"Available cameras for selection"},selectedMicrophone:{required:!1,tsType:{name:"OptionsDevice"},description:"Microphone that is shown as currently selected"},selectedSpeaker:{required:!1,tsType:{name:"OptionsDevice"},description:"Speaker that is shown as currently selected"},selectedCamera:{required:!1,tsType:{name:"OptionsDevice"},description:"Camera that is shown as currently selected"},onSelectCamera:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback when a camera is selected"},onSelectMicrophone:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Callback when a microphone is selected"},onSelectSpeaker:{required:!1,tsType:{name:"signature",type:"function",raw:"(device: OptionsDevice) => Promise<void>",signature:{arguments:[{name:"device",type:{name:"OptionsDevice"}}],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Speaker when a speaker is selected"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"OptionsButtonStrings"}],raw:"Partial<OptionsButtonStrings>"},description:"Optional strings to override in component"}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/OptionsButton.tsx"]={name:"OptionsButton",docgenInfo:OptionsButton_OptionsButton.__docgenInfo,path:"../react-components/src/components/OptionsButton.tsx"});var People20Filled=__webpack_require__(1678),copy_to_clipboard=__webpack_require__(281),copy_to_clipboard_default=__webpack_require__.n(copy_to_clipboard),ParticipantsButton_onRenderPeopleIcon=function onRenderPeopleIcon(){return Object(jsx_runtime.jsx)(People20Filled.a,{primaryFill:"currentColor"},"participantsIconKey")};ParticipantsButton_onRenderPeopleIcon.displayName="onRenderPeopleIcon";var ParticipantsButton_ParticipantsButton=function ParticipantsButton(props){var _props$menuProps,_props$labelKey,participantListProps=props.participantListProps,callInvitationURL=props.callInvitationURL,styles=props.styles,onMuteAll=props.onMuteAll,onRenderIcon=props.onRenderIcon,onMuteAllCallback=Object(react.useCallback)((function(){onMuteAll&&onMuteAll()}),[onMuteAll]),onRenderParticipantList=Object(react.useCallback)((function(){return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)(defaultParticipantListContainerStyle,null==styles?void 0:styles.participantListContainerStyle),children:Object(jsx_runtime.jsx)(ParticipantList_ParticipantList,Object.assign({},participantListProps))})}),[participantListProps,styles]),onCopyCallback=Object(react.useCallback)((function(){return!!callInvitationURL&&copy_to_clipboard_default()(callInvitationURL)}),[callInvitationURL]),localeStrings=LocalizationProvider_useLocale().strings.participantsButton,strings=Object(react.useMemo)((function(){return Object.assign({},localeStrings,props.strings)}),[localeStrings,props.strings]),participantCount=participantListProps.participants.length,generateDefaultParticipantsSubMenuProps=Object(react.useCallback)((function(){var items=[];return participantCount>0&&(items.push({key:"participantListMenuItemKey",onRender:onRenderParticipantList}),items.push({key:"participantsDivider1",itemType:ContextualMenu_types.a.Divider}),onMuteAll&&items.push({key:"muteAllKey",text:strings.muteAllButtonLabel,title:strings.muteAllButtonLabel,iconProps:{iconName:"MicOff2"},onClick:onMuteAllCallback})),items}),[strings,participantCount,onRenderParticipantList,onMuteAll,onMuteAllCallback]),defaultMenuProps=Object(react.useMemo)((function(){var menuProps={title:strings.menuHeader,styles:participantsButtonMenuPropsStyle,items:[]};if(participantCount>0){var participantCountWithoutMe=participantListProps.participants.map((function(p){return p.userId})).length;participantListProps.excludeMe&&(participantCountWithoutMe-=1),menuProps.items.push({key:"participantCountKey",name:formatString(strings.participantsListButtonLabel,{numParticipants:""+participantCountWithoutMe}),iconProps:{iconName:"People"},subMenuProps:{items:generateDefaultParticipantsSubMenuProps(),calloutProps:{styles:{root:{maxWidth:"100%"}}}}})}return callInvitationURL&&menuProps.items.push({key:"InviteLinkKey",name:strings.copyInviteLinkButtonLabel,title:strings.copyInviteLinkButtonLabel,iconProps:{iconName:"Link"},onClick:onCopyCallback}),menuProps}),[strings.menuHeader,strings.participantsListButtonLabel,strings.copyInviteLinkButtonLabel,participantCount,callInvitationURL,participantListProps.participants,participantListProps.excludeMe,generateDefaultParticipantsSubMenuProps,onCopyCallback]);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{menuProps:null!==(_props$menuProps=props.menuProps)&&void 0!==_props$menuProps?_props$menuProps:defaultMenuProps,menuIconProps:{hidden:!0},onRenderIcon:null!=onRenderIcon?onRenderIcon:ParticipantsButton_onRenderPeopleIcon,strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"participantsButtonLabel"}))};ParticipantsButton_ParticipantsButton.displayName="ParticipantsButton",ParticipantsButton_ParticipantsButton.__docgenInfo={description:"`ParticipantsButton` allows you to easily create a component rendering a participants button. It can be used in your ControlBar component for example.\nThis button contains dropdown menu items defined through its property `menuProps`. By default, it can display the number of remote participants with the full list\nas sub-menu and an option to mute all participants, as well as a copy-to-clipboard button to copy the call invitation URL.\nThis `menuProps` can be fully redefined and its property is of type [IContextualMenuProps](https://developer.microsoft.com/en-us/fluentui#/controls/web/contextualmenu#IContextualMenuProps).\n\n@param props - of type ParticipantsButtonProps",methods:[],displayName:"ParticipantsButton",props:{participantListProps:{required:!0,tsType:{name:"ParticipantListProps"},description:"Props of ParticipantList component"},styles:{required:!1,tsType:{name:"ParticipantsButtonStylesProps"},description:"Allows users to pass an object containing custom CSS styles.\n@Example\n```\n<ParticipantsButton styles={{ root: { background: 'blue' } }} />\n```"},callInvitationURL:{required:!1,tsType:{name:"string"},description:"URL to invite new participants to the current call"},onMuteAll:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"CallBack to mute all remote participants"},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"ParticipantsButtonStrings"}],raw:"Partial<ParticipantsButtonStrings>"},description:"Optional strings to override in component"}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ParticipantsButton.tsx"]={name:"ParticipantsButton",docgenInfo:ParticipantsButton_ParticipantsButton.__docgenInfo,path:"../react-components/src/components/ParticipantsButton.tsx"});var ShareScreenStop20Filled=__webpack_require__(1679),ScreenShareButton_onRenderScreenShareOnIcon=function onRenderScreenShareOnIcon(){return Object(jsx_runtime.jsx)(ShareScreenStop20Filled.a,{primaryFill:"currentColor"},"screenShareIconKey")};ScreenShareButton_onRenderScreenShareOnIcon.displayName="onRenderScreenShareOnIcon";var ScreenShareButton_onRenderScreenShareOffIcon=function onRenderScreenShareOffIcon(){return Object(jsx_runtime.jsx)(ShareScreenStart20Filled.a,{primaryFill:"currentColor"},"screenShareBorderedIconKey")};ScreenShareButton_onRenderScreenShareOffIcon.displayName="onRenderScreenShareOffIcon";var ScreenShareButton_ScreenShareButton=function ScreenShareButton(props){var _props$onToggleScreen,_props$onRenderOnIcon,_props$onRenderOffIco,_props$labelKey,localeStrings=LocalizationProvider_useLocale().strings.screenShareButton,strings=Object.assign({},localeStrings,props.strings);return Object(jsx_runtime.jsx)(ControlBarButton_ControlBarButton,Object.assign({},props,{onClick:null!==(_props$onToggleScreen=props.onToggleScreenShare)&&void 0!==_props$onToggleScreen?_props$onToggleScreen:props.onClick,onRenderOnIcon:null!==(_props$onRenderOnIcon=props.onRenderOnIcon)&&void 0!==_props$onRenderOnIcon?_props$onRenderOnIcon:ScreenShareButton_onRenderScreenShareOnIcon,onRenderOffIcon:null!==(_props$onRenderOffIco=props.onRenderOffIcon)&&void 0!==_props$onRenderOffIco?_props$onRenderOffIco:ScreenShareButton_onRenderScreenShareOffIcon,strings:strings,labelKey:null!==(_props$labelKey=props.labelKey)&&void 0!==_props$labelKey?_props$labelKey:"screenShareButtonLabel"}))};ScreenShareButton_ScreenShareButton.displayName="ScreenShareButton",ScreenShareButton_ScreenShareButton.__docgenInfo={description:"`ScreenShareButton` allows you to easily create a component for rendering a screen-share button.\nIt can be used in your ControlBar component for example.\n\n@param props - of type ScreenShareButtonProps",methods:[],displayName:"ScreenShareButton",props:{onToggleScreenShare:{required:!1,tsType:{name:"signature",type:"function",raw:"() => Promise<void>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"void"}],raw:"Promise<void>"}}},description:"Utility property for using this component with `communication react eventHandlers`.\nMaps directly to the `onClick` property."},strings:{required:!1,tsType:{name:"Partial",elements:[{name:"ScreenShareButtonStrings"}],raw:"Partial<ScreenShareButtonStrings>"},description:"Optional strings to override in component"}},composes:["ControlBarButtonProps"]},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../react-components/src/components/ScreenShareButton.tsx"]={name:"ScreenShareButton",docgenInfo:ScreenShareButton_ScreenShareButton.__docgenInfo,path:"../react-components/src/components/ScreenShareButton.tsx"})},282:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ContosoCallContainer}));__webpack_require__(186),__webpack_require__(37),__webpack_require__(9),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_common__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(201),_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(123),react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(0),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var isTeamsMeetingLink=function isTeamsMeetingLink(link){return link.startsWith("https://teams.microsoft.com/l/meetup-join")},ContosoCallContainer=function ContosoCallContainer(props){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_15__.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1],credential=Object(react__WEBPACK_IMPORTED_MODULE_15__.useMemo)((function(){try{return new _azure_communication_common__WEBPACK_IMPORTED_MODULE_13__.a(props.token)}catch(_unused){return void console.error("Failed to construct token credential")}}),[props.token]);return Object(react__WEBPACK_IMPORTED_MODULE_15__.useEffect)((function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){var callLocator;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:credential&&props.locator&&props.displayName&&(callLocator=isTeamsMeetingLink(props.locator)?{meetingLink:props.locator}:{groupId:props.locator},function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee(credential){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.d)({userId:{kind:"communicationUser",communicationUserId:props.userId.communicationUserId},displayName:props.displayName,credential:credential,locator:callLocator});case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(_x){return _ref2.apply(this,arguments)}}()(credential));case 1:case"end":return _context2.stop()}}),_callee2)})))()}),[props,credential]),Object(react__WEBPACK_IMPORTED_MODULE_15__.useEffect)((function(){return function(){_asyncToGenerator(regeneratorRuntime.mark((function _callee3(){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(adapter){_context3.next=2;break}return _context3.abrupt("return");case 2:return _context3.next=4,adapter.leaveCall().catch((function(e){console.error("Failed to leave call",e)}));case 4:adapter.dispose();case 5:case"end":return _context3.stop()}}),_callee3)})))()}}),[adapter]),adapter?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)("div",{style:{height:"90vh",width:"90vw"},children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.a,{adapter:adapter,fluentTheme:props.fluentTheme,callInvitationURL:null==props?void 0:props.callInvitationURL})}):void 0===credential?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.Fragment,{children:"Failed to construct credential. Provided token is malformed."}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.Fragment,{children:"Initializing..."})};ContosoCallContainer.__docgenInfo={description:"",methods:[],displayName:"ContosoCallContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},locator:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},callInvitationURL:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/CallComposite/snippets/Container.snippet.tsx"]={name:"ContosoCallContainer",docgenInfo:ContosoCallContainer.__docgenInfo,path:"stories/CallComposite/snippets/Container.snippet.tsx"})},283:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createUserAndGroup}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(90),__webpack_require__(87),__webpack_require__(179),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(93),__webpack_require__(53),__webpack_require__(83);var _azure_communication_identity__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(445),uuid__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(836);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var createUserAndGroup=function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(resourceConnectionString){var tokenClient,user;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return tokenClient=new _azure_communication_identity__WEBPACK_IMPORTED_MODULE_11__.a(resourceConnectionString),_context.next=3,tokenClient.createUserAndToken(["voip"]);case 3:return user=_context.sent,_context.abrupt("return",{userId:user.user,token:user.token,endpointUrl:new URL(resourceConnectionString.replace("endpoint=","").split(";")[0]).toString(),locator:Object(uuid__WEBPACK_IMPORTED_MODULE_12__.a)()});case 5:case"end":return _context.stop()}}),_callee)})));return function createUserAndGroup(_x){return _ref.apply(this,arguments)}}()},284:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ContosoChatContainer}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(201),_azure_communication_common__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(329),_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(123),react__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(0),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var ContosoChatContainer=function ContosoChatContainer(props){var credential=Object(react__WEBPACK_IMPORTED_MODULE_15__.useMemo)((function(){try{return new _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__.a(props.token)}catch(_unused){return void console.error("Failed to construct token credential")}}),[props.token]),_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_15__.useState)(),2),adapter=_useState2[0],setAdapter=_useState2[1];return Object(react__WEBPACK_IMPORTED_MODULE_15__.useEffect)((function(){credential&&props&&function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(credential){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setAdapter,_context.next=3,Object(_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.e)({endpointUrl:props.endpointUrl,userId:Object(_azure_communication_common__WEBPACK_IMPORTED_MODULE_13__.a)(props.userId),displayName:props.displayName,credential:credential,threadId:props.threadId});case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})));return function createAdapter(_x){return _ref.apply(this,arguments)}}()(credential)}),[props,credential]),adapter?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_14__.b,{adapter:adapter,fluentTheme:props.fluentTheme,options:{showParticipantPane:props.showParticipants}}):void 0===credential?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.Fragment,{children:"Failed to construct credential. Provided token is malformed."}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.Fragment,{children:"Initializing..."})};ContosoChatContainer.__docgenInfo={description:"",methods:[],displayName:"ContosoChatContainer",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},threadId:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},showParticipants:{required:!1,tsType:{name:"boolean"},description:""},showTopic:{required:!1,tsType:{name:"boolean"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ChatComposite/snippets/Container.snippet.tsx"]={name:"ContosoChatContainer",docgenInfo:ContosoChatContainer.__docgenInfo,path:"stories/ChatComposite/snippets/Container.snippet.tsx"})},293:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"CallBackend",(function(){return IdentityManagement_stories_CallBackend})),__webpack_require__.d(__webpack_exports__,"ChatBackend",(function(){return IdentityManagement_stories_ChatBackend}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(90),__webpack_require__(87),__webpack_require__(269),__webpack_require__(34),__webpack_require__(93),__webpack_require__(53),__webpack_require__(10),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var src=__webpack_require__(24),Stack=__webpack_require__(99),lib=__webpack_require__(20),TextField=__webpack_require__(1701),PrimaryButton=__webpack_require__(1666),Text=__webpack_require__(1711),IconButton=__webpack_require__(1718),Link=__webpack_require__(1705),copy_to_clipboard=__webpack_require__(281),copy_to_clipboard_default=__webpack_require__.n(copy_to_clipboard),react=__webpack_require__(0),communicationIdentityClient=(__webpack_require__(179),__webpack_require__(83),__webpack_require__(445)),v1=__webpack_require__(836);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var createUserAndGroup=function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(resourceConnectionString){var tokenClient,user;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return tokenClient=new communicationIdentityClient.a(resourceConnectionString),_context.next=3,tokenClient.createUserAndToken(["voip"]);case 3:return user=_context.sent,_context.abrupt("return",{userId:user.user.communicationUserId,token:user.token,endpointUrl:new URL(resourceConnectionString.replace("endpoint=","").split(";")[0]).toString(),locator:Object(v1.a)()});case 5:case"end":return _context.stop()}}),_callee)})));return function createUserAndGroup(_x){return _ref.apply(this,arguments)}}(),src_chatClient=__webpack_require__(444),communicationTokenCredential=__webpack_require__(201);function ChatBackend_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}var createUserAndThread=function(){var _ref=function ChatBackend_snippet_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){ChatBackend_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){ChatBackend_snippet_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(resourceConnectionString,displayNames){var _yield$chatClient$cre,_yield$chatClient$cre2,endpointUrl,tokenClient,userAndTokens,i,chatClient,threadId;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(0!==displayNames.length){_context.next=2;break}return _context.abrupt("return",[]);case 2:endpointUrl=new URL(resourceConnectionString.replace("endpoint=","").split(";")[0]).toString(),tokenClient=new communicationIdentityClient.a(resourceConnectionString),userAndTokens=[],i=0;case 6:if(!(i<displayNames.length)){_context.next=15;break}return _context.t0=userAndTokens,_context.next=10,tokenClient.createUserAndToken(["chat"]);case 10:_context.t1=_context.sent,_context.t0.push.call(_context.t0,_context.t1);case 12:i++,_context.next=6;break;case 15:return chatClient=new src_chatClient.a(endpointUrl,new communicationTokenCredential.a(userAndTokens[0].token)),_context.next=18,chatClient.createChatThread({topic:"DemoThread"},{participants:displayNames.map((function(displayName,i){return{id:userAndTokens[i].user,displayName:displayName}}))});case 18:if(_context.t4=_yield$chatClient$cre2=_context.sent.chatThread,_context.t3=null===_context.t4,_context.t3){_context.next=22;break}_context.t3=void 0===_yield$chatClient$cre2;case 22:if(!_context.t3){_context.next=26;break}_context.t5=void 0,_context.next=27;break;case 26:_context.t5=_yield$chatClient$cre2.id;case 27:if(_context.t6=_yield$chatClient$cre=_context.t5,_context.t2=null!==_context.t6,!_context.t2){_context.next=31;break}_context.t2=void 0!==_yield$chatClient$cre;case 31:if(!_context.t2){_context.next=35;break}_context.t7=_yield$chatClient$cre,_context.next=36;break;case 35:_context.t7="";case 36:return threadId=_context.t7,_context.abrupt("return",displayNames.map((function(displayName,i){return{userId:userAndTokens[i].user,token:userAndTokens[i].token,endpointUrl:endpointUrl,displayName:displayName,threadId:threadId}})));case 38:case"end":return _context.stop()}}),_callee)})));return function createUserAndThread(_x,_x2){return _ref.apply(this,arguments)}}(),jsx_runtime=__webpack_require__(1);function _toConsumableArray(arr){return function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||_unsupportedIterableToArray(arr)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function IdentityManagement_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function IdentityManagement_stories_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){IdentityManagement_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){IdentityManagement_stories_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||_unsupportedIterableToArray(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var containerStackTokens={childrenGap:10,padding:15},nestedStackTokens={childrenGap:10},IdentityManagement_stories_CallBackend=function CallBackend(){var theme=Object(src.D)(),_useState2=_slicedToArray(Object(react.useState)(""),2),connectionString=_useState2[0],setConnectionString=_useState2[1],_useState4=_slicedToArray(Object(react.useState)(),2),response=_useState4[0],setResponse=_useState4[1],_useState6=_slicedToArray(Object(react.useState)(""),2),errorMessage=_useState6[0],setErrorMessage=_useState6[1],onConnectionStringChange=Object(react.useCallback)((function(_,value){return setConnectionString(null!=value?value:"")}),[]),onGenerateClick=Object(react.useCallback)(IdentityManagement_stories_asyncToGenerator(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:createUserAndGroup(connectionString).then((function(response){setResponse(response),setErrorMessage("")})).catch((function(reason){setResponse(void 0),setErrorMessage(reason.toString())}));case 1:case"end":return _context.stop()}}),_callee)}))),[connectionString]);return Object(jsx_runtime.jsxs)(Stack.a,{tokens:containerStackTokens,className:Object(lib.G)({background:theme.palette.neutralLighterAlt,boxShadow:theme.effects.elevation4,width:"75%"}),children:[Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsxs)(Stack.a,{tokens:nestedStackTokens,className:Object(lib.G)({width:"100%"}),children:[Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(TextField.a,{required:!0,className:Object(lib.G)({width:"100%"}),placeholder:"Enter a valid connection string",onChange:onConnectionStringChange,errorMessage:errorMessage})}),Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Generate",onClick:onGenerateClick})})]})}),Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(IdentityManagement_stories_CopyableResponse,{response:response})})]})};IdentityManagement_stories_CallBackend.displayName="CallBackend";var IdentityManagement_stories_ChatBackend=function ChatBackend(){var theme=Object(src.D)(),_useState8=_slicedToArray(Object(react.useState)(""),2),connectionString=_useState8[0],setConnectionString=_useState8[1],_useState10=_slicedToArray(Object(react.useState)(),2),responses=_useState10[0],setResponses=_useState10[1],_useState12=_slicedToArray(Object(react.useState)(""),2),errorMessage=_useState12[0],setErrorMessage=_useState12[1],_useState14=_slicedToArray(Object(react.useState)([""]),2),displayNames=_useState14[0],setDisplayNames=_useState14[1],onConnectionStringChange=Object(react.useCallback)((function(_,value){return setConnectionString(null!=value?value:"")}),[]),onGenerateClick=Object(react.useCallback)(IdentityManagement_stories_asyncToGenerator(regeneratorRuntime.mark((function _callee2(){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:createUserAndThread(connectionString,displayNames).then((function(response){setResponses(response),setErrorMessage("")})).catch((function(reason){setResponses(void 0),setErrorMessage(reason.toString())}));case 1:case"end":return _context2.stop()}}),_callee2)}))),[connectionString,displayNames]);return Object(jsx_runtime.jsxs)(Stack.a,{tokens:containerStackTokens,className:Object(lib.G)({background:theme.palette.neutralLighterAlt,boxShadow:theme.effects.elevation4,width:"75%"}),children:[Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsxs)(Stack.a,{tokens:nestedStackTokens,className:Object(lib.G)({width:"100%"}),children:[Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(TextField.a,{required:!0,className:Object(lib.G)({width:"100%"}),placeholder:"Enter a valid connection string",onChange:onConnectionStringChange,errorMessage:errorMessage})}),Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(Text.a,{children:"Chat participants:"})}),Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(IdentityManagement_stories_DisplayNamesInput,{displayNames:displayNames,setDisplayNames:setDisplayNames})}),Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(PrimaryButton.a,{text:"Generate",onClick:onGenerateClick})})]})}),Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(IdentityManagement_stories_CopyableResponses,{responses:responses})})]})};IdentityManagement_stories_ChatBackend.displayName="ChatBackend";var IdentityManagement_stories_DisplayNamesInput=function DisplayNamesInput(props){var displayNames=props.displayNames,setDisplayNames=props.setDisplayNames,onTextChange=Object(react.useCallback)((function(i,value){var draft=_toConsumableArray(displayNames);draft[i]=null!=value?value:"",setDisplayNames(draft)}),[displayNames,setDisplayNames]),onAddParticipant=Object(react.useCallback)((function(){var draft=_toConsumableArray(displayNames);draft.push(""),setDisplayNames(draft)}),[displayNames,setDisplayNames]),onRemoveParticipant=Object(react.useCallback)((function(){var draft=_toConsumableArray(displayNames);draft.splice(draft.length-1,1),setDisplayNames(draft)}),[displayNames,setDisplayNames]);return Object(jsx_runtime.jsxs)(Stack.a,{tokens:nestedStackTokens,className:Object(lib.G)({width:"100%"}),children:[displayNames.map((function(name,i){return Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(TextField.a,{className:Object(lib.G)({width:"30%",maxWidth:300}),placeholder:"Enter display name",value:displayNames[i],onChange:function onChange(_,value){return onTextChange(i,value)}})},"displayNameInput."+i)})),Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:nestedStackTokens,className:Object(lib.G)({width:"100%"}),children:[Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(IconButton.a,{iconProps:addIcon,title:"Add Participant",ariaLabel:"Add Participant",onClick:onAddParticipant})}),displayNames.length>1?Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(IconButton.a,{iconProps:removeIcon,title:"Remove Participant",ariaLabel:"Remove Participant",onClick:onRemoveParticipant})}):Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{})]})})]})};IdentityManagement_stories_DisplayNamesInput.displayName="DisplayNamesInput";var IdentityManagement_stories_CopyableResponses=function CopyableResponses(props){var responses=props.responses;return void 0===responses?Object(jsx_runtime.jsx)(IdentityManagement_stories_CopyableResponse,{response:void 0}):Object(jsx_runtime.jsx)(Stack.a,{tokens:nestedStackTokens,className:Object(lib.G)({width:"100%"}),children:responses.map((function(response,i){return Object(jsx_runtime.jsx)(Stack.a.Item,{children:Object(jsx_runtime.jsx)(IdentityManagement_stories_CopyableResponse,{response:response})},"response."+i)}))})};IdentityManagement_stories_CopyableResponses.displayName="CopyableResponses";var IdentityManagement_stories_CopyableResponse=function CopyableResponse(props){var response=props.response,theme=Object(src.D)();if(void 0===response)return Object(jsx_runtime.jsxs)(Text.a,{children:["Connection string can be"," ",Object(jsx_runtime.jsx)(Link.a,{href:"https://docs.microsoft.com/en-us/azure/communication-services/quickstarts/create-communication-resource?tabs=windows&pivots=platform-azp#access-your-connection-strings-and-service-endpoints",children:"generated on azure portal"}),"."]});var lines=JSON.stringify(response,null,2).split(/\r?\n/);return Object(jsx_runtime.jsxs)(Stack.a,{className:Object(lib.G)({background:theme.palette.neutralLighter,padding:15}),children:[Object(jsx_runtime.jsx)(Stack.a.Item,{children:lines.map((function(line){return Object(jsx_runtime.jsx)(Text.a,{block:!0,nowrap:!0,children:line},line)}))}),Object(jsx_runtime.jsx)(Stack.a.Item,{align:"end",children:Object(jsx_runtime.jsx)(IconButton.a,{iconProps:copyIcon,title:"Copy",ariaLabel:"Copy",onClick:function onClick(){return copy_to_clipboard_default()(JSON.stringify(response))}})})]})};IdentityManagement_stories_CopyableResponse.displayName="CopyableResponse";var copyIcon={iconName:"Copy"},addIcon={iconName:"Add"},removeIcon={iconName:"Remove"};IdentityManagement_stories_CallBackend.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  const theme = useTheme();\n\n  const [connectionString, setConnectionString] = useState('');\n  const [response, setResponse] = useState();\n  const [errorMessage, setErrorMessage] = useState('');\n\n  const onConnectionStringChange = useCallback((_, value) => setConnectionString(value ?? ''), []);\n  const onGenerateClick = useCallback(async () => {\n    createUserAndGroup(connectionString)\n      .then((response) => {\n        setResponse(response);\n        setErrorMessage('');\n      })\n      .catch((reason) => {\n        setResponse(undefined);\n        setErrorMessage(reason.toString());\n      });\n  }, [connectionString]);\n\n  return (\n    <Stack\n      tokens={containerStackTokens}\n      className={mergeStyles({\n        background: theme.palette.neutralLighterAlt,\n        boxShadow: theme.effects.elevation4,\n        width: '75%'\n      })}\n    >\n      <Stack.Item>\n        <Stack\n          tokens={nestedStackTokens}\n          className={mergeStyles({\n            width: '100%'\n          })}\n        >\n          <Stack.Item>\n            <TextField\n              required\n              className={mergeStyles({\n                width: '100%'\n              })}\n              placeholder=\"Enter a valid connection string\"\n              onChange={onConnectionStringChange}\n              errorMessage={errorMessage}\n            />\n          </Stack.Item>\n          <Stack.Item>\n            <PrimaryButton text=\"Generate\" onClick={onGenerateClick} />\n          </Stack.Item>\n        </Stack>\n      </Stack.Item>\n\n      <Stack.Item>\n        <CopyableResponse response={response} />\n      </Stack.Item>\n    </Stack>\n  );\n}"}},IdentityManagement_stories_CallBackend.parameters),IdentityManagement_stories_ChatBackend.parameters=Object.assign({storySource:{source:"(): JSX.Element => {\n  const theme = useTheme();\n\n  const [connectionString, setConnectionString] = useState('');\n  const [responses, setResponses] = useState();\n  const [errorMessage, setErrorMessage] = useState('');\n  const [displayNames, setDisplayNames] = useState(['']);\n\n  const onConnectionStringChange = useCallback((_, value) => setConnectionString(value ?? ''), []);\n  const onGenerateClick = useCallback(async () => {\n    createUserAndThread(connectionString, displayNames)\n      .then((response) => {\n        setResponses(response);\n        setErrorMessage('');\n      })\n      .catch((reason) => {\n        setResponses(undefined);\n        setErrorMessage(reason.toString());\n      });\n  }, [connectionString, displayNames]);\n\n  return (\n    <Stack\n      tokens={containerStackTokens}\n      className={mergeStyles({\n        background: theme.palette.neutralLighterAlt,\n        boxShadow: theme.effects.elevation4,\n        width: '75%'\n      })}\n    >\n      <Stack.Item>\n        <Stack\n          tokens={nestedStackTokens}\n          className={mergeStyles({\n            width: '100%'\n          })}\n        >\n          <Stack.Item>\n            <TextField\n              required\n              className={mergeStyles({\n                width: '100%'\n              })}\n              placeholder=\"Enter a valid connection string\"\n              onChange={onConnectionStringChange}\n              errorMessage={errorMessage}\n            />\n          </Stack.Item>\n          <Stack.Item>\n            <Text>Chat participants:</Text>\n          </Stack.Item>\n          <Stack.Item>\n            <DisplayNamesInput displayNames={displayNames} setDisplayNames={setDisplayNames} />\n          </Stack.Item>\n          <Stack.Item>\n            <PrimaryButton text=\"Generate\" onClick={onGenerateClick} />\n          </Stack.Item>\n        </Stack>\n      </Stack.Item>\n\n      <Stack.Item>\n        <CopyableResponses responses={responses} />\n      </Stack.Item>\n    </Stack>\n  );\n}"}},IdentityManagement_stories_ChatBackend.parameters),IdentityManagement_stories_CallBackend.__docgenInfo={description:"",methods:[],displayName:"CallBackend"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/IdentityManagement/IdentityManagement.stories.tsx"]={name:"CallBackend",docgenInfo:IdentityManagement_stories_CallBackend.__docgenInfo,path:"stories/IdentityManagement/IdentityManagement.stories.tsx"}),IdentityManagement_stories_ChatBackend.__docgenInfo={description:"",methods:[],displayName:"ChatBackend"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/IdentityManagement/IdentityManagement.stories.tsx"]={name:"ChatBackend",docgenInfo:IdentityManagement_stories_ChatBackend.__docgenInfo,path:"stories/IdentityManagement/IdentityManagement.stories.tsx"})},294:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return IncomingCallAlerts_IncomingCallModal})),__webpack_require__.d(__webpack_exports__,"b",(function(){return IncomingCallAlerts_IncomingCallToast}));__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(9),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var src=__webpack_require__(24),Stack=__webpack_require__(99),Persona=__webpack_require__(560),Persona_types=__webpack_require__(26),DefaultButton=__webpack_require__(430),DialogContent_types=__webpack_require__(251),Dialog=__webpack_require__(1702),DialogFooter=__webpack_require__(823),CallEnd20Filled=__webpack_require__(1675),Call20Filled=__webpack_require__(1689),Video20Filled=__webpack_require__(1673),VideoOff20Filled=__webpack_require__(1674),useBoolean=__webpack_require__(1725),lib=(__webpack_require__(0),__webpack_require__(20)),IncomingCallAlerts_styles_theme=Object(lib.B)(),IncomingCallAlerts_styles_palette=IncomingCallAlerts_styles_theme.palette,incomingCallToastStyle=Object(lib.G)({minWidth:"20rem",width:"100%",height:"100%",backgroundColor:IncomingCallAlerts_styles_palette.whiteTranslucent40,opacity:.95,borderRadius:"0.5rem",boxShadow:IncomingCallAlerts_styles_theme.effects.elevation8,padding:"1rem"}),incomingCallToastAvatarContainerStyle=Object(lib.G)({marginRight:"0.5rem"}),incomingCallAcceptButtonStyle=Object(lib.G)({backgroundColor:IncomingCallAlerts_styles_palette.greenDark,color:IncomingCallAlerts_styles_palette.white,borderRadius:"2rem",minWidth:"2rem",width:"2rem",border:"none",padding:"none",":hover, :active":{backgroundColor:IncomingCallAlerts_styles_palette.green,color:IncomingCallAlerts_styles_palette.white}}),incomingCallRejectButtonStyle=Object(lib.G)({backgroundColor:IncomingCallAlerts_styles_palette.redDark,color:IncomingCallAlerts_styles_palette.white,borderRadius:"2rem",minWidth:"2rem",width:"2rem",border:"none",padding:"none",":hover, :active":{backgroundColor:IncomingCallAlerts_styles_palette.red,color:IncomingCallAlerts_styles_palette.white}}),incomingCallModalContainerStyle={borderRadius:"0.75rem"},incomingCallModalLocalPreviewStyle=Object(lib.G)({height:"10rem",background:IncomingCallAlerts_styles_palette.neutralLighterAlt,margin:"1.5rem 0",borderRadius:"0.25rem","& video":{borderRadius:"0.25rem"}}),jsx_runtime=__webpack_require__(1);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var IncomingCallAlerts_IncomingCallToast=function IncomingCallToast(props){var callerName=props.callerName,alertText=props.alertText,avatar=props.avatar,onClickAccept=props.onClickAccept,onClickReject=props.onClickReject;return Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,verticalAlign:"center",className:incomingCallToastStyle,children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"start",className:incomingCallToastAvatarContainerStyle,children:Object(jsx_runtime.jsx)(Persona.a,{imageUrl:avatar,text:callerName,size:Persona_types.c.size40,hidePersonaDetails:!0,"aria-label":callerName})}),Object(jsx_runtime.jsxs)(Stack.a,{grow:1,horizontalAlign:"center",style:{alignItems:"flex-start",fontFamily:"Segoe UI"},children:[Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.875rem"},children:Object(jsx_runtime.jsx)("b",{children:null!=callerName?callerName:"No display name"})}),Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.75rem"},children:Object(jsx_runtime.jsx)("span",{children:null!=alertText?alertText:"Incoming call"})})]}),Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,tokens:{childrenGap:10},children:[Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickReject()},className:incomingCallRejectButtonStyle,children:Object(jsx_runtime.jsx)(CallEnd20Filled.a,{primaryFill:"currentColor"})}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickAccept()},className:incomingCallAcceptButtonStyle,children:Object(jsx_runtime.jsx)(Call20Filled.a,{primaryFill:"currentColor"})})]})]})};IncomingCallAlerts_IncomingCallToast.displayName="IncomingCallToast";var IncomingCallAlerts_IncomingCallModal=function IncomingCallModal(props){var alertText=props.alertText,avatar=props.avatar,callerName=props.callerName,callerNameAlt=props.callerNameAlt,callerTitle=props.callerTitle,localParticipantDisplayName=props.localParticipantDisplayName,localVideoInverted=props.localVideoInverted,onClickAccept=props.onClickAccept,onClickReject=props.onClickReject,onClickVideoToggle=props.onClickVideoToggle,localVideoStreamElement=props.localVideoStreamElement,palette=Object(src.D)().palette,_useBoolean2=_slicedToArray(Object(useBoolean.a)(!1),2),hideDialog=_useBoolean2[0],toggleHideDialog=_useBoolean2[1].toggle,dialogContentProps={type:DialogContent_types.a.normal,title:null!=alertText?alertText:"Incoming Video Call"},showLocalVideo=!!localVideoStreamElement,mediaGalleryLocalParticipant=Object(jsx_runtime.jsx)(src.v,{renderElement:Object(jsx_runtime.jsx)(src.s,{videoStreamElement:localVideoStreamElement}),displayName:localParticipantDisplayName,isMirrored:localVideoInverted});return Object(jsx_runtime.jsx)(jsx_runtime.Fragment,{children:Object(jsx_runtime.jsxs)(Dialog.a,{hidden:hideDialog,onDismiss:toggleHideDialog,dialogContentProps:dialogContentProps,modalProps:{isBlocking:!0,styles:{main:incomingCallModalContainerStyle}},children:[Object(jsx_runtime.jsxs)(Stack.a,{horizontal:!0,verticalAlign:"center",children:[Object(jsx_runtime.jsx)(Stack.a,{horizontalAlign:"start",style:{marginRight:"0.5rem"},children:Object(jsx_runtime.jsx)(Persona.a,{imageUrl:avatar,text:callerName,size:Persona_types.c.size40,hidePersonaDetails:!0,"aria-label":callerName})}),Object(jsx_runtime.jsxs)(Stack.a,{grow:1,horizontalAlign:"center",style:{alignItems:"flex-start"},children:[Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.875rem",color:palette.black,fontWeight:"bold"},children:Object(jsx_runtime.jsxs)("span",{children:[null!=callerName?callerName:"No display name",callerNameAlt?Object(jsx_runtime.jsxs)("span",{style:{opacity:.5,marginLeft:"0.2rem"},children:["  ",callerNameAlt]}):null]})}),Object(jsx_runtime.jsx)(Stack.a,{style:{fontSize:"0.75rem",color:palette.neutralDark},children:Object(jsx_runtime.jsx)("span",{children:null!=callerTitle?callerTitle:""})})]})]}),showLocalVideo?Object(jsx_runtime.jsx)(Stack.a,{className:incomingCallModalLocalPreviewStyle,children:mediaGalleryLocalParticipant}):null,Object(jsx_runtime.jsxs)(DialogFooter.a,{children:[Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickVideoToggle()},style:{background:palette.neutralLighterAlt,border:"none"},children:showLocalVideo?Object(jsx_runtime.jsx)(Video20Filled.a,{primaryFill:"currentColor"}):Object(jsx_runtime.jsx)(VideoOff20Filled.a,{primaryFill:"currentColor"})}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickAccept()},text:"Accept",style:{background:palette.green,border:"none"}}),Object(jsx_runtime.jsx)(DefaultButton.a,{onClick:function onClick(){return onClickReject()},text:"Decline",style:{background:palette.redDark,border:"none"}})]})]})})};IncomingCallAlerts_IncomingCallToast.__docgenInfo={description:"",methods:[],displayName:"IncomingCallToast",props:{callerName:{required:!1,tsType:{name:"string"},description:"Caller's Name"},alertText:{required:!1,tsType:{name:"string"},description:'Alert Text. For example "incoming video call..."'},avatar:{required:!1,tsType:{name:"string"},description:"Caller's Avatar/Profile Image"},onClickAccept:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Accept Button is clicked"},onClickReject:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Reject Button is clicked"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/IncomingCallAlerts/components/IncomingCallAlerts.tsx"]={name:"IncomingCallToast",docgenInfo:IncomingCallAlerts_IncomingCallToast.__docgenInfo,path:"stories/Examples/IncomingCallAlerts/components/IncomingCallAlerts.tsx"}),IncomingCallAlerts_IncomingCallModal.__docgenInfo={description:"",methods:[],displayName:"IncomingCallModal",props:{callerName:{required:!1,tsType:{name:"string"},description:"Caller's Name"},alertText:{required:!1,tsType:{name:"string"},description:'Alert Text. For example "incoming video call..."'},avatar:{required:!1,tsType:{name:"string"},description:"Caller's Avatar/Profile Image"},onClickAccept:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Accept Button is clicked"},onClickReject:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Reject Button is clicked"},callerNameAlt:{required:!1,tsType:{name:"string"},description:"Text to the right of a Caller's Name"},callerTitle:{required:!1,tsType:{name:"string"},description:"A Caller's subtitle. Displayed right below the callers name"},localParticipantDisplayName:{required:!1,tsType:{name:"string"},description:"Receiver's Name"},localVideoInverted:{required:!1,tsType:{name:"boolean"},description:"If set to `true`, mirrors the local video preview of the receiver"},localVideoStreamElement:{required:!0,tsType:{name:"union",raw:"HTMLElement | null",elements:[{name:"HTMLElement"},{name:"null"}]},description:"Local Video Stream Element. An HTML Element containing a video stream."},onClickVideoToggle:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"Provide a function that handles the call behavior when Video Toggle Button is clicked"}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/IncomingCallAlerts/components/IncomingCallAlerts.tsx"]={name:"IncomingCallModal",docgenInfo:IncomingCallAlerts_IncomingCallModal.__docgenInfo,path:"stories/Examples/IncomingCallAlerts/components/IncomingCallAlerts.tsx"})},36:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"c",(function(){return memoizeFnAll})),__webpack_require__.d(__webpack_exports__,"a",(function(){return fromFlatCommunicationIdentifier})),__webpack_require__.d(__webpack_exports__,"d",(function(){return identifier_toFlatCommunicationIdentifier})),__webpack_require__.d(__webpack_exports__,"b",(function(){return getApplicationId}));__webpack_require__(1243),__webpack_require__(1244),__webpack_require__(178),__webpack_require__(9),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(47),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var argsCmp=function argsCmp(args1,args2,objCmp){return args1.length===args2.length&&args1.every((function(arg1,index){return objCmp(args2[index],arg1)}))},memoizeFnAll=function memoizeFnAll(fnToMemoize){var shouldCacheUpdate=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object.is,cache=new Map,nextCache=new Map;return function(callback){var retValue=callback((function memoizedFn(key){for(var value=cache.get(key),_len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];if(value){var _value=_slicedToArray(value,2),preArgs=_value[0],_ret=_value[1];if(argsCmp(preArgs,args,shouldCacheUpdate))return nextCache.set(key,[args,_ret]),_ret}var ret=fnToMemoize.apply(void 0,[key].concat(args));return nextCache.set(key,[args,ret]),ret}));return cache=nextCache,nextCache=new Map,retValue}},identifierModels=__webpack_require__(329),identifier_toFlatCommunicationIdentifier=function toFlatCommunicationIdentifier(id){return Object(identifierModels.b)(id)?id.communicationUserId:Object(identifierModels.c)(id)?id.microsoftTeamsUserId:Object(identifierModels.d)(id)?id.phoneNumber:id.id},fromFlatCommunicationIdentifier=function fromFlatCommunicationIdentifier(id){return{communicationUserId:id}},getApplicationId=(__webpack_require__(356),__webpack_require__(53),function getApplicationId(){return function sanitize(version){var alphaIndex=version.search(/alpha/);return alphaIndex>=0?version.substring(0,alphaIndex+5):version}("acr/0.0.0-alpha")})},405:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(you)","menuTitle":"More Options"},"typingIndicator":{"singleUser":"{user} is typing ...","multipleUsers":"{users} are typing ...","multipleUsersAbbreviateOne":"{users} and 1 other are typing ...","multipleUsersAbbreviateMany":"{users} and {numOthers} others are typing ...","delimiter":", "},"sendBox":{"placeholderText":"Enter a message"},"messageStatusIndicator":{"deliveredTooltipText":"Sent","seenTooltipText":"Seen","sendingTooltipText":"Sending","failedToSendTooltipText":"Failed to send"},"endCallButton":{"label":"Leave"},"cameraButton":{"onLabel":"Turn off","offLabel":"Turn on"},"microphoneButton":{"onLabel":"Mute","offLabel":"Unmute"},"optionsButton":{"label":"Options","cameraMenuTitle":"Camera","cameraMenuTooltip":"Choose Camera","microphoneMenuTitle":"Microphone","microphoneMenuTooltip":"Choose Microphone","speakerMenuTitle":"Speaker","speakerMenuTooltip":"Choose Speaker"},"participantsButton":{"label":"People","menuHeader":"In this call","participantsListButtonLabel":"{numParticipants} people","muteAllButtonLabel":"Mute all","copyInviteLinkButtonLabel":"Copy invite link"},"screenShareButton":{"onLabel":"Stop","offLabel":"Share"},"messageThread":{"yesterday":"Yesterday","sunday":"Sunday","monday":"Monday","tuesday":"Tuesday","wednesday":"Wednesday","thursday":"Thursday","friday":"Friday","saturday":"Saturday","participantJoined":"joined the chat.","participantLeft":"left the chat."},"errorBar":{"unableToReachChatService":"You are offline","accessDenied":"Unable to access chat services - please check the user credentials provided","userNotInThisThread":"You are no longer in this chat thread","sendMessageNotInThisThread":"Failed to send message because you are no longer in this chat thread","sendMessageGeneric":"Failed to send message"}}')},418:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return VideoTileExample}));var _azure_communication_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(24),_utils__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(0),__webpack_require__(155)),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1),VideoTileExample=function VideoTileExample(){var videoStreamElement=Object(_utils__WEBPACK_IMPORTED_MODULE_2__.a)(1)[0];return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.f,{children:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.v,{renderElement:Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_3__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_0__.s,{videoStreamElement:videoStreamElement}),displayName:"Jack Reacher",isMirrored:!0,isMuted:!0,styles:{root:{height:"300px",width:"400px"},videoContainer:{border:"5px solid firebrick"},overlayContainer:{background:"rgba(165, 13, 13, 0.5)"},displayNameContainer:{top:"1rem",bottom:"auto",right:"1rem",left:"auto",backgroundColor:"blue"}}})})};VideoTileExample.displayName="VideoTileExample",VideoTileExample.__docgenInfo={description:"",methods:[],displayName:"VideoTileExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Styling/snippets/StylingVideoTile.snippet.tsx"]={name:"VideoTileExample",docgenInfo:VideoTileExample.__docgenInfo,path:"stories/Styling/snippets/StylingVideoTile.snippet.tsx"})},419:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return OptionsButtonWithKnobs}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(10),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(24),react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(0),_controlsUtils__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(6),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var OptionsButtonWithKnobs=function OptionsButtonWithKnobs(args){var _onSelectSpeaker,_onSelectMicrophone,_onSelectCamera,_useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(_controlsUtils__WEBPACK_IMPORTED_MODULE_15__.d[0]),2),selectedCamera=_useState2[0],setSelectedCamera=_useState2[1],_useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(_controlsUtils__WEBPACK_IMPORTED_MODULE_15__.e[0]),2),selectedMicrophone=_useState4[0],setSelectedMicrophone=_useState4[1],_useState6=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(_controlsUtils__WEBPACK_IMPORTED_MODULE_15__.f[0]),2),selectedSpeaker=_useState6[0],setSelectedSpeaker=_useState6[1],exampleOptionProps={selectedCamera:selectedCamera,selectedMicrophone:selectedMicrophone,selectedSpeaker:selectedSpeaker,onSelectCamera:(_onSelectCamera=_asyncToGenerator(regeneratorRuntime.mark((function _callee(device){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:setSelectedCamera(device);case 1:case"end":return _context.stop()}}),_callee)}))),function onSelectCamera(_x){return _onSelectCamera.apply(this,arguments)}),onSelectMicrophone:(_onSelectMicrophone=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(device){return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:setSelectedMicrophone(device);case 1:case"end":return _context2.stop()}}),_callee2)}))),function onSelectMicrophone(_x2){return _onSelectMicrophone.apply(this,arguments)}),onSelectSpeaker:(_onSelectSpeaker=_asyncToGenerator(regeneratorRuntime.mark((function _callee3(device){return regeneratorRuntime.wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:setSelectedSpeaker(device);case 1:case"end":return _context3.stop()}}),_callee3)}))),function onSelectSpeaker(_x3){return _onSelectSpeaker.apply(this,arguments)})};return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_16__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__.m,Object.assign({},args,exampleOptionProps))};OptionsButtonWithKnobs.displayName="OptionsButtonWithKnobs",OptionsButtonWithKnobs.__docgenInfo={description:"",methods:[],displayName:"OptionsButtonWithKnobs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/ControlBar/Buttons/Options/snippets/OptionsButtonWithKnobs.snippet.tsx"]={name:"OptionsButtonWithKnobs",docgenInfo:OptionsButtonWithKnobs.__docgenInfo,path:"stories/ControlBar/Buttons/Options/snippets/OptionsButtonWithKnobs.snippet.tsx"})},420:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(0),__webpack_require__(1)),getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.j,{children:"Incoming Call Alerts"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"The Incoming Call Alert Components alert about an incoming call. They can render a local video preview, custom avatar image, caller name and incoming call alert text."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Incoming Call Modal"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:"\nimport { StreamMedia, VideoTile } from '@azure/communication-react';\nimport { DefaultButton, Persona, PersonaSize, Stack, Dialog, DialogType, DialogFooter } from '@fluentui/react';\nimport { CallEndIcon, CallIcon, CallVideoIcon, CallVideoOffIcon } from '@fluentui/react-northstar';\nimport { getTheme, mergeStyles } from '@fluentui/react';\n\nconst theme = getTheme();\nconst palette = theme.palette;\n\nconst incomingCallModalContainerStyle = {\n  borderRadius: '0.75rem'\n};\n\nconst incomingCallModalLocalPreviewStyle = mergeStyles({\n  height: '10rem',\n  background: palette.neutralLighterAlt,\n  margin: '1.5rem 0',\n  borderRadius: '0.25rem',\n  '& video': {\n    borderRadius: '0.25rem'\n  }\n});\n\ninterface IncomingCallModalProps extends IncomingCallToastProps {\n  /** Text to the right of a Caller's Name */\n  callerNameAlt?: string;\n  /** A Caller's subtitle. Displayed right below the callers name */\n  callerTitle?: string;\n  /** Receiver's Name */\n  localParticipantDisplayName?: string;\n  /** If set to 'true', mirrors the local video preview of the receiver */\n  localVideoInverted?: boolean;\n  /** Local Video Stream Element. An HTML Element containing a video stream. */\n  localVideoStreamElement: HTMLElement | null;\n  /** Provide a function that handles the call behavior when Video Toggle Button is clicked */\n  onClickVideoToggle: () => void;\n}\n\nconst IncomingCallModal = (props: WithTheme<IncomingCallModalProps>): JSX.Element => {\n  const {\n    alertText,\n    avatar,\n    callerName,\n    callerNameAlt,\n    callerTitle,\n    localParticipantDisplayName,\n    localVideoInverted,\n    onClickAccept,\n    onClickReject,\n    onClickVideoToggle,\n    localVideoStreamElement,\n    theme\n  } = props;\n  const palette = theme.palette;\n  const [hideDialog, { toggle: toggleHideDialog }] = useBoolean(false);\n  const dialogContentProps = { type: DialogType.normal, title: alertText ?? 'Incoming Video Call' };\n\n  const mediaGalleryLocalParticipant: JSX.Element = (\n    <VideoTile\n      renderElement={<StreamMedia videoStreamElement={localVideoStreamElement} />}\n      displayName={localParticipantDisplayName}\n      isMirrored={localVideoInverted}\n    />\n  );\n\n  cosnt showLocalVideo = !!localVideoStreamElement;\n\n  return (\n    <>\n      <Dialog\n        hidden={hideDialog}\n        onDismiss={toggleHideDialog}\n        dialogContentProps={dialogContentProps}\n        modalProps={{\n          isBlocking: true,\n          styles: { main: incomingCallModalContainerStyle }\n        }}\n      >\n        <Stack horizontal verticalAlign=\"center\">\n          <Stack horizontalAlign=\"start\" style={{ marginRight: '0.5rem' }}>\n            <Persona\n              imageUrl={avatar}\n              text={callerName}\n              size={PersonaSize.size40}\n              hidePersonaDetails={true}\n              aria-label={callerName}\n            />\n          </Stack>\n          <Stack grow={1} horizontalAlign=\"center\" style={{ alignItems: 'flex-start' }}>\n            <Stack style={{ fontSize: '0.875rem', color: palette.black, fontWeight: 'bold' }}>\n              <span>\n                {callerName ?? 'No display name'}\n                {callerNameAlt ? (\n                  <span style={{ opacity: 0.5, marginLeft: '0.2rem' }}> &bull; {callerNameAlt}</span>\n                ) : null}\n              </span>\n            </Stack>\n            <Stack style={{ fontSize: '0.75rem', color: palette.neutralDark }}>\n              <span>{callerTitle ?? ''}</span>\n            </Stack>\n          </Stack>\n        </Stack>\n\n        {showLocalVideo ? (\n          <Stack className={incomingCallModalLocalPreviewStyle}>{mediaGalleryLocalParticipant}</Stack>\n        ) : null}\n\n        <DialogFooter>\n          <DefaultButton\n            onClick={() => onClickVideoToggle()}\n            style={{ background: palette.neutralLighterAlt, border: 'none' }}\n          >\n            {showLocalVideo ? <CallVideoIcon size=\"small\" /> : <CallVideoOffIcon size=\"small\" />}\n          </DefaultButton>\n\n          <DefaultButton\n            onClick={() => onClickAccept()}\n            text=\"Accept\"\n            style={{ background: palette.green, border: 'none' }}\n          />\n\n          <DefaultButton\n            onClick={() => onClickReject()}\n            text=\"Decline\"\n            style={{ background: palette.redDark, border: 'none' }}\n          />\n        </DialogFooter>\n      </Dialog>\n    </>\n  );\n};\n"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Incoming Call Toast"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:"\nimport { DefaultButton, Persona, PersonaSize, Stack, Dialog, DialogType, DialogFooter } from '@fluentui/react';\nimport { CallEnd20Filled, Call20Filled } from '@fluentui/react-icons';\nimport { getTheme, mergeStyles } from '@fluentui/react';\n\nconst theme = getTheme();\nconst palette = theme.palette;\n\nconst incomingCallToastStyle = mergeStyles({\n  minWidth: '20rem',\n  width: '100%',\n  height: '100%',\n  backgroundColor: palette.whiteTranslucent40,\n  opacity: 0.95,\n  borderRadius: '0.5rem',\n  boxShadow: theme.effects.elevation8,\n  padding: '1rem'\n});\n\nconst incomingCallToastAvatarContainerStyle = mergeStyles({\n  marginRight: '0.5rem'\n});\n\nconst incomingCallAcceptButtonStyle = mergeStyles({\n  backgroundColor: palette.greenDark,\n  color: palette.white,\n  borderRadius: '2rem',\n  minWidth: '2rem',\n  width: '2rem',\n  border: 'none',\n  ':hover, :active': {\n    backgroundColor: palette.green,\n    color: palette.white\n  }\n});\n\nconst incomingCallRejectButtonStyle = mergeStyles({\n  backgroundColor: palette.redDark,\n  color: palette.white,\n  borderRadius: '2rem',\n  minWidth: '2rem',\n  width: '2rem',\n  border: 'none',\n  ':hover, :active': {\n    backgroundColor: palette.red,\n    color: palette.white\n  }\n});\n\ntype IncomingCallToastProps = {\n  /** Caller's Name */\n  callerName?: string;\n  /** Alert Text. For example \"incoming video call...\" */\n  alertText?: string;\n  /** Caller's Avatar/Profile Image */\n  avatar?: string;\n  /** Provide a function that handles the call behavior when Accept Button is clicked */\n  onClickAccept: () => void;\n  /** Provide a function that handles the call behavior when Reject Button is clicked */\n  onClickReject: () => void;\n};\n\nconst IncomingCallToast = (props: IncomingCallToastProps): JSX.Element => {\n  const { callerName, alertText, avatar, onClickAccept, onClickReject } = props;\n\n  return (\n    <Stack horizontal verticalAlign=\"center\" className={incomingCallToastStyle}>\n      <Stack horizontalAlign=\"start\" className={incomingCallToastAvatarContainerStyle}>\n        <Persona\n          imageUrl={avatar}\n          text={callerName}\n          size={PersonaSize.size40}\n          hidePersonaDetails={true}\n          aria-label={callerName}\n        />\n      </Stack>\n\n      <Stack grow={1} horizontalAlign=\"center\" style={{ alignItems: 'flex-start', fontFamily: 'Segoe UI' }}>\n        <Stack style={{ fontSize: '0.875rem' }}>\n          <b>{callerName ?? 'No display name'}</b>\n        </Stack>\n        <Stack style={{ fontSize: '0.75rem' }}>\n          <span>{alertText ?? 'Incoming call'}</span>\n        </Stack>\n      </Stack>\n\n      <Stack horizontal tokens={{ childrenGap: 10 }}>\n        <DefaultButton onClick={() => onClickReject()} className={incomingCallRejectButtonStyle}>\n          <CallEnd20Filled primaryFill=\"currentColor\" />\n        </DefaultButton>\n        <DefaultButton onClick={() => onClickAccept()} className={incomingCallAcceptButtonStyle}>\n          <Call20Filled primaryFill=\"currentColor\" />\n        </DefaultButton>\n      </Stack>\n    </Stack>\n  );\n};\n"})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/IncomingCallAlerts/IncomingCallAlertsDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/Examples/IncomingCallAlerts/IncomingCallAlertsDocs.tsx"})},421:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(0),__webpack_require__(1)),CallComponentText=__webpack_require__(1438).default,ComplianceBannerText=__webpack_require__(1439).default,LobbyComponentText=__webpack_require__(1440).default,getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.j,{children:"Teams Interop"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"Azure Communication Services applications can inter-operate with Microsoft Teams. There are some additional considerations when connecting to a Teams meeting."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Compliance notifications for recording and transcription"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"This example shows how you might notify your users when a Teams meeting is being recorded or transcribed. Here, a MessageBar is optionally added to the video frame:"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.i,{children:"Create Compliance Banner"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:ComplianceBannerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.i,{children:"Use Compliance Banner"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:CallComponentText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.j,{children:"Lobby Component"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"The Lobby component can be used for scenarios where the call is in a waiting state."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Create a Lobby Component"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:LobbyComponentText})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/TeamsInterop/TeamsInteropDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/Examples/TeamsInterop/TeamsInteropDocs.tsx"})},422:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return getDocs}));var _storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(5),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(0),__webpack_require__(1)),containerText=__webpack_require__(1444).default,serverText=__webpack_require__(1445).default,getDocs=function getDocs(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:[Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.j,{children:"MeetingComposite"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"MeetingComposite brings together key components to provide a full meeting experience out of the box."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Basic usage"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"A meeting composite is comprised of two key underlying parts: an ACS Call and an ACS Chat thread. As such you must provide a CallAdapter and a ChatAdapter into the meeting interface."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"A key thing to note is that initialization of adapters are asynchronous. Thus, the initialization step requires special handling, as the example code below shows."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:containerText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Prerequisites"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"MeetingComposite provides the UI for an *existing user* to join a call and a chat. Thus, the user and thread must be created beforehand. Typically, the user and group call or teams meeting are created on a Contoso-owned service and provided to the client application that then passes it to the CallComposite."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.g,{code:serverText}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Theming"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"MeetingComposite can be themed with Fluent UI themes, just like the base components. Look at the [CallComposite theme example](./?path=/story/composites-call-themeexample--theme-example) to see theming in action or the [overall theming example](./?path=/docs/theming--page) to see how theming works for all the components in this UI library."}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.d,{children:"Joining an existing Meeting"}),Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_storybook_addon_docs__WEBPACK_IMPORTED_MODULE_0__.c,{children:"The [join meeting](./?path=/story/composites-meeting-joinexample--join-example) provides an easy playground to join an existing Azure Communication Services group call and chat thread, or an existing Teams meeting. This is useful if you want to explore the composite with multiple users or try out Teams interop scenarios."})]})};getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MeetingComposite/MeetingCompositeDocs.tsx"]={name:"getDocs",docgenInfo:getDocs.__docgenInfo,path:"stories/MeetingComposite/MeetingCompositeDocs.tsx"})},423:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return MeetingExperience}));__webpack_require__(37),__webpack_require__(9),__webpack_require__(40),__webpack_require__(8),__webpack_require__(18),__webpack_require__(23),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17),__webpack_require__(21),__webpack_require__(14),__webpack_require__(29);var _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(201),_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(123),react__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(0),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(1);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _slicedToArray(arr,i){return function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}(arr)||function _iterableToArrayLimit(arr,i){var _i=null==arr?null:"undefined"!=typeof Symbol&&arr[Symbol.iterator]||arr["@@iterator"];if(null==_i)return;var _s,_e,_arr=[],_n=!0,_d=!1;try{for(_i=_i.call(arr);!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{_n||null==_i.return||_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i)||function _unsupportedIterableToArray(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr,i)||function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var MeetingExperience=function MeetingExperience(props){var _useState2=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(),2),callAdapter=_useState2[0],setCallAdapter=_useState2[1],_useState4=_slicedToArray(Object(react__WEBPACK_IMPORTED_MODULE_14__.useState)(),2),chatAdapter=_useState4[0],setChatAdapter=_useState4[1],credential=Object(react__WEBPACK_IMPORTED_MODULE_14__.useMemo)((function(){try{return new _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__.a(props.token)}catch(_unused){return void console.error("Failed to construct token credential")}}),[props.token]);return Object(react__WEBPACK_IMPORTED_MODULE_14__.useEffect)((function(){props&&credential&&props.locator&&props.displayName&&props.threadId&&props.userId&&props.endpointUrl&&function(){var _ref=function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}(regeneratorRuntime.mark((function _callee(){return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setCallAdapter,_context.next=3,Object(_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__.d)({userId:{kind:"communicationUser",communicationUserId:props.userId.communicationUserId},displayName:props.displayName,credential:credential,locator:props.locator});case 3:return _context.t1=_context.sent,(0,_context.t0)(_context.t1),_context.t2=setChatAdapter,_context.next=8,Object(_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__.e)({endpointUrl:props.endpointUrl,userId:{kind:"communicationUser",communicationUserId:props.userId.communicationUserId},displayName:props.displayName,credential:credential,threadId:props.threadId});case 8:_context.t3=_context.sent,(0,_context.t2)(_context.t3);case 10:case"end":return _context.stop()}}),_callee)})));return function createAdapters(){return _ref.apply(this,arguments)}}()()}),[credential,props]),callAdapter&&chatAdapter?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(_azure_communication_react__WEBPACK_IMPORTED_MODULE_13__.c,{callAdapter:callAdapter,chatAdapter:chatAdapter,fluentTheme:props.fluentTheme}):void 0===credential?Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.Fragment,{children:"Failed to construct credential. Provided token is malformed."}):Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_15__.Fragment,{children:"Initializing..."})};MeetingExperience.__docgenInfo={description:"",methods:[],displayName:"MeetingExperience",props:{userId:{required:!0,tsType:{name:"CommunicationUserIdentifier"},description:""},token:{required:!0,tsType:{name:"string"},description:""},displayName:{required:!0,tsType:{name:"string"},description:""},endpointUrl:{required:!0,tsType:{name:"string"},description:""},locator:{required:!0,tsType:{name:"union",raw:"GroupCallLocator | TeamsMeetingLinkLocator",elements:[{name:"GroupCallLocator"},{name:"TeamsMeetingLinkLocator"}]},description:""},threadId:{required:!0,tsType:{name:"string"},description:""},fluentTheme:{required:!1,tsType:{name:"union",raw:"PartialTheme | Theme",elements:[{name:"PartialTheme"},{name:"Theme"}]},description:""},callInvitationURL:{required:!1,tsType:{name:"string"},description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MeetingComposite/snippets/Meeting.snippet.tsx"]={name:"MeetingExperience",docgenInfo:MeetingExperience.__docgenInfo,path:"stories/MeetingComposite/snippets/Meeting.snippet.tsx"})},424:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return createUserCredentials}));__webpack_require__(83),__webpack_require__(53),__webpack_require__(93),__webpack_require__(37),__webpack_require__(9),__webpack_require__(90),__webpack_require__(87),__webpack_require__(179),__webpack_require__(16),__webpack_require__(15),__webpack_require__(17);var _azure_communication_chat__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(444),_azure_communication_common__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(201),_azure_communication_identity__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(445),uuid__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(836);function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var getChatThreadFromTeamsLink=function getChatThreadFromTeamsLink(teamsMeetingLink){var threadId=teamsMeetingLink.replace("https://teams.microsoft.com/l/meetup-join/","");if(!(threadId=(threadId=threadId.replaceAll("%3a",":").replace("%40","@")).split(/^(.*?@thread\.v2)/gm)[1])||0===threadId.length)throw"Could not get chat thread from teams link";return threadId},createNewChatThread=function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark((function _callee(chatClient,participants){var chatThreadResponse,chatThread;return regeneratorRuntime.wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,chatClient.createChatThread({topic:"Meeting with a friendly bot"},{participants:participants});case 2:if(!((chatThreadResponse=_context.sent).invalidParticipants&&chatThreadResponse.invalidParticipants.length>0)){_context.next=5;break}throw"Server could not add participants to the chat thread";case 5:if((chatThread=chatThreadResponse.chatThread)&&chatThread.id){_context.next=8;break}throw"Server could not create chat thread";case 8:return _context.abrupt("return",chatThread.id);case 9:case"end":return _context.stop()}}),_callee)})));return function createNewChatThread(_x,_x2){return _ref.apply(this,arguments)}}(),createUserCredentials=function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark((function _callee2(resourceConnectionString,displayName,teamsMeetingLink){var tokenClient,_yield$tokenClient$cr,user,token,endpointUrl,chatClient,locator,threadId;return regeneratorRuntime.wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return tokenClient=new _azure_communication_identity__WEBPACK_IMPORTED_MODULE_13__.a(resourceConnectionString),_context2.next=3,tokenClient.createUserAndToken(["voip","chat"]);case 3:if(_yield$tokenClient$cr=_context2.sent,user=_yield$tokenClient$cr.user,token=_yield$tokenClient$cr.token,endpointUrl=new URL(resourceConnectionString.replace("endpoint=","").split(";")[0]).toString(),chatClient=new _azure_communication_chat__WEBPACK_IMPORTED_MODULE_11__.a(endpointUrl,new _azure_communication_common__WEBPACK_IMPORTED_MODULE_12__.a(token)),locator=teamsMeetingLink?{meetingLink:teamsMeetingLink}:{groupId:Object(uuid__WEBPACK_IMPORTED_MODULE_14__.a)()},!teamsMeetingLink){_context2.next=13;break}_context2.t0=getChatThreadFromTeamsLink(teamsMeetingLink),_context2.next=16;break;case 13:return _context2.next=15,createNewChatThread(chatClient,[{id:user,displayName:displayName}]);case 15:_context2.t0=_context2.sent;case 16:return threadId=_context2.t0,_context2.abrupt("return",{userId:user,token:token,displayName:displayName,endpointUrl:endpointUrl,locator:locator,threadId:threadId});case 18:case"end":return _context2.stop()}}),_callee2)})));return function createUserCredentials(_x3,_x4,_x5){return _ref2.apply(this,arguments)}}()},425:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return ConfigHintBanner})),__webpack_require__.d(__webpack_exports__,"b",(function(){return ConfigJoinMeetingHintBanner}));__webpack_require__(0);var _CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(169),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1),ConfigHintBanner=function ConfigHintBanner(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__.b)(["Please provide the connection string and display name to use."])})},ConfigJoinMeetingHintBanner=function ConfigJoinMeetingHintBanner(){return Object(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.Fragment,{children:Object(_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_1__.b)(["Please provide the connection string, display name and Teams meeting link to use."])})};ConfigHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MeetingComposite/Utils.tsx"]={name:"ConfigHintBanner",docgenInfo:ConfigHintBanner.__docgenInfo,path:"stories/MeetingComposite/Utils.tsx"}),ConfigJoinMeetingHintBanner.__docgenInfo={description:"",methods:[],displayName:"ConfigJoinMeetingHintBanner"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/MeetingComposite/Utils.tsx"]={name:"ConfigJoinMeetingHintBanner",docgenInfo:ConfigJoinMeetingHintBanner.__docgenInfo,path:"stories/MeetingComposite/Utils.tsx"})},428:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return LayoutsDocs_getDocs}));var esm=__webpack_require__(5),src=(__webpack_require__(0),__webpack_require__(24)),Persona=__webpack_require__(560),Persona_types=__webpack_require__(26),lib=__webpack_require__(20),Stack=__webpack_require__(99),jsx_runtime=__webpack_require__(1),OneToOneCallLayout_snippet_renderPersona=function renderPersona(){return Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size56,hidePersonaDetails:!0,text:"Toby",initialsTextColor:"white"})};OneToOneCallLayout_snippet_renderPersona.displayName="renderPersona";var OneToOneCallLayout_snippet_OneToOneCallLayoutExample=function OneToOneCallLayoutExample(){var videoStreamStyle=Object(lib.G)({border:"1",borderStyle:"solid",position:"absolute",bottom:".25rem",right:".25rem",height:"25%",width:"30%"});return Object(jsx_runtime.jsx)(Stack.a,{style:{height:"500px",width:"600px",border:"1px"},horizontal:!0,children:Object(jsx_runtime.jsx)(src.v,{styles:{overlayContainer:videoStreamStyle},displayName:"Holly",children:Object(jsx_runtime.jsx)(src.v,{onRenderPlaceholder:OneToOneCallLayout_snippet_renderPersona})})})};OneToOneCallLayout_snippet_OneToOneCallLayoutExample.displayName="OneToOneCallLayoutExample",OneToOneCallLayout_snippet_OneToOneCallLayoutExample.__docgenInfo={description:"",methods:[],displayName:"OneToOneCallLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Layouts/snippets/OneToOneCallLayout.snippet.tsx"]={name:"OneToOneCallLayoutExample",docgenInfo:OneToOneCallLayout_snippet_OneToOneCallLayoutExample.__docgenInfo,path:"stories/Examples/Layouts/snippets/OneToOneCallLayout.snippet.tsx"});__webpack_require__(34);var ScreenShareLayout_snippet_renderPersona=function renderPersona(props){return Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size56,hidePersonaDetails:!0,text:props.displayName,initialsTextColor:"white"})};ScreenShareLayout_snippet_renderPersona.displayName="renderPersona";var ScreenShareLayout_snippet_renderScreenSharePlaceholder=function renderScreenSharePlaceholder(){return Object(jsx_runtime.jsx)(Stack.a,{className:Object(lib.G)({height:"100%"}),children:Object(jsx_runtime.jsx)(Stack.a,{verticalAlign:"center",horizontalAlign:"center",className:Object(lib.G)({height:"100%"}),children:"Your Screen Share Stream"})})};ScreenShareLayout_snippet_renderScreenSharePlaceholder.displayName="renderScreenSharePlaceholder";var ScreenShareLayout_snippet_renderSharePersonaPlaceholder=function renderSharePersonaPlaceholder(){return Object(jsx_runtime.jsx)(Persona.a,{styles:{root:{margin:"auto"}},size:Persona_types.c.size56,hidePersonaDetails:!0,text:"Toby",initialsTextColor:"white"})};ScreenShareLayout_snippet_renderSharePersonaPlaceholder.displayName="renderSharePersonaPlaceholder";var ScreenShareLayout_snippet_ScreenShareLayoutExample=function ScreenShareLayoutExample(){var aspectRatioBoxStyle=Object(lib.G)({borderWidth:".063rem .063rem .025rem .063rem",borderStyle:"solid",width:"100%",height:0,position:"relative",paddingTop:"56.25%"}),aspectRatioBoxContentStyle=Object(lib.G)({position:"absolute",top:0,left:0,width:"100%",height:"100%"}),videoStreamStyle=Object(lib.G)({border:"1",borderStyle:"solid",position:"absolute",bottom:".25rem",right:".25rem",height:"20%",width:"30%"}),participantsComponents=["Michael","Jim","Pam","Dwight","Kelly","Ryan","Andy"].map((function(participantDisplayName,index){return Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxStyle,children:Object(jsx_runtime.jsx)(Stack.a,{className:aspectRatioBoxContentStyle,children:Object(jsx_runtime.jsx)(src.v,{displayName:participantDisplayName,onRenderPlaceholder:ScreenShareLayout_snippet_renderPersona})})},index)}));return Object(jsx_runtime.jsxs)(Stack.a,{style:{height:"31.25rem",width:"53.125rem",border:".063rem"},horizontal:!0,children:[Object(jsx_runtime.jsx)(Stack.a.Item,{className:Object(lib.G)({height:"100%",width:"30%"}),children:Object(jsx_runtime.jsx)(Stack.a,{grow:!0,className:Object(lib.G)({height:"100%",overflow:"auto"}),children:participantsComponents})}),Object(jsx_runtime.jsx)(Stack.a.Item,{grow:!0,className:Object(lib.G)({height:"100%"}),children:Object(jsx_runtime.jsx)(src.v,{styles:{overlayContainer:videoStreamStyle},onRenderPlaceholder:ScreenShareLayout_snippet_renderScreenSharePlaceholder,children:Object(jsx_runtime.jsx)(src.v,{onRenderPlaceholder:ScreenShareLayout_snippet_renderSharePersonaPlaceholder})})})]})};ScreenShareLayout_snippet_ScreenShareLayoutExample.displayName="ScreenShareLayoutExample",ScreenShareLayout_snippet_ScreenShareLayoutExample.__docgenInfo={description:"",methods:[],displayName:"ScreenShareLayoutExample"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Layouts/snippets/ScreenShareLayout.snippet.tsx"]={name:"ScreenShareLayoutExample",docgenInfo:ScreenShareLayout_snippet_ScreenShareLayoutExample.__docgenInfo,path:"stories/Examples/Layouts/snippets/ScreenShareLayout.snippet.tsx"});var OneToOneCallLayoutExampleText=__webpack_require__(1434).default,ScreenShareLayoutExampleText=__webpack_require__(1435).default,LayoutsDocs_getDocs=function getDocs(){return Object(jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[Object(jsx_runtime.jsx)(esm.j,{children:"Layouts"}),Object(jsx_runtime.jsx)(esm.c,{children:"In this section, we showcase different examples of building your own calling gallery layouts using `VideoTile` component from `@azure/communication-react` package and `@fluentui/react` package."}),Object(jsx_runtime.jsx)(esm.c,{children:"In these examples, we use [Stack](https://developer.microsoft.com/en-us/fluentui#/controls/web/stack) component from `fluentui` to build a layout for our video tiles. For the individual elements in this layout we use `VideoTile` from `@azure/communication-react` to render each participant. We are not passing in video stream to the `VideoTile` component in these examples, instead a [Persona](https://developer.microsoft.com/en-us/fluentui#/controls/web/persona) component is used as a placeholder component."}),Object(jsx_runtime.jsx)(esm.c,{children:"Note: In the code examples, all `%` characters wer replaced by their unicode value `\\u0025` due to URI malformed issue when loading the storybook snippets"}),Object(jsx_runtime.jsx)(esm.d,{children:"OneToOne Call Layout"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:OneToOneCallLayoutExampleText,children:Object(jsx_runtime.jsx)(OneToOneCallLayout_snippet_OneToOneCallLayoutExample,{})}),Object(jsx_runtime.jsx)(esm.d,{children:"Screenshare Layout"}),Object(jsx_runtime.jsx)(esm.b,{mdxSource:ScreenShareLayoutExampleText,children:Object(jsx_runtime.jsx)(ScreenShareLayout_snippet_ScreenShareLayoutExample,{})}),Object(jsx_runtime.jsx)(esm.c,{children:"In the example above, we show a layout containing 30% of side panel on the left and 70% screen share stream on the right. To customize the proportion of the side panel, you can change the `width` of the side panel component and the screen share component will take the rest of the width automatically."}),Object(jsx_runtime.jsx)(esm.c,{children:"For the individual video tile in the side panel, it has aspect ratio `16:9`. To customize the aspect ratio of the video tile, you can change the `paddingTop` field in the `aspectRatioBoxStyle` to be the ratio you want."})]})};LayoutsDocs_getDocs.__docgenInfo={description:"",methods:[],displayName:"getDocs"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["stories/Examples/Layouts/LayoutsDocs.tsx"]={name:"getDocs",docgenInfo:LayoutsDocs_getDocs.__docgenInfo,path:"stories/Examples/Layouts/LayoutsDocs.tsx"})},540:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_exports__.default="import { FluentThemeProvider, StreamMedia, VideoTile, VideoTileStylesProps } from '@azure/communication-react';\nimport React from 'react';\nimport { useVideoStreams } from '../../utils';\n\nexport const VideoTileExample: () => JSX.Element = () => {\n  const customStyles: VideoTileStylesProps = {\n    root: { height: '300px', width: '400px' },\n    videoContainer: { border: '5px solid firebrick' },\n    overlayContainer: { background: 'rgba(165, 13, 13, 0.5)' },\n    displayNameContainer: { top: '1rem', bottom: 'auto', right: '1rem', left: 'auto', backgroundColor: 'blue' }\n  };\n\n  const videoStreamElement = useVideoStreams(1)[0];\n\n  return (\n    <FluentThemeProvider>\n      <VideoTile\n        renderElement={\n          // NOTE: Replace with your own video provider. (An html element with video stream)\n          <StreamMedia videoStreamElement={videoStreamElement} />\n        }\n        displayName={'Jack Reacher'}\n        isMirrored={true}\n        isMuted={true}\n        styles={customStyles}\n      />\n    </FluentThemeProvider>\n  );\n};\n"},6:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"h",(function(){return getControlledBotAvatarSymbol})),__webpack_require__.d(__webpack_exports__,"d",(function(){return defaultControlsCameras})),__webpack_require__.d(__webpack_exports__,"e",(function(){return defaultControlsMicrophones})),__webpack_require__.d(__webpack_exports__,"f",(function(){return defaultControlsSpeakers})),__webpack_require__.d(__webpack_exports__,"i",(function(){return getControlledTheme})),__webpack_require__.d(__webpack_exports__,"a",(function(){return controlsToAdd})),__webpack_require__.d(__webpack_exports__,"j",(function(){return hiddenControl})),__webpack_require__.d(__webpack_exports__,"b",(function(){return defaultCallCompositeHiddenControls})),__webpack_require__.d(__webpack_exports__,"c",(function(){return defaultChatCompositeHiddenControls})),__webpack_require__.d(__webpack_exports__,"g",(function(){return defaultMeetingCompositeHiddenControls}));var _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(837),_fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1528),_fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(1526),_fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(1527),_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(169),_constants__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(13),getControlledBotAvatarSymbol=function getControlledBotAvatarSymbol(AvatarName){switch(AvatarName){case"Default":return"";case"Cat":return"";case"Fox":return"";case"Koala":return""}return""},defaultControlsCameras=[{id:"camera1",name:"Full HD Webcam"},{id:"camera2",name:"Macbook Pro Webcam"}],defaultControlsMicrophones=[{id:"mic1",name:"Realtek HD Audio"},{id:"mic2",name:"Macbook Pro Mic"}],defaultControlsSpeakers=[{id:"speaker1",name:"Realtek HD Audio"},{id:"speaker2",name:"Macbook Pro Speaker"}],getControlledTheme=function getControlledTheme(choice){switch(choice){case"Default":return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_0__.a;case"Dark":return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_1__.a;case"Teams":return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_2__.a;case"Word":return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_3__.a}return _fluentui_theme_samples__WEBPACK_IMPORTED_MODULE_0__.a},controlsToAdd={avatarInitials:{control:"text",defaultValue:"A B",name:"Avatar initials"},botAvatar:{control:"radio",options:["Default","Cat","Fox","Koala"],defaultValue:"Default",name:"Bot Avatar"},callerImages:{control:"file",accept:".jpeg, .jpg, .png",defaultValue:[],name:"Avatar"},callerName:{control:"text",defaultValue:"Maximus Aurelius",name:"Caller Name"},callerNameAlt:{control:"text",defaultValue:"1st",name:"Caller Name Alt"},callerTitle:{control:"text",defaultValue:"Emperor and Philosopher, Rome",name:"Caller Title"},callInvitationURL:{control:"text",defaultValue:"",name:"Optional URL to invite other participants to the call"},callLocator:{control:"text",defaultValue:"",name:"Call locator (ACS group ID or Teams meeting link)"},callModalAlertText:{control:"text",defaultValue:"Incoming Video Call",name:"Alert Text"},callToastAlertText:{control:"text",defaultValue:"Incoming Call",name:"Alert Text"},callStateText:{control:"text",defaultValue:"You're in the lobby",name:"Call State Text"},callStateSubText:{control:"text",defaultValue:"You should be admitted shortly",name:"Call State Subtext"},cameras:{control:"object",defaultValue:defaultControlsCameras,name:"Cameras"},chatThreadId:{control:"text",defaultValue:"",name:"Existing thread"},checked:{control:"boolean",defaultValue:!1,name:"Is checked"},connectionString:{control:"text",defaultValue:"",name:_CompositeStringUtils__WEBPACK_IMPORTED_MODULE_4__.a},controlBarDefaultIcons:{control:"radio",options:["airplane","bus","ship"],defaultValue:"airplane",name:"Icon"},controlBarLayout:{control:"select",options:["horizontal","vertical","dockedTop","dockedBottom","dockedLeft","dockedRight","floatingTop","floatingBottom","floatingLeft","floatingRight"],defaultValue:"floatingBottom",name:"Layout"},disabled:{control:"boolean",defaultValue:!1,name:"Disable component"},displayName:{control:"text",defaultValue:"",name:"Display Name"},enableJumpToNewMessageButton:{control:"boolean",defaultValue:!0,name:"Enable Jump To New Message"},endpointUrl:{control:"text",defaultValue:"",name:"Azure Communication Services endpoint URL"},errorTypes:{control:"check",options:["unableToReachChatService","accessDenied","userNotInThisThread","sendMessageNotInThisThread","sendMessageGeneric"],defaultValue:["accessDenied"],name:"ErrorType"},excludeMeFromList:{control:"boolean",defaultValue:!1,name:"Are you excluded from the list"},font:{control:"text",defaultValue:"Monaco, Menlo, Consolas",name:"Font"},gridParticipants:{control:"object",defaultValue:[{displayName:"Michael",isVideoReady:!1},{displayName:"Jim",isVideoReady:!1},{displayName:"Pam",isVideoReady:!1},{displayName:"Dwight",isVideoReady:!1}],name:"Participants"},isCameraEnabled:{control:"boolean",defaultValue:!0,name:"Is camera available"},isMe:{control:"boolean",defaultValue:!1,name:"Is You"},isMicrophoneEnabled:{control:"boolean",defaultValue:!0,name:"Is microphone available"},isMuteAllAvailable:{control:"boolean",defaultValue:!1,name:"User option to mute all participants is availble"},isMuted:{control:"boolean",defaultValue:!1,name:"Is muted"},isScreenSharing:{control:"boolean",defaultValue:!1,name:"Is screen sharing"},isSendBoxWithWarning:{control:"boolean",defaultValue:!1,name:"Has warning/information message"},isVideoAvailable:{control:"boolean",defaultValue:!0,name:"Is video available"},isVideoMirrored:{control:"boolean",defaultValue:!1,name:"Is video mirrored"},isVideoReady:{control:"boolean",defaultValue:!1,name:"Is Video ready"},layoutHeight:{control:{type:"range",min:_constants__WEBPACK_IMPORTED_MODULE_5__.h.min,max:_constants__WEBPACK_IMPORTED_MODULE_5__.h.max,step:_constants__WEBPACK_IMPORTED_MODULE_5__.h.step},defaultValue:_constants__WEBPACK_IMPORTED_MODULE_5__.g,name:"Height (px)"},layoutWidth:{control:{type:"range",min:_constants__WEBPACK_IMPORTED_MODULE_5__.j.min,max:_constants__WEBPACK_IMPORTED_MODULE_5__.j.max,step:_constants__WEBPACK_IMPORTED_MODULE_5__.j.step},defaultValue:_constants__WEBPACK_IMPORTED_MODULE_5__.i,name:"Width (px)"},localParticipantDisplayName:{control:"text",defaultValue:"John Doe",name:"Local Participant displayName"},localParticipant:{control:"object",defaultValue:[{name:"You",status:"Connected",isMuted:!1,isScreenSharing:!1}],name:"Your information"},localVideoInverted:{control:"boolean",defaultValue:!0,name:"Invert Local Video"},localVideoStreamEnabled:{control:"boolean",defaultValue:!0,name:"Turn Local Video On"},messageDeliveredTooltipText:{control:"text",defaultValue:"Sent",name:"Delivered icon tooltip text"},messageFailedToSendTooltipText:{control:"text",defaultValue:"Failed to send",name:"Failed to send icon tooltip text"},messageSeenTooltipText:{control:"text",defaultValue:"Seen",name:"Seen icon tooltip text"},messageSendingTooltipText:{control:"text",defaultValue:"Sending",name:"Sending icon tooltip text"},messageStatus:{control:"select",options:["delivered","sending","seen","failed"],defaultValue:"delivered",name:"Message Status"},microphones:{control:"object",defaultValue:defaultControlsMicrophones,name:"Microphones"},participantItemMenuItemsStr:{control:"text",defaultValue:"Mute, Remove",name:"Menu items (comma separated)"},participantNames:{control:"text",defaultValue:"You, Hal Jordan, Barry Allen, Bruce Wayne",name:"Participants (comma separated with You being local user)"},remoteParticipantNames:{control:"text",defaultValue:"Rick, Daryl, Michonne, Dwight",name:"Other participants (comma separated)"},remoteParticipants:{control:"object",defaultValue:[{name:"Rick",status:"InLobby",isMuted:!1,isScreenSharing:!1},{name:"Daryl",status:"Connecting",isMuted:!1,isScreenSharing:!1},{name:"Michonne",status:"Idle",isMuted:!1,isScreenSharing:!1}],name:"Remote participants"},screenShareLayoutWidth:{control:{type:"range",min:_constants__WEBPACK_IMPORTED_MODULE_5__.j.min,max:_constants__WEBPACK_IMPORTED_MODULE_5__.j.max,step:_constants__WEBPACK_IMPORTED_MODULE_5__.j.step},defaultValue:850,name:"Width (px)"},screenShareSidePanelTileAspectRatio:{control:"select",options:["16:9","3:2","4:3","5:9","1:1"],defaultValue:"16:9",name:"Side Panel Tile Aspect Ratio (Width:Height)"},screenShareSidePanelWidthRatio:{control:"select",options:["30%","35%","40%","45%","50%"],defaultValue:"30%",name:"Side Panel Width Ratio"},sendBoxWarningMessage:{control:"text",defaultValue:"Please wait 30 seconds to send new messages",name:"Warning/information message for SendBox"},showChatParticipants:{control:"boolean",defaultValue:!0,name:"Show Participants Pane"},showChatTopic:{control:"boolean",defaultValue:!0,name:"Show Topic"},showLabel:{control:"boolean",defaultValue:!1,name:"Show label"},showMessageDate:{control:"boolean",defaultValue:!0,name:"Enable Message Date"},showMessageStatus:{control:"boolean",defaultValue:!0,name:"Enable Message Status Indicator"},showMuteIndicator:{control:"boolean",defaultValue:!0,name:"Show Mute/UnMute Indicator"},speakers:{control:"object",defaultValue:defaultControlsSpeakers,name:"Speakers"},teamsMeetingLink:{control:"text",defaultValue:"",name:"Teams meeting link"},theme:{control:"radio",options:["Default","Dark","Teams","Word"],defaultValue:"Default",name:"Theme"},token:{control:"text",defaultValue:"",name:"Valid token for user"},typingUsers:{control:"object",defaultValue:[{userId:"1",displayName:"User1"},{userId:"2",displayName:"User2"}],name:"Typing users"},userId:{control:"text",defaultValue:"",name:"User identifier for user"},videoGallerylayout:{control:"select",options:["default","floatingLocalVideo"],defaultValue:"default",name:"Layout"},videoTileHeight:{control:{type:"range",min:80,max:800,step:10},defaultValue:300,name:"Height (px)"},videoTileWidth:{control:{type:"range",min:100,max:1200,step:10},defaultValue:400,name:"Width (px)"}},hiddenControl={control:!1,table:{disable:!0}},defaultCallCompositeHiddenControls={adapter:hiddenControl,fluentTheme:hiddenControl,onRenderAvatar:hiddenControl,identifiers:hiddenControl,locale:hiddenControl,rtl:hiddenControl},defaultChatCompositeHiddenControls={adapter:hiddenControl,fluentTheme:hiddenControl,onRenderAvatar:hiddenControl,onRenderMessage:hiddenControl,onRenderTypingIndicator:hiddenControl,options:hiddenControl,identifiers:hiddenControl,locale:hiddenControl,rtl:hiddenControl},defaultMeetingCompositeHiddenControls={callAdapter:hiddenControl,chatAdapter:hiddenControl,fluentTheme:hiddenControl,meetingInvitationURL:hiddenControl,rtl:hiddenControl}},793:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(Sie)","menuTitle":"Mehr Optionen"},"typingIndicator":{"singleUser":"{user} tippt ...","multipleUsers":"{users} tippen gerade ...","multipleUsersAbbreviateOne":"{users} und 1 anderer tippen gerade ...","multipleUsersAbbreviateMany":"{users} und {numOthers} andere tippen gerade ...","delimiter":", "},"sendBox":{"placeholderText":"Eine Nachricht schreiben"},"messageStatusIndicator":{"deliveredTooltipText":"Geschickt","seenTooltipText":"Gesehen","sendingTooltipText":"Senden","failedToSendTooltipText":"Senden fehlgeschlagen"},"endCallButton":{"label":"Verlassen"},"cameraButton":{"onLabel":"Ausschalten","offLabel":"Einschalten"},"microphoneButton":{"onLabel":"Stumm","offLabel":"Einschalten"},"optionsButton":{"label":"Optionen","cameraMenuTitle":"Kamera","cameraMenuTooltip":"Kamera whlen","microphoneMenuTitle":"Mikrofon","microphoneMenuTooltip":"Mikrofon auswhlen","speakerMenuTitle":"Lautsprecher","speakerMenuTooltip":"Lautsprecher auswhlen"},"participantsButton":{"label":"Leute","menuHeader":"In diesem Anruf","participantsListButtonLabel":"{numParticipants} Leute","muteAllButtonLabel":"Alle stummschalten","copyInviteLinkButtonLabel":"Einladungslink kopieren"},"screenShareButton":{"onLabel":"Halt","offLabel":"Teilen"},"messageThread":{"yesterday":"Gestern","sunday":"Sonntag","monday":"Montag","tuesday":"Dienstag","wednesday":"Mittwoch","thursday":"Donnerstag","friday":"Freitag","saturday":"Samstag","participantJoined":"ist dem Chat beigetreten.","participantLeft":"hat den Chat verlassen."},"errorBar":{"unableToReachChatService":"Du bist offline.","accessDenied":"Kein Zugriff auf Chat-Dienste mglich - bitte berprfen Sie die bereitgestellten Benutzerdaten.","userNotInThisThread":"Du bist nicht mehr in diesem Chat-Thread","sendMessageNotInThisThread":"Nachricht konnte nicht gesendet werden, da Sie sich nicht mehr in diesem Chat-Thread befinden","sendMessageGeneric":"Fehler beim senden einer nachricht"}}')},794:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"()","menuTitle":"  "},"typingIndicator":{"singleUser":"{user}  ...","multipleUsers":"{users}  ...","multipleUsersAbbreviateOne":"{users}     ...","multipleUsersAbbreviateMany":"{users}    ...","delimiter":"  "},"sendBox":{"placeholderText":" "},"messageStatusIndicator":{"deliveredTooltipText":"","seenTooltipText":"","sendingTooltipText":"","failedToSendTooltipText":"  "},"endCallButton":{"label":""},"cameraButton":{"onLabel":"","offLabel":""},"microphoneButton":{"onLabel":"","offLabel":""},"optionsButton":{"label":"","cameraMenuTitle":" ","cameraMenuTooltip":" ","microphoneMenuTitle":"","microphoneMenuTooltip":" ","speakerMenuTitle":" ","speakerMenuTooltip":"  "},"participantsButton":{"label":"","menuHeader":"  ","participantsListButtonLabel":" {numParticipants}","muteAllButtonLabel":" ","copyInviteLinkButtonLabel":"  "},"screenShareButton":{"onLabel":"","offLabel":""},"messageThread":{"yesterday":"","sunday":"","monday":"","tuesday":" ","wednesday":"","thursday":" ","friday":"","saturday":"","participantJoined":"  ","participantLeft":" "},"errorBar":{"unableToReachChatService":"  ","accessDenied":"     -       ","userNotInThisThread":"     ","sendMessageNotInThisThread":"         ","sendMessageGeneric":"  "}}')},795:function(module){module.exports=JSON.parse('{"participantItem":{"isMeText":"(toi)","menuTitle":"Plus d\'options"},"typingIndicator":{"singleUser":"{user} tape ...","multipleUsers":"{users} tapent ...","multipleUsersAbbreviateOne":"{users} et 1 autre tapent  ...","multipleUsersAbbreviateMany":"{users} et {numOthers} autre tapent ...","delimiter":", "},"sendBox":{"placeholderText":"Entrez un message"},"messageStatusIndicator":{"deliveredTooltipText":"Envoy","seenTooltipText":"Vu","sendingTooltipText":"Envoi","failedToSendTooltipText":"chec de l\'envoi"},"endCallButton":{"label":"Quitter"},"cameraButton":{"onLabel":"teindre","offLabel":"Allumer"},"microphoneButton":{"onLabel":"Desactiver","offLabel":"Activer"},"optionsButton":{"label":"Options","cameraMenuTitle":"Camra","cameraMenuTooltip":"Choisissez Camra","microphoneMenuTitle":"Microphone","microphoneMenuTooltip":"Choisissez Microphone","speakerMenuTitle":"Speaker","speakerMenuTooltip":"Choose Speaker"},"participantsButton":{"label":"People","menuHeader":"In this call","participantsListButtonLabel":"{numParticipants} people","muteAllButtonLabel":"Rendre tout silencieux","copyInviteLinkButtonLabel":"Copier le lien d\'invitation"},"screenShareButton":{"onLabel":"Arrter","offLabel":"Partager"},"messageThread":{"yesterday":"Hier","sunday":"Dimanche","monday":"Lundi","tuesday":"Mardi","wednesday":"Mercredi","thursday":"Jeudi","friday":"Vendredi","saturday":"Samedi","participantJoined":"a rejoint la conversation.","participantLeft":"a quitt la conversation."},"errorBar":{"unableToReachChatService":"Vous tes hors ligne.","accessDenied":"Impossible d\'accder aux services de chat - veuillez vrifier les informations d\'identification de l\'utilisateur fournies","userNotInThisThread":"Vous n\'tes plus dans ce fil de discussion","sendMessageNotInThisThread":"chec de l\'envoi du message car vous n\'tes plus dans ce fil de discussion","sendMessageGeneric":"chec de l\'envoi du message"}}')},879:function(module,exports,__webpack_require__){__webpack_require__(880),__webpack_require__(1035),__webpack_require__(1036),__webpack_require__(1490),__webpack_require__(1477),__webpack_require__(1505),__webpack_require__(1482),__webpack_require__(1506),__webpack_require__(1483),__webpack_require__(1485),__webpack_require__(1491),module.exports=__webpack_require__(1298)},947:function(module,exports){}},[[879,2,3]]]);